{
  final EditorCell selectedCell=getEditorCell();
  if (type == CellActionType.DELETE && selectedCell.isLastPositionInBigCell() && !selectedCell.isFirstPositionInBigCell()) {
    final EditorCell target;
    if (selectedCell.isLastPositionInBigCell() && selectedCell.getContainingBigCell().getNextSibling() != null) {
      target=selectedCell.getContainingBigCell().getNextSibling();
    }
 else     if (selectedCell.getNextSibling() != null) {
      target=selectedCell.getNextSibling();
    }
 else {
      target=selectedCell.getNextLeaf(CellConditions.SELECTABLE);
    }
    if (target == null || ModelAccess.instance().runReadAction(new Computable<Boolean>(){
      @Override public Boolean compute(){
        return jetbrains.mps.util.SNodeOperations.isAncestor(target.getSNode(),selectedCell.getSNode());
      }
    }
))     return false;
    return getEditorComponent().getActionHandler().executeAction(target,CellActionType.DELETE);
  }
  if (type == CellActionType.BACKSPACE && selectedCell.isFirstPositionInBigCell() && !selectedCell.isLastPositionInBigCell()) {
    final EditorCell target;
    if (selectedCell.isFirstPositionInBigCell() && selectedCell.getContainingBigCell().getPrevSibling() != null) {
      target=selectedCell.getContainingBigCell().getPrevSibling();
    }
 else     if (selectedCell.getPrevSibling() != null) {
      target=selectedCell.getPrevSibling();
    }
 else {
      target=selectedCell.getPrevLeaf(CellConditions.SELECTABLE);
    }
    if (target == null)     return false;
    return getEditorComponent().getActionHandler().executeAction(target,CellActionType.DELETE);
  }
  return false;
}
