{
  final EditorCell selectedCell=getEditorCell();
  if (type == CellActionType.DELETE && selectedCell.isLastPositionInBigCell() && !selectedCell.isFirstPositionInBigCell()) {
    final jetbrains.mps.openapi.editor.cells.EditorCell target;
    jetbrains.mps.openapi.editor.cells.EditorCell bigCellNextSibling=CellTraversalUtil.getNextSibling(selectedCell.getContainingBigCell());
    if (selectedCell.isLastPositionInBigCell() && bigCellNextSibling != null) {
      target=bigCellNextSibling;
    }
 else {
      jetbrains.mps.openapi.editor.cells.EditorCell nextSibling=CellTraversalUtil.getNextSibling(selectedCell.getContainingBigCell());
      if (nextSibling != null) {
        target=nextSibling;
      }
 else {
        target=CellTraversalUtil.getNextLeaf(selectedCell,jetbrains.mps.openapi.editor.cells.CellConditions.SELECTABLE);
      }
    }
    if (target == null || ModelAccess.instance().runReadAction(new Computable<Boolean>(){
      @Override public Boolean compute(){
        return jetbrains.mps.util.SNodeOperations.isAncestor(target.getSNode(),selectedCell.getSNode());
      }
    }
))     return false;
    return getEditorComponent().getActionHandler().executeAction(target,CellActionType.DELETE);
  }
  if (type == CellActionType.BACKSPACE && selectedCell.isFirstPositionInBigCell() && !selectedCell.isLastPositionInBigCell()) {
    final jetbrains.mps.openapi.editor.cells.EditorCell target;
    jetbrains.mps.openapi.editor.cells.EditorCell bigCellPrevSibling=CellTraversalUtil.getPrevSibling(selectedCell.getContainingBigCell());
    if (selectedCell.isFirstPositionInBigCell() && bigCellPrevSibling != null) {
      target=bigCellPrevSibling;
    }
 else {
      jetbrains.mps.openapi.editor.cells.EditorCell prevSibling=CellTraversalUtil.getPrevSibling(selectedCell);
      if (prevSibling != null) {
        target=prevSibling;
      }
 else {
        target=CellTraversalUtil.getPrevLeaf(selectedCell,jetbrains.mps.openapi.editor.cells.CellConditions.SELECTABLE);
      }
    }
    if (target == null)     return false;
    return getEditorComponent().getActionHandler().executeAction(target,CellActionType.DELETE);
  }
  return false;
}
