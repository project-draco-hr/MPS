{
  TypeCheckingContext typeCheckingContext=TypeContextManager.getInstance().createTypeCheckingContext(node.getContainingRoot());
  typeCheckingContext.checkIfNotChecked(node,true);
  if (typeCheckingContext instanceof TypeCheckingContextNew) {
    State state=((TypeCheckingContextNew)typeCheckingContext).getState();
    State state2=new State(state.getTypeCheckingContext());
    AbstractOperation rootOperation=state.getOperation();
    List<AbstractOperation> operations=state.getOperationsAsList();
    int num=operations.size() / 3;
    AbstractOperation operation=operations.get(num);
    Collections.reverse(operations);
    state2.executeOperationsBeforeAnchor(rootOperation,operation);
    for (    AbstractOperation toRevert : operations) {
      if (toRevert.equals(operation)) {
        break;
      }
      toRevert.undo(state);
    }
    Assert.assertTrue(StateMatcher.match(state,state2));
  }
}
