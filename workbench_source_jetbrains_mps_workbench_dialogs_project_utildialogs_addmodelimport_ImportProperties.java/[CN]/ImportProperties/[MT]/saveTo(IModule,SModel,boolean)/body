{
  for (  SModelReference imported : getModelsToImport(all)) {
    targetModel.addModelImport(imported,false);
  }
  for (  ModuleReference language : getLanguagesToImport(all)) {
    targetModel.addLanguage(language);
  }
  for (  ModuleReference devkit : getDevkitsToImport(all)) {
    targetModel.addDevKit(devkit);
  }
  for (  ModuleReference language : getLanguagesToImport(all)) {
    targetModule.getModuleDescriptor().getUsedLanguages().add(language);
  }
  for (  ModuleReference devkit : getDevkitsToImport(all)) {
    targetModule.getModuleDescriptor().getUsedDevkits().add(devkit);
  }
  List<Dependency> deps=getNewModuleDependencies(all);
  if (!deps.isEmpty()) {
    ModuleDescriptor descriptor=targetModule.getModuleDescriptor();
    if (descriptor != null) {
      for (      Dependency dep : deps) {
        descriptor.getDependencies().add(dep);
      }
      targetModule.setModuleDescriptor(descriptor,true);
    }
 else {
      targetModule.invalidateCaches();
    }
  }
  targetModule.save();
}
