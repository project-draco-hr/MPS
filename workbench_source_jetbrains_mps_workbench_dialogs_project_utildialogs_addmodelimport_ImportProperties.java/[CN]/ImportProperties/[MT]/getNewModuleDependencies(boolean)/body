{
  Set<ModuleReference> depModules=new HashSet<ModuleReference>();
  if (all) {
    for (    SModelReference model : myModels) {
      ModuleReference prefModule=getPreferredModuleForModel(model);
      if (prefModule != null) {
        depModules.add(prefModule);
      }
    }
  }
 else {
    for (    ModelImportDescriptor m : myModelImports) {
      if (!m.getIsImported())       continue;
      if (m.getModule() == null)       continue;
      depModules.add(m.getModule());
    }
  }
  List<Dependency> result=new ArrayList<Dependency>();
  for (  ModuleReference ref : depModules) {
    Dependency dep=new Dependency();
    dep.setModuleRef(ref);
    dep.setReexport(false);
    result.add(dep);
  }
  return result;
}
