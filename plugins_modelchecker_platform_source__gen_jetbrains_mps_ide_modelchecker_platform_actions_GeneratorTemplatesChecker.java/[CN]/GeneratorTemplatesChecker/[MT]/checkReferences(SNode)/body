{
  for (  SReference ref : ListSequence.fromList(SNodeOperations.getReferences(node))) {
    if ((AttributeOperations.getAttribute(node,new IAttributeDescriptor.LinkAttribute(MetaAdapterFactory.getConcept(0xb401a68083254110L,0x8fd384331ff25befL,0xfd7f44d616L,"jetbrains.mps.lang.generator.structure.ReferenceMacro"),ref.getLink())) != null)) {
      continue;
    }
    SNode target=jetbrains.mps.util.SNodeOperations.getTargetNodeSilently(ref);
    if (target == null) {
      continue;
    }
    if (!(SModelStereotype.isGeneratorModel(SNodeOperations.getModel(target)))) {
      continue;
    }
    SNode root=SNodeOperations.getContainingRoot(target);
    if (AttributeOperations.getAttribute(root,new IAttributeDescriptor.NodeAttribute(MetaAdapterFactory.getConcept(0xb401a68083254110L,0x8fd384331ff25befL,0x11017244494L,"jetbrains.mps.lang.generator.structure.RootTemplateAnnotation"))) == null) {
      continue;
    }
    if (root == SNodeOperations.getContainingRoot(node)) {
      continue;
    }
    SpecificChecker.addIssue(myResults,node,String.format("Reference across root templates in role '%s', use mapping label or reference macro",ref.getLink().getName()),ModelChecker.SEVERITY_WARNING,"Cross-template reference",null);
  }
}
