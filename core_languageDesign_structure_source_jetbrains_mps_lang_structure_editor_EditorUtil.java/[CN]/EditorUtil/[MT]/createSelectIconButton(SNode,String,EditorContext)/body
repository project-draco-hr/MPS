{
  IModule module=findAnchorModule(sourceNode);
  final Macros macros=Macros.moduleDescriptor(module);
  String path=sourceNode.getProperty(propertyName);
  final IModule finalModule=module;
  String filename=finalModule == null ? null : macros.expandPath(path,finalModule.getDescriptorFile());
  final File baseFile=filename == null ? null : new File(filename);
  final JButton button=new JButton();
  button.setAction(new AbstractAction("..."){
    public void actionPerformed(    ActionEvent e){
      Component root=SwingUtilities.getRoot(button);
      JFrame frame=root instanceof JFrame ? (JFrame)root : null;
      TreeFileChooser chooser=new TreeFileChooser();
      chooser.setContext(context.getOperationContext());
      if (baseFile != null && baseFile.exists()) {
        chooser.setInitialFile(FileSystem.getInstance().getFileByPath(baseFile.getAbsolutePath()));
      }
      IFile result=chooser.showDialog(frame);
      if (result == null)       return;
      String selectedPath=FileUtil.getCanonicalPath(result.getAbsolutePath());
      final String pathToShow;
      if (finalModule != null) {
        pathToShow=macros.shrinkPath(selectedPath,finalModule.getDescriptorFile());
      }
 else {
        pathToShow=selectedPath;
      }
      ModelAccess.instance().runWriteActionInCommand(new Runnable(){
        public void run(){
          sourceNode.setProperty(propertyName,pathToShow);
        }
      }
);
    }
  }
);
  return button;
}
