{
  if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.TypeVariableReference") && declTypes.size() > 0) {
    int idx=0;
    for (    SNode tvd : vars) {
      if (SPropertyOperations.getString(tvd,"name").equals(SPropertyOperations.getString(SLinkOperations.getTarget(type,"typeVariableDeclaration",false),"name"))) {
        return SNodeOperations.copyNode(declTypes.get(idx));
      }
      idx=idx + 1;
    }
  }
 else   if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.ClassifierType")) {
    for (    SNode pt : SLinkOperations.getTargets(type,"parameter",true)) {
      SNode rt=ClassifierTypeUtil.resolveType(pt,declTypes,vars);
      if (pt != rt) {
        SNodeOperations.replaceWithAnother(pt,rt);
      }
    }
  }
  return type;
}
