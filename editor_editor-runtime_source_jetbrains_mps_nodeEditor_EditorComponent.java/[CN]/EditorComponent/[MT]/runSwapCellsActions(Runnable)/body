{
  try {
    myCellSwapInProgress=true;
    EditorContext ec=getEditorContext();
    jetbrains.mps.openapi.editor.cells.EditorCell sc=getSelectedCell();
    if (sc != null) {
      myRecentlySelectedCellInfo=APICellAdapter.getCellInfo(sc);
    }
    Object memento=ec.createMemento();
    action.run();
    ec.pushTracerTask("restoring memento",true);
    ec.setMemento(memento);
    ec.popTracerTask();
    myRecentlySelectedCellInfo=null;
  }
  finally {
    myCellSwapInProgress=false;
  }
}
