{
  if (isDisposed())   return;
  clearModelDisposedTrace();
  if (myNode != null && notifiesCreation()) {
    notifyDisposal();
  }
  ModelAccess.instance().runReadAction(new Runnable(){
    @Override public void run(){
      disposeTypeCheckingContext();
      myNode=node;
      if (myNode != null) {
        myNodePointer=new jetbrains.mps.smodel.SNodePointer(myNode);
        myVirtualFile=!myNoVirtualFile ? MPSNodesVirtualFileSystem.getInstance().getFileFor(node) : null;
        setOperationContext(operationContext);
        SModel model=node.getModel();
        setEditorContext(new EditorContext(EditorComponent.this,model,operationContext));
        setReadOnly(model == null || model.isReadOnly());
      }
 else {
        myNodePointer=null;
        myVirtualFile=null;
        setOperationContext(null);
        setEditorContext(new EditorContext(EditorComponent.this,null,null));
        setReadOnly(true);
      }
      getTypeCheckingContext();
      rebuildEditorContent();
    }
  }
);
  if (myNode != null && notifiesCreation()) {
    notifyCreation();
  }
}
