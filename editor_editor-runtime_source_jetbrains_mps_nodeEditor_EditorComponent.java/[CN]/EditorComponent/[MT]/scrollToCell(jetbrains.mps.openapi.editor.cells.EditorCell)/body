{
  if (!myHasUI || getVisibleRect().isEmpty()) {
    return;
  }
  jetbrains.mps.openapi.editor.cells.EditorCell largestVerticalBigCell=cell;
  int viewportWidth=getViewport().getWidth();
  int x0;
  int width;
  if (cell instanceof EditorCell_Label) {
    EditorCell_Label cellLabel=(EditorCell_Label)cell;
    int caretX=cellLabel.getCaretX();
    int charWidth=cellLabel.getCharWidth();
    width=4 * charWidth;
    x0=caretX - 2 * charWidth;
  }
 else   if (getDeepestSelectedCell() instanceof EditorCell_Label && cell.getWidth() > viewportWidth) {
    EditorCell_Label cellLabel=(EditorCell_Label)getDeepestSelectedCell();
    int caretX=cellLabel.getCaretX();
    int charWidth=cellLabel.getCharWidth();
    x0=Math.max(cell.getX(),caretX + 2 * charWidth - viewportWidth);
    width=viewportWidth;
  }
 else {
    x0=cell.getX();
    width=cell.getWidth();
  }
  Rectangle visibleRect=getVisibleRect();
  Rectangle rectangle=new Rectangle(x0,visibleRect.y,width,visibleRect.height);
  if (!rectangle.isEmpty()) {
    boolean adjustHorizontally=!visibleRect.contains(rectangle);
    if (adjustHorizontally) {
      if (width <= viewportWidth) {
        int x1=Math.max(0,x0 + width - viewportWidth);
        scrollToRectIfNotVisible(expandRectangleOneLine(new Rectangle(x1,largestVerticalBigCell.getY(),x0 - x1 + width,largestVerticalBigCell.getHeight())));
      }
 else {
        scrollToRectIfNotVisible(expandRectangleOneLine(new Rectangle(x0 - SCROLL_GAP,largestVerticalBigCell.getY(),viewportWidth + SCROLL_GAP,largestVerticalBigCell.getHeight())));
      }
    }
 else {
      scrollToRectIfNotVisible(expandRectangleOneLine(new Rectangle(x0,largestVerticalBigCell.getY(),width,largestVerticalBigCell.getHeight())));
    }
  }
}
