{
  IdeMain.setTestMode(false);
  long start=System.currentTimeMillis();
  configureMPS();
  final SModel baseModel=readModel(args[0]);
  final SModel mineModel=readModel(args[1]);
  final SModel newModel=readModel(args[2]);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      final MergeModelsDialog dialog=ModelAccess.instance().runReadAction(new Computable<MergeModelsDialog>(){
        public MergeModelsDialog compute(){
          return new MergeModelsDialog(null,baseModel,mineModel,newModel);
        }
      }
);
      dialog.showDialog();
      final SModel result=dialog.getResultModel();
      if (result == null)       System.exit(0);
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          ModelPersistence.saveModel(result,FileSystem.getFile(args[3]));
        }
      }
);
    }
  }
);
}
