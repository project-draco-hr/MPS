{
  Set<SModuleReference> remove=new HashSet<SModuleReference>();
  Set<SModuleReference> add=new LinkedHashSet<SModuleReference>();
  for (  SModuleReference ref : refs) {
    SModuleReference newRef=jetbrains.mps.project.structure.modules.ModuleReference.update(ref);
    if (jetbrains.mps.project.structure.modules.ModuleReference.differs(ref,newRef)) {
      remove.add(ref);
      add.add((SModuleReference)newRef);
    }
  }
  refs.removeAll(remove);
  refs.addAll(add);
  return !remove.isEmpty();
}
