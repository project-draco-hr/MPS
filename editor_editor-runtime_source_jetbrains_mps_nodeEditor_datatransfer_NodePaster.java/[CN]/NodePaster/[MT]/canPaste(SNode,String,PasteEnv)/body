{
  if (myPasteNodes == null || myPasteNodes.isEmpty()) {
    return PASTE_N_A;
  }
  String role_=role != null ? role : pasteTarget.getRoleInParent();
  boolean canPasteAsRoot=(pasteTarget.getParent() == null) && canPasteAsRoots(pasteTarget.getModel());
  boolean canPasteToTarget=canPasteToTarget(pasteTarget,role_,true);
  if (pasteEnv == PasteEnv.PROJECT_TREE) {
    if (canPasteAsRoot) {
      return PASTE_TO_ROOT;
    }
    if (canPasteToTarget) {
      return PASTE_TO_TARGET;
    }
  }
 else {
    if (canPasteToTarget) {
      return PASTE_TO_TARGET;
    }
  }
  if (canPasteToParent(pasteTarget,role_,false)) {
    return PASTE_TO_PARENT;
  }
  return PASTE_N_A;
}
