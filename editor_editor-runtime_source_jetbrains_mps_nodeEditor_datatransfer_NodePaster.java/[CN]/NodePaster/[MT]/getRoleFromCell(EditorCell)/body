{
  String role=targetCell.getRole();
  if (role != null) {
    return role;
  }
  EditorCell_Collection actualCollection=(targetCell instanceof EditorCell_Collection) ? (EditorCell_Collection)targetCell : targetCell.getParent();
  if (actualCollection != null) {
    role=((jetbrains.mps.nodeEditor.cells.EditorCell_Collection)actualCollection).getCellNodesRole();
  }
  while (actualCollection != null && role == null) {
    actualCollection=actualCollection.getParent();
    if (actualCollection == null) {
      break;
    }
    role=((jetbrains.mps.nodeEditor.cells.EditorCell_Collection)actualCollection).getCellNodesRole();
  }
  if (role == null) {
    SNode pasteTarget=targetCell.getSNode();
    role=pasteTarget.getRoleInParent();
  }
  return role;
}
