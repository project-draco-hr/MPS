{
  String role=firstRole;
  SNode anchorNode=firstAnchorNode;
  while (anchorNode != null) {
    SNode container=anchorNode.getParent();
    if (container == null) {
      return null;
    }
    if (canPasteToTarget(container,role,firstAnchorNode == anchorNode)) {
      return new NodeAndRole(anchorNode,role);
    }
    if (exactly) {
      break;
    }
    anchorNode=container;
    role=anchorNode.getRoleInParent();
  }
  return null;
}
