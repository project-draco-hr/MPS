{
  if (isRegistered())   return;
  setIsRegistered(true);
  myWindowManager=ToolWindowManager.getInstance(myProject);
  if (myNumber != -1) {
    KeymapManager.getInstance().getActiveKeymap().addShortcut(ActivateToolWindowAction.getActionIdForToolWindow(myId),new KeyboardShortcut(KeyStroke.getKeyStroke("alt " + myNumber),null));
  }
  ToolWindow toolWindow=myWindowManager.registerToolWindow(myId,myCanCloseContent,myAnchor);
  JComponent component=getComponent();
  if (component != null) {
    if (!hasCloseButton()) {
      addContent(component,null,false);
    }
 else {
      DefaultGroup group=new DefaultGroup();
      group.add(new BaseAction("","Close",Icons.CLOSE_ICON){
        public void doExecute(        AnActionEvent e){
          getContentManager().removeAllContents(true);
        }
      }
);
      JPanel panel=new JPanel(new BorderLayout());
      panel.add(component,BorderLayout.CENTER);
      panel.add(ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,group,false).getComponent(),BorderLayout.WEST);
      addContent(panel,null,false);
    }
  }
  toolWindow.setIcon(myIcon);
  toolWindow.setToHideOnEmptyContent(true);
  toolWindow.installWatcher(toolWindow.getContentManager());
  if (!isInitiallyAvailable()) {
    setAvailable(false);
  }
}
