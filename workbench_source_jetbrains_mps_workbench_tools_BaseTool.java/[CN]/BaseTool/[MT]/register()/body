{
  if (myProject.isDisposed())   return;
  if (isRegistered())   return;
  setIsRegistered(true);
  myWindowManager=ToolWindowManager.getInstance(myProject);
  if (myNumber != -1) {
    KeymapManager.getInstance().getActiveKeymap().addShortcut(ActivateToolWindowAction.getActionIdForToolWindow(myId),new KeyboardShortcut(KeyStroke.getKeyStroke("alt " + myNumber),null));
  }
  ToolWindow toolWindow=myWindowManager.registerToolWindow(myId,myCanCloseContent,myAnchor);
  if (myComponent == null)   myComponent=getComponent();
  if (myComponent != null) {
    if (!hasCloseButton()) {
      addContent(myComponent,null,false);
    }
 else {
      DefaultGroup group=new DefaultGroup();
      group.add(new BaseAction("","Close",Icons.CLOSE_ICON){
        public void doExecute(        AnActionEvent e){
          unregister();
        }
      }
);
      JPanel panel=new JPanel(new BorderLayout());
      panel.add(myComponent,BorderLayout.CENTER);
      panel.add(ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,group,false).getComponent(),BorderLayout.WEST);
      addContent(panel,null,false);
    }
  }
  toolWindow.setIcon(myIcon);
  toolWindow.setToHideOnEmptyContent(true);
  toolWindow.installWatcher(toolWindow.getContentManager());
  if (!isInitiallyAvailable()) {
    setAvailable(false);
  }
}
