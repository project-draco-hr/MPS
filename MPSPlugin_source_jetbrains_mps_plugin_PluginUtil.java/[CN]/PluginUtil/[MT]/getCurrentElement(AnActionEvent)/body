{
  Editor editor=(Editor)e.getDataContext().getData(DataConstants.EDITOR);
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  PsiFile file=PsiDocumentManager.getInstance(project).getCachedPsiFile(editor.getDocument());
  return file.findElementAt(editor.getCaretModel().getOffset());
}
