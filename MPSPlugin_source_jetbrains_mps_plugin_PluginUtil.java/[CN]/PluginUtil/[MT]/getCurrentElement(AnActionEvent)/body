{
  Editor editor=(Editor)e.getDataContext().getData(DataConstants.EDITOR);
  if (editor == null)   return null;
  Project project=(Project)e.getDataContext().getData(DataConstants.PROJECT);
  PsiFile file=PsiDocumentManager.getInstance(project).getCachedPsiFile(editor.getDocument());
  if (file == null)   return null;
  return file.findElementAt(editor.getCaretModel().getOffset());
}
