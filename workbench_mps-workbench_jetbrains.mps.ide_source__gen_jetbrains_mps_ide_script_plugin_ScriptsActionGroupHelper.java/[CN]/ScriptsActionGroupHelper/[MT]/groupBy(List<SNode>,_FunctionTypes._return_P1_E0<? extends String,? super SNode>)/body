{
  Map<String,List<SNode>> result=MapSequence.fromMap(new HashMap<String,List<SNode>>());
{
    Iterator<SNode> script_it=ListSequence.fromList(scripts).iterator();
    SNode script_var;
    while (script_it.hasNext()) {
      script_var=script_it.next();
      String groupKey=groupKeyProducer.invoke(script_var);
      List<SNode> group=MapSequence.fromMap(result).get(groupKey);
      if (group == null) {
        group=new ArrayList<SNode>();
        MapSequence.fromMap(result).put(groupKey,group);
      }
      ListSequence.fromList(group).addElement(script_var);
    }
  }
  return result;
}
