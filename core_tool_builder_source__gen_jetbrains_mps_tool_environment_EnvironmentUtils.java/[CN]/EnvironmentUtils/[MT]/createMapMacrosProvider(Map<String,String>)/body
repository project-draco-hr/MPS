{
  Map<String,String> realMacros=new HashMap<String,String>();
  for (  String macroName : MapSequence.fromMap(macros).keySet()) {
    String canonicalPath=PathUtil.getCanonicalPath(MapSequence.fromMap(macros).get(macroName));
    File file=new File(canonicalPath);
    if (file.exists() && file.isDirectory()) {
      realMacros.put(macroName,canonicalPath);
    }
  }
  return new MapPathMacrosProvider(realMacros);
}
