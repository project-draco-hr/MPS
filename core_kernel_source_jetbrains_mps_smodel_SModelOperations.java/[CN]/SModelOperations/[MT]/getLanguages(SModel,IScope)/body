{
  Set<Language> languages=new LinkedHashSet<Language>();
  for (  ModuleReference lang : ((jetbrains.mps.smodel.SModel)model).importedLanguages()) {
    Language language=scope.getLanguage(lang);
    if (language != null) {
      languages.add(language);
      language.getDependenciesManager().collectAllExtendedLanguages(languages);
    }
  }
  for (  ModuleReference dk : ((jetbrains.mps.smodel.SModel)model).importedDevkits()) {
    DevKit devKit=scope.getDevKit(dk);
    if (devKit != null) {
      for (      Language l : devKit.getAllExportedLanguages()) {
        if (languages.add(l)) {
          l.getDependenciesManager().collectAllExtendedLanguages(languages);
        }
      }
    }
  }
  return new ArrayList<Language>(languages);
}
