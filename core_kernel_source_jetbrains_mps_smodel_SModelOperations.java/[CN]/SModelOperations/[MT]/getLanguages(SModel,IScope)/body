{
  Set<Language> languages=new LinkedHashSet<Language>();
  for (  SModuleReference lang : ((jetbrains.mps.smodel.SModelInternal)model).importedLanguages()) {
    Language language=(Language)lang.resolve(MPSModuleRepository.getInstance());
    if (language != null) {
      languages.add(language);
      languages.addAll(LanguageDependenciesManager.getAllExtendedLanguages(language));
    }
  }
  for (  SModuleReference dk : ((jetbrains.mps.smodel.SModelInternal)model).importedDevkits()) {
    DevKit devKit=(DevKit)dk.resolve(MPSModuleRepository.getInstance());
    if (devKit != null) {
      for (      Language l : devKit.getAllExportedLanguages()) {
        if (languages.add(l)) {
          languages.addAll(LanguageDependenciesManager.getAllExtendedLanguages(l));
        }
      }
    }
  }
  return new ArrayList<Language>(languages);
}
