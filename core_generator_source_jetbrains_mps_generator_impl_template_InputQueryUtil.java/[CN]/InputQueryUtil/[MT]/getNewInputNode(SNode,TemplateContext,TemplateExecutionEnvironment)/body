{
  try {
    SNode query=RuleUtil.getSourceNodeQuery(nodeMacro);
    if (query != null) {
      return getNewInputNode(nodeMacro,query,context,env.getQueryExecutor());
    }
    return context.getInput();
  }
 catch (  Throwable t) {
    env.getLogger().handleException(t);
    env.getLogger().error(nodeMacro,"couldn't get new input node",GeneratorUtil.describeInput(context));
    throw new GenerationFailureException(t);
  }
}
