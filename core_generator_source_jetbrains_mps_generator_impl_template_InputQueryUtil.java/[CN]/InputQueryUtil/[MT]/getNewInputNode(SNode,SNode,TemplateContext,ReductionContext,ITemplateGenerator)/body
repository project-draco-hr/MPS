{
  try {
    SNode query=RuleUtil.getSourceNodeQuery(nodeMacro);
    if (query != null) {
      return getNewInputNode(currentInputNode,nodeMacro,query,context,reductionContext);
    }
    return currentInputNode;
  }
 catch (  Throwable t) {
    generator.getLogger().handleException(t);
    generator.showErrorMessage(currentInputNode,nodeMacro,"couldn't get new input node");
    throw new GenerationFailureException(t);
  }
}
