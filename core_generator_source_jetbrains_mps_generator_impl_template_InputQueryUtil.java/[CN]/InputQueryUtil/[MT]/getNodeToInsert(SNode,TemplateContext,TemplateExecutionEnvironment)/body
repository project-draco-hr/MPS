{
  try {
    SNode query=RuleUtil.getInsertMacro_Query(insertMacro);
    if (query != null) {
      return env.getQueryExecutor().evaluateInsertQuery(context.getInput(),insertMacro,query,context);
    }
    env.getGenerator().showErrorMessage(context.getInput(),insertMacro,"couldn't get nodes to insert");
    throw new GenerationFailureException("couldn't get nodes to insert");
  }
 catch (  Throwable t) {
    env.getLogger().handleException(t);
    env.getGenerator().showErrorMessage(context.getInput(),insertMacro,"couldn't get nodes to insert (see exception)");
    throw new GenerationFailureException(t);
  }
}
