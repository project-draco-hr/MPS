{
  Set<jetbrains.mps.project.structure.modules.ModuleReference> namespaces=new HashSet<jetbrains.mps.project.structure.modules.ModuleReference>(model.getEngagedOnGenerationLanguages());
  for (  SNode root : model.getRoots()) {
    collectLanguageNamespaces(root,namespaces,excludeTLBase);
  }
  List<Language> result=new ArrayList<Language>();
  for (  jetbrains.mps.project.structure.modules.ModuleReference namespace : namespaces) {
    Language language=scope.getLanguage(namespace);
    if (language != null) {
      result.add(language);
    }
 else {
      LOG.error("couldn't find language for namespace '" + namespace + "' in scope: "+ scope);
    }
  }
  return result;
}
