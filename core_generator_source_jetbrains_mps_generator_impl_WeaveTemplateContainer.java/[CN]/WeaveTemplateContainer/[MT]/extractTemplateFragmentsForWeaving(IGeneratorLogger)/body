{
  List<SNode> templateFragments=GeneratorUtilEx.getTemplateFragments(myTemplateNode);
  if (templateFragments.isEmpty()) {
    logger.error(myTemplateNode.getReference(),"nothing to weave: no template fragments found in template");
    return templateFragments;
  }
  boolean sameParent=true;
  SNode defaultContext=null;
  for (  SNode templateFragment : templateFragments) {
    SNode fragmentContextNode=templateFragment.getParent().getParent();
    if (defaultContext == null) {
      defaultContext=fragmentContextNode;
    }
 else     if (defaultContext != fragmentContextNode) {
      sameParent=false;
      break;
    }
  }
  if (!sameParent) {
    List<ProblemDescription> list=new ArrayList<ProblemDescription>();
    for (    SNode templateFragment : templateFragments) {
      list.add(GeneratorUtil.describe(templateFragment,"template fragment"));
    }
    logger.error(myTemplateNode.getReference(),"all fragments with shall have the same parent",list.toArray(new ProblemDescription[list.size()]));
  }
  return templateFragments;
}
