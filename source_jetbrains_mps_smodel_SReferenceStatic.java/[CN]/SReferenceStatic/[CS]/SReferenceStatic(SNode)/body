{
  myNodeRef=new WeakReference<SNode>(node);
  CommandProcessor.instance().addCommandListener(new CommandAdapter(){
    public void commandFinished(    @NotNull CommandEvent event){
      CommandProcessor.instance().removeCommandListener(this);
      SNode node=myNodeRef.get();
      if (node != null && node.isRegistered()) {
        myModelUID=node.getModel().getUID();
        myNodeId=node.getSNodeId();
      }
    }
  }
);
}
