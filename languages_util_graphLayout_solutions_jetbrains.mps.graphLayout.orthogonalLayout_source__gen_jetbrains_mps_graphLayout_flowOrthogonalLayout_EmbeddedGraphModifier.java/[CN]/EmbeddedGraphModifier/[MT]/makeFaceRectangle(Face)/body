{
  Dart badDart=null;
  List<Dart> darts=face.getDarts();
  Iterator<Dart> dartItr=ListSequence.<Dart>fromList(darts).iterator();
  Dart prev=ListSequence.<Dart>fromList(darts).last();
  int sum=0;
  while (dartItr.hasNext() && badDart == null) {
    Dart cur=dartItr.next();
    int turn=MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(prev).getTurn(MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(cur));
    if (turn < 0) {
      badDart=prev;
      sum=turn;
    }
    prev=cur;
  }
  while (sum != 1) {
    if (!(dartItr.hasNext())) {
      dartItr=ListSequence.<Dart>fromList(darts).iterator();
    }
    Dart cur=dartItr.next();
    sum+=MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(prev).getTurn(MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(cur));
    prev=cur;
  }
  if (badDart != null) {
    List<Edge> newEdges=ListSequence.<Edge>fromList(new ArrayList<Edge>());
    Dart prevOpposite=myEmbeddedGraph.getOpposite(prev);
    Node newNode=myEmbeddedGraph.splitEdge(prev.getEdge(),newEdges);
    for (    Edge newEdge : ListSequence.<Edge>fromList(newEdges)) {
      for (      Dart newDart : ListSequence.<Dart>fromList(myEmbeddedGraph.getDarts(newEdge))) {
        if (myEmbeddedGraph.getFace(newDart) == face) {
          MapSequence.<Dart,Direction2D>fromMap(myDartDirections).put(newDart,MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(prev));
        }
 else {
          MapSequence.<Dart,Direction2D>fromMap(myDartDirections).put(newDart,MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(prev).opposite());
        }
      }
    }
    MapSequence.fromMap(myDartDirections).removeKey(prev);
    MapSequence.fromMap(myDartDirections).removeKey(prevOpposite);
    Node badCorner=badDart.getTarget();
    Edge splitEdge=myGraph.connect(badCorner,newNode);
    List<Face> newFaces=myEmbeddedGraph.splitFace(face,ListSequence.<Edge>fromListAndArray(new ArrayList<Edge>(),splitEdge),badCorner,newNode);
    for (    Dart dart : ListSequence.<Dart>fromList(myEmbeddedGraph.getDarts(splitEdge))) {
      if (dart.getSource() == badCorner) {
        MapSequence.<Dart,Direction2D>fromMap(myDartDirections).put(dart,MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(badDart));
      }
 else {
        MapSequence.<Dart,Direction2D>fromMap(myDartDirections).put(dart,MapSequence.<Dart,Direction2D>fromMap(myDartDirections).get(badDart).opposite());
      }
    }
    for (    Face newFace : ListSequence.<Face>fromList(newFaces)) {
      makeFaceRectangle(newFace);
    }
  }
}
