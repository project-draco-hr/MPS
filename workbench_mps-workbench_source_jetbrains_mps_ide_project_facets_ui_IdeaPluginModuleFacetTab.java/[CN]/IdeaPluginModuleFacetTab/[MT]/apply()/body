{
  ((IdeaPluginModuleFacetImpl)myNewIdeaPluginModuleFacet).setPluginId(myTextField.getText());
  Memento memento=new MementoImpl();
  myNewIdeaPluginModuleFacet.save(memento);
  ModuleFacetDescriptor facetDescriptor=new ModuleFacetDescriptor(((ModuleFacetBase)myNewIdeaPluginModuleFacet).getFacetType(),memento);
  ModuleDescriptor descriptor=((AbstractModule)myIdeaPluginModuleFacet.getModule()).getModuleDescriptor();
  Iterator<ModuleFacetDescriptor> iterator=descriptor.getModuleFacetDescriptors().iterator();
  while (iterator.hasNext()) {
    ModuleFacetDescriptor mfd=iterator.next();
    if (mfd.getType().equals(facetDescriptor.getType())) {
      iterator.remove();
      break;
    }
  }
  if (!myNewIdeaPluginModuleFacet.getPluginId().isEmpty())   descriptor.getModuleFacetDescriptors().add(facetDescriptor);
}
