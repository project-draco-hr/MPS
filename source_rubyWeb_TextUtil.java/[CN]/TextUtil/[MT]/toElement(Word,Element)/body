{
  if (word instanceof SectionTag) {
    SectionTag tag=(SectionTag)word;
    Element target=new Element("section");
    Element header=new Element("h");
    header.setText(tag.getName());
    target.addContent(header);
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof PhotoTag) {
    PhotoTag tag=(PhotoTag)word;
    Element target=new Element("photo");
    target.setAttribute("ref",tag.getRef());
    element.addContent(target);
    return;
  }
  if (word instanceof ATag) {
    ATag tag=(ATag)word;
    Element target=new Element("a");
    target.setAttribute("href",((ATag)word).getHref());
    element.addContent(target);
    toElement(tag.getText(),target);
    return;
  }
  if (word instanceof BRTag) {
    element.addContent(new Element("br"));
    return;
  }
  if (word instanceof BoldTag) {
    BoldTag tag=(BoldTag)word;
    Element bold=new Element("b");
    element.addContent(bold);
    toElement(tag.getText(),bold);
    return;
  }
  if (word instanceof PreTag) {
    PreTag tag=(PreTag)word;
    Element pre=new Element("pre");
    element.addContent(pre);
    toElement(tag.getText(),pre);
    return;
  }
  if (word instanceof ParagraphTag) {
    ParagraphTag tag=(ParagraphTag)word;
    Element p=new Element("p");
    element.addContent(p);
    toElement(tag.getText(),p);
    return;
  }
  if (word instanceof BookTag) {
    BookTag tag=(BookTag)word;
    Element book=new Element("book");
    book.setAttribute("isbn",tag.getIsbn());
    element.addContent(book);
    toElement(tag.getText(),book);
    return;
  }
  if (word instanceof ItalicTag) {
    ItalicTag tag=(ItalicTag)word;
    Element italic=new Element("i");
    element.addContent(italic);
    toElement(tag.getText(),italic);
    return;
  }
  if (word instanceof TermTag) {
    TermTag tag=(TermTag)word;
    Element term=new Element("term");
    element.addContent(term);
    toElement(tag.getText(),term);
    return;
  }
  if (word instanceof CodeTag) {
    CodeTag tag=(CodeTag)word;
    Element code=new Element("code");
    element.addContent(code);
    toElement(tag.getText(),code);
    return;
  }
  if (word instanceof QuoteTag) {
    QuoteTag tag=(QuoteTag)word;
    Element target=new Element("quote");
    if (tag.getBibliographyReference() != null) {
      target.setAttribute("ref",tag.getBibliographyReference().getName());
    }
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof CiteTag) {
    CiteTag tag=(CiteTag)word;
    Element target=new Element("cite");
    if (tag.getBibliographyReference() != null) {
      target.setAttribute("name",tag.getBibliographyReference().getName());
    }
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof XRefTag) {
    XRefTag tag=(XRefTag)word;
    Element xref=new Element("xref");
    if (tag.getTarget() != null) {
      xref.setAttribute("targetID",tag.getTarget().getName());
    }
    toElement(tag.getText(),xref);
    element.addContent(xref);
    return;
  }
  if (word instanceof XRefTargetTag) {
    XRefTargetTag tag=(XRefTargetTag)word;
    Element target=new Element("xref-target");
    target.setAttribute("ID",tag.getName());
    if (tag.getPaper() != null) {
      target.setAttribute("paper",tag.getPaper().getName());
    }
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof PatternRefTag) {
    PatternRefTag tag=(PatternRefTag)word;
    Element target=new Element("patternRef");
    if (tag.getPattern() != null) {
      target.setAttribute("name",tag.getPattern().getKey());
    }
 else {
      target.setAttribute("name","");
    }
    element.addContent(target);
    return;
  }
  if (word instanceof FigureTag) {
    FigureTag tag=(FigureTag)word;
    Element target=new Element("figure");
    target.setAttribute("src",tag.getSource());
    element.addContent(target);
    return;
  }
  if (word instanceof TBDTag) {
    TBDTag tag=(TBDTag)word;
    Element target=new Element("tbd");
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof FigureRefTag) {
    FigureRefTag tag=(FigureRefTag)word;
    Element target=new Element("figureRef");
    if (tag.getFigure() != null) {
      target.setAttribute("ref",tag.getFigure().getSource());
    }
    toElement(tag.getText(),target);
    element.addContent(target);
    return;
  }
  if (word instanceof InsertCodeTag) {
    InsertCodeTag tag=(InsertCodeTag)word;
    Element target=new Element("insertCode");
    target.setAttribute("file",tag.getFile());
    target.setAttribute("fragment",tag.getFragment());
    element.addContent(target);
    return;
  }
  if (word instanceof ListTag) {
    ListTag tag=(ListTag)word;
    Element target=new Element("ul");
    for (    ListItem item : CollectionUtil.iteratorAsIterable(tag.items())) {
      Element li=new Element("li");
      toElement(item.getText(),li);
      target.addContent(li);
    }
    element.addContent(target);
    return;
  }
  element.addContent(word.getValue());
}
