{
  IdeFrameImpl frameImpl=null;
  if (frame instanceof IdeFrameImpl) {
    frameImpl=(IdeFrameImpl)frame;
  }
  if (frameImpl == null || !(frameImpl.isShowing())) {
    final FramelessNotificationPopup popup=new FramelessNotificationPopup(owner,content,backgroud,true,null);
    myPopupDecorator=new NotificationPopup.PopupDecorator(){
      public void addListener(      JBPopupListener listener){
        popup.getPopup().addListener(listener);
      }
      public void hide(){
        popup.getPopup().cancel();
      }
    }
;
  }
 else {
    final Wrapper wrapper=new NonOpaquePanel(content){
      @Override public Dimension getPreferredSize(){
        final Dimension size=super.getPreferredSize();
        if (size.width > 400 || size.height > 200) {
          size.width=400;
          size.height=200;
        }
        return size;
      }
    }
;
    final Balloon balloon=JBPopupFactory.getInstance().createBalloonBuilder(wrapper).setFadeoutTime(5000).setHideOnClickOutside(false).setHideOnFrameResize(false).setHideOnKeyOutside(false).setCloseButtonEnabled(true).setFillColor(backgroud).setShowCallout(false).setClickHandler(null,false).createBalloon();
    frameImpl.getBalloonLayout().add(balloon);
    myPopupDecorator=new NotificationPopup.PopupDecorator(){
      public void addListener(      JBPopupListener listener){
        balloon.addListener(listener);
      }
      public void hide(){
        balloon.hide();
      }
    }
;
  }
}
