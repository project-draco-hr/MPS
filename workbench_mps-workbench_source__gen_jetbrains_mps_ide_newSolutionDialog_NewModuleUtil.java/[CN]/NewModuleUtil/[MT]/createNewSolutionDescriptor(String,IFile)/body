{
  SolutionDescriptor descriptor=new SolutionDescriptor();
  descriptor.setNamespace(namespace);
  descriptor.setId(ModuleId.regular());
  final IFile modelsDir=descriptorFile.getParent().getDescendant(Solution.SOLUTION_MODELS);
  if (modelsDir.exists() && modelsDir.getChildren().size() != 0) {
    throw new IllegalStateException("Trying to create a solution in an existing solution's directory: " + descriptorFile.getParent());
  }
 else {
    if (ModelAccess.instance().isInEDT()) {
      modelsDir.mkdirs();
    }
 else {
      ModelAccess.instance().writeFilesInEDT(new Runnable(){
        public void run(){
          modelsDir.mkdirs();
        }
      }
);
    }
  }
  DefaultModelRoot modelRoot=new DefaultModelRoot();
  modelRoot.setContentRoot(modelsDir.getParent().getPath());
  modelRoot.addFile(DefaultModelRoot.SOURCE_ROOTS,modelsDir.getPath());
  descriptor.getModelRootDescriptors().add(modelRoot.toDescriptor());
  return descriptor;
}
