{
  if (nodeRef == null)   return null;
  final SNode node=nodeRef.resolve(MPSModuleRepository.getInstance());
  if (node == null)   return null;
  for (  MPSPsiNodeFactory factory : MPSPsiNodeFactory.EP_NAME.getExtensions()) {
    if (!(factory instanceof MPSPsiNodeFactoryStubAware))     continue;
    PsiElement psiElement=((MPSPsiNodeFactoryStubAware)factory).getPsiSource(node);
    if (psiElement != null) {
      return psiElement;
    }
  }
  return getPsi(node);
}
