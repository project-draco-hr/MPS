{
  try {
    Object searchScopeOrListOfNodes=createSearchScopeOrListOfNodes(operationContext,_context);
    if (searchScopeOrListOfNodes == null)     return new EmptySearchScope();
    if (searchScopeOrListOfNodes instanceof ISearchScope)     return (ISearchScope)searchScopeOrListOfNodes;
    if (searchScopeOrListOfNodes instanceof Iterable) {
      Iterable iterable=CollectionUtil.withoutNulls((Iterable)searchScopeOrListOfNodes);
      return new SimpleSearchScope(IterableUtil.asList(iterable));
    }
    throw new RuntimeException("unexpected type in search-scope provider " + searchScopeOrListOfNodes.getClass());
  }
 catch (  Throwable t) {
    LOG.error(t);
    return new EmptySearchScope();
  }
}
