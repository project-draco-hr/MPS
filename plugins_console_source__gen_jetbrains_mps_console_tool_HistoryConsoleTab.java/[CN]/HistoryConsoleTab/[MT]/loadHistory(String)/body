{
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      SModel loadedModel=loadHistoryModel(state);
      myRoot=SModelOperations.createNewRootNode(myModel,SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x131ec6f2097ff75fL,"jetbrains.mps.console.base.structure.OutputConsoleRoot")));
      if (loadedModel == null || ListSequence.fromList(SModelOperations.roots(loadedModel,MetaAdapterFactory.getConcept(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x131ec6f2097ff75fL,"jetbrains.mps.console.base.structure.OutputConsoleRoot"))).isEmpty()) {
        SLinkOperations.setTarget(myRoot,MetaAdapterFactory.getContainmentLink(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x15fb34051f725a2cL,0x15fb34051f725bafL,"history"),SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0xa835f28c1aa02beL,"jetbrains.mps.console.base.structure.History"))));
      }
 else {
        SLinkOperations.setTarget(myRoot,MetaAdapterFactory.getContainmentLink(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x15fb34051f725a2cL,0x15fb34051f725bafL,"history"),SLinkOperations.getTarget(ListSequence.fromList(SModelOperations.roots(loadedModel,MetaAdapterFactory.getConcept(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x131ec6f2097ff75fL,"jetbrains.mps.console.base.structure.OutputConsoleRoot"))).first(),MetaAdapterFactory.getContainmentLink(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x15fb34051f725a2cL,0x15fb34051f725bafL,"history")));
      }
      SLinkOperations.setTarget(myRoot,MetaAdapterFactory.getContainmentLink(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x15fb34051f725a2cL,0x15fb34051f725bb1L,"commandHolder"),SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xde1ad86d6e504a02L,0xb306d4d17f64c375L,0x4e27160acb4484bL,"jetbrains.mps.console.base.structure.CommandHolder"))));
      TemporaryModels.getInstance().addMissingImports(myModel);
    }
  }
);
}
