{
  IdTableBuilding.registerIdIndexer(MPSFileTypeFactory.MODEL_FILE_TYPE,new FileTypeIdIndexer(){
    @NotNull public Map<IdIndexEntry,Integer> map(    FileContent inputData){
      String content=inputData.getContentAsText().toString();
      Matcher matcherNode=REFERENCE_PATTERN.matcher(content);
      Matcher matcherInstance=INSTANCE_PATTERN.matcher(content);
      HashMap<IdIndexEntry,Integer> result=new HashMap<IdIndexEntry,Integer>();
      while (matcherNode.find()) {
        String node=unescape(matcherNode.group(1));
        result.put(new IdIndexEntry(node,true),matcherNode.start(1));
      }
      while (matcherInstance.find()) {
        String instance=unescape(matcherInstance.group(1));
        result.put(new IdIndexEntry(instance,true),matcherInstance.start(1));
      }
      return result;
    }
    private String unescape(    String s){
      return StringEscapeUtils.unescapeXml(s);
    }
  }
);
}
