{
  if (cell == null) {
    return null;
  }
  if (GeometryUtil.isLastPositionInBigCell(cell)) {
    return cell;
  }
  if (cell instanceof EditorCell_Label && cell.getRole() == null) {
    EditorCell result=new ChildrenCollectionFinder(cell,true,false).find();
    if (result != null) {
      return result;
    }
    result=new ChildrenCollectionFinder(cell,false,false).find();
    if (result != null) {
      if (result instanceof EditorCell_Collection) {
        return ((EditorCell_Collection)result).lastCell();
      }
      return result;
    }
  }
  return cell;
}
