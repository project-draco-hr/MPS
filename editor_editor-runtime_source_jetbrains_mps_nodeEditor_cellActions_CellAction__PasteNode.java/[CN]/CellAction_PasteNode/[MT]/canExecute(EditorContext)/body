{
  Selection selection=context.getSelectionManager().getSelection();
  if (selection instanceof SingularSelection) {
    EditorCell selectedCell=getCellToPasteTo(context.getSelectedCell());
    if (selectedCell == null) {
      return false;
    }
    SNode selectedNode=selectedCell.getSNode();
    if (selectedNode == null || jetbrains.mps.util.SNodeOperations.isDisposed(selectedNode)) {
      return false;
    }
    List<SNode> pasteNodes=CopyPasteUtil.getNodesFromClipboard(selectedNode.getModel());
    if (pasteNodes == null || pasteNodes.isEmpty()) {
      return CopyPasteUtil.isConversionAvailable(selectedNode.getModel(),selectedNode);
    }
    if (selection instanceof EditorCellLabelSelection) {
      return canPasteViaNodePaster(selectedCell,pasteNodes);
    }
 else     if (selection instanceof EditorCellSelection) {
      return canPasteViaNodePasterWithRemove(selection,pasteNodes) || canPasteViaNodePaster(selectedCell,pasteNodes);
    }
  }
 else   if (selection instanceof MultipleSelection) {
    SNode selectedNode=selection.getSelectedNodes().get(0);
    List<SNode> pasteNodes=CopyPasteUtil.getNodesFromClipboard(selectedNode.getModel());
    return canPasteViaNodePasterWithRemove(selection,pasteNodes);
  }
  return false;
}
