{
  if (contextNode == null) {
    myGenerator.showErrorMessage(applicableNode,rule.getRuleNode().resolve(MPSModuleRepository.getInstance()),"weaving rule: cannot find context node");
    return false;
  }
  SNode contextRoot=contextNode.getContainingRoot();
  SModel model=contextRoot.getModel();
  if (model == null) {
    myGenerator.showErrorIfStrict(rule.getRuleNode().resolve(MPSModuleRepository.getInstance()),"bad context for weaving rule: no root for context " + contextNode);
    return !myGenerator.isStrict();
  }
  SNode originalContextRoot=myGenerator.getOriginalRootByGenerated(contextRoot);
  if (originalContextRoot == null) {
    myGenerator.showErrorIfStrict(rule.getRuleNode().resolve(MPSModuleRepository.getInstance()),"bad context for weaving rule: " + contextRoot + " is generated by 'create root' rule");
    return !myGenerator.isStrict();
  }
  if (applicableNode.getModel() == null)   return true;
  SNode inputRoot=applicableNode.getContainingRoot();
  if (originalContextRoot != inputRoot) {
    myGenerator.showErrorIfStrict(rule.getRuleNode().resolve(MPSModuleRepository.getInstance()),"bad context for weaving rule: " + contextRoot.toString() + " is generated from "+ originalContextRoot.toString()+ ", while input node is from "+ inputRoot.toString());
    return !myGenerator.isStrict();
  }
  return true;
}
