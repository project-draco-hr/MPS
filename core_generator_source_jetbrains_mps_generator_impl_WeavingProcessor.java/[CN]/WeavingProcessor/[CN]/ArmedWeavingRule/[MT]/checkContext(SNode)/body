{
  ITemplateGenerator generatorIface=myEnv.getGenerator();
  TemplateGenerator generator=myEnv.getGenerator();
  if (contextNode == null) {
    generatorIface.showErrorMessage(myApplicableNode,myRule.getRuleNode().resolve(MPSModuleRepository.getInstance()),"weaving rule: cannot find context node");
    return false;
  }
  SNode contextRoot=contextNode.getContainingRoot();
  SModel model=contextRoot.getModel();
  if (model == null) {
    return reportErrorIfStrict("bad context for weaving rule: no root for context " + contextNode);
  }
  SNode originalContextRoot=generator.getOriginalRootByGenerated(contextRoot);
  if (originalContextRoot == null) {
    return reportErrorIfStrict(String.format("bad context for weaving rule: %s is generated by 'create root' rule",contextRoot));
  }
  if (myApplicableNode.getModel() == null)   return true;
  SNode inputRoot=myApplicableNode.getContainingRoot();
  if (originalContextRoot != inputRoot) {
    String msg="bad context for weaving rule: %s is generated from %s , while input node is from %s";
    return reportErrorIfStrict(String.format(msg,contextRoot,originalContextRoot,inputRoot));
  }
  return true;
}
