{
  SNode query=QueriesUtil.getQueryFunction_fromSourceSubstituteMacro(macro);
  SNode returnType=TypeChecker.getInstance().getTypeOf(query);
  if (SNodeOperations.isInstanceOf(query,"jetbrains.mps.lang.generator.structure.SourceSubstituteMacro_SourceNodeQuery")) {
{
      GeneratedMatchingPattern pattern_iiuth6_a0d0b=new MacroIntentionsUtil.Pattern_iiuth6_a0a0a0a3a1();
      SNode coercedNode_iiuth6_a0d0b=TypeChecker.getInstance().getRuntimeSupport().coerce_(returnType,pattern_iiuth6_a0d0b);
      if (coercedNode_iiuth6_a0d0b != null) {
        return ((SNode)pattern_iiuth6_a0d0b.getFieldValue("patternVar_concept"));
      }
 else {
{
          GeneratedMatchingPattern pattern_iiuth6_a0a0d0b=new MacroIntentionsUtil.Pattern_iiuth6_a0a0a0a0c0a0d0b();
          SNode coercedNode_iiuth6_a0a0d0b=TypeChecker.getInstance().getRuntimeSupport().coerce_(returnType,pattern_iiuth6_a0a0d0b);
          if (coercedNode_iiuth6_a0a0d0b != null) {
            return ((SNode)pattern_iiuth6_a0a0d0b.getFieldValue("patternVar_concept"));
          }
 else {
            return null;
          }
        }
      }
    }
  }
 else {
    SNode macroOuterNode=SNodeOperations.getParent(SNodeOperations.getParent(macro));
    return getContextNodeConcept(macroOuterNode);
  }
}
