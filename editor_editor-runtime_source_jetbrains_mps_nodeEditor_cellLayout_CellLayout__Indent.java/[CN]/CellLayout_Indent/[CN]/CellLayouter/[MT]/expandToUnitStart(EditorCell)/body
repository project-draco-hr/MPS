{
  EditorCell result=cell;
  while (true) {
    EditorCell prevLeaf=APICellAdapter.getPrevLeaf(result);
    while (prevLeaf != null && !myLineContent.contains(prevLeaf)) {
      prevLeaf=prevLeaf.getParent();
    }
    if (!myCell.isAncestorOf(prevLeaf))     break;
    if (!myLineContent.contains(prevLeaf))     break;
    if (isNoWrap(result) || APIStyleAdapter.getStyleAttribute(result,StyleAttributes.PUNCTUATION_LEFT)) {
      result=prevLeaf;
    }
 else {
      break;
    }
  }
  return result;
}
