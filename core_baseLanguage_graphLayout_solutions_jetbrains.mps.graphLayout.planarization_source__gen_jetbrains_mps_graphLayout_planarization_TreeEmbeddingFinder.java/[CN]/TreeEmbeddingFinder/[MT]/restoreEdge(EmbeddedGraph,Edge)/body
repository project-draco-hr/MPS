{
  MapSequence.fromMap(mySplittedEdges).put(removedEdge,ListSequence.fromList(new ArrayList<Edge>()));
  DualGraph dualGraph=new DualGraph(embeddedGraph);
  Map<Edge,List<Face>> adjacentFacesMap=embeddedGraph.getAdjacentFacesMap();
  List<Node> newNodes=ListSequence.fromList(new ArrayList<Node>());
  for (  Node node : ListSequence.fromList(removedEdge.getAdjacentNodes())) {
    Node newNode=dualGraph.addDummyNode();
    for (    Edge nodeEdge : ListSequence.fromList(node.getEdges(Edge.Direction.BOTH))) {
      for (      Face face : ListSequence.fromList(MapSequence.fromMap(adjacentFacesMap).get(nodeEdge))) {
        newNode.addEdgeTo(MapSequence.fromMap(dualGraph.getNodesMap()).get(face));
      }
    }
    ListSequence.fromList(newNodes).addElement(newNode);
  }
  System.out.println("adding " + removedEdge);
  List<Edge> path=ShortestPath.getPath(dualGraph,ListSequence.fromList(newNodes).getElement(0),ListSequence.fromList(newNodes).getElement(1),Edge.Direction.BOTH);
  List<Node> nodePath=ListSequence.fromList(new ArrayList<Node>());
  List<Face> facePath=ListSequence.fromList(new ArrayList<Face>());
  ListSequence.fromList(nodePath).addElement(ListSequence.fromList(removedEdge.getAdjacentNodes()).getElement(0));
  Node cur=ListSequence.fromList(newNodes).getElement(0);
  for (  Edge edge : ListSequence.fromList(path)) {
    Edge realEdge=MapSequence.fromMap(dualGraph.getEdgesMap()).get(edge);
    if (MapSequence.fromMap(adjacentFacesMap).get(realEdge) != null) {
      ListSequence.fromList(nodePath).addElement(split(embeddedGraph,MapSequence.fromMap(dualGraph.getEdgesMap()).get(edge)));
    }
    cur=edge.getOpposite(cur);
    Face curFace=MapSequence.fromMap(dualGraph.getFacesMap()).get(cur);
    if (curFace != null) {
      ListSequence.fromList(facePath).addElement(curFace);
    }
  }
  ListSequence.fromList(nodePath).addElement(ListSequence.fromList(removedEdge.getAdjacentNodes()).getElement(1));
  for (int i=0; i < ListSequence.fromList(nodePath).count() - 1; i++) {
    Edge newEdge=ListSequence.fromList(nodePath).getElement(i).addEdgeTo(ListSequence.fromList(nodePath).getElement(i + 1));
    ListSequence.fromList(MapSequence.fromMap(mySplittedEdges).get(removedEdge)).addElement(newEdge);
    splitFace(embeddedGraph,ListSequence.fromList(facePath).getElement(i),newEdge);
  }
}
