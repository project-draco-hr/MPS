{
  return ModelAccess.instance().runReadAction(new Computable<EditorCell>(){
    public EditorCell compute(){
      if (myCheckFirst && isMultipleCollectionCell(myCurrent)) {
        return myCurrent;
      }
      SNode anchorNode=getLCA(myAnchor.getSNode(),myCurrent.getSNode());
      if (anchorNode == null) {
        return null;
      }
      if (anchorNode != myCurrent.getSNode()) {
        EditorCell curr=myCurrent;
        while (curr != null && curr.getSNode() != anchorNode) {
          if (isMultipleCollectionCell(curr)) {
            return curr;
          }
          curr=curr.getParent();
        }
        if (curr != null && curr.getSNode() == anchorNode && isMultipleCollectionCell(curr)) {
          return curr;
        }
      }
      DfsTraverser traverser=new DfsTraverser(myCurrent,myForward);
      while (traverser.getCurrent() != null) {
        EditorCell current=traverser.getCurrent();
        SNode currentNode=current.getSNode();
        if (!jetbrains.mps.util.SNodeOperations.isAncestor(anchorNode,currentNode)) {
          return null;
        }
        if (isMultipleCollectionCell(current)) {
          return current;
        }
        traverser.next();
      }
      return null;
    }
  }
);
}
