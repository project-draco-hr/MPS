{
  if (SHOW_INFO > 0) {
    System.out.println("Making boxes for nodes");
    System.out.println("initial graph: ");
    printEmbeddedGraph();
  }
  List<Node> nodes=ListSequence.fromList(new ArrayList<Node>());
  ListSequence.fromList(nodes).addSequence(SetSequence.fromSet(MapSequence.fromMap(nodeSizes).keySet()));
  for (  Node node : ListSequence.fromList(nodes)) {
    List<Edge> oldEdges=ListSequence.fromList(new ArrayList<Edge>());
    ListSequence.fromList(oldEdges).addSequence(ListSequence.fromList(node.getEdges()));
    for (    Edge oldEdge : ListSequence.fromList(oldEdges)) {
      splitEdge(oldEdge);
    }
    Map<Direction2D,List<Edge>> rectEdges=makeRectangleForNode(node);
    for (    Direction2D dir : Direction2D.values()) {
      int length=MapSequence.fromMap(nodeSizes).get(node).width;
      if (dir.isVertical()) {
        length=MapSequence.fromMap(nodeSizes).get(node).height;
      }
      List<Edge> edges=MapSequence.fromMap(rectEdges).get(dir);
      int edgeLength=length / ListSequence.fromList(edges).count();
      for (      Edge edge : ListSequence.fromList(edges)) {
        if (edge == ListSequence.fromList(edges).last()) {
          MapSequence.fromMap(myBoxEdgeLengths).put(edge,length - (edgeLength * (ListSequence.fromList(edges).count() - 1)));
        }
 else {
          MapSequence.fromMap(myBoxEdgeLengths).put(edge,edgeLength);
        }
      }
    }
  }
  if (SHOW_INFO > 0) {
    System.out.println("after modification: ");
    printEmbeddedGraph();
  }
}
