{
  Solution solution=new Solution();
  SolutionDescriptor solutionDescriptor;
  if (handle.getDescriptor() != null) {
    solutionDescriptor=(SolutionDescriptor)handle.getDescriptor();
    if (solutionDescriptor.getUUID() == null) {
      solutionDescriptor.setUUID(UUID.randomUUID().toString());
      SolutionDescriptorPersistence.saveSolutionDescriptor(handle.getFile(),solutionDescriptor);
    }
  }
 else {
    solutionDescriptor=new SolutionDescriptor();
    solutionDescriptor.setUUID(UUID.randomUUID().toString());
  }
  solution.myDescriptorFile=handle.getFile();
  MPSModuleRepository repository=MPSModuleRepository.getInstance();
  if (repository.existsModule(solutionDescriptor.getModuleReference())) {
    LOG.error("Loading module " + solutionDescriptor.getNamespace() + " for the second time");
    return repository.getSolution(solutionDescriptor.getModuleReference());
  }
  solution.setSolutionDescriptor(solutionDescriptor,false);
  repository.addModule(solution,moduleOwner);
  return solution;
}
