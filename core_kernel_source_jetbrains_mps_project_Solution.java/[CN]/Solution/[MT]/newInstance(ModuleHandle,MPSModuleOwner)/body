{
  Solution solution=new Solution();
  SolutionDescriptor descriptor;
  if (handle.getDescriptor() != null) {
    descriptor=(SolutionDescriptor)handle.getDescriptor();
    if (descriptor.getUUID() == null) {
      descriptor.setUUID(UUID.randomUUID().toString());
      SolutionDescriptorPersistence.saveSolutionDescriptor(handle.getFile(),descriptor);
    }
  }
 else {
    descriptor=new SolutionDescriptor();
    descriptor.setUUID(UUID.randomUUID().toString());
  }
  solution.myDescriptorFile=handle.getFile();
  IModule d=MPSModuleRepository.checkRegistered(descriptor.getModuleReference(),handle.getFile());
  if (d != null) {
    return (Solution)d;
  }
  solution.setSolutionDescriptor(descriptor,false);
  MPSModuleRepository.getInstance().addModule(solution,moduleOwner);
  return solution;
}
