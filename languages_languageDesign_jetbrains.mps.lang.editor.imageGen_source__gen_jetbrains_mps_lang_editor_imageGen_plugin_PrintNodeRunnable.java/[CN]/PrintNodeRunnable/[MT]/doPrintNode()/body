{
  SNode node=myNodeReference.resolve(myRepository);
  if (node == null) {
    myErrorMessage="Can't find node " + myNodeReference + " inside repository: "+ myRepository;
    return;
  }
  HeadlessEditorComponent editorComponent=new HeadlessEditorComponent(node,myRepository);
  try {
    EditorCell rootCell=editorComponent.getRootCell();
    BufferedImage image=new BufferedImage(rootCell.getWidth(),rootCell.getHeight(),BufferedImage.TYPE_INT_ARGB);
    rootCell.paint(image.getGraphics());
    try {
      myResult=new ByteArrayOutputStream();
      ImageIO.write(image,"png",myResult);
    }
 catch (    IOException ioex) {
      myResult=null;
      myErrorMessage="Exception while writing image: " + ioex.toString();
    }
  }
  finally {
    editorComponent.dispose();
  }
}
