{
  for (  String conceptId : LanguageHierarchyCache.getAncestorsNames(node.getConcept().getId())) {
    if (myConcept2IntentionFactories.containsKey(conceptId)) {
      for (      IntentionFactory intentionFactory : myConcept2IntentionFactories.get(conceptId)) {
        if (isAncestor && !intentionFactory.isAvailableInChildNodes()) {
          continue;
        }
        if (!filter.accept(intentionFactory) || !intentionFactory.isApplicable(node,editorContext)) {
          continue;
        }
        if (!visitor.visit(intentionFactory)) {
          return;
        }
      }
    }
    if (myIntentions.containsKey(conceptId)) {
      for (      Intention intention : myIntentions.get(conceptId)) {
        if (isAncestor && !intention.isAvailableInChildNodes()) {
          continue;
        }
        if (!filter.accept(intention) || !intention.isApplicable(node,editorContext)) {
          continue;
        }
        if (!visitor.visit(intention)) {
          return;
        }
      }
    }
  }
}
