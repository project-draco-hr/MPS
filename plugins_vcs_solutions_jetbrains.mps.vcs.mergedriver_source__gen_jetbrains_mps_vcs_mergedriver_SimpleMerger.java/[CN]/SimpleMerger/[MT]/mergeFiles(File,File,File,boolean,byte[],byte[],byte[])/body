{
  FileInputStream baseIS=null;
  FileInputStream localIS=null;
  FileInputStream latestIS=null;
  OutputStream out=null;
  try {
    baseIS=new FileInputStream(baseFile);
    localIS=new FileInputStream(localFile);
    latestIS=new FileInputStream(latestFile);
    byte[] baseContent=ReadUtil.read(baseIS);
    FileUtil.closeFileSafe(baseIS);
    out=(overwrite ? new FileOutputStream(baseFile) : System.out);
    out.write(conflictStart);
    out.write(LINE_SEPARATOR);
    out.write(ReadUtil.read(localIS));
    out.write(separator);
    out.write(LINE_SEPARATOR);
    out.write(baseContent);
    out.write(separator);
    out.write(LINE_SEPARATOR);
    out.write(ReadUtil.read(latestIS));
    out.write(conflictEnd);
    out.write(LINE_SEPARATOR);
    return CONFLICTS;
  }
 catch (  IOException e) {
    return FATAL_ERROR;
  }
 finally {
    FileUtil.closeFileSafe(baseIS);
    FileUtil.closeFileSafe(localIS);
    FileUtil.closeFileSafe(latestIS);
    FileUtil.closeFileSafe(out);
  }
}
