{
  if (myPrepared) {
    return;
  }
  ((JComponent)getContentPane()).setBorder(BorderFactory.createEmptyBorder(4,4,4,4));
  setLayout(new BorderLayout());
  JPanel panel1=new JPanel(new BorderLayout());
  if (stretchMainComponent()) {
    panel1.add(getMainComponent(),BorderLayout.CENTER);
  }
 else {
    JPanel wrapper=new JPanel(new BorderLayout());
    wrapper.add(new JPanel(),BorderLayout.CENTER);
    wrapper.add(getMainComponent(),BorderLayout.NORTH);
    panel1.add(wrapper,BorderLayout.CENTER);
  }
  JPanel buttonsPanel=new JPanel(new BorderLayout());
  buttonsPanel.setBorder(BorderFactory.createEmptyBorder(4,0,0,0));
  JButton[] buttons=createButtons();
  JPanel innerButtonsPanel=new JPanel(new GridLayout(1,buttons.length,5,30));
  for (  JButton button : buttons) {
    innerButtonsPanel.add(button);
  }
  buttonsPanel.add(myErrorLabel,BorderLayout.NORTH);
  buttonsPanel.add(innerButtonsPanel,getButtonsPosition());
  panel1.add(buttonsPanel,BorderLayout.SOUTH);
  add(panel1,BorderLayout.CENTER);
  ((JComponent)getContentPane()).registerKeyboardAction(new AbstractAction("Dispose dialog"){
    public void actionPerformed(    ActionEvent e){
      dispose();
    }
  }
,KeyStroke.getKeyStroke("ESCAPE"),JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
  setDefaultCloseOperation(DISPOSE_ON_CLOSE);
  myPrepared=true;
}
