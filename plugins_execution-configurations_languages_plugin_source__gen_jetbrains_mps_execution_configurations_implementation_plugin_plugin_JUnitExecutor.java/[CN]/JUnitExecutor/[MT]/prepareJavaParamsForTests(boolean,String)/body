{
  JavaRunParameters_Configuration javaRunParams=myJavaRunParameters;
  JavaRunParameters parameters=javaRunParams.getJavaRunParameters().clone();
  String vmFromJava=javaRunParams.getJavaRunParameters().getVmOptions();
  if (vmFromJava == null) {
    vmFromJava="";
  }
  if (reuseCaches) {
    String runIdString="-D" + CachesUtil.REUSE_CACHES_DIR + "=\""+ cachesDir+ "\"";
    parameters.setVmOptions(vmFromJava + " " + runIdString);
  }
 else {
    if (myJUnitSettings.getReuseCaches()) {
      UIUtil.invokeLaterIfNeeded(new Runnable(){
        public void run(){
          ToolWindowManager.getInstance(myProject).notifyByBalloon(myExecutor.getId(),MessageType.WARNING,"Cannot reuse caches, because the directory is locked by another run.\nSaving caches in the " + " temp directory...");
        }
      }
);
    }
  }
  return parameters;
}
