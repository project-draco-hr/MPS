{
  final Object element=parent.getValue();
  if (!(element instanceof MainNodeTreeElement))   return Collections.emptyList();
  Map<RelationDescriptor,List<TreeElement>> groups=new HashMap<RelationDescriptor,List<TreeElement>>();
  for (  TreeElement te : children) {
    if (!(te instanceof AspectTreeElement))     continue;
    AspectTreeElement ate=(AspectTreeElement)te;
    RelationDescriptor d=ate.getAspectDescriptor();
    if (!groups.containsKey(d)) {
      groups.put(d,new ArrayList<TreeElement>());
    }
    groups.get(d).add(ate);
  }
  Collection<Group> result=new ArrayList<Group>();
  for (  Entry<RelationDescriptor,List<TreeElement>> e : groups.entrySet()) {
    result.add(new AspectGroup(e.getKey(),e.getValue()));
  }
  return result;
}
