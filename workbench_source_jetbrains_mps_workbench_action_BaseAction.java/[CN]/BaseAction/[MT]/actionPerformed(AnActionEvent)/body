{
  try {
    collectActionData(e);
    final ModelAccess access=ModelAccess.instance();
    if (myExecuteOutsideCommand) {
      doExecute(e);
    }
 else {
      access.runWriteActionInCommand(new Runnable(){
        public void run(){
          doExecute(e);
        }
      }
);
    }
  }
  finally {
    cleanup();
  }
}
