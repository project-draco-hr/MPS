{
  SModel ourModel=new jetbrains.mps.smodel.SModel(myModelRef);
  myPsiSources=MapSequence.fromMap(new HashMap<SNodeId,PsiElement>());
  ASTConverter converter=new ASTConverter(myPsiSources);
  for (  PsiJavaFile jf : Sequence.fromIterable(myDataSource.getJavaFiles())) {
    Set<SNode> roots=SetSequence.fromSet(new HashSet<SNode>());
    for (    PsiClass cls : jf.getClasses()) {
      SNode node=converter.convertClass(cls);
      SModelOperations.addRootNode(ourModel,node);
      SetSequence.fromSet(roots).addElement(node);
      MapSequence.fromMap(myRootsById).put(node.getNodeId(),node);
    }
    if (SetSequence.fromSet(roots).isNotEmpty()) {
      MapSequence.fromMap(myRootsPerFile).put(jf,roots);
    }
  }
  return ourModel;
}
