{
  SNode baseNode=null;
  for (  NodeEditorFactory handler : NodeEditorFactory.EXT_POINT.getExtensions(myProject.getProject())) {
    baseNode=handler.getBaseNode(root);
    if (baseNode != null) {
      break;
    }
  }
  if (baseNode == null) {
    baseNode=root;
  }
  checkBaseNodeIsValid(root,baseNode);
  MPSNodeVirtualFile file=NodeVirtualFileSystem.getInstance().getFileFor(myProject.getRepository(),baseNode);
  checkVirtualFileBaseNode(baseNode,file);
  FileEditorManager editorManager=FileEditorManager.getInstance(myProject.getProject());
  file.putUserData(FileEditorProvider.KEY,ApplicationManager.getApplication().getComponent(MPSFileNodeEditorProvider.class));
  FileEditor fileEditor=editorManager.openFile(file,focus,true)[0];
  MPSFileNodeEditor fileNodeEditor=(MPSFileNodeEditor)fileEditor;
  Editor nodeEditor=fileNodeEditor.getNodeEditor();
  if (nodeEditor != null && nodeEditor.isTabbed()) {
    nodeEditor.showNode(root,false);
  }
  return nodeEditor;
}
