{
{
    SNode node=actionContext.getNode();
    SearchQuery searchQuery=new SearchQuery(node,GlobalScope.getInstance());
    IResultProvider resultProvider=TreeBuilder.forFinders(new ConceptInstances_Finder(),new NodeAndDescendantsUsages_Finder());
    IDEProjectFrame projectFrame=(IDEProjectFrame)actionContext.get(IDEProjectFrame.class);
    SearchResults searchResults=resultProvider.getResults(searchQuery,projectFrame.createAdaptiveProgressMonitor());
    refactoringContext.setParameter("sourceLanguage",Language.getLanguageFor(SNodeOperations.getModel(node).getModelDescriptor()));
    if (((Language)refactoringContext.getParameter("sourceLanguage")) != null) {
      SModelDescriptor editorModelDescriptor=((Language)refactoringContext.getParameter("sourceLanguage")).getEditorModelDescriptor();
      List searchResultsList=searchResults.getSearchResults();
      if (editorModelDescriptor != null) {
        refactoringContext.setParameter("conceptEditorDeclaration",SModelUtil_new.findEditorDeclaration(editorModelDescriptor.getSModel(),((AbstractConceptDeclaration)SNodeOperations.getAdapter(node))));
        if (((ConceptEditorDeclaration)refactoringContext.getParameter("conceptEditorDeclaration")) != null) {
          SNode editorNode=((ConceptEditorDeclaration)refactoringContext.getParameter("conceptEditorDeclaration")).getNode();
          for (          SearchResult<SNode> searchResult : new ArrayList<SearchResult<SNode>>((Collection)searchResultsList)) {
            if (searchResult.getObject().getContainingRoot() == editorNode) {
              searchResults.remove(searchResult);
            }
          }
        }
      }
      SModelDescriptor constraintsModelDescriptor=((Language)refactoringContext.getParameter("sourceLanguage")).getConstraintsModelDescriptor();
      if (constraintsModelDescriptor != null) {
        refactoringContext.setParameter("conceptBehavior",SModelUtil_new.findBehaviorDeclaration(constraintsModelDescriptor.getSModel(),((AbstractConceptDeclaration)SNodeOperations.getAdapter(node))));
        if (((ConceptBehavior)refactoringContext.getParameter("conceptBehavior")) != null) {
          SNode behaviorNode=((ConceptBehavior)refactoringContext.getParameter("conceptBehavior")).getNode();
          for (          SearchResult<SNode> searchResult : new ArrayList<SearchResult<SNode>>((Collection)searchResultsList)) {
            if (searchResult.getObject().getContainingRoot() == behaviorNode) {
              searchResults.remove(searchResult);
            }
          }
        }
      }
    }
    List aliveResults=searchResults.getAliveResults();
    if (!(aliveResults.isEmpty())) {
      return searchResults;
    }
    return null;
  }
}
