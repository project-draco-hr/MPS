{
  final SRepository projectRepo=myProject.getRepository();
  final ModelAccess modelAccess=projectRepo.getModelAccess();
  modelAccess.executeCommandInEDT(new Runnable(){
    @Override public void run(){
      SModuleReference conceptLanguage=myNodeConcept.getLanguage().getSourceModule().getModuleReference();
      if (!SModelOperations.getAllImportedLanguages(myModel).contains(conceptLanguage)) {
        ((SModelInternal)myModel).addLanguage(conceptLanguage);
      }
      final SNode node=NodeFactoryManager.createNode(myNodeConcept,null,null,myModel);
      SNodeAccessUtil.setProperty(node,SNodeUtil.property_BaseConcept_virtualPackage,myVirtualPackage);
      myModel.addRootNode(node);
      for (      CreateNodeExtension ext : CreateRootFilterEP.getInstance().getCreateNodeExtensions()) {
        if (ext.isApplicable(myModel)) {
          ext.setupRoot(node);
        }
      }
      modelAccess.runWriteInEDT(new Runnable(){
        @Override public void run(){
          if (!trySelectInCurrentPane(myProject,node)) {
            NavigationSupport.getInstance().selectInTree(myProject,node,false);
          }
          NavigationSupport.getInstance().openNode(myProject,node,true,false);
        }
      }
);
    }
  }
);
}
