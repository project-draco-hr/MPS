{
  for (  SNode attribute : AttributeOperations.getAllAttributes(oldChild)) {
    String role=attribute.getRoleInParent();
    if (AttributesRolesUtil.isPropertyAttributeRole(role)) {
      String propertyName=AttributesRolesUtil.getPropertyNameFromPropertyAttributeRole(role);
      if (SModelSearchUtil.findPropertyDeclaration(((jetbrains.mps.smodel.SNode)newChild).getConceptDeclarationNode(),propertyName) == null) {
        LOG.error("couldn't copy attribute " + attribute.getConcept().getName() + " for property '"+ propertyName+ "' : so such property in concept "+ newChild.getConcept().getName(),newChild);
        continue;
      }
    }
    if (AttributesRolesUtil.isLinkAttributeRole(role)) {
      String linkRole=AttributesRolesUtil.getLinkRoleFromLinkAttributeRole(role);
      if (SModelSearchUtil.findLinkDeclaration(((jetbrains.mps.smodel.SNode)newChild).getConceptDeclarationNode(),linkRole) == null) {
        LOG.error("couldn't copy attribute " + attribute.getConcept().getName() + " for link '"+ linkRole+ "' : so such link in concept "+ newChild.getConcept().getName(),newChild);
        continue;
      }
    }
    SNode newAttribute=CopyUtil.copy(attribute);
    newChild.addChild(role,newAttribute);
  }
}
