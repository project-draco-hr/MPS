{
  for (  SNode attribute : AttributeOperations.getAllAttributes(oldChild)) {
    String role=attribute.getRoleInParent();
    if (AttributesRolesUtil.isPropertyAttributeRole(role)) {
      String propertyName=AttributesRolesUtil.getPropertyNameFromPropertyAttributeRole(role);
      if (SModelSearchUtil.findPropertyDeclaration(((jetbrains.mps.smodel.SNode)newChild).getConceptDeclarationNode(),propertyName) == null) {
        LOG.error("couldn't copy attribute " + NameUtil.shortNameFromLongName(attribute.getConcept().getId()) + " for property '"+ propertyName+ "' : so such property in concept "+ NameUtil.shortNameFromLongName(newChild.getConcept().getId()),newChild);
        continue;
      }
    }
    if (AttributesRolesUtil.isLinkAttributeRole(role)) {
      String linkRole=AttributesRolesUtil.getLinkRoleFromLinkAttributeRole(role);
      if (SModelSearchUtil.findLinkDeclaration(((jetbrains.mps.smodel.SNode)newChild).getConceptDeclarationNode(),linkRole) == null) {
        LOG.error("couldn't copy attribute " + NameUtil.shortNameFromLongName(attribute.getConcept().getId()) + " for link '"+ linkRole+ "' : so such link in concept "+ NameUtil.shortNameFromLongName(newChild.getConcept().getId()),newChild);
        continue;
      }
    }
    SNode newAttribute=CopyUtil.copy(attribute);
    newChild.addChild(role,newAttribute);
  }
}
