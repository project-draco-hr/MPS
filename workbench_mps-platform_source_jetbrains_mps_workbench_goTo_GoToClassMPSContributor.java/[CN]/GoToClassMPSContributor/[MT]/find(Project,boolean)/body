{
  final MPSProject mpsProject=ProjectHelper.fromIdeaProject(project);
  if (mpsProject == null) {
    return Collections.emptyList();
  }
  final List<NodePointerNavigationItem> nodes=new ArrayList<NodePointerNavigationItem>();
  mpsProject.getModelAccess().runReadAction(new Runnable(){
    @Override public void run(){
      if (includeNonProjectItems) {
        find(new FilteredGlobalScope(),nodes);
      }
 else {
        find(new ModulesScope(mpsProject.getProjectModulesWithGenerators()),nodes);
      }
    }
  }
);
  return nodes;
}
