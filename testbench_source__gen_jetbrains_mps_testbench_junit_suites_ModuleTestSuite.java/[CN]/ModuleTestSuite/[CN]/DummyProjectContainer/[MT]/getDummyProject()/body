{
  File dummy=createDummyProjectFile();
  Project p=IdeaEnvironment.openProjectInIdeaEnvironment(dummy);
  if (this.lastProject != null) {
    try {
      SwingUtilities.invokeAndWait(new Runnable(){
        public void run(){
          Project lastProject=DummyProjectContainer.this.lastProject;
          File projectFile=lastProject.getProjectFile();
          lastProject.dispose();
          if (projectFile != null) {
            FileUtil.delete(projectFile);
          }
        }
      }
);
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  this.lastProject=p;
  this.projectName=dummy.getName();
  return p;
}
