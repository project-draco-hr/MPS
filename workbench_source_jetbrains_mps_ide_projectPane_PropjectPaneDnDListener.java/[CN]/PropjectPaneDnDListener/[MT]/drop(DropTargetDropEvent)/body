{
  Point point=dtde.getLocation();
  Object target=myTree.getPathForLocation(point.x,point.y).getLastPathComponent();
  if (!(target instanceof SNodeTreeNode)) {
    dtde.rejectDrop();
    return;
  }
  SNode targetNode=((SNodeTreeNode)target).getSNode();
  Object source=null;
  try {
    source=dtde.getTransferable().getTransferData(myDataFlavor);
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
  if (!(source instanceof SNode)) {
    dtde.rejectDrop();
    return;
  }
  SNode sourceNode=(SNode)source;
  List<SNode> nodeToMove=getNodesToMove(targetNode,Collections.singletonList(sourceNode));
  if (nodeToMove.isEmpty()) {
    dtde.rejectDrop();
    return;
  }
  Project project=(Project)DataManager.getInstance().getDataContext().getData(MPSDataKeys.PROJECT.getName());
  JOptionPane.showConfirmDialog(WindowManager.getInstance().getFrame(project),"<html>Do you want to move node from virtual package '<b>" + getVirtualPackage(sourceNode) + "</b>' to '<b>"+ getVirtualPackage(targetNode)+ "</b>'?</html>");
  dtde.acceptDrop(dtde.getDropAction());
}
