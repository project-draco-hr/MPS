{
  if (node == null)   return null;
synchronized (TYPECHECKING_LOCK) {
    if (this.isInEditorQueries()) {
      return getTypeOf_resolveMode(node,typeChecker);
    }
 else     if (typeChecker.isGenerationMode()) {
      return getTypeOf_generationMode(node);
    }
 else {
      return getTypeOf_normalMode(node);
    }
  }
}
