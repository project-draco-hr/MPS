{
  Project ideaProject=null;
  Project[] projects=ProjectManager.getInstance().getOpenProjects();
  if (projects.length != 0) {
    ideaProject=projects[0];
  }
 else {
    final Project[] project=new Project[]{null};
    final ProjectManager manager=ProjectManager.getInstance();
    manager.addProjectManagerListener(new ProjectManagerAdapter(){
      @Override public void projectOpened(      Project p){
        manager.removeProjectManagerListener(this);
        project[0]=p;
      }
    }
);
    while (project[0] == null)     test.flushAWT();
    ideaProject=project[0];
  }
  while (ideaProject.getComponent(MPSProjectHolder.class) == null)   test.flushAWT();
  final boolean[] loaded=new boolean[]{false};
  StartupManager.getInstance(ideaProject).registerPostStartupActivity(new Runnable(){
    public void run(){
      loaded[0]=true;
    }
  }
);
  while (!loaded[0])   test.flushAWT();
  test.flushAWT();
  DialogFinder finder=new DialogFinder(".*Tip of the Day.*",true);
  finder.setWait(10);
  Component dialog=finder.find();
  if (dialog != null) {
    test.pressButton(dialog,"Close");
  }
  return ideaProject.getComponent(MPSProjectHolder.class).getMPSProject();
}
