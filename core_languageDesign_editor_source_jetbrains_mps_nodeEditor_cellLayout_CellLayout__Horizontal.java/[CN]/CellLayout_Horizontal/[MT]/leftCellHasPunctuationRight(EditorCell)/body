{
  EditorCell_Collection parent=currentCell.getParent();
  if (parent != null && parent.getCellLayout() instanceof CellLayout_Horizontal) {
    int index=parent.getCellNumber(currentCell);
    if (index > 0) {
      EditorCell leftCell=parent.getChildAt(index - 1);
      if (leftCell.getLastLeaf() instanceof EditorCell_Collection) {
        return leftCellHasPunctuationRight(leftCell);
      }
 else {
        return hasPunctuationRight(leftCell);
      }
    }
 else {
      return leftCellHasPunctuationRight(parent);
    }
  }
  return true;
}
