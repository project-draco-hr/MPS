{
  try {
    MPSProjectMigrationState migrationState=project.getComponent(MPSProjectMigrationState.class);
    if (migrationState.isMigrationRequired() && migrationState.hasMigrationAgent()) {
      migrationState.addMigrationListener(new DEFAULT(){
        @Override public void migrationFinished(        Project mpsProject){
          ((ProjectViewImpl)ProjectView.getInstance(project)).setupImpl(toolWindow);
        }
      }
);
    }
 else {
      ((ProjectViewImpl)ProjectView.getInstance(project)).setupImpl(toolWindow);
    }
  }
 catch (  Throwable t) {
    System.out.println("*** Oops");
    t.printStackTrace();
  }
}
