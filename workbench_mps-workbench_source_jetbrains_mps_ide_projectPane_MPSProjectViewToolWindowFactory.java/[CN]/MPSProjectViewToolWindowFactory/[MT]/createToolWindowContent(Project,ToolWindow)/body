{
  MPSProjectMigrationComponent migrationState=project.getComponent(MPSProjectMigrationComponent.class);
  if (migrationState.isMigrationRequired() && migrationState.hasMigrationAgent()) {
    migrationState.addMigrationListener(new DEFAULT(){
      @Override public void migrationFinished(      Project mpsProject){
        ((ProjectViewImpl)ProjectView.getInstance(project)).setupImpl(toolWindow);
      }
    }
);
  }
 else {
    ((ProjectViewImpl)ProjectView.getInstance(project)).setupImpl(toolWindow);
  }
}
