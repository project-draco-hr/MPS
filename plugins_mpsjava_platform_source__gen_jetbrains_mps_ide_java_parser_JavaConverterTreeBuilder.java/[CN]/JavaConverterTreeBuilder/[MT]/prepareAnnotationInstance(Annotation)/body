{
  SNode annotationInstance=SModelOperations.createNewNode(myCurrentModel,"jetbrains.mps.baseLanguage.structure.AnnotationInstance",null);
  SNode sourceNode=annotationInstance;
  AnnotationBinding annotationBinding=annotation.getCompilerAnnotation();
  SReference classifierReference=null;
  if (annotationBinding == null) {
    TypeReference type=annotation.type;
    if (type != null) {
      classifierReference=myTypesProvider.createErrorClassifierReference("annotation",type.resolvedType,sourceNode);
    }
  }
 else {
    classifierReference=myTypesProvider.createClassifierReference(annotationBinding.getAnnotationType(),"annotation",sourceNode);
  }
  if (classifierReference != null) {
    sourceNode.setReference(classifierReference.getRole(),classifierReference);
  }
  return annotationInstance;
}
