{
  SNode expression=processExpressionRefl(x.expression);
  SNode result=SModelOperations.createNewNode(myCurrentModel,null,"jetbrains.mps.baseLanguage.structure.SwitchStatement");
  SLinkOperations.setTarget(result,"expression",expression,true);
  SLinkOperations.setTarget(result,"defaultBlock",SModelOperations.createNewNode(myCurrentModel,null,"jetbrains.mps.baseLanguage.structure.StatementList"),true);
  if (x.defaultCase != null) {
    addBlock(SLinkOperations.getTarget(result,"defaultBlock",true),x.defaultCase.sourceStart(),x.defaultCase.sourceEnd());
  }
  if (x.statements != null) {
    SNode currentSwitchCase=null;
    for (    Statement stmt : x.statements) {
      if (stmt instanceof CaseStatement) {
        if ((currentSwitchCase != null)) {
          getBlock(currentSwitchCase)._3(stmt.sourceStart);
        }
        CaseStatement caseStatement=(CaseStatement)stmt;
        if (caseStatement.constantExpression == null) {
          currentSwitchCase=SLinkOperations.getTarget(result,"defaultBlock",true);
        }
 else {
          SNode switchCase=processCaseStatement((CaseStatement)stmt);
          if ((switchCase != null)) {
            ListSequence.fromList(SLinkOperations.getTargets(result,"case",true)).addElement(switchCase);
          }
          currentSwitchCase=((switchCase == null) ? null : SLinkOperations.getTarget(switchCase,"body",true));
        }
      }
 else       if ((currentSwitchCase != null)) {
        getBlock(currentSwitchCase)._3(stmt.sourceEnd);
        ListSequence.fromList(SLinkOperations.getTargets(currentSwitchCase,"statement",true)).addElement(processStatementRefl(stmt));
      }
    }
    if ((currentSwitchCase != null)) {
      getBlock(currentSwitchCase)._3(x.sourceEnd);
    }
  }
  return result;
}
