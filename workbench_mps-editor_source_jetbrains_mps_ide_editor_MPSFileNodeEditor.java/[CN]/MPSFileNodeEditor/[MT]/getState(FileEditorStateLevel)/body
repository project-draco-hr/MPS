{
  final MPSEditorStateWrapper state=new MPSEditorStateWrapper();
  if (!isDisposed() && myNodeEditor != null) {
    myProject.getModelAccess().runReadAction(new Runnable(){
      @Override public void run(){
        state.setEditorState(myNodeEditor.saveState());
      }
    }
);
  }
 else {
    state.setEditorState(new BaseEditorState());
  }
  state.setLevel(level);
  return state;
}
