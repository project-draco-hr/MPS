{
  model.setLoading(true);
  Map<SNode,SNode> sourceNodesToNewNodes=new HashMap<SNode,SNode>();
  Set<SReference> allReferences=new HashSet<SReference>();
  SModel fakeModel=node.getModel();
  fakeModel.setLoading(true);
  SNode nodeToPaste=copyNode_internal(node,sourceNodesToNewNodes,allReferences);
  processReferencesOut(sourceNodesToNewNodes,allReferences,new HashSet<SReference>());
  nodeToPaste.changeModel(model);
  model.setLoading(false);
  fakeModel.setLoading(false);
  return nodeToPaste;
}
