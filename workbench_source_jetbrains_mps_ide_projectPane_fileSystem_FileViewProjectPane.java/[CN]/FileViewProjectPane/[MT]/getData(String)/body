{
  if (dataId.equals(PlatformDataKeys.VIRTUAL_FILE_ARRAY.getName())) {
    List<VirtualFile> files=new LinkedList<VirtualFile>();
    TreePath[] treePaths=getSelectionPaths();
    if (treePaths != null) {
      for (      TreePath tp : treePaths) {
        Object lastPathComponent=tp.getLastPathComponent();
        if (lastPathComponent instanceof FileNode) {
          FileNode node=(FileNode)lastPathComponent;
          VirtualFile file=node.getFile();
          if (file.isValid()) {
            files.add(file);
          }
        }
      }
    }
    return files.toArray(new VirtualFile[files.size()]);
  }
 else   if (dataId.equals(PlatformDataKeys.VIRTUAL_FILE.getName())) {
    TreePath tp=getSelectedPath();
    if (tp == null) {
      return super.getData(dataId);
    }
    Object lastPathComponent=tp.getLastPathComponent();
    if (lastPathComponent instanceof FileNode) {
      FileNode node=(FileNode)lastPathComponent;
      VirtualFile file=node.getFile();
      if (file.isValid()) {
        return node.getFile();
      }
    }
  }
 else   if (dataId.equals(PlatformDataKeys.COPY_PROVIDER.getName())) {
    return new FilePaneCopyProvider();
  }
 else   if (dataId.equals(PlatformDataKeys.PASTE_PROVIDER.getName())) {
    return new FilePanePasteProvider();
  }
  return super.getData(dataId);
}
