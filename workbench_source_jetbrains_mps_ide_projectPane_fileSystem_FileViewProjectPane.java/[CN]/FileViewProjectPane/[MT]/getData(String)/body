{
  if (dataId.equals(DataConstants.VIRTUAL_FILE_ARRAY)) {
    List<VirtualFile> files=new LinkedList<VirtualFile>();
    TreePath[] treePaths=getSelectionPaths();
    for (    TreePath tp : treePaths) {
      Object lastPathComponent=tp.getLastPathComponent();
      if (lastPathComponent instanceof AbstractFileTreeNode) {
        AbstractFileTreeNode node=(AbstractFileTreeNode)lastPathComponent;
        files.add(VFileSystem.getFile(node.getFile()));
      }
    }
    return files.toArray(new VirtualFile[files.size()]);
  }
  return super.getData(dataId);
}
