{
  if (dataId.equals(PlatformDataKeys.VIRTUAL_FILE_ARRAY.getName())) {
    List<VirtualFile> files=new LinkedList<VirtualFile>();
    TreePath[] treePaths=getSelectionPaths();
    if (treePaths != null) {
      for (      TreePath tp : treePaths) {
        Object lastPathComponent=tp.getLastPathComponent();
        if (lastPathComponent instanceof FileNode) {
          FileNode node=(FileNode)lastPathComponent;
          files.add(node.getFile());
        }
      }
    }
    return files.toArray(new VirtualFile[files.size()]);
  }
  return super.getData(dataId);
}
