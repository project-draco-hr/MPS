{
  TracingUtil.fillOriginalNode(myTemplateContext.getInput(),outputNodeToWeave,false);
  RoleValidator v=myGenerator.getChildRoleValidator(contextParentNode,childRole);
  Status status=v.validate(outputNodeToWeave);
  if (status != null) {
    myGenerator.getLogger().warning(myTemplateNode,status.getMessage("weave node"),status.describe(GeneratorUtil.describeInput(myTemplateContext),GeneratorUtil.describe(contextParentNode,"context parent node")));
    contextParentNode.addChild(childRole,outputNodeToWeave);
  }
 else {
    if (v.isMultipleSource()) {
      contextParentNode.addChild(childRole,outputNodeToWeave);
    }
 else {
      SNode oldChild=jetbrains.mps.util.SNodeOperations.getChild(contextParentNode,childRole);
      if (oldChild != null) {
        contextParentNode.removeChild(oldChild);
      }
      contextParentNode.addChild(childRole,outputNodeToWeave);
    }
  }
}
