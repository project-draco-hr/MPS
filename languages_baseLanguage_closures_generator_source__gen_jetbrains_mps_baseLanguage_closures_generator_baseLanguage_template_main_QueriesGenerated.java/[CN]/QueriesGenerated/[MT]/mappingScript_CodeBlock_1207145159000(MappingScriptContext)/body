{
  for (  SNode cl : SModelOperations.getNodes(_context.getModel(),"jetbrains.mps.baseLanguage.closures.structure.ClosureLiteral")) {
    for (    SNode vd : WrappersUtils.collectVariableDeclarationsToWrap(cl)) {
      if (SNodeOperations.isInstanceOf(vd,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration")) {
        Flags.WRAPPING_LOCAL_VARIABLE.flag(_context,vd);
        SNode sl=SNodeOperations.getAncestor(vd,"jetbrains.mps.baseLanguage.structure.StatementList",false,false);
        for (        SNode varRef : SNodeOperations.getDescendants(sl,"jetbrains.mps.baseLanguage.structure.VariableReference",false,new String[]{})) {
          if (SLinkOperations.getTarget(varRef,"variableDeclaration",false) == vd) {
            if (!(SNodeOperations.isInstanceOf(SNodeOperations.getParent(varRef),"jetbrains.mps.baseLanguage.closures.structure.ClosureArgReference"))) {
              SNode argRef=SNodeOperations.replaceWithNewChild(varRef,"jetbrains.mps.baseLanguage.closures.structure.ClosureArgReference");
              SLinkOperations.setTarget(argRef,"original",varRef,true);
              Flags.WRAPPING_LOCAL_VARIABLE.flag(_context,varRef);
            }
          }
        }
      }
 else       if (SNodeOperations.isInstanceOf(vd,"jetbrains.mps.baseLanguage.structure.ParameterDeclaration")) {
        SPropertyOperations.set(vd,"isFinal","" + (false));
        Flags.WRAPPING_LOCAL_VARIABLE.flag(_context,vd);
        SNode sl=SLinkOperations.getTarget(SNodeOperations.getAncestor(vd,"jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration",false,false),"body",true);
        Flags.WRAPPING_LOCAL_VARIABLE.flag(_context,sl);
        for (        SNode varRef : SNodeOperations.getDescendants(sl,"jetbrains.mps.baseLanguage.structure.VariableReference",false,new String[]{})) {
          if (SLinkOperations.getTarget(varRef,"variableDeclaration",false) == vd && !(SNodeOperations.isInstanceOf(SNodeOperations.getParent(varRef),"jetbrains.mps.baseLanguage.structure.ClassCreator") && BehaviorReflection.invokeVirtual(String.class,SNodeOperations.cast(SNodeOperations.getParent(SLinkOperations.getTarget(SNodeOperations.cast(SNodeOperations.getParent(varRef),"jetbrains.mps.baseLanguage.structure.ClassCreator"),"baseMethodDeclaration",false)),"jetbrains.mps.lang.core.structure.INamedConcept"),"virtual_getFqName_1213877404258",new Object[]{}).startsWith("jetbrains.mps.baseLanguage.closures.runtime.Wrappers"))) {
            SNode argRef=SNodeOperations.replaceWithNewChild(varRef,"jetbrains.mps.baseLanguage.closures.structure.ClosureArgReference");
            SLinkOperations.setTarget(argRef,"original",varRef,true);
          }
        }
      }
    }
  }
}
