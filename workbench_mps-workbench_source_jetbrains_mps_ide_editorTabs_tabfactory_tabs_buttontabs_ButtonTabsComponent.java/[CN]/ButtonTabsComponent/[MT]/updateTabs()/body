{
  if (isDisposedNode())   return;
  if (getLastNode() != null && getLastNode().resolve(MPSModuleRepository.getInstance()) == null) {
    onNodeChange(myBaseNode.resolve(MPSModuleRepository.getInstance()));
  }
  myRealTabs.clear();
  ArrayList<RelationDescriptor> tabs=new ArrayList<RelationDescriptor>(myPossibleTabs);
  Collections.sort(tabs,new RelationComparator());
  Map<RelationDescriptor,List<SNode>> newContent=updateDocumentsAndNodes();
  for (  RelationDescriptor tab : tabs) {
    List<SNode> nodes=newContent.get(tab);
    if (nodes != null) {
      myRealTabs.add(new ButtonEditorTab(this,new NodeChangeCallback(){
        @Override public void changeNode(        SNode newNode){
          onNodeChange(newNode);
        }
      }
,myRealTabs.size(),tab,myBaseNode,getColorProvider(),myEditor));
    }
  }
  DefaultActionGroup group=new DefaultActionGroup();
  for (  ButtonEditorTab tab : myRealTabs) {
    group.add(tab.getSelectTabAction());
  }
  if (myToolbar != null) {
    getComponent().remove(myToolbar.getComponent());
  }
  ActionToolbar actionToolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,group,true);
  actionToolbar.setLayoutPolicy(ActionToolbar.WRAP_LAYOUT_POLICY);
  myToolbar=actionToolbar;
  getComponent().add(myToolbar.getComponent(),BorderLayout.CENTER);
}
