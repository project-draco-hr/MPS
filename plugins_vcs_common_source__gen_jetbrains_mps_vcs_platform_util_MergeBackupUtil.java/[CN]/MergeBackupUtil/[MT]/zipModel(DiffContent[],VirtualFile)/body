{
  File tmpDir=FileUtil.createTmpDir();
  MergeDriverBackupUtil.writeContentsToFile(contents[MergeConstants.ORIGINAL].getDocument().getText().getBytes(FileUtil.DEFAULT_CHARSET),file.getName(),tmpDir,MergeVersion.BASE.getSuffix());
  MergeBackupUtil.writeContentsToFile(contents[MergeConstants.CURRENT],file,tmpDir,MergeVersion.MINE.getSuffix());
  MergeBackupUtil.writeContentsToFile(contents[MergeConstants.LAST_REVISION],file,tmpDir,MergeVersion.REPOSITORY.getSuffix());
  File zipfile=chooseZipFileForModelFile(VirtualFileUtils.toIFile(file));
  zipfile.getParentFile().mkdirs();
  FileUtil.zip(tmpDir,zipfile);
  FileUtil.delete(tmpDir);
  return zipfile;
}
