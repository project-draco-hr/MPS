{
  checkGraphsCorrectness();
  int wasEdges=myDepGraph.getEdgesCount();
  final Collection<SModule> modules=getModules();
  for (  SModule module : modules) {
    if (!isModuleDisposed(module)) {
      Collection<SModule> outs=new ArrayList<SModule>(myDepGraph.getOuts(module));
      for (      SModule m : outs) {
        myDepGraph.removeEdge(module,m);
        myBackDepGraph.removeEdge(m,module);
      }
      for (      SModule depModule : GlobalModuleDependenciesManager.directlyUsedModules(module,true,true)) {
        if (modules.contains(depModule)) {
          myDepGraph.addEdge(module,depModule);
          myBackDepGraph.addEdge(depModule,module);
        }
      }
    }
  }
  LOG.debug("Difference in the edge count after validation " + (myDepGraph.getEdgesCount() - wasEdges));
}
