{
  checkGraphsCorrectness();
  int wasEdges=myDepGraph.clearEdges();
  myBackDepGraph.clearEdges();
  Collection<SModule> modules=getModules();
  for (  SModule module : modules) {
    if (module.getRepository() == null) {
      LOG.error("Disposed module in ModulesWatcher",new IllegalStateException());
      continue;
    }
    for (    SModule depModule : GlobalModuleDependenciesManager.directlyUsedModules(module,true,true)) {
      if (modules.contains(depModule)) {
        myDepGraph.addEdge(module,depModule);
        myBackDepGraph.addEdge(depModule,module);
      }
    }
  }
  LOG.debug("Difference in the edge count after validation " + (myDepGraph.getEdgesCount() - wasEdges));
}
