{
  checkGraphsCorrectness();
  int wasEdges=myDepGraph.getEdgesCount();
  final Collection<? extends SModule> modules=getModules();
  for (  SModule module : modules) {
    if (!isModuleDisposed(module)) {
      Collection<? extends SModule> outs=new ArrayList<SModule>(myDepGraph.getOuts(module));
      for (      SModule m : outs)       removeEdge(module,m);
      Collection<? extends SModule> depModules=GlobalModuleDependenciesManager.directlyUsedModules(module,true,true);
      for (      SModule depModule : depModules) {
        if (modules.contains(depModule))         addEdge(module,depModule);
      }
    }
  }
  LOG.debug("Difference in the edge count after validation " + (myDepGraph.getEdgesCount() - wasEdges));
}
