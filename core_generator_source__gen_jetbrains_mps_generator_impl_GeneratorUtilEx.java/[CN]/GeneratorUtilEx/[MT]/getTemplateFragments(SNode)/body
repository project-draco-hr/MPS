{
  List<SNode> templateFragments=new ArrayList<SNode>();
  LinkedList<SNode> queue=new LinkedList<SNode>();
  queue.addFirst(template);
  final SNode conceptTemplateFragment=SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.TemplateFragment");
  while (!(queue.isEmpty())) {
    SNode subnode=queue.removeFirst();
    boolean tfFound=false;
    for (    SNode attr : SLinkOperations.getChildren(subnode,MetaAdapterFactory.getContainmentLink(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x10802efe25aL,0x47bf8397520e5942L,"smodelAttribute"))) {
      if (SNodeOperations.getConceptDeclaration(attr) == conceptTemplateFragment) {
        templateFragments.add((SNode)attr);
        tfFound=true;
        break;
      }
    }
    if (!(tfFound)) {
      queue.addAll(SNodeOperations.getChildren(subnode));
    }
  }
  return templateFragments;
}
