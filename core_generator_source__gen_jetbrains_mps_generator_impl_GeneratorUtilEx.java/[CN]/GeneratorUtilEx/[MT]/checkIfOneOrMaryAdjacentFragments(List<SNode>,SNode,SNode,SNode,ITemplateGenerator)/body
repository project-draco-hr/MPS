{
  if (fragments.isEmpty()) {
    generator.showErrorMessage(inputNode,templateContainer,ruleNode,"couldn't process template: no template fragments found");
    return false;
  }
  if (fragments.size() > 1) {
    SNode templateNode=SNodeOperations.getParent(fragments.get(0));
    SNode parent=SNodeOperations.getParent(templateNode);
    String role=templateNode.getRole();
    for (    SNode fragment : fragments) {
      templateNode=SNodeOperations.getParent(fragment);
      if (!((parent == SNodeOperations.getParent(templateNode) && role.equals(templateNode.getRole())))) {
        generator.showErrorMessage(inputNode,templateContainer,ruleNode,"couldn't process template: all template fragments must reside in the same parent node");
        return false;
      }
    }
  }
  return true;
}
