{
  SNode mappingLabel=null;
  if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.generator.structure.CreateRootRule")) {
    mappingLabel=SLinkOperations.getTarget(SNodeOperations.cast(node,"jetbrains.mps.lang.generator.structure.CreateRootRule"),"label",false);
  }
 else   if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.generator.structure.BaseMappingRule")) {
    mappingLabel=SLinkOperations.getTarget(SNodeOperations.cast(node,"jetbrains.mps.lang.generator.structure.BaseMappingRule"),"labelDeclaration",false);
  }
 else   if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.generator.structure.TemplateFragment")) {
    mappingLabel=SLinkOperations.getTarget(SNodeOperations.cast(node,"jetbrains.mps.lang.generator.structure.TemplateFragment"),"labelDeclaration",false);
  }
 else   if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.generator.structure.NodeMacro")) {
    mappingLabel=SLinkOperations.getTarget(SNodeOperations.cast(node,"jetbrains.mps.lang.generator.structure.NodeMacro"),"mappingLabel",false);
  }
 else   if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.generator.structure.PatternReduction_MappingRule")) {
    mappingLabel=SLinkOperations.getTarget(SNodeOperations.cast(node,"jetbrains.mps.lang.generator.structure.PatternReduction_MappingRule"),"labelDeclaration",false);
  }
 else {
    LOG.errorWithTrace("unexpected input " + node.getDebugText());
  }
  String mappingName=(mappingLabel != null ? SPropertyOperations.getString(mappingLabel,"name") : null);
  if (mappingName == null) {
    return defaultValue;
  }
  return mappingName;
}
