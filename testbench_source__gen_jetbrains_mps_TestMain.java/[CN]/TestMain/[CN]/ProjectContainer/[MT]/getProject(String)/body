{
  if (isLastProject(name)) {
    return this.lastProject;
  }
 else {
    if (LOG.isInfoEnabled()) {
      LOG.info("Opening project");
    }
    Project p=IdeaEnvironment.openProjectInIdeaEnvironment(new File(name));
    if (this.lastProject != null) {
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            ProjectContainer.this.lastProject.dispose();
          }
        }
);
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
    this.lastProject=p;
    this.projectName=name;
    return p;
  }
}
