{
  if (isLastProject(name)) {
    if (LOG.isInfoEnabled()) {
      LOG.info("Using the last created project");
    }
    return this.lastProject;
  }
 else {
    if (LOG.isInfoEnabled()) {
      LOG.info("Opening a new project");
    }
    Project currentProject=IdeaEnvironment.openProjectInIdeaEnvironment(new File(name));
    if (this.lastProject != null) {
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            ProjectContainer.this.lastProject.dispose();
          }
        }
);
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
    this.lastProject=currentProject;
    this.projectName=name;
    return currentProject;
  }
}
