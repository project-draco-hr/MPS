{
  TextBuilder textBuilder;
  NodeRangeSelection nodeRangeSelection=editorComponent.getNodeRangeSelection();
  if (nodeRangeSelection.isActive()) {
    textBuilder=renderText(nodeRangeSelection);
  }
 else {
    EditorCell cell=editorComponent.getSelectedCell();
    if (cell == null)     return TextBuilder.getEmptyTextBuilder();
    textBuilder=cell.renderText();
  }
  return textBuilder;
}
