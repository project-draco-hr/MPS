{
  HashSet<String> result=new HashSet<String>();
  LinkedList<String> queue=new LinkedList<String>(initial);
  while (!queue.isEmpty()) {
    String next=queue.removeFirst();
    if (badLanguages.contains(next)) {
      continue;
    }
    if (result.contains(next)) {
      continue;
    }
    final SModule nextModule=MPSModuleRepository.getInstance().getModuleByFqName(next);
    if (nextModule == null) {
      badLanguages.add(next);
      continue;
    }
    result.add(next);
    for (    SDependency d : nextModule.getDeclaredDependencies()) {
      if (SDependencyScope.EXTENDS.equals(d.getScope())) {
        queue.add(d.getTarget().getModuleName());
      }
    }
  }
  return result;
}
