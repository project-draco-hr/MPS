{
  SNode root=event.getRoot();
  final boolean added=event.isAdded();
  if (added) {
    if (root.getModel() == null) {
      return;
    }
  }
 else {
    if (event.getRootRef().getNodeId() != null) {
      return;
    }
  }
  final SNodeId rootId=root.getNodeId();
  runUpdateTask(new _FunctionTypes._void_P0_E0(){
    public void invoke(){
      if (added) {
        removeChanges(rootId,DeleteRootChange.class,new _FunctionTypes._return_P1_E0<Boolean,DeleteRootChange>(){
          public Boolean invoke(          DeleteRootChange ch){
            return true;
          }
        }
);
        buildAndAddChanges(new _FunctionTypes._void_P1_E0<ChangeSetBuilder>(){
          public void invoke(          ChangeSetBuilder b){
            b.buildForNode(getOldNode(rootId),event.getRoot());
          }
        }
);
      }
 else {
        if (removeChanges(rootId,AddRootChange.class,new _FunctionTypes._return_P1_E0<Boolean,AddRootChange>(){
          public Boolean invoke(          AddRootChange ch){
            return true;
          }
        }
) == 0) {
          removeDescendantChanges(rootId);
          buildAndAddChanges(new _FunctionTypes._void_P1_E0<ChangeSetBuilder>(){
            public void invoke(            ChangeSetBuilder b){
              b.buildForNode(getOldNode(rootId),null);
            }
          }
);
        }
      }
    }
  }
,null,event);
}
