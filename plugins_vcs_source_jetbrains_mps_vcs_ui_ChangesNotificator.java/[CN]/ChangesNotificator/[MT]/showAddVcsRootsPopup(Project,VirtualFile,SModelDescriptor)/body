{
  if (myRoots.get(vcsRoot) == null) {
    final MyNotificationInfo info=new MyNotificationInfo();
    info.addSModelDescriptor(sm);
    myRoots.put(vcsRoot,info);
    final JEditorPane pane=createPopupComponent();
    pane.addHyperlinkListener(new HyperlinkListener(){
      public void hyperlinkUpdate(      final HyperlinkEvent e){
        if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
          boolean result=showAddVcsRootsDialog(info,vcsRoot,project);
          if (result) {
            myVcsRootsManager.addNewVcsRoot(vcsRoot);
          }
 else {
            myVcsRootsManager.addExcludedRoot(vcsRoot);
          }
        }
      }
    }
);
    pane.setText(info.getPopupMessage());
    info.setListener(new ChangeListener(){
      public void stateChanged(      ChangeEvent e){
        pane.setText(info.getPopupMessage());
      }
    }
);
    StatusBar bar=WindowManager.getInstance().getStatusBar(project);
    IdeFrame frame=WindowManager.getInstance().getIdeFrame(project);
    final jetbrains.mps.vcs.ui.NotificationPopup popup=new jetbrains.mps.vcs.ui.NotificationPopup(frame,(JComponent)bar,pane,POPUP_COLOR);
    popup.addListener(new JBPopupAdapter(){
      @Override public void onClosed(      LightweightWindowEvent event){
        myRoots.remove(vcsRoot);
      }
    }
);
  }
 else {
    MyNotificationInfo info=myRoots.get(vcsRoot);
    info.addSModelDescriptor(sm);
  }
}
