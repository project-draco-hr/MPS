{
  myLinkByRole=new HashMap<String,SNode>();
  SNode[] concepts=((ConceptAndSuperConceptsCache)getOwnerCache()).getConcepts();
  FlattenIterable<SNode> allLinks=new FlattenIterable<SNode>(new ArrayList<Iterable<SNode>>(concepts.length));
  for (  SNode concept : concepts) {
    Iterable<SNode> list=SNodeUtil.getConcept_LinkDeclarations(concept);
    allLinks.add(list);
    for (    SNode link : list) {
      String role1=SModelUtil.getLinkDeclarationRole(link);
      if (role1 == null)       continue;
      if (myLinkByRole.containsKey(role1))       continue;
      myLinkByRole.put(role1,link);
    }
  }
  Map<SNode,SNode> specializedLinks=new HashMap<SNode,SNode>();
  for (  SNode link : allLinks) {
    SNode specializedLink=SModelUtil.getLinkDeclarationSpecializedLink(link);
    if (specializedLink != null) {
      specializedLinks.put(specializedLink,link);
    }
  }
  myMostSpecificLinkBySpecializedLink=new HashMap<SNode,SNode>();
  myMostSpecificLinks=new ArrayList<SNode>(5);
  for (  SNode link : allLinks) {
    SNode moreSpecificLink=specializedLinks.get(link);
    if (moreSpecificLink == null) {
      myMostSpecificLinks.add(link);
    }
 else {
      while (moreSpecificLink != null) {
        myMostSpecificLinkBySpecializedLink.put(link,moreSpecificLink);
        moreSpecificLink=specializedLinks.get(moreSpecificLink);
      }
    }
  }
  myDependsOnNodes=new HashSet<SNode>();
  for (  SNode concept : concepts) {
    myDependsOnNodes.add(concept);
  }
  for (  SNode link : allLinks) {
    myDependsOnNodes.add(link);
  }
}
