{
  setupEnvironment();
  Map<File,List<String>> mpsProjects=myWhatToDo.getMPSProjectFiles();
  for (  File file : mpsProjects.keySet()) {
    Project p=myEnvironment.openProject(file);
    info("Loaded project " + p);
    myEnvironment.flushAllEvents();
    try {
      Class<?> euClass=PluginManager.getPlugin(PluginId.getId(MigrationWorker.MIGRATION_PLUGIN)).getPluginClassLoader().loadClass(MigrationWorker.TASK_EXEC_CLASS);
      Method method=euClass.getMethod("migrate",Project.class);
      Object result=method.invoke(p);
      if (!(((Boolean)result))) {
        info("Nothing to migrate");
      }
    }
 catch (    Exception e) {
      error(e.getMessage());
    }
    myEnvironment.flushAllEvents();
    myEnvironment.closeProject(p);
  }
  dispose();
}
