{
  checkLoaded();
  PasteWrapper wrapper=getWrapperFor(node,targetConcept);
  if (wrapper == null) {
    throw new IllegalStateException();
  }
  SNode result=wrapper.wrap(new PasteWrapperContext(node));
  if (result.getParent() != null) {
    result.getParent().removeChild(result);
  }
  return result;
}
