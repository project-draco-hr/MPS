{
  if (!isFoldable() || isCollapsed() == collapsed) {
    return;
  }
  myCollapsed=collapsed == myInitiallyCollapsed ? null : collapsed;
  if (!isInTree()) {
    return;
  }
  getEditor().setCollapseState(this,myCollapsed);
  requestRelayout();
  collapsedStateChanged();
  updateSelectionOnCollapseChange();
}
