{
  List<? extends jetbrains.mps.openapi.editor.cells.EditorCell> selectionCells=myCellLayout.getSelectionCells(this);
  if (selectionCells != null) {
    ParentSettings selection=isSelectionPaintedOnAncestor(parentSettings);
    for (    jetbrains.mps.openapi.editor.cells.EditorCell cell : selectionCells) {
      if (g.hitClip(cell.getX(),cell.getY(),cell.getWidth(),cell.getHeight())) {
        ((EditorCell)cell).paintSelection(g,c,false,selection);
      }
    }
  }
 else {
    List<Rectangle> selection=myCellLayout.getSelectionBounds(this);
    g.setColor(c);
    for (    Rectangle part : selection) {
      g.fillRect(part.x,part.y,part.width,part.height);
    }
  }
}
