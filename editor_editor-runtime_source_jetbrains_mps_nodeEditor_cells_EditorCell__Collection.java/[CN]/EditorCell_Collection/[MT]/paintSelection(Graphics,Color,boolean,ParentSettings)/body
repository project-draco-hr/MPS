{
  if (drawBorder && g instanceof Graphics2D) {
    g=new SelectionGraphics((Graphics2D)g);
  }
  List<? extends EditorCell> selectionCells=myCellLayout instanceof CellLayoutExt ? ((CellLayoutExt)myCellLayout).getSelectionCells(this) : null;
  if (selectionCells != null) {
    ParentSettings selection=isSelectionPaintedOnAncestor(parentSettings);
    for (    EditorCell cell : selectionCells) {
      if (g.hitClip(cell.getX(),cell.getY(),cell.getWidth(),cell.getHeight())) {
        cell.paintSelection(g,c,false,selection);
      }
    }
  }
 else {
    List<Rectangle> selection=myCellLayout.getSelectionBounds(this);
    g.setColor(c);
    for (    Rectangle part : selection) {
      g.fillRect(part.x,part.y,part.width,part.height);
    }
  }
  if (g instanceof SelectionGraphics) {
    SelectionGraphics selectionGraphics=(SelectionGraphics)g;
    selectionGraphics.getOriginalGraphics().setColor(c.darker());
    selectionGraphics.getOriginalGraphics().draw(selectionGraphics.getSelectionArea());
  }
}
