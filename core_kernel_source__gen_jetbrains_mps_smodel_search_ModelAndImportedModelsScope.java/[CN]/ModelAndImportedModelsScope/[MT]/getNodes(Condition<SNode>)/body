{
  List<? extends SModel> models=getModels();
  List<SNode> result=new ArrayList<SNode>();
  if (myRootsOnly) {
    for (    SModel model : models) {
      for (      SNode root : model.getRootNodes()) {
        if (condition.met(root)) {
          result.add(root);
        }
      }
    }
  }
 else {
    for (    SModel model : models) {
      try {
        if (model == null) {
          continue;
        }
        SModel md=((SModelDescriptor)model).getSModel();
        if (condition instanceof IsInstanceCondition) {
          IsInstanceCondition isInstance=(IsInstanceCondition)condition;
          result.addAll(SNodeOperations.getModelFastFinder(md).getNodes(isInstance.getConceptFqName(),true));
        }
 else {
          for (          SNode node : new NodesIterable(md)) {
            if (condition.met(node)) {
              result.add(node);
            }
          }
        }
      }
 catch (      Throwable t) {
        LOG.error("error collecting nodes form model " + model,t);
      }
    }
  }
  return result;
}
