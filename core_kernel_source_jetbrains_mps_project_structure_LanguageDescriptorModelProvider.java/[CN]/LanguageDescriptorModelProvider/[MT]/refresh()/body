{
  ModelAccess.assertLegalWrite();
  Set<SModelReference> old=new HashSet<SModelReference>(myModels.keySet());
  for (  Language module : MPSModuleRepository.getInstance().getAllLanguages()) {
    SModelReference ref=getSModelReference(module);
    if (myModels.containsKey(ref)) {
      old.remove(ref);
      LanguageModelDescriptor languageModelDescriptor=myModels.get(ref);
      if (languageModelDescriptor != null) {
        languageModelDescriptor.invalidate();
      }
    }
 else {
      createModel(module);
    }
  }
  for (  SModelReference mm : old) {
    LanguageModelDescriptor model=myModels.get(mm);
    if (model != null) {
      removeModel(model);
    }
  }
}
