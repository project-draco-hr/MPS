{
  ModelAccess.assertLegalWrite();
  Set<SModelFqName> old=new HashSet<SModelFqName>(myModels.keySet());
  for (  Language module : MPSModuleRepository.getInstance().getAllLanguages()) {
    SModelFqName fq=getModelFqName(module);
    if (myModels.containsKey(fq)) {
      old.remove(fq);
      LanguageModelDescriptor languageModelDescriptor=myModels.get(fq);
      if (languageModelDescriptor != null) {
        languageModelDescriptor.invalidate();
      }
    }
 else {
      createModel(module);
    }
  }
  for (  SModelFqName mm : old) {
    LanguageModelDescriptor model=myModels.get(mm);
    if (model != null) {
      removeModel(model);
    }
  }
}
