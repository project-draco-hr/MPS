{
  Set<SModule> significantModules=getPluginModules(unloadedModules);
  for (  SModule module : significantModules) {
    ModuleLoadingState state=states.get(module);
    if (state == null) {
      states.put(module,ModuleLoadingState.UNLOAD);
    }
    if (state == ModuleLoadingState.LOAD) {
      states.put(module,null);
    }
    if (state == ModuleLoadingState.RELOAD) {
      states.put(module,ModuleLoadingState.UNLOAD);
    }
    if (state == ModuleLoadingState.UNLOAD) {
      throw new IllegalStateException();
    }
  }
  if (!significantModules.isEmpty()) {
    schedulePluginsReload();
  }
}
