{
  Map<Edge,Integer> edgeLengths=MapSequence.fromMap(new HashMap<Edge,Integer>());
  for (  Edge edge : ListSequence.fromList(myHorConstraintsGraph.getEdges())) {
    MapSequence.fromMap(edgeLengths).put(edge,myUnitLength);
  }
  for (  Edge edge : ListSequence.fromList(myVerConstraintsGraph.getEdges())) {
    MapSequence.fromMap(edgeLengths).put(edge,myUnitLength);
  }
  for (  Edge edge : SetSequence.fromSet(MapSequence.fromMap(myEdgeLengths).keySet())) {
    MapSequence.fromMap(edgeLengths).put(MapSequence.fromMap(myEdgeMap).get(edge),MapSequence.fromMap(myEdgeLengths).get(edge));
  }
  for (  Node node : SetSequence.fromSet(MapSequence.fromMap(nodeDirectionSizes).keySet())) {
    for (    Edge edge : ListSequence.fromList(node.getEdges())) {
      Dart sourceDart=myEmbeddedGraph.getSourceDart(edge,node);
      MapSequence.fromMap(edgeLengths).put(MapSequence.fromMap(myEdgeMap).get(edge),MapSequence.fromMap(MapSequence.fromMap(nodeDirectionSizes).get(node)).get(MapSequence.fromMap(myDirections).get(sourceDart)));
    }
  }
  for (  Edge edge : SetSequence.fromSet(MapSequence.fromMap(edgeExtentions).keySet())) {
    Edge curEdge=ListSequence.fromList(historyManager.getHistory(edge)).first();
    Edge constraintEdge=MapSequence.fromMap(myEdgeMap).get(curEdge);
    MapSequence.fromMap(edgeLengths).put(constraintEdge,MapSequence.fromMap(edgeLengths).get(constraintEdge) + MapSequence.fromMap(edgeExtentions).get(edge));
  }
  Map<Node,Integer> horNumbering=WeightedTopologicalNumbering.number(myHorConstraintsGraph,edgeLengths);
  Map<Node,Integer> verNjumbering=WeightedTopologicalNumbering.number(myVerConstraintsGraph,edgeLengths);
  Map<Node,Point> coordinates=MapSequence.fromMap(new HashMap<Node,Point>());
  for (  Node node : ListSequence.fromList(myGraph.getNodes())) {
    Node horSeg=MapSequence.fromMap(myHorNodeMap).get(node);
    Node verSeg=MapSequence.fromMap(myVerNodeMap).get(node);
    MapSequence.fromMap(coordinates).put(node,new Point(MapSequence.fromMap(verNjumbering).get(verSeg),MapSequence.fromMap(horNumbering).get(horSeg)));
  }
  return coordinates;
}
