{
  Set<SModule> result=new HashSet<SModule>();
  for (  SDependency dependency : module.getDeclaredDependencies()) {
    SModule dependencyModule=dependency.getTarget();
    if (dependencyModule == null) {
      if (dependency.getScope() == SDependencyScope.GENERATES_INTO || dependency.getScope() == SDependencyScope.DESIGN) {
        continue;
      }
      if (!checked) {
        continue;
      }
 else {
        throw new AbsentDependencyException(dependency);
      }
    }
    boolean isExport=dependency.isReexport() || dependency.getScope() == SDependencyScope.EXTENDS;
    if (includeNonReexport || isExport) {
      result.add(dependencyModule);
    }
  }
  if (includeNonReexport) {
    if (runtimes) {
      result.addAll(new RuntimesOfUsedLanguageCalculator(module,checked).invoke());
    }
  }
  return result;
}
