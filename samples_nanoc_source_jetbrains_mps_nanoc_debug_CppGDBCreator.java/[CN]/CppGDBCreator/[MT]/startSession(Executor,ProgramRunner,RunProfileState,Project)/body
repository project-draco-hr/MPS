{
  try {
    File gdbFile=new File(GDBLocationUtil.getGdbLocation());
    ProcessBuilder processBuilder=new ProcessBuilder();
    processBuilder.directory(gdbFile.getParentFile());
    processBuilder.command(gdbFile.getAbsolutePath(),"-quiet","--interpreter=mi");
    Process process=processBuilder.start();
    final ConsoleViewImpl consoleView=StacktraceUtil.createConsoleView(project);
    String s=ProcessUtil.getProcessId(process);
    SimpleConsoleProcessHandler processHandler=new SimpleConsoleProcessHandler(consoleView,process,gdbFile.getAbsolutePath());
    processHandler.addProcessListener(new MyProcessListener());
    ExecutionConsole executionConsole=new ExecutionConsole(){
      @Override public JComponent getComponent(){
        return consoleView.getComponent();
      }
      @Override public JComponent getPreferredFocusableComponent(){
        return consoleView;
      }
      @Override public void dispose(){
        Disposer.dispose(consoleView);
      }
    }
;
    myDebugSession=new CppDebugSession();
    myDebugSession.setProcessHandler(processHandler);
    myDebugSession.getGDBEventsHandler().addEventListener(new GDBEventsListener(){
      @Override public void breakpointHit(      GDBAnswer answer){
      }
      @Override public void processTerminated(      SimpleConsoleProcessHandler gdbProcess){
        gdbProcess.inputWithFlush("-gdb-exit\n");
      }
    }
);
    return new DefaultExecutionResult(executionConsole,processHandler,consoleView.createConsoleActions());
  }
 catch (  Throwable t) {
    throw new ExecutionException("can't create debug session",t);
  }
}
