{
  Iterable<String> names=Sequence.fromIterable(modules).ofType(AbstractModule.class).translate(new ITranslator2<AbstractModule,MigrationScriptReference>(){
    public Iterable<MigrationScriptReference> translate(    AbstractModule module){
      return MigrationsUtil.getAllScriptsToBeExecuted(module);
    }
  }
).select(new ISelector<MigrationScriptReference,String>(){
    public String select(    MigrationScriptReference it){
      MigrationScript script=fetchLanguageScript(it,false);
      String langNameShrinked=NameUtil.compactNamespace(it.getLanguage().getQualifiedName());
      if (script == null) {
        return "<missing script>: language:" + langNameShrinked + ", version:"+ it.getFromVersion();
      }
      return script.getCaption() + "  [" + langNameShrinked+ "]";
    }
  }
);
  return SetSequence.fromSetWithValues(new HashSet<String>(),names);
}
