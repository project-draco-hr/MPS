{
  return Sequence.fromIterable(modules).ofType(AbstractModule.class).any(new IWhereFilter<AbstractModule>(){
    public boolean accept(    final AbstractModule module){
      return Sequence.fromIterable(MigrationsUtil.getNextStepScripts(module)).any(new IWhereFilter<MigrationUnitReference>(){
        public boolean accept(        MigrationUnitReference item){
          if (item instanceof MigrationScriptReference) {
            return MigrationsUtil.isLanguageMigrationNeeded(((MigrationScriptReference)item).getLanguage(),((MigrationScriptReference)item).getFromVersion(),module);
          }
          if (item instanceof RefactoringStepReference) {
            return MigrationsUtil.isDependencyMigrationNeeded(((RefactoringStepReference)item).getModule().resolve(module.getRepository()),((RefactoringStepReference)item).getFromVersion(),module);
          }
          throw new IllegalStateException();
        }
      }
);
    }
  }
);
}
