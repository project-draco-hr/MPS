{
  List<ModuleReference> currentlyUsedLanguages=SNodeOperations.getUsedLanguages(sModel);
  List<ModuleReference> usedLanguages=myUsedLanguagesTable.getElements();
  Set<ModuleReference> languagesToRemove=new HashSet<ModuleReference>(currentlyUsedLanguages);
  languagesToRemove.removeAll(usedLanguages);
  for (  ModuleReference language : languagesToRemove) {
    ((jetbrains.mps.smodel.SModelInternal)sModel).deleteLanguage(language);
  }
  Set<ModuleReference> languagesToAdd=new HashSet<ModuleReference>(usedLanguages);
  languagesToAdd.removeAll(currentlyUsedLanguages);
  for (  ModuleReference language : languagesToAdd) {
    ((jetbrains.mps.smodel.SModelInternal)sModel).addLanguage(language);
  }
  Collection<ModuleReference> addedLanguages=new ArrayList<ModuleReference>();
  for (  ModuleReference language : usedLanguages) {
    if (module.getScope().getLanguage(language) == null) {
      module.addUsedLanguage(language);
      addedLanguages.add(language);
    }
  }
}
