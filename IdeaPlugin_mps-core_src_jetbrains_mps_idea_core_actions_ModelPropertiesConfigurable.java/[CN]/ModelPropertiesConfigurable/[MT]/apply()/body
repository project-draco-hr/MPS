{
  ModelAccess.instance().runCommandInEDT(new Runnable(){
    @Override public void run(){
      SModel sModel=myDescriptor.getSModel();
      IModule module=myDescriptor.getModule();
      Set<ModuleReference> languagesToRemove=new HashSet<ModuleReference>(sModel.importedLanguages());
      languagesToRemove.removeAll(myUsedLanguagesTab.getUsedLanguages());
      for (      ModuleReference language : languagesToRemove) {
        sModel.deleteLanguage(language);
      }
      Set<ModuleReference> languagesToAdd=new HashSet<ModuleReference>(myUsedLanguagesTab.getUsedLanguages());
      languagesToAdd.removeAll(sModel.importedLanguages());
      for (      ModuleReference language : languagesToAdd) {
        if (module.getScope().getLanguage(language) == null) {
          module.addUsedLanguage(language);
        }
        sModel.addLanguage(language);
      }
      myDescriptor.save();
      myImportedLanguages=new ArrayList<ModuleReference>(sModel.importedLanguages());
    }
  }
,ProjectHelper.toMPSProject(myProject));
}
