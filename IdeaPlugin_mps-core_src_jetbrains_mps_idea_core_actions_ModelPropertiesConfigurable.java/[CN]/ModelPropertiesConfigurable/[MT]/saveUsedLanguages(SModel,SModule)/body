{
  List<SModuleReference> currentlyUsedLanguages=SNodeOperations.getUsedLanguages(sModel);
  List<SModuleReference> usedLanguages=myUsedLanguagesTable.getElements();
  Set<SModuleReference> languagesToRemove=new HashSet<SModuleReference>(currentlyUsedLanguages);
  languagesToRemove.removeAll(usedLanguages);
  for (  SModuleReference language : languagesToRemove) {
    ((jetbrains.mps.smodel.SModelInternal)sModel).deleteLanguage(language);
  }
  Set<SModuleReference> languagesToAdd=new HashSet<SModuleReference>(usedLanguages);
  languagesToAdd.removeAll(currentlyUsedLanguages);
  for (  SModuleReference language : languagesToAdd) {
    ((jetbrains.mps.smodel.SModelInternal)sModel).addLanguage(language);
  }
  Collection<SModuleReference> addedLanguages=new ArrayList<SModuleReference>();
  for (  SModuleReference language : usedLanguages) {
    if (((AbstractModule)module).getScope().getLanguage(language) == null) {
      ((AbstractModule)module).addUsedLanguage(language);
      addedLanguages.add(language);
    }
  }
}
