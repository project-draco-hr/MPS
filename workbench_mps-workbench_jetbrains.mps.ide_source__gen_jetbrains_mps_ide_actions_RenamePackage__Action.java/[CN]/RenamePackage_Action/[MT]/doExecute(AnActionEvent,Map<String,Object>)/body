{
  final PackageNode treeNode=(PackageNode)((TreeNode)MapSequence.fromMap(_params).get("ppNode"));
  final String name=treeNode.getPackage();
  ModelAccess modelAccess=((MPSProject)MapSequence.fromMap(_params).get("project")).getRepository().getModelAccess();
  final String newName=JOptionPane.showInputDialog(((Frame)MapSequence.fromMap(_params).get("frame")),"Enter New Package Name",name);
  if (newName == null) {
    return;
  }
  modelAccess.executeCommandInEDT(new Runnable(){
    public void run(){
      Set<SNode> nodesUnderPackage=treeNode.getNodesUnderPackage();
      for (      SNode node : nodesUnderPackage) {
        String oldPackage=SPropertyOperations.getString(node,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x10802efe25aL,0x115eca8579fL,"virtualPackage"));
        String newPackage=newName + oldPackage.substring(name.length());
        SPropertyOperations.set(node,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x10802efe25aL,0x115eca8579fL,"virtualPackage"),(newPackage.length() > 0 ? newPackage : null));
      }
    }
  }
);
}
