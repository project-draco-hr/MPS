{
synchronized (myLock) {
    if (myReloadSession == null) {
      return;
    }
    if (myReloadSession.isEmpty()) {
      return;
    }
    myQueue.queue(new Update(myUpdateId){
      @Override public void run(){
        for (        Project project : myProjectManager.getOpenProjects()) {
          if (project.getComponent(ProjectLevelVcsManager.class).isBackgroundVcsOperationRunning()) {
            queueReload();
            return;
          }
        }
        final ReloadSession session;
synchronized (myLock) {
          if (myReloadSession == null) {
            return;
          }
          session=myReloadSession;
          if (session.isEmpty()) {
            return;
          }
          myReloadSession=null;
        }
        ProgressManager.getInstance().run(new Task.Modal(null,"Reloading",false){
          @Override public void run(          @NotNull final ProgressIndicator progressIndicator){
            session.doReload(new ProgressMonitorAdapter(progressIndicator));
          }
        }
);
      }
    }
);
  }
}
