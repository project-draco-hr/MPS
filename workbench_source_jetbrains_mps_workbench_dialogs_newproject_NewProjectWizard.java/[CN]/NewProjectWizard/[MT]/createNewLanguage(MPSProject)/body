{
  String descriptorFileName=NameUtil.shortNameFromLongName(myOptions.getLanguageNamespace());
  File descriptorFile=new File(myOptions.getLanguagePath(),descriptorFileName + MPSExtentions.DOT_LANGUAGE);
  File dir=descriptorFile.getParentFile();
  if (!(dir.exists())) {
    dir.mkdirs();
  }
  Language language=Language.createLanguage(myOptions.getLanguageNamespace(),new FileSystemFile(descriptorFile),mpsProject);
  LanguageDescriptor languageDescriptor=language.getLanguageDescriptor();
  String name=LanguageDesign_DevKit.MODULE_REFERENCE.toString();
  String uid="jetbrains.mps.projectLanguage.structure.DevKitReference";
  ModuleReference ref=new ModuleReference(name,uid);
  languageDescriptor.getUsedDevkits().add(ref);
  LanguageAspect.STRUCTURE.createNew(language);
  LanguageAspect.EDITOR.createNew(language);
  LanguageAspect.CONSTRAINTS.createNew(language);
  LanguageAspect.TYPESYSTEM.createNew(language);
  language.setLanguageDescriptor(languageDescriptor);
  language.save();
  return language;
}
