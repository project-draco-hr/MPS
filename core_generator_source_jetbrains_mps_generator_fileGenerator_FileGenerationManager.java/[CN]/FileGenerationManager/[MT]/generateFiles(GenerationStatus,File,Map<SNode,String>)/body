{
  Set<VirtualFile> generatedVFiles=new HashSet<VirtualFile>();
  Map<String,GenerationRootDependencies> dependenciesByFile=null;
  DefaultFileGenerator fileGenerator=new DefaultFileGenerator();
  for (  SNode outputRootNode : outputNodeContents.keySet()) {
    try {
      VirtualFile generatedVFile=fileGenerator.generateFile(outputRootNode,null,status.getInputModel(),outputNodeContents.get(outputRootNode),outputRootDirectory);
      if (generatedVFile != null) {
        generatedVFiles.add(generatedVFile);
      }
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
  DebugInfo debugInfoCache=null;
  ModelDependencies modelDep=null;
  GenerationDependencies dependencies=status.getDependencies();
  if (dependencies != null) {
    File outputDir=FileGenerationUtil.getDefaultOutputDir(status.getInputModel(),outputRootDirectory);
    for (    GenerationRootDependencies rdep : dependencies.getUnchangedDependencies()) {
      for (      String filename : rdep.getFiles()) {
        File ioFile=new File(outputDir,filename);
        VirtualFile file=LocalFileSystem.getInstance().findFileByIoFile(ioFile);
        if (file != null && file.exists()) {
          generatedVFiles.add(file);
          if (modelDep == null) {
            modelDep=BLDependenciesCache.getInstance().get(status.getOriginalInputModel());
          }
          if (modelDep != null) {
            RootDependencies root=modelDep.getDependency(filename);
            if (root != null) {
              status.getBLDependencies().replaceRoot(root);
            }
          }
        }
      }
      if (debugInfoCache == null) {
        debugInfoCache=BLDebugInfoCache.getInstance().get(status.getOriginalInputModel());
      }
      if (debugInfoCache != null) {
        DebugInfoRoot infoRoot=debugInfoCache.getRootInfo(rdep.getRootId());
        if (infoRoot != null) {
          status.getDebugInfo().replaceRoot(infoRoot);
        }
      }
    }
  }
  return generatedVFiles;
}
