{
  if (outputRoot == null)   throw new RuntimeException("unspecified output path for file generation.");
  if (!status.isOk())   return false;
  Map<SNode,String> outputNodeContents=new LinkedHashMap<SNode,String>();
  if (!generateText(context,status,outputNodeContents))   return false;
  Set<VirtualFile> generatedFiles=generateFiles(status,outputRoot,outputNodeContents);
  File cachesOutputRoot=FileGenerationUtil.getCachesOutputDir(outputRoot);
  Set<VirtualFile> generatedCaches=generateCaches(status,cachesOutputRoot);
  performCleanup(status.getInputModel(),CollectionUtil.set(outputRoot,cachesOutputRoot),CollectionUtil.union(generatedFiles,generatedCaches));
  return true;
}
