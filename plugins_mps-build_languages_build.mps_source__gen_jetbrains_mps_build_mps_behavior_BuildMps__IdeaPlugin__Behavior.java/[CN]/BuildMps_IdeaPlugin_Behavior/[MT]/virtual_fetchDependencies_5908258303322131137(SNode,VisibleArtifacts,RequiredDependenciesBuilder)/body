{
  RequiredPlugins plugins=new RequiredPlugins(artifacts.getGenContext(),Sequence.<SNode>singleton(thisNode));
  plugins.collectDependency();
  for (  SNode plugin : Sequence.fromIterable(plugins.getDependency()).where(new IWhereFilter<SNode>(){
    public boolean accept(    SNode it){
      return SNodeOperations.getContainingRoot(it) != SNodeOperations.getContainingRoot(thisNode);
    }
  }
)) {
    SNode pluginArtifact=SNodeOperations.as(artifacts.findArtifact(plugin),"jetbrains.mps.build.structure.BuildLayout_Node");
    if (pluginArtifact != null) {
      builder.add(pluginArtifact,plugin);
    }
  }
}
