{
  if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.TypeVariableReference") && ListSequence.fromList(actTypes).isNotEmpty()) {
    int idx=0;
    for (    SNode tvd : vars) {
      if (tvd == SLinkOperations.getTarget(SNodeOperations.cast(type,"jetbrains.mps.baseLanguage.structure.TypeVariableReference"),"typeVariableDeclaration",false) && idx < ListSequence.fromList(actTypes).count()) {
        return SNodeOperations.copyNode(getTypeCoercedToClassifierType(ListSequence.fromList(actTypes).getElement(idx)));
      }
      idx++;
    }
  }
 else   if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.ClassifierType")) {
    for (    SNode pt : SLinkOperations.getTargets(SNodeOperations.cast(type,"jetbrains.mps.baseLanguage.structure.ClassifierType"),"parameter",true)) {
      SNode rt=resolveType(pt,actTypes,vars);
      if (pt != rt) {
        SNodeOperations.replaceWithAnother(pt,rt);
      }
    }
  }
 else   if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.UpperBoundType")) {
    SNode bound=SLinkOperations.getTarget(SNodeOperations.cast(type,"jetbrains.mps.baseLanguage.structure.UpperBoundType"),"bound",true);
    SNodeOperations.replaceWithAnother(bound,resolveType(bound,actTypes,vars));
  }
 else   if (SNodeOperations.isInstanceOf(type,"jetbrains.mps.baseLanguage.structure.LowerBoundType")) {
    SNode bound=SLinkOperations.getTarget(SNodeOperations.cast(type,"jetbrains.mps.baseLanguage.structure.LowerBoundType"),"bound",true);
    SNodeOperations.replaceWithAnother(bound,resolveType(bound,actTypes,vars));
  }
  return type;
}
