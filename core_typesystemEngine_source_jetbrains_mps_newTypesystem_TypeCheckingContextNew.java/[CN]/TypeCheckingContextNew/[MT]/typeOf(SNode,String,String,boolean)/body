{
  EquationInfo info=new EquationInfo(node,"typeOf",ruleModel,ruleId);
  if (node == null)   return null;
  INodeTypesComponent currentTypesComponent=getNodeTypesComponent();
  if (currentTypesComponent != null) {
    currentTypesComponent.addNodeToFrontier(node);
    currentTypesComponent.typeOfNodeCalled(node);
    if (addDependency) {
      currentTypesComponent.addDependencyOnCurrent(node);
    }
    if (ruleModel != null && ruleId != null) {
      currentTypesComponent.markNodeAsAffectedByRule(node,ruleModel,ruleId);
    }
  }
  return myState.typeOf(node,info);
}
