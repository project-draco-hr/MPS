{
  final VirtualFile file=VFileSystem.getFile(path);
  if (file == null || !file.isValid()) {
    String moduleString=module == null ? "" : (" in " + module.toString());
    String message="Can't load class path item " + path + moduleString;
    throw new IOException(message);
  }
  IClassPathItem currentItem=file.getUserData(CLASSPATH_KEY);
  if (currentItem == null) {
    if (file.isDirectory()) {
      currentItem=new FileClassPathItem(path);
    }
 else {
      currentItem=new JarFileClassPathItem(path);
    }
    file.putUserData(CLASSPATH_KEY,currentItem);
    file.getFileSystem().addVirtualFileListener(new MyVirtualFileAdapter(file));
  }
  return currentItem;
}
