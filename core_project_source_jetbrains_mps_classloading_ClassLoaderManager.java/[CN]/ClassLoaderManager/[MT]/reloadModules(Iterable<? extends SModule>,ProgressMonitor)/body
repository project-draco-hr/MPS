{
  LOG.info("Reloading modules");
  if (IterableUtils.isEmpty(modules)) {
    LOG.info("Reloaded 0 modules");
    return new ArrayList<SModule>();
  }
  try {
    monitor.start("Reloading modules' class loaders...",2);
    myModulesWatcher.invalidate();
    Collection<SModule> modulesToReload=new LinkedHashSet<SModule>(doUnloadModules(modules,monitor.subTask(1)));
    for (    SModule module : modules)     modulesToReload.add(module);
    Collection<SModule> loadedModules=new LinkedHashSet<SModule>(doLoadModules(modulesToReload,monitor.subTask(1)));
    LOG.info("Reloaded " + loadedModules.size() + " modules");
    return loadedModules;
  }
  finally {
    monitor.done();
  }
}
