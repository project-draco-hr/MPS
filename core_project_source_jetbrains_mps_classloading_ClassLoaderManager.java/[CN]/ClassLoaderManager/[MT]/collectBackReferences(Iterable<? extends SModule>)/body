{
  Set<SModule> modules=new HashSet<SModule>();
  Set<SModule> queue=new HashSet<SModule>();
  for (  SModule module : startModules) {
    queue.add(module);
  }
  while (!queue.isEmpty()) {
    SModule module=queue.iterator().next();
    queue.remove(module);
    if (!modules.contains(module)) {
      modules.add(module);
      if (myBackRefs.containsKey(module)) {
        queue.addAll(myBackRefs.get(module));
      }
    }
  }
  return Collections.unmodifiableSet(modules);
}
