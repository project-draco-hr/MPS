{
  if (mySilently || myConfirmationOption.getValue() == VcsShowConfirmationOption.Value.DO_ACTION_SILENTLY) {
    reallyPerform(myVirtualFilesToRevert,myVirtualFilesToAdd);
  }
 else   if (myConfirmationOption.getValue() == VcsShowConfirmationOption.Value.DO_NOTHING_SILENTLY) {
    return;
  }
 else {
    Collection<VirtualFile> filesToProcess=null;
    List<VirtualFile> virtualFileList=CollectionUtil.union(myVirtualFilesToAdd,myVirtualFilesToRevert);
    if (!virtualFileList.isEmpty()) {
      final AbstractVcsHelper helper=AbstractVcsHelper.getInstance(myProject);
      filesToProcess=helper.selectFilesToProcess(virtualFileList,"Add Files To Vcs",null,"Add File To Vcs","Do you want to add the following file to Vcs?\n{0}\n\nIf you say NO, you can still add it later manually.",myConfirmationOption);
    }
    if (filesToProcess != null) {
      reallyPerform(CollectionUtil.intersect(myVirtualFilesToRevert,filesToProcess),CollectionUtil.intersect(myVirtualFilesToAdd,filesToProcess));
    }
  }
}
