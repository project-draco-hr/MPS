{
  List<VirtualFile> path=new LinkedList<VirtualFile>();
  path.add(vf);
  while (true) {
    VirtualFile parent=path.get(0).getParent();
    if (parent == null) {
      return Collections.EMPTY_LIST;
    }
    if (isScheduledForDeletion(parent)) {
      return Collections.EMPTY_LIST;
    }
 else     if (isUnderVCS(parent)) {
      break;
    }
 else {
      VirtualFile[] files=parent.getChildren();
      for (      VirtualFile child : files) {
        if (MPSFileTypesManager.instance().isModuleFile(child) && !myVirtualFilesToAdd.contains(child)) {
          return Collections.EMPTY_LIST;
        }
      }
      path.add(0,parent);
    }
  }
  return path;
}
