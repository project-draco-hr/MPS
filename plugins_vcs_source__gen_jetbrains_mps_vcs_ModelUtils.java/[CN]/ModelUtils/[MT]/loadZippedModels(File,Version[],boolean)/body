{
  File tmpdir=FileUtil.createTmpDir();
  UnzipUtil.unzip(zipfile,tmpdir);
  String zipfilename=zipfile.getName();
  String name=zipfilename.substring(0,zipfilename.length() - "zip".length());
  String prefix=tmpdir + File.separator + name;
  SModel[] models=new SModel[versions.length];
  int index=0;
  for (  final Version v : versions) {
    File file;
    if (useZipName) {
      file=new File(prefix + v.getSuffix());
    }
 else {
      File[] files=tmpdir.listFiles(new FilenameFilter(){
        public boolean accept(        File dir,        String name){
          return name.endsWith(v.getSuffix());
        }
      }
);
      if (files == null || files.length == 1) {
        if (log.isErrorEnabled()) {
          log.error("Wrong zip contents");
        }
      }
      file=files[0];
    }
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    FileInputStream fis=new FileInputStream(file);
    while (true) {
      int i=fis.read();
      if (i == -1) {
        break;
      }
      baos.write(i);
    }
    models[index]=ModelUtils.readModel(baos.toByteArray(),file.getAbsolutePath());
    index++;
  }
  FileUtil.delete(tmpdir);
  return models;
}
