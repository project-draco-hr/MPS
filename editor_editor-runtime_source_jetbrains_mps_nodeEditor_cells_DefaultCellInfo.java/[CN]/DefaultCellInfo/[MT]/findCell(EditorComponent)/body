{
  if (myCellId != null) {
    final EditorContext editorContext=editorComponent.getEditorContext();
    if (myNodeReference == null || editorContext == null)     return null;
    final EditorCell[] cell=new EditorCell[]{null};
    editorContext.getRepository().getModelAccess().runReadAction(new Runnable(){
      @Override public void run(){
        cell[0]=editorComponent.findCellWithId(myNodeReference.resolve(editorContext.getRepository()),myCellId);
      }
    }
);
    return cell[0];
  }
 else   if (myParentInfo != null) {
    EditorCell parentCell=myParentInfo.findCell(editorComponent);
    if (!(parentCell instanceof EditorCell_Collection)) {
      return null;
    }
    EditorCell_Collection parentCollection=(EditorCell_Collection)parentCell;
    if (myCellNumber >= parentCollection.getCellsCount()) {
      return null;
    }
    EditorCell editorCell=parentCollection.getChildAt(myCellNumber);
    return editorCell.getCellId() == null ? editorCell : null;
  }
  return null;
}
