{
  SNode parent=SNodeOperations.getParent(part);
  if (SNodeOperations.isInstanceOf(parent,"jetbrains.mps.core.notation.structure.SNotationMapping") && "presentation".equals(SNodeOperations.getContainingLinkRole(part))) {
    return getRightOutermostNotation(SNodeOperations.cast(parent,"jetbrains.mps.core.notation.structure.SNotationPart"));
  }
  if (SNodeOperations.isInstanceOf(parent,"jetbrains.mps.core.notation.structure.SNotationUnorderedGroup") && ListSequence.fromList(SLinkOperations.getTargets(SNodeOperations.cast(parent,"jetbrains.mps.core.notation.structure.SNotationUnorderedGroup"),"parts",true)).last() == part) {
    return getRightOutermostNotation(SNodeOperations.cast(parent,"jetbrains.mps.core.notation.structure.SNotationPart"));
  }
  return part;
}
