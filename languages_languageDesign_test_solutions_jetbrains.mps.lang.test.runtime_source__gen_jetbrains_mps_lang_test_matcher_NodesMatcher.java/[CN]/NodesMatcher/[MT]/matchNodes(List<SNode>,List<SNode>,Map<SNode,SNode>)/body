{
  Iterator<SNode> iteratorA=a.iterator();
  Iterator<SNode> iteratorB=b.iterator();
  while (iteratorA.hasNext() && iteratorB.hasNext()) {
    NodesMatcher.match(iteratorA.next(),iteratorB.next(),map);
  }
  ArrayList<NodeDifference> ret=null;
  iteratorA=a.iterator();
  iteratorB=b.iterator();
  while (iteratorA.hasNext() && iteratorB.hasNext()) {
    NodeDifference diff=NodesMatcher.matchNodes(iteratorA.next(),iteratorB.next(),map);
    if (diff != null) {
      if (ret == null) {
        ret=new ArrayList<NodeDifference>();
      }
      ret.add(diff);
    }
  }
  return ret;
}
