{
  SNode bottomMostTernary=ParenthesisUtil.findBottomMostTernary(SNodeOperations.cast(firstCommon,"jetbrains.mps.baseLanguage.structure.TernaryOperatorExpression"));
  if (rightTurn != null) {
    SNodeOperations.replaceWithAnother(firstCommon,SLinkOperations.getTarget(bottomMostTernary,"ifFalse",true));
    if (leftTurn != null) {
      SLinkOperations.setTarget(rightTurn,"leftExpression",SLinkOperations.getTarget(firstCommon,"condition",true),true);
      SLinkOperations.setTarget(leftTurn,"rightExpression",parens,true);
    }
 else {
      SLinkOperations.setTarget(rightTurn,"leftExpression",parens,true);
    }
  }
 else {
    if (leftTurn != null) {
      SNodeOperations.replaceWithAnother(firstCommon,SLinkOperations.getTarget(firstCommon,"condition",true));
      SLinkOperations.setTarget(leftTurn,"rightExpression",parens,true);
    }
 else {
      SNodeOperations.replaceWithAnother(firstCommon,parens);
    }
  }
  SLinkOperations.setTarget(bottomMostTernary,"ifFalse",rightAccumulator,true);
  SLinkOperations.setTarget(firstCommon,"condition",leftAccumulator,true);
}
