{
  if (!(file instanceof MPSNodeVirtualFile)) {
    return null;
  }
  if (!(ModelAccess.instance().isInEDT())) {
    return FileStatus.NOT_CHANGED;
  }
  final MPSNodeVirtualFile nodeFile=(MPSNodeVirtualFile)file;
  SNode root=MPSEditorUtil.getCurrentEditedNode(myProject,nodeFile);
  if (root == null) {
    root=ModelAccess.instance().runReadAction(new Computable<SNode>(){
      @Override public SNode compute(){
        return nodeFile.getNode().getContainingRoot();
      }
    }
);
  }
  if (root == null) {
    return null;
  }
  if (SNodeOperations.isDisposed(root)) {
    return null;
  }
  return myMapping.getStatus(root);
}
