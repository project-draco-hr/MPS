{
  if (!(file instanceof MPSNodeVirtualFile)) {
    return null;
  }
  if (!(ModelAccess.instance().isInEDT())) {
    return FileStatus.NOT_CHANGED;
  }
  final MPSNodeVirtualFile nodeFile=(MPSNodeVirtualFile)file;
  final Wrappers._T<FileStatus> status=new Wrappers._T<FileStatus>(null);
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      SNode root=MPSEditorUtil.getCurrentEditedNode(myProject,nodeFile);
      if (root == null) {
        root=nodeFile.getNode().getContainingRoot();
      }
      if (root == null) {
        return;
      }
      if (SNodeUtil.isAccessible(root,MPSModuleRepository.getInstance())) {
        return;
      }
      status.value=myMapping.getStatus(root);
    }
  }
);
  return status.value;
}
