{
  if (!(file instanceof MPSNodeVirtualFile)) {
    return null;
  }
  if (!(ThreadUtils.isInEDT())) {
    return FileStatus.NOT_CHANGED;
  }
  final MPSNodeVirtualFile nodeFile=(MPSNodeVirtualFile)file;
  return new ModelAccessHelper(myProject.getModelAccess()).runReadAction(new Computable<FileStatus>(){
    public FileStatus compute(){
      SNode root=MPSEditorUtil.getCurrentEditedNode(myProject.getProject(),nodeFile);
      if (root == null) {
        root=nodeFile.getNode().getContainingRoot();
      }
      if (!(SNodeUtil.isAccessible(root,myProject.getRepository()))) {
        return null;
      }
      return myMapping.getStatus(root);
    }
  }
);
}
