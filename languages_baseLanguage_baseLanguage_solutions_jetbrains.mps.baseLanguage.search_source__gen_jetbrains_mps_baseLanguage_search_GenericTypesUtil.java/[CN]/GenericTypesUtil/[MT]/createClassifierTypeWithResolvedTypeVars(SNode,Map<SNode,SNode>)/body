{
  SNode typeCopy=SNodeOperations.copyNode(type);
  for (  SNode typeVariableRef : ListSequence.fromList(SNodeOperations.getNodeDescendants(typeCopy,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1109283449304l,"jetbrains.mps.baseLanguage.structure.TypeVariableReference"),false,new SConcept[]{}))) {
    SNode resolvedType=GenericTypesUtil.getTypeByTypeVariable(typeVariableRef,typeByTypeVar);
    if (resolvedType != typeVariableRef) {
      SNodeOperations.replaceWithAnother(typeVariableRef,SNodeOperations.copyNode(resolvedType));
    }
  }
  return typeCopy;
}
