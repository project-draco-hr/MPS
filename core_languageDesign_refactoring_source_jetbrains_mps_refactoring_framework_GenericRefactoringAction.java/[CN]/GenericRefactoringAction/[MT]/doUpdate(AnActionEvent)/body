{
  RefactoringTarget refTarget=myRefactoring.getRefactoringTarget();
  boolean oneEntity=myRefactoring.isOneTargetOnly();
  Set entities;
  if (refTarget == RefactoringTarget.NODE) {
    entities=getNodes(e,oneEntity);
  }
 else   if (refTarget == RefactoringTarget.MODEL) {
    entities=getModels(e,oneEntity);
  }
 else {
    entities=getModules(e,oneEntity);
  }
  boolean enabled;
  if (entities == null || entities.isEmpty()) {
    enabled=false;
  }
 else {
    enabled=RefactoringUtil.isApplicableInContext(myRefactoring,entities);
  }
  setEnabledState(e.getPresentation(),enabled);
}
