{
  ActionEventData data=new ActionEventData(e);
  boolean enabled=true;
  List<SNode> nodes=getNodes(data);
  if (myRefactoring.getRefactoringTarget() == RefactoringTarget.NODE) {
    enabled=RefactoringUtil.isApplicableInContext(myRefactoring,nodes);
  }
 else   if (myRefactoring.getRefactoringTarget() == RefactoringTarget.MODEL) {
    SModelDescriptor modelDescriptor=data.getModelDescriptor();
    if (modelDescriptor != null) {
      enabled=myRefactoring.isApplicableToModel(modelDescriptor);
    }
  }
  setEnabledState(e.getPresentation(),enabled);
}
