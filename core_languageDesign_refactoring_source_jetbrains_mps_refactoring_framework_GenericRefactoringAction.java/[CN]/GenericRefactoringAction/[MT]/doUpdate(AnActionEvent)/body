{
  ActionEventData data=new ActionEventData(e);
  boolean enabled=true;
  SNode node=getNode(data);
  if (myRefactoring.getRefactoringTarget() == RefactoringTarget.NODE) {
    if (node != null) {
      enabled=myRefactoring.isApplicableWRTConcept(node);
    }
  }
 else   if (myRefactoring.getRefactoringTarget() == RefactoringTarget.MODEL) {
    SModelDescriptor modelDescriptor=data.getModelDescriptor();
    if (modelDescriptor != null) {
      enabled=myRefactoring.isApplicableToModel(modelDescriptor);
    }
  }
  RefactoringTarget refactoringTarget=myRefactoring.getRefactoringTarget();
  Map<Class,ILoggableRefactoring> allRefactorings=RefactoringActionGroup.getAvailableRefactorings(node,refactoringTarget);
  if (!allRefactorings.containsKey(myRefactoring.getClass())) {
    enabled=false;
  }
  setEnabledState(e.getPresentation(),enabled);
}
