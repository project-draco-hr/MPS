{
  Set<SNode> conceptsToRemove=SetSequence.fromSetWithValues(new HashSet<SNode>(),ListSequence.fromList(SLinkOperations.getTargets(builder,"part",true)).where(new IWhereFilter<SNode>(){
    public boolean accept(    SNode it){
      return SNodeOperations.isInstanceOf(it,"jetbrains.mps.lang.actions.structure.RemovePart") && (SLinkOperations.getTarget(SNodeOperations.cast(it,"jetbrains.mps.lang.actions.structure.RemovePart"),"conceptToRemove",false) != null);
    }
  }
).select(new ISelector<SNode,SNode>(){
    public SNode select(    SNode it){
      return SLinkOperations.getTarget(SNodeOperations.cast(it,"jetbrains.mps.lang.actions.structure.RemovePart"),"conceptToRemove",false);
    }
  }
));
  if (SetSequence.fromSet(conceptsToRemove).isNotEmpty()) {
    for (Iterator<SubstituteAction> it=ListSequence.fromList(actions).iterator(); it.hasNext(); ) {
      SubstituteAction action=it.next();
      if (SetSequence.fromSet(conceptsToRemove).contains(SNodeOperations.as(action.getOutputConcept(),"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration"))) {
        it.remove();
      }
    }
  }
  for (  SNode removeByCondition : ListSequence.fromList(SLinkOperations.getTargets(builder,"part",true)).where(new IWhereFilter<SNode>(){
    public boolean accept(    SNode it){
      return SNodeOperations.isInstanceOf(it,"jetbrains.mps.lang.actions.structure.RemoveByConditionPart");
    }
  }
)) {
    String methodName="removeActionsByCondition_" + removeByCondition.getNodeId();
    try {
      QueryMethodGenerated.invoke(methodName,context,new RemoveSubstituteActionByConditionContext(ListSequence.fromList(actions).iterator(),parentNode,currentChild,childConcept),SNodeOperations.getModel(builder));
    }
 catch (    Throwable t) {
      LOG.error(t);
    }
  }
  return actions;
}
