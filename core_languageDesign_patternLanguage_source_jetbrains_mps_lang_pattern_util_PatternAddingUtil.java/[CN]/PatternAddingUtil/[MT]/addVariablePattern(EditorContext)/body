{
  EditorCell contextCell=context.getSelectedCell();
  SNode node=contextCell.getSNode();
  SModel model=node.getModel();
  LinkDeclaration linkDeclaration=(LinkDeclaration)BaseAdapter.fromNode((SNode)contextCell.getUserObject(EditorCell.METAINFO_LINK_DECLARATION));
  if (linkDeclaration != null && SModelUtil_new.getGenuineLinkMetaclass(linkDeclaration) == LinkMetaclass.reference) {
    linkDeclaration=SModelUtil_new.getGenuineLinkDeclaration(linkDeclaration);
    String role=linkDeclaration.getRole();
    LinkPatternVariableDeclaration linkPatternVariable=LinkPatternVariableDeclaration.newInstance(model);
    node.setLinkAttribute(role,linkPatternVariable.getNode());
  }
 else {
    PatternVariableDeclaration patternVariable=PatternVariableDeclaration.newInstance(model);
    node.setAttribute(patternVariable.getNode());
  }
}
