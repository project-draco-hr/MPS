{
  if (operations == null || operations.size() == 0 || operations.iterator().next() == null) {
    return null;
  }
  List<MPSTreeNode> result=new ArrayList<MPSTreeNode>();
  for (  AbstractOperation operation : operations) {
    boolean showNode=showNode(operation);
    List<MPSTreeNode> children=new ArrayList<MPSTreeNode>();
    for (    AbstractOperation consequence : operation.getConsequences()) {
      Collection<MPSTreeNode> nodes=create(Collections.singletonList(consequence),showNode || showParent);
      if (nodes != null) {
        children.addAll(nodes);
      }
    }
    if (!(filterNodeType(operation))) {
      continue;
    }
    if (!(showParent)) {
      if (!(showNode) && children.isEmpty()) {
        continue;
      }
    }
    if (showParent) {
      TypeSystemTraceTreeNode treeNode=new TypeSystemTraceTreeNode(operation,myOperationContext,myCurrentContext.getState(),myEditorComponent);
      for (      MPSTreeNode node : children) {
        treeNode.add(node);
      }
      result.add(treeNode);
    }
 else {
      result.addAll(children);
    }
  }
  return result;
}
