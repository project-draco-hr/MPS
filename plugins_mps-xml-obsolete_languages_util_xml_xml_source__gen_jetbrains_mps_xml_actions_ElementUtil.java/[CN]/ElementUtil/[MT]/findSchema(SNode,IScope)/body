{
  SNode schema=null;
  SNode element=SNodeOperations.getAncestor(node,"jetbrains.mps.xml.structure.Element",true,false);
  if ((element == null)) {
    SNode containingRoot=SNodeOperations.getContainingRoot(node);
    if (SNodeOperations.isInstanceOf(containingRoot,"jetbrains.mps.xml.structure.XmlRoot")) {
      schema=BehaviorReflection.invokeVirtual((Class<SNode>)((Class)Object.class),SNodeOperations.cast(containingRoot,"jetbrains.mps.xml.structure.XmlRoot"),"virtual_getSchema_1213877420378",new Object[]{scope});
    }
  }
 else {
    schema=SNodeOperations.getAncestor(SLinkOperations.getTarget(element,"elementDeclaration",false),"jetbrains.mps.xmlSchema.structure.Schema",false,false);
  }
  return schema;
}
