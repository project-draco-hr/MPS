{
  SNode elementDeclaration=null;
  SNode currentNode=node;
  if (!(includeThis)) {
    currentNode=SNodeOperations.getParent(node);
  }
  while (true) {
    if ((currentNode == null)) {
      break;
    }
    if (SNodeOperations.isInstanceOf(currentNode,"jetbrains.mps.xml.structure.Element")) {
      elementDeclaration=SLinkOperations.getTarget(SNodeOperations.cast(currentNode,"jetbrains.mps.xml.structure.Element"),"elementDeclaration",false);
      break;
    }
    if (SNodeOperations.isInstanceOf(currentNode,"jetbrains.mps.xml.structure.Content")) {
      SNode content=SNodeOperations.cast(currentNode,"jetbrains.mps.xml.structure.Content");
      elementDeclaration=ListSequence.fromList(BehaviorReflection.invokeVirtualStatic((Class<List<SNode>>)((Class)Object.class),SConceptRepository.getInstance().getConcept(NameUtil.nodeFQName(SNodeOperations.getConceptDeclaration(content))),"virtual_getCorrespondingElement_3044950653914717088",new Object[]{})).first();
      if ((elementDeclaration != null)) {
        break;
      }
    }
    currentNode=SNodeOperations.getParent(currentNode);
  }
  return elementDeclaration;
}
