{
  this.myGraph=graph;
  this.myOrder=order;
  this.init();
  List<Map<Node,Integer>> xCoords=ListSequence.<Map<Node,Integer>>fromList(new ArrayList<Map<Node,Integer>>());
  ListSequence.<Map<Node,Integer>>fromList(xCoords).addElement(computeCoords(TOP_TO_BOTTOM,LEFTMOST));
  ListSequence.<Map<Node,Integer>>fromList(xCoords).addElement(computeCoords(TOP_TO_BOTTOM,RIGHTMOST));
  ListSequence.<Map<Node,Integer>>fromList(xCoords).addElement(computeCoords(BOTTOM_TO_TOP,LEFTMOST));
  ListSequence.<Map<Node,Integer>>fromList(xCoords).addElement(computeCoords(BOTTOM_TO_TOP,RIGHTMOST));
  List<Integer> maxCoord=ListSequence.<Integer>fromList(new ArrayList<Integer>());
  int minMaxCoord=Integer.MAX_VALUE;
  List<Node> nodes=graph.getNodes();
  for (  Map<Node,Integer> coords : ListSequence.<Map<Node,Integer>>fromList(xCoords)) {
    int curMaxCoord=0;
    for (    Node node : ListSequence.<Node>fromList(nodes)) {
      curMaxCoord=Math.max(curMaxCoord,MapSequence.<Node,Integer>fromMap(coords).get(node));
    }
    minMaxCoord=Math.min(minMaxCoord,curMaxCoord);
    ListSequence.<Integer>fromList(maxCoord).addElement(curMaxCoord);
  }
  List<Integer> shifts=ListSequence.<Integer>fromList(new ArrayList<Integer>());
  for (int i=0; i < ListSequence.<Map<Node,Integer>>fromList(xCoords).count(); i++) {
    if (i % 2 == 0) {
      ListSequence.<Integer>fromList(shifts).addElement(0);
    }
 else {
      ListSequence.<Integer>fromList(shifts).addElement(minMaxCoord - ListSequence.<Integer>fromList(maxCoord).getElement(i));
    }
  }
  Map<Node,Integer> finalXCoord=new NodeMap<Integer>(graph);
  for (  Node node : ListSequence.<Node>fromList(nodes)) {
    List<Integer> nodeXCoords=ListSequence.<Integer>fromList(new ArrayList<Integer>());
    for (int i=0; i < ListSequence.<Map<Node,Integer>>fromList(xCoords).count(); i++) {
      ListSequence.<Integer>fromList(nodeXCoords).addElement(MapSequence.<Node,Integer>fromMap(ListSequence.<Map<Node,Integer>>fromList(xCoords).getElement(i)).get(node) + ListSequence.<Integer>fromList(shifts).getElement(i));
    }
    nodeXCoords=ListSequence.<Integer>fromList(nodeXCoords).sort(new ISelector<Integer,Comparable<?>>(){
      public Comparable<?> select(      Integer it){
        return it;
      }
    }
,true).toListSequence();
    MapSequence.<Node,Integer>fromMap(finalXCoord).put(node,ListSequence.<Integer>fromList(nodeXCoords).getElement(1) + ListSequence.<Integer>fromList(nodeXCoords).getElement(2));
  }
  int minXCoord=Integer.MAX_VALUE;
  for (  Node node : ListSequence.<Node>fromList(nodes)) {
    minXCoord=Math.min(minXCoord,MapSequence.<Node,Integer>fromMap(finalXCoord).get(node));
  }
  for (  Node node : ListSequence.<Node>fromList(nodes)) {
    MapSequence.<Node,Integer>fromMap(finalXCoord).put(node,MapSequence.<Node,Integer>fromMap(finalXCoord).get(node) - minXCoord);
  }
  Map<Node,Point> coord=new NodeMap<Point>(graph);
  for (  Node node : ListSequence.<Node>fromList(nodes)) {
    MapSequence.<Node,Point>fromMap(coord).put(node,new Point(MapSequence.<Node,Integer>fromMap(finalXCoord).get(node),MapSequence.<Node,Integer>fromMap(myNumLayer).get(node)));
  }
  return coord;
}
