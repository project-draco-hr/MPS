{
  if (!myMigrationManager.isMigrationRequired())   return;
  StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().assertWriteAccessAllowed();
      if (!myState.reloadFinished) {
        VirtualFileManager.getInstance().syncRefresh();
        myState.reloadFinished=true;
        ProjectManagerEx.getInstance().reloadProject(myProject);
      }
 else {
        myState.reloadFinished=false;
        MigrationAssistantWizard wizard=new MigrationAssistantWizard(myProject,myMigrationManager);
        wizard.showAndGetOk();
      }
    }
  }
);
}
