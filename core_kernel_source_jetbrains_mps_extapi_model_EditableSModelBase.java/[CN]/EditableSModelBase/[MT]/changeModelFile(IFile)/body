{
  assertCanChange();
  if (!(getSource() instanceof FileDataSource)) {
    throw new UnsupportedOperationException("cannot change model file on non-file data source");
  }
  FileDataSource source=(FileDataSource)getSource();
  if (source.getFile().getPath().equals(newModelFile.getPath()))   return;
  IFile oldFile=source.getFile();
  jetbrains.mps.smodel.SModel model=getSModel();
  fireBeforeModelFileChanged(new SModelFileChangedEvent(model.getModelDescriptor(),oldFile,newModelFile));
  source.setFile(newModelFile);
  updateTimestamp();
  fireModelFileChanged(new SModelFileChangedEvent(model.getModelDescriptor(),oldFile,newModelFile));
}
