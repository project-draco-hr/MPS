{
  LOG.assertCanWrite();
  monitor.start("Reloading classes...",6);
  try {
    monitor.step("Updating classpath...");
    updateClassPath();
    monitor.advance(1);
    monitor.step("Updating stub models...");
    LibrariesLoader.getInstance().loadNewLibs();
    monitor.advance(1);
    monitor.step("Disposing old classes...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.unload();
      }
    }
);
    monitor.advance(1);
    monitor.step("Updating language registry...");
    LanguageRegistry.getInstance().reloadLanguages();
    monitor.advance(1);
    monitor.step("Updating extensions...");
    ExtensionRegistry.getInstance().reloadExtensionDescriptors();
    monitor.advance(1);
    monitor.step("Reloading classes...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.load();
      }
    }
);
    monitor.advance(1);
    monitor.step("Rebuilding ui...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.onAfterReload();
      }
    }
);
    monitor.advance(1);
  }
  finally {
    monitor.done();
  }
}
