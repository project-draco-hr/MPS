{
  LOG.assertCanWrite();
  indicator.pushState();
  try {
    indicator.setIndeterminate(true);
    indicator.setText("Reloading classes...");
    indicator.setText2("Performing cleanup...");
    CleanupManager.getInstance().cleanup();
    indicator.setText2("Updating classpath...");
    updateClassPath();
    indicator.setText2("Refreshing models...");
    SModelRepository.getInstance().refreshModels();
    indicator.setText2("Updating stub models...");
    StubReloadManager.getInstance().reload();
    indicator.setText2("Invalidating language caches...");
    MPSModuleRepository.getInstance().invalidateCaches();
    indicator.setText2("Disposing old classes...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.unload();
      }
    }
);
    indicator.setText2("Reloading classes...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.load();
      }
    }
);
    indicator.setText2("Rebuilding ui...");
    callListeners(new ListenerCaller(){
      public void call(      ReloadListener l){
        l.onAfterReload();
      }
    }
);
  }
  finally {
    indicator.popState();
  }
}
