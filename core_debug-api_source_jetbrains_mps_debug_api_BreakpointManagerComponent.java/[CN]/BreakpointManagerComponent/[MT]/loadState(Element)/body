{
synchronized (myBreakpoints) {
    clear();
    List breakpointsElement=state.getChildren(BREAKPOINT_ELEMENT);
    for (ListIterator it=breakpointsElement.listIterator(); it.hasNext(); ) {
      Element breakpointElement=(Element)it.next();
      String kindName=breakpointElement.getAttributeValue(KIND_TAG);
      IBreakpointKind kind=myProvidersManager.getKind(kindName);
      if (kind == null) {
        myUnreadBreakpoints.add(breakpointElement);
        continue;
      }
      IBreakpointsProvider provider=myProvidersManager.getProvider(kind);
      if (provider == null) {
        myUnreadBreakpoints.add(breakpointElement);
        continue;
      }
      try {
        IBreakpoint breakpoint=provider.loadFromState((Element)breakpointElement.getChildren().get(0),kind,myProject);
        if (breakpoint != null) {
          breakpoint.addBreakpointListener(myBreakpointListener);
          myBreakpoints.add(breakpoint);
        }
 else {
          myUnreadBreakpoints.add(breakpointElement);
        }
      }
 catch (      Throwable t) {
        LOG.error("Error while loading breakpoint from " + breakpointElement,t);
      }
    }
  }
  ModelAccess.instance().runReadAction(new Runnable(){
    @Override public void run(){
synchronized (myBreakpoints) {
        for (        IBreakpoint breakpoint : myBreakpoints) {
          if (breakpoint instanceof ILocationBreakpoint) {
            addLocationBreakpoint((ILocationBreakpoint)breakpoint);
          }
        }
      }
    }
  }
);
}
