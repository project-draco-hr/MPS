{
  Element rootElement=new Element(BREAKPOINTS_LIST_ELEMENT);
synchronized (myBreakpoints) {
    for (    IBreakpoint breakpoint : myBreakpoints) {
      IBreakpointKind kind=breakpoint.getKind();
      IBreakpointsProvider provider=myProvidersManager.getProvider(kind);
      if (provider == null) {
        continue;
      }
      try {
        Element element=provider.saveToState(breakpoint);
        if (element != null) {
          Element breakpointElement=new Element(BREAKPOINT_ELEMENT);
          breakpointElement.setAttribute(new Attribute(KIND_TAG,kind.getName()));
          breakpointElement.addContent(element);
          rootElement.addContent(breakpointElement);
        }
      }
 catch (      Throwable t) {
        LOG.error("Error while saving breakpoint " + breakpoint.getPresentation(),t);
      }
    }
  }
  for (  Element el : myUnreadBreakpoints) {
    rootElement.addContent((Element)el.clone());
  }
  return rootElement;
}
