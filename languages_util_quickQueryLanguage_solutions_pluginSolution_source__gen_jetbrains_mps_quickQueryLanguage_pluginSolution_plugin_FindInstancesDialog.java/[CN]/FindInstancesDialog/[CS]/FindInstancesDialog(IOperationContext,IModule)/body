{
  super(ProjectHelper.toMainFrame(context.getProject()),"Find Instances by condition");
  this.myContext=context;
  this.setSize(new Dimension(500,500));
  this.setModal(false);
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      FindInstancesDialog.this.myNode=SConceptOperations.createNewNode("jetbrains.mps.quickQueryLanguage.structure.ModelQuery",null);
      SNode statementList=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.StatementList",null);
      SNode expressionStatement=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.ExpressionStatement",null);
      SNode defaultCondition=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.BooleanConstant",null);
      SPropertyOperations.set(defaultCondition,"value","" + true);
      SLinkOperations.setTarget(expressionStatement,"expression",defaultCondition,true);
      ListSequence.fromList(SLinkOperations.getTargets(statementList,"statement",true)).addElement(expressionStatement);
      SLinkOperations.setTarget(SLinkOperations.getTarget(FindInstancesDialog.this.myNode,"condition",true),"body",statementList,true);
      FindInstancesDialog.this.myEditor=new EmbeddableEditor(context,myModelOwner,myNode){
        @Override protected void processClassesData(        IClassesData cd){
          doProcessClassesData(cd);
        }
      }
;
    }
  }
);
  if (module instanceof Language) {
    final Set<Language> languageList=SetSequence.fromSet(new HashSet<Language>());
    ModelAccess.instance().runReadAction(new Runnable(){
      public void run(){
        ((Language)module).getDependenciesManager().collectAllExtendedLanguages(languageList);
      }
    }
);
    for (    Language extendedLanguage : languageList) {
      this.myEditor.addLanguageStructureModel(extendedLanguage);
    }
  }
  this.myPanel.add(this.myEditor.getComponenet(),BorderLayout.CENTER);
  this.myEditor.addLanguageStructureModel(BootstrapLanguages.collectionsLanguage());
  if (module instanceof Language) {
    this.myEditor.addLanguageStructureModel((Language)module);
  }
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      FindInstancesDialog.this.myScope=new ScopeEditor(new ScopeOptions());
      FindInstancesDialog.this.myPanel.add(FindInstancesDialog.this.myScope.getComponent(),BorderLayout.SOUTH);
    }
  }
);
}
