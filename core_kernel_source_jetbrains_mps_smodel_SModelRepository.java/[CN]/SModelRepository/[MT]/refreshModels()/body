{
  ModelAccess.instance().runWriteAction(new Runnable(){
    public void run(){
      LOG.debug("Model refresh");
      for (      IModule m : MPSModuleRepository.getInstance().getAllModules()) {
        (new ModelReloading(((AbstractModule)m))).markOldStubModels();
      }
      for (      SModelDescriptor m : new ArrayList<SModelDescriptor>(myModelDescriptors)) {
        m.refresh();
      }
      for (      SModelDescriptor m : new ArrayList<SModelDescriptor>(myModelDescriptors)) {
        if (!(m instanceof BaseStubModelDescriptor))         continue;
        ((BaseStubModelDescriptor)m).unmarkReload();
      }
      LOG.debug("Model refresh done");
    }
  }
);
}
