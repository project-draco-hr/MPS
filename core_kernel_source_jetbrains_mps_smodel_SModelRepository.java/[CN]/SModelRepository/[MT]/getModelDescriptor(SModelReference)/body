{
  if (modelReference == null)   return null;
  SModelId id=modelReference.getSModelId();
  if (id == null) {
    SModelFqName fqName=modelReference.getSModelFqName();
    if (fqName == null)     return null;
    if (InternalFlag.isInternalMode()) {
      if (!myWasError) {
        myWasError=true;
        LOG.warning("getModelDescriptor() is executed by fqName. This is likely to cause problems. And it is veeery slow.");
      }
    }
    return getModelDescriptor(fqName);
  }
  return myIdToModelDescriptorMap.get(id);
}
