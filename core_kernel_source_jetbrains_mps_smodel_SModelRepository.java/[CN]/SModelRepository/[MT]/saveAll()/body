{
  ModelAccess.assertLegalWrite();
  List<EditableSModelDescriptor> modelsToRefresh;
synchronized (myModelsLock) {
    modelsToRefresh=getModelsToSave();
  }
  for (  EditableSModelDescriptor emd : modelsToRefresh) {
    FileSystem.getInstance().refresh(emd.getModelFile());
  }
synchronized (myModelsLock) {
    for (    EditableSModelDescriptor emd : getModelsToSave()) {
      try {
        emd.save();
        emd.setChanged(false);
      }
 catch (      Throwable t) {
        LOG.error(t);
      }
    }
  }
}
