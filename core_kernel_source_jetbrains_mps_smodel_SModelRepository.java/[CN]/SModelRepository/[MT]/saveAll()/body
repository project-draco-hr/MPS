{
  ModelAccess.assertLegalWrite();
  List<EditableSModelDescriptor> modelsToRefresh;
synchronized (myModelsLock) {
    modelsToRefresh=getModelsToSave();
  }
  FileSystem fs=FileSystem.getInstance();
  for (  EditableSModelDescriptor emd : modelsToRefresh) {
    if (!(emd instanceof BaseSModelDescriptorWithSource))     return;
    ModelDataSource source=((BaseSModelDescriptorWithSource)emd).getSource();
    if (!(source instanceof FileBasedModelDataSource))     continue;
    Collection<String> files=((FileBasedModelDataSource)source).getFilesToListen();
    for (    String file : files) {
      fs.refresh(fs.getFileByPath(file));
    }
  }
synchronized (myModelsLock) {
    for (    EditableSModelDescriptor emd : getModelsToSave()) {
      try {
        emd.save();
      }
 catch (      Throwable t) {
        LOG.error(t);
      }
    }
  }
}
