{
  ModelAccess.assertLegalWrite();
  List<EditableSModel> modelsToRefresh;
synchronized (myModelsLock) {
    modelsToRefresh=getModelsToSave();
  }
  for (  EditableSModel emd : modelsToRefresh) {
    DataSource source=emd.getSource();
    if (!(source instanceof DataSourceBase))     continue;
    ((DataSourceBase)source).refresh();
  }
synchronized (myModelsLock) {
    for (    EditableSModel emd : getModelsToSave()) {
      try {
        emd.save();
      }
 catch (      Throwable t) {
        LOG.error(t);
      }
    }
  }
}
