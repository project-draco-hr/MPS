{
  if (isEditorActivated) {
    TextLine textLine=myEditorWindow.myTextLine;
    int caretPosition=textLine.getCaretPosition();
    String text=textLine.getText();
    String substring=text.substring(0,caretPosition);
    return substring;
  }
  if (myCachedText == null) {
    return null;
  }
  int caretPos=Math.min(myCachedText.length(),Math.max(myCachedCaretPosition,0));
  return myCachedText.substring(0,caretPos);
}
