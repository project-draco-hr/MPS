{
  Module module=e.getData(LangDataKeys.MODULE);
  VirtualFile[] vFiles=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  if (module == null || vFiles == null)   return false;
  MPSFacet mpsFacet=FacetManager.getInstance(module).getFacetByType(MPSFacetType.ID);
  if (mpsFacet == null || !mpsFacet.wasInitialized())   return false;
  Set<ModelRoot> modelRoots=new HashSet<ModelRoot>();
  modelRoots.addAll(mpsFacet.getConfiguration().getState().getModelRoots());
  Map<String,DefaultModelRoot> rootsMap=new HashMap<String,DefaultModelRoot>();
  for (  ModelRoot modelRoot : modelRoots) {
    if (modelRoot instanceof DefaultModelRoot) {
      rootsMap.put(((DefaultModelRoot)modelRoot).getPath(),(DefaultModelRoot)modelRoot);
    }
  }
  for (  VirtualFile vFile : vFiles) {
    if (!vFile.isDirectory())     return false;
    String url=vFile.getUrl();
    if (!LocalFileSystem.PROTOCOL.equals(VirtualFileManager.extractProtocol(url)))     return false;
    String path=VirtualFileManager.extractPath(url);
    if (!rootsMap.containsKey(path))     return false;
  }
  return true;
}
