{
  Module module=e.getData(LangDataKeys.MODULE);
  VirtualFile[] vFiles=e.getData(PlatformDataKeys.VIRTUAL_FILE_ARRAY);
  if (module == null || vFiles == null) {
    return false;
  }
  MPSFacet mpsFacet=FacetManager.getInstance(module).getFacetByType(MPSFacetType.ID);
  if (mpsFacet == null || !mpsFacet.wasInitialized()) {
    return false;
  }
  Set<String> modelRootPaths=new HashSet<String>();
  modelRootPaths.addAll(Arrays.asList(mpsFacet.getConfiguration().getState().getModelRootPaths()));
  for (  VirtualFile vFile : vFiles) {
    if (!vFile.isDirectory()) {
      return false;
    }
    String url=vFile.getUrl();
    if (!LocalFileSystem.PROTOCOL.equals(VirtualFileManager.extractProtocol(url))) {
      return false;
    }
    String path=VirtualFileManager.extractPath(url);
    if (!modelRootPaths.contains(path)) {
      return false;
    }
  }
  return true;
}
