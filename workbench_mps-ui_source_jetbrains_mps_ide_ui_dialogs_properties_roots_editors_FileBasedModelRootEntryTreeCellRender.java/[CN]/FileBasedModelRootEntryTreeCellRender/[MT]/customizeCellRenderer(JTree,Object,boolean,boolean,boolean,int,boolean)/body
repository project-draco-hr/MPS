{
  super.customizeCellRenderer(tree,value,selected,expanded,leaf,row,hasFocus);
  ModelRootEntry entry=myModelRootEditor.getFileBasedModelRootEntry();
  if (entry != null) {
    final Object userObject=((DefaultMutableTreeNode)value).getUserObject();
    if (userObject instanceof NodeDescriptor) {
      final Object element=((NodeDescriptor)userObject).getElement();
      if (element instanceof FileElement) {
        final VirtualFile file=((FileElement)element).getFile();
        if (file != null) {
          final FileBasedModelRoot modelRoot=(FileBasedModelRoot)entry.getModelRoot();
          if (modelRoot != null) {
            if (file.isDirectory()) {
              setIcon(updateIcon(modelRoot,file,getIcon()));
            }
 else             if (file != null && !file.isDirectory()) {
              final Color colorForFile=getColorForFile(modelRoot,file);
              if (colorForFile != null)               setForeground(colorForFile);
            }
          }
        }
      }
    }
  }
}
