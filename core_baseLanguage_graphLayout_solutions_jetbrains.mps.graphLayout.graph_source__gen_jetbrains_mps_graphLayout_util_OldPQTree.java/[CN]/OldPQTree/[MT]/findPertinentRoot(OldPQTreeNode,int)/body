{
  if (node instanceof OldLeaf) {
    if (node.getState() == OldPQTreeNode.State.FULL) {
      MapSequence.fromMap(myNumFullLeaves).put(node,1);
    }
 else {
      MapSequence.fromMap(myNumFullLeaves).put(node,0);
    }
  }
 else {
    int num=0;
    for (    OldPQTreeNode child : ListSequence.fromList(node.getChildren())) {
      OldPQTreeNode pertinentRoot=findPertinentRoot(child,numAllFullLeaves);
      if (pertinentRoot != null) {
        return pertinentRoot;
      }
      num+=MapSequence.fromMap(myNumFullLeaves).get(child);
    }
    MapSequence.fromMap(myNumFullLeaves).put(node,num);
  }
  if (MapSequence.fromMap(myNumFullLeaves).get(node) == numAllFullLeaves) {
    return node;
  }
 else {
    return null;
  }
}
