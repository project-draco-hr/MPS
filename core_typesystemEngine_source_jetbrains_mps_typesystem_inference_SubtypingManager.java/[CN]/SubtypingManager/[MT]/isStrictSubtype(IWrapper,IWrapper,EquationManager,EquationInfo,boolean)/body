{
  IWrapper subRepresentator=subtype;
  IWrapper superRepresentator=supertype;
  if (equationManager != null) {
    subRepresentator=equationManager.getRepresentatorWrapper(subtype);
    superRepresentator=equationManager.getRepresentatorWrapper(supertype);
  }
  if (superRepresentator instanceof NodeWrapper) {
    SNode node=superRepresentator.getNode();
    if (jetbrains.mps.typesystemEngine.util.LatticeUtil.isJoin(node)) {
      for (      SNode argument : jetbrains.mps.typesystemEngine.util.LatticeUtil.getJoinArguments(node)) {
        if (equationManager == null || equationManager.isConcrete(NodeWrapper.createWrapperFromNode(argument,equationManager,true))) {
          if (isSubtypeByReplacementRules(subRepresentator.getNode(),argument,isWeak)) {
            return true;
          }
        }
        if (isSubtype(subRepresentator,NodeWrapper.createWrapperFromNode(argument,equationManager,true),equationManager,errorInfo,isWeak)) {
          return true;
        }
      }
    }
  }
  if (subRepresentator instanceof NodeWrapper) {
    SNode node=subRepresentator.getNode();
    if (jetbrains.mps.typesystemEngine.util.LatticeUtil.isMeet(node)) {
      boolean replacementAllowed=equationManager == null || equationManager.isConcrete(superRepresentator);
      for (      SNode argument : jetbrains.mps.typesystemEngine.util.LatticeUtil.getMeetArguments(node)) {
        if (replacementAllowed) {
          if (isSubtypeByReplacementRules(argument,superRepresentator.getNode(),isWeak)) {
            return true;
          }
        }
        if (isSubtype(NodeWrapper.createWrapperFromNode(argument,equationManager,true),superRepresentator,equationManager,errorInfo,isWeak)) {
          return true;
        }
      }
    }
    if (searchInSupertypes((NodeWrapper)subRepresentator,superRepresentator,equationManager,errorInfo,isWeak))     return true;
  }
  return false;
}
