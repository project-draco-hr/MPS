{
  ThreadUtils.assertEDT();
  myProject=project;
  myFinder=finder;
  myFinder.addResultsListener(this);
  myQuery=query;
  myTool=tool;
  ViewOptions viewOptions=new ViewOptions();
  viewOptions.myCategories[0]=true;
  viewOptions.myShowSearchedNodes=false;
  viewOptions.myGroupSearchedNodes=false;
  viewOptions.mySearchedNodesButtonsVisible=false;
  myUsagesView=new UsagesView(project,viewOptions);
  UsagesView.RerunAction searchAction=new UsagesView.RerunAction(myUsagesView,"Search again");
  searchAction.setRunOptions(provider,query);
  myUsagesView.setActions(searchAction,new UsagesView.RebuildAction(myUsagesView),new AnAction("Close","",AllIcons.Actions.Cancel){
    public void actionPerformed(    @NotNull AnActionEvent p0){
      MigrationScriptsView.this.close();
    }
  }
,PinToolwindowTabAction.getPinAction());
  myUsagesView.setContents(finder.getLastSearchResults());
  myMainPanel=new JPanel(new BorderLayout());
  myMainPanel.add(myUsagesView.getComponent(),BorderLayout.CENTER);
  myControlsPanel=new JPanel(new FlowLayout(FlowLayout.LEFT));
  myApplyButton=new JButton(new AbstractAction("Apply Migrations"){
    @Override public void actionPerformed(    ActionEvent e){
      applyMigrations();
    }
  }
);
  myControlsPanel.add(myApplyButton);
  myStatusPanel=new JPanel(new FlowLayout(FlowLayout.CENTER,5,0));
  myControlsPanel.add(myStatusPanel);
  myMainPanel.add(myControlsPanel,BorderLayout.SOUTH);
  this.myIndicator=new InlineProgressIndicator(true,createTaskInfo());
  this.myController=new MigrationScriptsController(myFinder);
}
