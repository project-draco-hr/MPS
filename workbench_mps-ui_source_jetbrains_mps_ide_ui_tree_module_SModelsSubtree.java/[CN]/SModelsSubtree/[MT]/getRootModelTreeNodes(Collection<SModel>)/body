{
  List<SModelTreeNode> result=new ArrayList<SModelTreeNode>();
  ArrayList<SModel> sortedModels=new ArrayList<SModel>(models);
  Collections.sort(sortedModels,new SModelComparator());
  if (!sortedModels.isEmpty()) {
    int rootIndex=0;
    while (rootIndex < sortedModels.size()) {
      SModel rootModelDescriptor=sortedModels.get(rootIndex);
      int countNamePart=getCountNamePart(rootModelDescriptor,NameUtil.namespaceFromLongName(SModelStereotype.withoutStereotype(rootModelDescriptor.getReference().getModelName())));
      SModelTreeNode treeNode=new SModelTreeNode(rootModelDescriptor,null,countNamePart);
      result.add(treeNode);
      rootIndex=myWithModelsAsNamespace ? buildChildModels(treeNode,sortedModels,rootIndex) : rootIndex + 1;
    }
  }
  return result;
}
