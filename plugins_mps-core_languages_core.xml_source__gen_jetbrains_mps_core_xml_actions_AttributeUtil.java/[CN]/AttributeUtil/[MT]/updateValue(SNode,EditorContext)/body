{
  if (attr == null) {
    return;
  }
  List<SNode> valuesToDelete=new ArrayList<SNode>();
  SNode lastValue=null;
  for (  SNode part : SLinkOperations.getTargets(attr,"value",true)) {
    if (SNodeOperations.isInstanceOf(part,"jetbrains.mps.core.xml.structure.XmlTextValue")) {
      if (StringUtils.isEmpty(SPropertyOperations.getString(SNodeOperations.cast(part,"jetbrains.mps.core.xml.structure.XmlTextValue"),"text"))) {
        ListSequence.fromList(valuesToDelete).addElement(part);
      }
 else       if (lastValue != null) {
        SPropertyOperations.set(lastValue,"text",SPropertyOperations.getString_def(lastValue,"text","") + SPropertyOperations.getString(SNodeOperations.cast(part,"jetbrains.mps.core.xml.structure.XmlTextValue"),"text"));
        ListSequence.fromList(valuesToDelete).addElement(part);
      }
 else {
        lastValue=SNodeOperations.cast(part,"jetbrains.mps.core.xml.structure.XmlTextValue");
      }
    }
 else {
      lastValue=null;
    }
  }
  for (  SNode d : valuesToDelete) {
    SNodeOperations.deleteNode(d);
  }
}
