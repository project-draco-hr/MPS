{
  Set<SNode> usedParameters=this.findUsedParameters();
  SNode statement=SNodeOperations.getAncestor(this.myMethodCall,"jetbrains.mps.baseLanguage.structure.Statement",false,false);
  Map<SNode,SNode> map=MapSequence.<SNode,SNode>fromMap(new HashMap<SNode,SNode>());
  List<SNode> parameters=SLinkOperations.getTargets(this.myMethodDeclaration,"parameter",true);
  for (int i=0; i < ListSequence.<SNode>fromList(this.myArguments).count(); i++) {
    SNode parameterDeclaration=ListSequence.<SNode>fromList(parameters).getElement(i);
    SNode argument=ListSequence.<SNode>fromList(this.myArguments).getElement(i);
    if (SetSequence.<SNode>fromSet(usedParameters).contains(parameterDeclaration)) {
      if (this.canSubstituteParameter(argument,parameterDeclaration)) {
        MapSequence.<SNode,SNode>fromMap(map).put(parameterDeclaration,argument);
      }
 else {
        String name=SPropertyOperations.getString(parameterDeclaration,"name");
        SNode type=SLinkOperations.getTarget(parameterDeclaration,"type",true);
        SNode ref=this.createVariable(statement,name,type,argument);
        MapSequence.<SNode,SNode>fromMap(map).put(parameterDeclaration,ref);
      }
    }
  }
  return map;
}
