{
  final Wrappers._T<Iterable<ModuleReference>> allModuleRefs=new Wrappers._T<Iterable<ModuleReference>>();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      List<IModule> modules=MPSModuleRepository.getInstance().getAllModules();
      allModuleRefs.value=ListSequence.fromList(modules).select(new ISelector<IModule,ModuleReference>(){
        public ModuleReference select(        IModule it){
          return it.getModuleReference();
        }
      }
);
    }
  }
);
  List<ModuleReference> moduleRefs=CommonChoosers.showDialogModuleCollectionChooser(myOwner.getMainComponent(),"module",Sequence.fromIterable(allModuleRefs.value).toListSequence(),null);
  if (moduleRefs == null) {
    return null;
  }
  List<Dependency> result=new ArrayList<Dependency>();
  for (  ModuleReference m : moduleRefs) {
    Dependency dependency=new Dependency();
    dependency.setModuleRef(m);
    result.add(dependency);
  }
  return result;
}
