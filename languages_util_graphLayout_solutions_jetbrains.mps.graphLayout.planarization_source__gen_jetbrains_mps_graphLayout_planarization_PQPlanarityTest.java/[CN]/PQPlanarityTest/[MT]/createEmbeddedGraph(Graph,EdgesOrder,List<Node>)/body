{
  EmbeddedGraph embeddedGraph=new EmbeddedGraph(graph);
  Node last=ListSequence.<Node>fromList(nodeOrder).last();
  Face outerFace=order.findFace(graph,last,ListSequence.<Edge>fromList(order.getInEdgesOrder(last)).first(),false);
  embeddedGraph.addFace(outerFace);
  embeddedGraph.setOuterFace(outerFace);
  for (  Node node : ListSequence.<Node>fromList(nodeOrder).reversedList()) {
    Iterator<Edge> edgeItr=ListSequence.<Edge>fromList(order.getInEdgesOrder(node)).iterator();
    while (edgeItr.hasNext()) {
      Edge edge=edgeItr.next();
      if (edgeItr.hasNext()) {
        embeddedGraph.addFace(order.findFace(graph,node,edge,true));
      }
    }
  }
  return embeddedGraph;
}
