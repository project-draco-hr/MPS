{
  myStPlanarGraph=stPlanarGraph;
  Graph graph=myStPlanarGraph.getGraph();
  myModifiedGraph=splitNodes(graph);
  myModifiedDualGraph=modifyDualGraph(stPlanarGraph);
  Map<Edge,Integer> edgeWeights=MapSequence.fromMap(new HashMap<Edge,Integer>());
  for (  Node node : ListSequence.fromList(graph.getNodes())) {
    MapSequence.fromMap(edgeWeights).put(MapSequence.fromMap(myFakeEdges).get(node),MapSequence.fromMap(nodeConstraints).get(node).height);
  }
  for (  Edge edge : ListSequence.fromList(graph.getEdges())) {
    MapSequence.fromMap(edgeWeights).put(MapSequence.fromMap(myEdgesMap).get(edge),MapSequence.fromMap(edgeConstraints).get(edge).height);
  }
  Map<Edge,Integer> dualEdgeWeights=MapSequence.fromMap(new HashMap<Edge,Integer>());
  for (  Node node : ListSequence.fromList(graph.getNodes())) {
    MapSequence.fromMap(dualEdgeWeights).put(MapSequence.fromMap(myFakeDualEdges).get(node),MapSequence.fromMap(nodeConstraints).get(node).width);
  }
  for (  Edge edge : ListSequence.fromList(myModifiedDualGraph.getEdges())) {
    Edge realEdge=MapSequence.fromMap(myModifiedDualGraph.getEdgesMap()).get(edge);
    Dimension dimension=MapSequence.fromMap(edgeConstraints).get(realEdge);
    if (dimension != null) {
      MapSequence.fromMap(dualEdgeWeights).put(edge,dimension.width);
    }
  }
  myVerNumbering=WeightedTopologicalNumbering.number(myModifiedGraph,edgeWeights);
  myHorNumbering=WeightedTopologicalNumbering.number(myModifiedDualGraph,dualEdgeWeights);
  Map<Object,Rectangle> representation=MapSequence.fromMap(new HashMap<Object,Rectangle>());
  for (  Node node : ListSequence.fromList(graph.getNodes())) {
    MapSequence.fromMap(representation).put(node,getRectangle(node,MapSequence.fromMap(myFakeEdges).get(node)));
  }
  for (  Edge edge : ListSequence.fromList(graph.getEdges())) {
    MapSequence.fromMap(representation).put(edge,getRectangle(edge,MapSequence.fromMap(myEdgesMap).get(edge)));
  }
  return representation;
}
