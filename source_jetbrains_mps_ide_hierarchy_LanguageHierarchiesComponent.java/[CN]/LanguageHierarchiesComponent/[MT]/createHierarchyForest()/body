{
  java.util.List<ConceptContainer> result=new ArrayList<ConceptContainer>();
  Map<ConceptDeclaration,ConceptContainer> processed=new HashMap<ConceptDeclaration,ConceptContainer>();
  SModel structureModel=myLanguage.getStructureModelDescriptor().getSModel();
  outer:   for (  ConceptDeclaration concept : structureModel.getRoots(ConceptDeclaration.class)) {
    ConceptDeclaration parentConcept=concept;
    ConceptContainer prevConceptContainer=null;
    while (parentConcept != null && parentConcept != SModelUtil.getBaseConcept() && !(mySkipAncestors && parentConcept.getModel() != structureModel)) {
      ConceptContainer newConceptContainer=processed.get(parentConcept);
      if (newConceptContainer == null) {
        newConceptContainer=new ConceptContainer(parentConcept,this);
        if (parentConcept.getModel() != structureModel) {
          newConceptContainer.setColor(ColorAndGraphicsUtil.saturateColor(Color.ORANGE,0.5f));
        }
      }
      newConceptContainer.addChild(prevConceptContainer);
      prevConceptContainer=newConceptContainer;
      if (processed.containsKey(parentConcept))       continue outer;
      processed.put(parentConcept,newConceptContainer);
      parentConcept=parentConcept.getExtends();
    }
    result.add(prevConceptContainer);
  }
  return result;
}
