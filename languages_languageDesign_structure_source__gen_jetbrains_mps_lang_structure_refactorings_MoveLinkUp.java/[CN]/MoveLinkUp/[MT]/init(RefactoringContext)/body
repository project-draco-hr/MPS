{
  final Wrappers._T<SNode> concept=new Wrappers._T<SNode>();
  ModelAccess modelAccess=refactoringContext.getRepository().getModelAccess();
  modelAccess.runReadAction(new Runnable(){
    public void run(){
      concept.value=SNodeOperations.getAncestor(refactoringContext.getSelectedNode(),"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration",false,false);
    }
  }
);
  if ((concept.value == null)) {
    return false;
  }
  if (!(((Boolean)refactoringContext.getParameter("mergeLinks")))) {
    refactoringContext.setParameter("linkToReplace",null);
  }
  modelAccess.runReadAction(new Runnable(){
    public void run(){
      refactoringContext.setParameter("linkToReplace",RefUtil.findLinkToMerge(((SNode)refactoringContext.getParameter("targetConcept")),refactoringContext.getSelectedNode()));
    }
  }
);
  return true;
}
