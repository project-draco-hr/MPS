{
  try {
    Language newStructureLanguage=(Language)MPSModuleRepository.getInstance().getModuleByFqName("jetbrains.mps.core.structure");
    Language language=(Language)((IModule)MapSequence.fromMap(_params).get("module"));
    language.addUsedLanguage(newStructureLanguage.getModuleReference());
    SModelFqName newModelName=SModelFqName.fromString(language.getModuleFqName() + ".core");
    SModelDescriptor desc=SModelRepository.getInstance().getModelDescriptor(newModelName);
    final Wrappers._T<SModel> newStructure=new Wrappers._T<SModel>();
    if (desc == null) {
      SModelRoot root=Sequence.fromIterable(((Iterable<SModelRoot>)language.getSModelRoots())).where(new IWhereFilter<SModelRoot>(){
        public boolean accept(        SModelRoot it){
          return it.getManager() instanceof DefaultModelRootManager;
        }
      }
).first();
      newStructure.value=language.createModel(newModelName,root,null).getSModel();
    }
 else {
      newStructure.value=desc.getSModel();
      Sequence.fromIterable(((Iterable<SNode>)newStructure.value.roots())).toListSequence().visitAll(new IVisitor<SNode>(){
        public void visit(        SNode it){
          newStructure.value.removeRoot(it);
        }
      }
);
    }
    newStructure.value.addLanguage(newStructureLanguage.getModuleReference());
    newStructure.value.addRoot(PluginUtils.convertStructure(LanguageAspect.STRUCTURE.get(language).getSModel()));
  }
 catch (  Throwable t) {
    if (log.isErrorEnabled()) {
      log.error("User's action execute method failed. Action:" + "MigrateStructure",t);
    }
  }
}
