{
  Method idMethod=null;
  for (  Method m : actionClass.getMethods()) {
    if (m.getName().equals(GeneratedAction.getIdMethodName())) {
      idMethod=m;
      break;
    }
  }
  String id;
  if (idMethod == null) {
    id=actionClass.getName();
  }
 else {
    try {
      id=languageNamespace + "#" + (String)idMethod.invoke(null,new Object[]{params});
    }
 catch (    IllegalAccessException e) {
      LOG.error("This can't happen",e);
      return null;
    }
catch (    InvocationTargetException e) {
      LOG.error("User's getIdent() method failed",e);
      return null;
    }
  }
  AnAction action=ActionManager.getInstance().getAction(id);
  if (action == null) {
    try {
      AnAction newAction=(AnAction)actionClass.getConstructors()[0].newInstance(params);
      registerAction(newAction,id,languageNamespace);
      return newAction;
    }
 catch (    InstantiationException e) {
      LOG.error("Unable to create action " + actionClass.getSimpleName(),e);
      return null;
    }
catch (    IllegalAccessException e) {
      LOG.error("Unable to create action " + actionClass.getSimpleName(),e);
      return null;
    }
catch (    InvocationTargetException e) {
      LOG.error("Unable to create action " + actionClass.getSimpleName(),e);
      return null;
    }
  }
 else {
    return (AnAction)action;
  }
}
