{
  String classname=refText;
  int dotIndex=classname.lastIndexOf(".");
  if (dotIndex >= 0) {
    List<SNode> localClassifiers=getClassifiersByRefName(model,classname);
    if (ListSequence.fromList(localClassifiers).count() >= 1) {
      return ListSequence.fromList(localClassifiers).first();
    }
    String package_=classname.substring(0,dotIndex);
    classname=classname.substring(dotIndex + 1).replace('$','.');
    return resolveClass(package_,null,classname);
  }
  if (targetModelReference == null) {
    targetModelReference=model.getSModelReference();
  }
  if (targetModelReference.getSModelId() != null) {
    SModelDescriptor targetModel=scope.getModelDescriptor(targetModelReference);
    if (targetModel == null) {
      return null;
    }
    return ListSequence.fromList(getClassifiersByRefName(targetModel.getSModel(),classname)).first();
  }
  SModelFqName modelname=targetModelReference.getSModelFqName();
  return resolveClass(modelname.getLongName(),modelname.getStereotype(),classname);
}
