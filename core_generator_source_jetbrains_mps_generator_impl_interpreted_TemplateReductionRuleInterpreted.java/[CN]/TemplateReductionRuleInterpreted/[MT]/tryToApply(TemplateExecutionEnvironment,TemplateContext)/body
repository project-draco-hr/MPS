{
  if (!checkCondition(baseRuleCondition,false,context.getInput(),environment.getGenerator())) {
    return null;
  }
  SNodeReference ruleNodeId=new jetbrains.mps.smodel.SNodePointer(ruleNode);
  environment.getTracer().pushRule(ruleNodeId);
  try {
    if (environment.getGenerator().isIncremental()) {
      NodeReadEventsCaster.setNodesReadListener(null);
    }
    return apply(context,environment.getEnvironment(context.getInput(),this));
  }
 catch (  AbandonRuleInputException e) {
    return Collections.emptyList();
  }
 finally {
    if (environment.getGenerator().isIncremental()) {
      NodeReadEventsCaster.removeNodesReadListener();
    }
    environment.getTracer().closeRule(ruleNodeId);
  }
}
