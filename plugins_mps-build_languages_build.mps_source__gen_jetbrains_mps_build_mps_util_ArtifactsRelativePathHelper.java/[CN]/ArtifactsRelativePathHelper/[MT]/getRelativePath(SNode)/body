{
  Stack<SNode> names=new Stack<SNode>();
  names.push(node);
  SNode parent=artifacts.parent(node);
  while (parent != null) {
    if (MapSequence.fromMap(prefixes).containsKey(parent)) {
      break;
    }
    names.push(parent);
    parent=artifacts.parent(parent);
  }
  if (parent == null) {
    throw new ArtifactsRelativePathHelper.RelativePathException("no common folder");
  }
  StringBuilder result=new StringBuilder(MapSequence.fromMap(prefixes).get(parent));
  while (!(names.isEmpty())) {
    SNode elem=names.pop();
    boolean lastElement=names.isEmpty();
    if (SNodeOperations.isInstanceOf(elem,MetaAdapterFactory.getConcept(0x798100da4f0a421aL,0xb99171f8c50ce5d2L,0x286d67dde532a284L,"jetbrains.mps.build.structure.BuildLayout_TransparentContainer"))) {
      continue;
    }
    result.append(getNodeName(elem,lastElement));
    if (!(lastElement)) {
      result.append("/");
    }
  }
  return result.toString();
}
