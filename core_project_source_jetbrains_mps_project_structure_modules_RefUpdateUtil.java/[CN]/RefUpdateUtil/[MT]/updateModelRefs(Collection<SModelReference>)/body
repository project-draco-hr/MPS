{
  Set<SModelReference> remove=new HashSet<SModelReference>();
  Set<SModelReference> add=new LinkedHashSet<SModelReference>();
  for (  SModelReference ref : refs) {
    jetbrains.mps.smodel.SModelReference sRef=(jetbrains.mps.smodel.SModelReference)ref;
    jetbrains.mps.smodel.SModelReference newRef=sRef.update();
    if (sRef.differs(newRef)) {
      remove.add(ref);
      add.add(newRef);
    }
  }
  refs.removeAll(remove);
  refs.addAll(add);
  return !remove.isEmpty();
}
