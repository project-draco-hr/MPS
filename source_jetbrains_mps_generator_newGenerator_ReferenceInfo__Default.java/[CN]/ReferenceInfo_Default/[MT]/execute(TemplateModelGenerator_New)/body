{
  SNode referentNode=generator.findOutputNodeByTemplateNodeAndInputNode(myTemplateTargetNode,myInputNode);
  if (referentNode != null) {
    myOutputNode.addReferent(myReferenceRole,referentNode);
    return;
  }
  SNode outputSourceNode=generator.findOutputNodeByTemplateNodeAndInputNode(myTemplateSourceNode,myInputNode);
  if (outputSourceNode == null)   return;
  SNode templateTargetNode=myTemplateSourceNode.getParent();
  SNode outputTargetNode=outputSourceNode.getParent();
  while (templateTargetNode != null && outputTargetNode != null) {
    if (templateTargetNode.equals(myTemplateTargetNode)) {
      myOutputNode.addReferent(myReferenceRole,outputTargetNode);
    }
    templateTargetNode=templateTargetNode.getParent();
    outputTargetNode=outputTargetNode.getParent();
  }
}
