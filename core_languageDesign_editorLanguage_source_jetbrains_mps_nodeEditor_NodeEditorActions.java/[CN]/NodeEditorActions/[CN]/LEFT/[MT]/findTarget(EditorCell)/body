{
  EditorCell_Collection parent=cell.getParent();
  if (parent == null)   return null;
  EditorCell nextToLeft=parent.findNextToLeft(cell);
  if (nextToLeft != null)   return nextToLeft;
  EditorCell_Collection parentCollection=parent.getParent();
  if (parentCollection == null)   return null;
  EditorCell target=parentCollection.getPrevCell(parent);
  while (target != null && !(EditorUtil.isCollection(target) || target.isSelectable())) {
    target=parentCollection.getPrevCell(target);
  }
  while (target == null || !(EditorUtil.isCollection(target) || target.isSelectable())) {
    parent=parentCollection;
    parentCollection=parentCollection.getParent();
    if (parentCollection == null)     return null;
    target=parentCollection.getPrevCell(parent);
    while (target != null && !(EditorUtil.isCollection(target) || target.isSelectable())) {
      target=parentCollection.getPrevCell(target);
    }
  }
  if (!(EditorUtil.isCollection(target)))   return target;
  return EditorUtil.findLastSelectableCell((EditorCell_Collection)target);
}
