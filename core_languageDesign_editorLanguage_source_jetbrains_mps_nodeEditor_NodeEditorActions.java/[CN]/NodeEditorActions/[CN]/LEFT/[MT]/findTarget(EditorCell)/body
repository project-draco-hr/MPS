{
  EditorCell_Collection parent=cell.getParent();
  if (parent == null)   return null;
  EditorCell nextToLeft=parent.findNextToLeft(cell);
  if (nextToLeft != null)   return nextToLeft;
  EditorCell_Collection parentCollection=parent.getParent();
  if (parentCollection == null)   return null;
  EditorCell target=parent.getPrevSibling();
  while (target != null && !(target.isUnfoldedCollection() || target.isSelectable())) {
    target=target.getPrevSibling();
  }
  while (target == null || !(target.isUnfoldedCollection() || target.isSelectable())) {
    parent=parentCollection;
    parentCollection=parentCollection.getParent();
    if (parentCollection == null)     return null;
    target=parent.getPrevSibling();
    while (target != null && !(target.isUnfoldedCollection() || target.isSelectable())) {
      target=target.getPrevSibling();
    }
  }
  if (!(target.isUnfoldedCollection()))   return target;
  return ((EditorCell_Collection)target).findChild(CellFinders.LAST_SELECTABLE_LEAF);
}
