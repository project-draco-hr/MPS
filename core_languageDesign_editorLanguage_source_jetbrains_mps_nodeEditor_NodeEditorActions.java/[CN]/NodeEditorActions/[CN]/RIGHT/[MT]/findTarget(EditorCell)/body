{
  EditorCell_Collection parent=cell.getParent();
  if (parent == null) {
    return (cell.isUnfoldedCollection()) ? ((EditorCell_Collection)cell).findChild(CellFinders.FIRST_SELECTABLE_LEAF) : null;
  }
  EditorCell nextToRight=parent.findNextToRight(cell);
  if (nextToRight != null)   return nextToRight;
  EditorCell_Collection parentCollection=parent.getParent();
  if (parentCollection == null)   return null;
  EditorCell target=parent.getNextSibling();
  while (target != null && !(target.isUnfoldedCollection() || target.isSelectable())) {
    target=target.getNextSibling();
  }
  while (target == null || !(target.isUnfoldedCollection() || target.isSelectable())) {
    parent=parentCollection;
    parentCollection=parentCollection.getParent();
    if (parentCollection == null)     return null;
    target=parent.getNextSibling();
    while (target != null && !(target.isUnfoldedCollection() || target.isSelectable())) {
      target=target.getNextSibling();
    }
  }
  if (!(target.isUnfoldedCollection()))   return target;
  return ((EditorCell_Collection)target).findChild(CellFinders.FIRST_SELECTABLE_LEAF);
}
