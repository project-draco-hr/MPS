{
  EditorCell_Collection parentCell=(cell.isUnfoldedCollection()) ? (EditorCell_Collection)cell : cell.getParent();
  if (parentCell == null)   return null;
  while (!(parentCell.getCellLayout() instanceof CellLayout_Horizontal || parentCell.getCellLayout() instanceof CellLayout_Flow)) {
    EditorCell firstCell=parentCell.firstCell();
    if (firstCell.isUnfoldedCollection())     parentCell=(EditorCell_Collection)firstCell;
  }
  EditorCell_Collection prev_parentCell=parentCell;
  while (parentCell != null && (parentCell.getCellLayout() instanceof CellLayout_Horizontal || parentCell.getCellLayout() instanceof CellLayout_Flow)) {
    prev_parentCell=parentCell;
    parentCell=parentCell.getParent();
  }
  return prev_parentCell;
}
