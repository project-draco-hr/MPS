{
  EditorCell_Collection rootCell=cell.isUnfoldedCollection() ? (EditorCell_Collection)cell : cell.getParent();
  while (rootCell.getParent() != null)   rootCell=rootCell.getParent();
class RightmostCellCondition extends EditorCellCondition {
    private int myY=cell.getBaseline();
    public void checkLeafCell(    EditorCell editorCell){
      if (editorCell.getY() > myY) {
        return;
      }
      if (editorCell.getY() + editorCell.getHeight() < myY) {
        return;
      }
      if (getFoundCell() == null) {
        if (editorCell.isSelectable()) {
          setFoundCell(editorCell);
        }
        return;
      }
      if (editorCell.getX() > getFoundCell().getX() && editorCell.isSelectable()) {
        if (!isLeftmost)         setFoundCell(editorCell);
        return;
      }
      if (editorCell.getX() < getFoundCell().getX() && editorCell.isSelectable()) {
        if (isLeftmost) {
          setFoundCell(editorCell);
        }
      }
    }
  }
  RightmostCellCondition rightmostCellCondition=new RightmostCellCondition();
  rootCell.iterateTreeUntilCondition(rightmostCellCondition);
  return rightmostCellCondition.getFoundCell();
}
