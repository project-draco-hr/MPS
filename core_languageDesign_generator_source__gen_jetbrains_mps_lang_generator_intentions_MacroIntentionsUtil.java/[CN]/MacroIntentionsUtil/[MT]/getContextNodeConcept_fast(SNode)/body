{
  SNode enclosingMacro=findOuterMacro(contextNode);
  if ((enclosingMacro == null)) {
    return QueriesUtil.getApplicableConcept_fromEnvironment(contextNode);
  }
  if (SNodeOperations.isInstanceOf(enclosingMacro,"jetbrains.mps.lang.generator.structure.SourceSubstituteMacro")) {
    return getConceptFrom(SNodeOperations.cast(enclosingMacro,"jetbrains.mps.lang.generator.structure.SourceSubstituteMacro"));
  }
  return null;
}
