{
  SNode query=QueriesUtil.getQueryFunction_fromSourceSubstituteMacro(macro);
  SNode returnType=TypeChecker.getInstance().getTypeOf(query);
  if (SNodeOperations.isInstanceOf(query,"jetbrains.mps.lang.generator.structure.SourceSubstituteMacro_SourceNodeQuery")) {
{
      GeneratedMatchingPattern pattern_3019_m84bxgbllskv=new MacroIntentionsUtil.Pattern_3019_l523emneyyfb();
      SNode coercedNode_3019_m84bxgbllskv=TypeChecker.getInstance().getRuntimeSupport().coerce_(returnType,pattern_3019_m84bxgbllskv);
      if (coercedNode_3019_m84bxgbllskv != null) {
        return ((SNode)pattern_3019_m84bxgbllskv.getFieldValue("PatternVar_concept"));
      }
 else {
        return null;
      }
    }
  }
 else   if (SNodeOperations.isInstanceOf(query,"jetbrains.mps.lang.generator.structure.SourceSubstituteMacro_SourceNodesQuery")) {
{
      GeneratedMatchingPattern pattern_3019_m84bxgbllskh=new MacroIntentionsUtil.Pattern_3019_l523emneyyj8();
      SNode coercedNode_3019_m84bxgbllskh=TypeChecker.getInstance().getRuntimeSupport().coerce_(returnType,pattern_3019_m84bxgbllskh);
      if (coercedNode_3019_m84bxgbllskh != null) {
        return ((SNode)pattern_3019_m84bxgbllskh.getFieldValue("PatternVar_concept"));
      }
 else {
        return null;
      }
    }
  }
 else {
    SNode macroOuterNode=SNodeOperations.getParent(SNodeOperations.getParent(macro));
    return getContextNodeConcept(macroOuterNode);
  }
}
