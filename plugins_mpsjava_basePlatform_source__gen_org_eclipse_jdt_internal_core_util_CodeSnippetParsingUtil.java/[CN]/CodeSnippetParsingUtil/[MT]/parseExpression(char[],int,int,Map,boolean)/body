{
  if (source == null) {
    throw new IllegalArgumentException();
  }
  CompilerOptions compilerOptions=new CompilerOptions(settings);
  final ProblemReporter problemReporter=new ProblemReporter(DefaultErrorHandlingPolicies.proceedWithAllProblems(),compilerOptions,new DefaultProblemFactory(Locale.getDefault()));
  CommentRecorderParser parser=new CommentRecorderParser(problemReporter,false);
  ICompilationUnit sourceUnit=new CompilationUnit(source,"",compilerOptions.defaultEncoding);
  CompilationResult compilationResult=new CompilationResult(sourceUnit,0,0,compilerOptions.maxProblemsPerUnit);
  CompilationUnitDeclaration unit=new CompilationUnitDeclaration(problemReporter,compilationResult,source.length);
  Expression result=parser.parseExpression(source,offset,length,unit,false);
  if (recordParsingInformation) {
    this.recordedParsingInformation=getRecordedParsingInformation(compilationResult,unit.comments);
  }
  return result;
}
