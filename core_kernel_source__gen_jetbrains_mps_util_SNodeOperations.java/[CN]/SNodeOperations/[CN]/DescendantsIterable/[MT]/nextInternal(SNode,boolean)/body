{
  if (curr == null) {
    return null;
  }
  if (!(skipChildren)) {
    Iterator<? extends SNode> iterator=curr.getChildren().iterator();
    if (iterator.hasNext()) {
      return iterator.next();
    }
  }
  if (curr == original) {
    return null;
  }
  SNode parent;
  do {
    parent=curr.getParent();
    jetbrains.mps.smodel.SNode s=((jetbrains.mps.smodel.SNode)curr).nextSibling();
    if (s != null) {
      return s;
    }
    curr=parent;
  }
 while (curr != original);
  return null;
}
