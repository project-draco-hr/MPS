{
  if (anchor != null) {
    parent.insertChildBefore(role,child,((jetbrains.mps.smodel.SNode)anchor).treeNext());
    return;
  }
  Iterable<? extends SNode> childrenWithRole=parent.getChildren(role);
  parent.insertChildBefore(role,child,(childrenWithRole.iterator().hasNext() ? null : childrenWithRole.iterator().next()));
}
