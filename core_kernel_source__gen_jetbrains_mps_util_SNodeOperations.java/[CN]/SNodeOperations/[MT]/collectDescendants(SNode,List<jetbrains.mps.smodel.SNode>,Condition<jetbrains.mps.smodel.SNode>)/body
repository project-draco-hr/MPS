{
  for (  SNode child : Sequence.fromIterable(node.getChildren())) {
    if (condition == null || condition == Condition.TRUE_CONDITION || (child instanceof jetbrains.mps.smodel.SNode && condition.met(((jetbrains.mps.smodel.SNode)child)))) {
      ListSequence.fromList(list).addElement(((jetbrains.mps.smodel.SNode)child));
    }
    collectDescendants(child,list,condition);
  }
}
