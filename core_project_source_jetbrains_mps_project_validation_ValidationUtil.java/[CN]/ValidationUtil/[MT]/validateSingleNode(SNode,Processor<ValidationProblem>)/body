{
  SLanguage lang=node.getConcept().getLanguage();
  if (((SLanguageAdapter)lang).getLanguageDescriptor() == null) {
    LanguageMissingError error=new LanguageMissingError(node,lang,lang.getSourceModule() == null);
    return processor.process(error);
  }
  SConcept concept=node.getConcept();
  if (!concept.isValid()) {
    return processor.process(new ConceptMissingError(node,concept));
  }
  List<SProperty> props=IterableUtil.asList(concept.getProperties());
  for (  SProperty p : node.getProperties()) {
    if (props.contains(p))     continue;
    if (!processor.process(new ConceptFeatureMissingError(node,p,String.format("Missing property: %s",p.getName())))) {
      return false;
    }
  }
  List<SContainmentLink> links=IterableUtil.asList(concept.getContainmentLinks());
  for (  SNode n : node.getChildren()) {
    SContainmentLink l=n.getContainmentLink();
    if (links.contains(l))     continue;
    if (!processor.process(new ConceptFeatureMissingError(node,l,String.format("Missing link: %s",l.getName())))) {
      return false;
    }
  }
  List<SReferenceLink> refs=IterableUtil.asList(concept.getReferenceLinks());
  for (  SReference r : node.getReferences()) {
    SReferenceLink l=r.getLink();
    if (refs.contains(l)) {
      continue;
    }
    if (!processor.process(new ConceptFeatureMissingError(node,l,String.format("Missing reference: %s",l.getName())))) {
      return false;
    }
  }
  for (  SContainmentLink link : concept.getContainmentLinks()) {
    Collection<? extends SNode> children=IterableUtil.asCollection(node.getChildren(link));
    if (!link.isOptional() && children.isEmpty()) {
      if (jetbrains.mps.smodel.SNodeUtil.link_ConstructorDeclaration_returnType.equals(link))       continue;
      if (SModelStereotype.isGeneratorModel(node.getModel())) {
        continue;
      }
      if (!processor.process(new ConceptFeatureCardinalityError(node,link,String.format("No child in obligatory role %s",link.getName())))) {
        return false;
      }
    }
    if (!link.isMultiple() && children.size() > 1) {
      if (SModelStereotype.isGeneratorModel(node.getModel())) {
        continue;
      }
      if (!processor.process(new ConceptFeatureCardinalityError(node,link,String.format("Only one child is allowed in role %s",link.getName())))) {
        return false;
      }
    }
  }
  for (  SReferenceLink ref : concept.getReferenceLinks()) {
    if (!ref.isOptional()) {
      if (node.getReference(ref) == null) {
        if (SModelStereotype.isGeneratorModel(node.getModel())) {
          continue;
        }
        if (!processor.process(new ConceptFeatureCardinalityError(node,ref,String.format("No reference in obligatory role %s",ref.getName())))) {
          return false;
        }
      }
    }
  }
  return true;
}
