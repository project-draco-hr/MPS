{
  final SModelDescriptor descriptor=super.getSModelDescriptor(indicator);
  final Language custommpsLanguage=MPSModuleRepository.getInstance().getLanguage("jetbrains.mps.build.custommps");
  ModelAccess.instance().runWriteAction(new Runnable(){
    public void run(){
      ModuleReference moduleReference=custommpsLanguage.getModuleReference();
      descriptor.getModule().addUsedLangauge(moduleReference);
    }
  }
);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      ModelAccess.instance().runWriteActionInCommand(new Runnable(){
        public void run(){
          ModuleReference moduleReference=custommpsLanguage.getModuleReference();
          descriptor.getSModel().addLanguage(moduleReference);
        }
      }
);
    }
  }
);
  return descriptor;
}
