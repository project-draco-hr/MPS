{
  Environment currentEnv=EnvironmentContainer.get();
  if (currentEnv != null)   currentEnv.dispose();
  Environment environment=new MpsEnvironment(EnvironmentConfig.emptyEnvironment());
  try {
    LOG.info("ADDING CORE CONTRIBUTORS");
    addContributorWithPaths(getCorePaths());
    checkDeps();
    LOG.info("ADDING WORKBENCH CONTRIBUTORS");
    addContributorWithPaths(Collections.singletonList(PathManager.getWorkbenchPath()));
    checkDeps();
    LOG.info("ADDING PLUGINS CONTRIBUTORS");
    addContributorWithPaths(Collections.singletonList(PathManager.getHomePath() + File.separator + "plugins"));
    checkDeps();
  }
  finally {
    environment.dispose();
  }
  Assert.assertFalse("Some dependencies are invalid",myFailed);
}
