{
  EnvironmentConfig config=EnvironmentConfig.emptyEnvironment();
  Environment currentEnv=ActiveEnvironment.getInstance();
  if (currentEnv != null)   currentEnv.dispose();
  MpsEnvironment environment=new MpsEnvironment(config);
  try {
    LOG.info("ADDING CORE CONTRIBUTORS");
    addContributorWithPaths(getCorePaths());
    checkDeps();
    LOG.info("ADDING WORKBENCH CONTRIBUTORS");
    addContributorWithPaths(Collections.singletonList(PathManager.getWorkbenchPath()));
    checkDeps();
    LOG.info("ADDING PLUGINS CONTRIBUTORS");
    addContributorWithPaths(Collections.singletonList(PathManager.getHomePath() + File.separator + "plugins"));
    checkDeps();
  }
  finally {
    environment.dispose();
  }
  Assert.assertFalse("Some dependencies are invalid",myFailed);
}
