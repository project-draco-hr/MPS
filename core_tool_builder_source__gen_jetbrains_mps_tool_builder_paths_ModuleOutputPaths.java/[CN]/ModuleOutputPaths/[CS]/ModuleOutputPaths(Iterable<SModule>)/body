{
  this.sortedOutDirs=DirUtil.sortDirs(Sequence.fromIterable(modules).where(new IWhereFilter<SModule>(){
    public boolean accept(    SModule it){
      return it instanceof AbstractModule && ((AbstractModule)it).getOutputPath() != null;
    }
  }
).select(new ISelector<SModule,String>(){
    public String select(    SModule it){
      return ((AbstractModule)it).getOutputPath().getPath();
    }
  }
));
  this.sortedOutCacheDirs=DirUtil.sortDirs(Sequence.fromIterable(Sequence.fromArray(this.sortedOutDirs)).select(new ISelector<String,String>(){
    public String select(    String outDir){
      return FileGenerationUtil.getCachesPath(outDir);
    }
  }
));
  this.sortedTestOutDirs=DirUtil.sortDirs(Sequence.fromIterable(modules).where(new IWhereFilter<SModule>(){
    public boolean accept(    SModule it){
      return it.getFacet(TestsFacet.class) != null;
    }
  }
).select(new ISelector<SModule,String>(){
    public String select(    SModule it){
      IFile dir=it.getFacet(TestsFacet.class).getTestsOutputPath();
      return (dir != null ? dir.getPath() : null);
    }
  }
));
  this.sortedTestOutCacheDirs=DirUtil.sortDirs(Sequence.fromIterable(Sequence.fromArray(this.sortedTestOutDirs)).select(new ISelector<String,String>(){
    public String select(    String outDir){
      return FileGenerationUtil.getCachesPath(outDir);
    }
  }
));
  Iterable<String> modelRootPaths=Sequence.fromIterable(modules).translate(new ITranslator2<SModule,ModelRoot>(){
    public Iterable<ModelRoot> translate(    SModule mod){
      return mod.getModelRoots();
    }
  }
).where(new IWhereFilter<ModelRoot>(){
    public boolean accept(    ModelRoot it){
      return it instanceof FolderModelRootBase;
    }
  }
).select(new ISelector<ModelRoot,String>(){
    public String select(    ModelRoot smr){
      return ((FolderModelRootBase)smr).getPath();
    }
  }
);
  modelRootPaths=Sequence.fromIterable(modelRootPaths).concat(Sequence.fromIterable(modules).translate(new ITranslator2<SModule,ModelRoot>(){
    public Iterable<ModelRoot> translate(    SModule mod){
      return mod.getModelRoots();
    }
  }
).where(new IWhereFilter<ModelRoot>(){
    public boolean accept(    ModelRoot it){
      return it instanceof FileBasedModelRoot;
    }
  }
).select(new ISelector<ModelRoot,String>(){
    public String select(    ModelRoot smr){
      return ((FileBasedModelRoot)smr).getContentRoot();
    }
  }
));
  this.sortedModelDirs=DirUtil.sortDirs(Sequence.fromIterable(modelRootPaths).select(new ISelector<String,IFile>(){
    public IFile select(    String path){
      return FileSystem.getInstance().getFileByPath(path);
    }
  }
).where(new IWhereFilter<IFile>(){
    public boolean accept(    IFile f){
      return f.isDirectory() && !(f instanceof JarEntryFile);
    }
  }
).select(new ISelector<IFile,String>(){
    public String select(    IFile dir){
      return dir.getPath();
    }
  }
));
}
