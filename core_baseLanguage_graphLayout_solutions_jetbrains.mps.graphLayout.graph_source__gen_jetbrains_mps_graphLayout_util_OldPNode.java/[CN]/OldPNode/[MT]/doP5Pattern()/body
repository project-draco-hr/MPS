{
  OldPQTreeNode newFullNode=new OldPNode();
  newFullNode.setState(OldPQTreeNode.State.FULL);
  OldPQTreeNode newEmptyNode=new OldPNode();
  newEmptyNode.setState(OldPQTreeNode.State.EMPTY);
  OldQNode partialNode=null;
  Iterator<OldPQTreeNode> nodeItr=ListSequence.fromList(getChildren()).iterator();
  while (nodeItr.hasNext()) {
    OldPQTreeNode node=nodeItr.next();
    if (node.getState() == OldPQTreeNode.State.FULL) {
      nodeItr.remove();
      newFullNode.addLastChild(node);
    }
    if (node.getState() == OldPQTreeNode.State.EMPTY) {
      nodeItr.remove();
      newEmptyNode.addLastChild(node);
    }
    if (node.getState() == OldPQTreeNode.State.PARTIAL) {
      partialNode=(OldQNode)node;
    }
  }
  newFullNode=newFullNode.adjust();
  newEmptyNode=newEmptyNode.adjust();
  if (ListSequence.fromList(partialNode.getChildren()).first().getState() == OldPQTreeNode.State.FULL) {
    partialNode.addFirstChild(newFullNode);
    partialNode.addLastChild(newEmptyNode);
  }
 else {
    partialNode.addLastChild(newFullNode);
    partialNode.addFirstChild(newEmptyNode);
  }
  return partialNode;
}
