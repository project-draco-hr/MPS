{
  MapSequence.fromMap(myDfsState).put(node,DURING);
  preprocess(node,from);
  for (  Edge edge : ListSequence.fromList(node.getEdges(myDirection)).where(myEdgeFilter)) {
    if (edge != from) {
      processEdge(edge,node);
      Node target=edge.getOpposite(node);
      if (MapSequence.fromMap(myDfsState).get(target) == BEFORE) {
        dfs(target,edge);
      }
    }
  }
  postprocess(node,from);
  MapSequence.fromMap(myDfsState).put(node,AFTER);
}
