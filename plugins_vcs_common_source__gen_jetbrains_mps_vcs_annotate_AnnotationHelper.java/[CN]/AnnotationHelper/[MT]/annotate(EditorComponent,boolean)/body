{
  if (SetSequence.fromSet(ourProgress).contains(editorComponent)) {
    return false;
  }
  final LeftEditorHighlighter leftEditorHighlighter=editorComponent.getLeftEditorHighlighter();
  if (findAnnotationColumn(editorComponent) != null) {
    if (!(dryRun)) {
      leftEditorHighlighter.removeLeftColumn(findAnnotationColumn(editorComponent));
    }
    return true;
  }
  final SNode root=editorComponent.getEditedNode();
  SModel model=check_19hp0u_a0g0d(root);
  DataSource source=model.getSource();
  IFile iFile;
  if (source instanceof FileDataSource) {
    iFile=((FileDataSource)source).getFile();
  }
 else   if (source instanceof FilePerRootDataSource) {
    iFile=((FilePerRootDataSource)source).getFile(root.getName() + "." + FilePerRootDataSource.ROOT_EXTENSION);
  }
 else {
    return false;
  }
  final VirtualFile file=VirtualFileUtils.getVirtualFile(iFile);
  final Project project=editorComponent.getOperationContext().getProject();
  final com.intellij.openapi.project.Project ideaProject=ProjectHelper.toIdeaProject(project);
  final AbstractVcs vcs=ProjectLevelVcsManager.getInstance(ideaProject).getVcsFor(file);
  if (vcs == null || project == null) {
    return false;
  }
  _FunctionTypes._return_P1_E0<? extends Boolean,? super FileStatus> checkFileStatus=new _FunctionTypes._return_P1_E0<Boolean,FileStatus>(){
    public Boolean invoke(    FileStatus fs){
      return fs == FileStatus.UNKNOWN || fs == FileStatus.ADDED || fs == FileStatus.IGNORED;
    }
  }
;
  if (checkFileStatus.invoke(FileStatusManager.getInstance(ideaProject).getStatus(file))) {
    return false;
  }
  final AnnotationProvider annotationProvider=vcs.getAnnotationProvider();
  if (annotationProvider == null) {
    return false;
  }
  if (dryRun) {
    return true;
  }
  Task.Backgroundable annotateTask=new Task.Backgroundable(ideaProject,"Retrieving annotations",true,BackgroundFromStartOption.getInstance()){
    private FileAnnotation myFileAnnotation;
    private VcsException myException;
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        myFileAnnotation=annotationProvider.annotate(file);
      }
 catch (      VcsException e) {
        myException=e;
      }
    }
    @Override public void onCancel(){
      onSuccess();
    }
    @Override public void onSuccess(){
      SetSequence.fromSet(ourProgress).removeElement(editorComponent);
      if (myException != null) {
        AbstractVcsHelper.getInstance(ideaProject).showErrors(Arrays.asList(myException),"Exception on retrieving annotation");
      }
      if (myFileAnnotation != null) {
        project.getRepository().getModelAccess().runReadAction(new Runnable(){
          public void run(){
            AnnotationColumn annotationColumn=new AnnotationColumn(leftEditorHighlighter,root,myFileAnnotation,vcs,file);
            leftEditorHighlighter.addLeftColumn(annotationColumn);
          }
        }
);
      }
    }
  }
;
  SetSequence.fromSet(ourProgress).addElement(editorComponent);
  try {
    ProgressManager.getInstance().run(annotateTask);
  }
 catch (  Throwable t) {
    SetSequence.fromSet(ourProgress).removeElement(editorComponent);
  }
  return true;
}
