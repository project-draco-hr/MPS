{
  Set<String> keys=new HashSet<String>();
  keys.addAll(expected.keySet());
  keys.addAll(actual.keySet());
  StringBuilder errors=new StringBuilder();
  for (  String name : keys) {
    String content=actual.get(name);
    if (content == null) {
      errors.append("File is not generated: " + name + "\n");
      continue;
    }
    String existing=expected.get(name);
    if (existing == null) {
      errors.append("Non-existing file generated: " + name + "\n");
      continue;
    }
    if (!existing.equals(content)) {
      TextDiffBuilder tbuilder=new TextDiffBuilder(existing.split("\n|\r\n"),content.split("\n|\r\n"));
      tbuilder.compare();
      if (tbuilder.hasDifference()) {
        for (        String s : tbuilder.getResult()) {
          errors.append(s).append('\n');
        }
      }
    }
  }
  return errors.toString();
}
