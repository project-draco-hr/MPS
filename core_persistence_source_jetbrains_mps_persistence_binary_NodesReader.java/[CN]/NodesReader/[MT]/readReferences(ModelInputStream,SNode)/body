{
  int references=is.readInt();
  for (; references > 0; references--) {
    int kind=is.readInt();
    SNodeId targetNodeId=kind == 1 ? readTargetNodeId(is) : null;
    DynamicReferenceOrigin origin=kind == 3 ? new DynamicReferenceOrigin(is.readNodePointer(),is.readNodePointer()) : null;
    SReferenceLinkId role=SReferenceLinkId.deserialize(is.readString());
    String roleName=is.readString();
    SModelReference modelRef=is.readByte() == 18 ? is.readModelReference() : myModelReference;
    String resolveInfo=is.readString();
    SReferenceLink sref=MetaAdapterFactory.getReferenceLink(role,roleName);
    if (kind == 1) {
      SReference reference=new StaticReference(sref,node,modelRef,targetNodeId,resolveInfo);
      node.setReference(reference.getLink(),reference);
    }
 else     if (kind == 2 || kind == 3) {
      DynamicReference reference=new DynamicReference(sref,node,modelRef,resolveInfo);
      if (origin != null) {
        reference.setOrigin(origin);
      }
      node.setReference(reference.getLink(),reference);
    }
 else {
      throw new IOException("unknown reference type");
    }
  }
}
