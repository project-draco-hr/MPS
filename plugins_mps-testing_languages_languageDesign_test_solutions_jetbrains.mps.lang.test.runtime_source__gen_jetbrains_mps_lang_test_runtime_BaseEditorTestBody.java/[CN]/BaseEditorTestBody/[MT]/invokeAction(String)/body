{
  UndoHelper undoHelper=new UndoHelper(myProject,getEditorComponent());
  undoHelper.runUndoableInEDTAndWait(new Runnable(){
    public void run(){
      AnAction action=ActionManager.getInstance().getAction(actionId);
      AnActionEvent event=ActionUtils.createEvent(ActionPlaces.MAIN_MENU,DATA_MANAGER.getDataContext(getEditorComponent()));
      action.actionPerformed(event);
    }
  }
);
  flushEventQueueAfterAction();
}
