{
  UndoHelper undoHelper=new UndoHelper(myProject,getEditorComponent());
  final AnAction action=ActionManager.getInstance().getAction(actionId);
  final AnActionEvent event=ActionUtils.createEvent(ActionPlaces.MAIN_MENU,DATA_MANAGER.getDataContext(getEditorComponent()));
  undoHelper.runUndoableInEDTAndWait(new Runnable(){
    public void run(){
      myEditor.getCurrentEditorComponent().rebuildEditorContent();
      action.actionPerformed(event);
    }
  }
);
  flushEventQueueAfterAction();
}
