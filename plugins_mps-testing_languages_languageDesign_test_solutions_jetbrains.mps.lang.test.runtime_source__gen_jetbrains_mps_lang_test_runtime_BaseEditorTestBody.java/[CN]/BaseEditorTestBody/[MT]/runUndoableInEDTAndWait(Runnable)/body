{
  UndoManagerImpl undoManager=(UndoManagerImpl)UndoManager.getInstance(ProjectHelper.toIdeaProject(myProject));
  CurrentEditorProvider oldEditorProvider=undoManager.getEditorProvider();
  undoManager.setEditorProvider(new CurrentEditorProvider(){
    public FileEditor getCurrentEditor(){
      return myFileNodeEditor;
    }
  }
);
  Exception exception=ThreadUtils.runInUIThreadAndWait(runnable);
  if (exception != null) {
    throw new RuntimeException("Failure during editor test execution",exception);
  }
  flushEDTEvents();
  flushEDTEvents();
  undoManager.setEditorProvider(oldEditorProvider);
}
