{
  ProjectBuilderLogger logger=myContext.getLoggingManager().getProjectBuilderLogger();
  if (logger.isEnabled()) {
    try {
      logger.logCompiledPaths(makeFacetConfiguration.getWrittenFiles(),MPSMakeConstants.BUILDER_ID,"Written files:");
    }
 catch (    IOException ignore) {
    }
  }
  for (  String writtenFile : makeFacetConfiguration.getWrittenFiles()) {
    myContext.processMessage(new FileGeneratedEvent());
    try {
      SModel source=makeFacetConfiguration.getSource(writtenFile);
      ModuleBuildTarget target=myToMake.get(source);
      File file=new File(writtenFile);
      if (source != null && source.getSource() instanceof FileDataSource) {
        myOutputConsumer.registerOutputFile(target,file,Collections.singletonList((source.getSource()).getLocation()));
      }
      if (!JavaBuilder.JAVA_SOURCES_FILTER.accept(file) && !myRedirects.isInCacheOutput(writtenFile)) {
        try {
          copyResource(target,file);
        }
 catch (        IOException e) {
          myContext.processMessage(new CompilerMessage("MPS resources",Kind.ERROR,e.getMessage(),FileUtil.toSystemIndependentName(file.getParent())));
          success=false;
        }
      }
      myRefreshComponent.refresh(writtenFile);
    }
 catch (    IOException e) {
      reportError(e);
      success=false;
    }
  }
  for (  String keptFile : makeFacetConfiguration.getKeptFiles()) {
    try {
      FSOperations.markDirty(myContext,new File(keptFile));
    }
 catch (    IOException e) {
      reportError(e);
      success=false;
    }
    SModel source=makeFacetConfiguration.getSource(keptFile);
    if (source != null && source.getSource() instanceof FileDataSource) {
      try {
        myOutputConsumer.registerOutputFile(myToMake.get(source),new File(keptFile),Collections.singletonList((source.getSource()).getLocation()));
      }
 catch (      IOException e) {
        reportError(e);
        success=false;
      }
    }
  }
  if (logger.isEnabled()) {
    logger.logDeletedFiles(makeFacetConfiguration.getDeletedFiles());
  }
  for (  String deletedFile : makeFacetConfiguration.getDeletedFiles()) {
    try {
      FSOperations.markDeleted(myContext,new File(deletedFile));
    }
 catch (    IOException e) {
      reportError(e);
      success=false;
    }
  }
  myRefreshComponent.removed(makeFacetConfiguration.getDeletedFiles());
  return success;
}
