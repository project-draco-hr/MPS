{
  if (type instanceof ClassifierType) {
    StringBuilder sb=new StringBuilder();
    ClassifierType classifierType=(ClassifierType)type;
    Classifier classifier=classifierType.getClassifier();
    sb.append(classifier.getModel().getLongName()).append('.').append(classifier.getName());
    List<Type> typeParameters=classifierType.getParameters();
    if (typeParameters != null && !typeParameters.isEmpty()) {
      sb.append('<');
      appendTypesList(sb,typeParameters);
      sb.append('>');
    }
    return sb.toString();
  }
  if (type instanceof ArrayType) {
    return mpsTypeAsString(((ArrayType)type).getComponentType()) + "[]";
  }
  if (type instanceof VariableArityType) {
    return mpsTypeAsString(((VariableArityType)type).getComponentType()) + "...";
  }
  if (type instanceof PrimitiveType) {
    return SModelUtil_new.getAlias(type.getNode().getConceptDeclarationAdapter());
  }
  if (type instanceof TypeVariableReference) {
    return ((TypeVariableReference)type).getTypeVariableDeclaration().getName();
  }
  if (type instanceof UpperBoundType) {
    return "? extends " + mpsTypeAsString(((UpperBoundType)type).getBound());
  }
  if (type instanceof LowerBoundType) {
    return "? super " + mpsTypeAsString(((LowerBoundType)type).getBound());
  }
  if (type instanceof WildCardType) {
    return "?";
  }
  return null;
}
