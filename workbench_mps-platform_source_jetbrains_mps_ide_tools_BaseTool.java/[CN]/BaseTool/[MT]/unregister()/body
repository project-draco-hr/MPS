{
  if (!isRegistered()) {
    return;
  }
  ThreadUtils.assertEDT();
  doUnregister();
  final List<Project> openedProjects=Arrays.asList(ProjectManager.getInstance().getOpenProjects());
  if (myShortcutsByKeymap != null && (openedProjects.contains(getProject()) || openedProjects.isEmpty())) {
    for (    Entry<String,KeyStroke> keymapItem : myShortcutsByKeymap.entrySet()) {
      Keymap keymap=KeymapManager.getInstance().getKeymap(keymapItem.getKey());
      if (keymap != null) {
        keymap.removeAllActionShortcuts(ActivateToolWindowAction.getActionIdForToolWindow(myId));
      }
    }
  }
  ToolWindow toolWindow=getToolWindow();
  if (toolWindow != null) {
    ContentManager contentManager=toolWindow.getContentManager();
    if (contentManager != null && !contentManager.isDisposed()) {
      contentManager.removeAllContents(true);
    }
  }
  myWindowManager.unregisterToolWindow(myId);
  myIsRegistered=false;
}
