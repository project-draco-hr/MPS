{
  final List<ITestNodeWrapper>[] stuffToTest=new List[1];
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    public void run(){
      stuffToTest[0]=DefaultJUnit_Configuration.this.collectWhatToTestUnderProgress(project.getComponent(MPSProject.class));
    }
  }
,ModalityState.NON_MODAL);
  return RunUtil.makeBeforeRun(project,ListSequence.fromList(stuffToTest[0]).<SNode>select(new ISelector<ITestNodeWrapper,SNode>(){
    public SNode select(    ITestNodeWrapper it){
      return it.getNode();
    }
  }
).toListSequence());
}
