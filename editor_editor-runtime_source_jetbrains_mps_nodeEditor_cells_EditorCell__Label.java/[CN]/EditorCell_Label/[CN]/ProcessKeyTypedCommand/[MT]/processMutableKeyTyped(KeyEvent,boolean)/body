{
  String newText=getTextOnEvent(keyEvent);
  if (!allowErrors && !isValidText(newText)) {
    return false;
  }
  int startSelection=myTextLine.getStartTextSelectionPosition();
  changeText(newText);
  setCaretPositionIfPossible(startSelection + 1);
  myTextLine.resetSelection();
  fireSelectionChanged();
  ensureCaretVisible();
  return true;
}
