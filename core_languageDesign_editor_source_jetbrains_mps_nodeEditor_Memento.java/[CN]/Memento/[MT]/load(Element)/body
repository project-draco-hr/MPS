{
  Memento memento=new Memento();
  Element selectedCell=e.getChild(SELECTED_CELL);
  if (selectedCell != null) {
    memento.mySelectedCellInfo=DefaultCellInfo.loadFrom(selectedCell);
  }
  Element selectionStack=e.getChild(SELECTION_STACK);
  if (selectionStack != null) {
    List children=selectionStack.getChildren(STACK_ELEMENT);
    for (    Object o : children) {
      memento.mySelectionStack.push(new SelectionInfo((Element)o));
    }
  }
  Element folded=e.getChild(FOLDED);
  if (folded != null) {
    List children=folded.getChildren(FOLDED_ELEMENT);
    for (    Object o : children) {
      memento.myFolded.add(DefaultCellInfo.loadFrom((Element)o));
    }
  }
  Element textLine=e.getChild(TEXT_LINE);
  if (textLine != null) {
    try {
      memento.myCaretX=Integer.parseInt(textLine.getAttributeValue(CARET_POSITION));
      memento.mySelectionStart=Integer.parseInt(textLine.getAttributeValue(SEL_START));
      memento.mySelectionEnd=Integer.parseInt(textLine.getAttributeValue(SEL_END));
    }
 catch (    NumberFormatException ex) {
      memento.myCaretX=0;
      memento.mySelectionStart=0;
      memento.mySelectionEnd=0;
    }
  }
  return memento;
}
