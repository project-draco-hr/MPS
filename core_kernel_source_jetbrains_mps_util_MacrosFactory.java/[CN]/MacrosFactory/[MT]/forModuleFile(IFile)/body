{
  String name=moduleFile.getPath().toLowerCase();
  Macros macros;
  if (name.endsWith(MPSExtentions.DOT_SOLUTION) || name.endsWith(MPSExtentions.DOT_IDEMODULE)) {
    macros=new DescriptorMacros(SOLUTION_DESCRIPTOR);
  }
 else   if (name.endsWith(MPSExtentions.DOT_DEVKIT)) {
    macros=new DescriptorMacros(DEVKIT_DESCRIPTOR);
  }
 else   if (name.endsWith(MPSExtentions.DOT_LANGUAGE)) {
    macros=new DescriptorMacros(LANGUAGE_DESCRIPTOR);
  }
 else   if (name.endsWith(MPSExtentions.PACKAGED_MODULE)) {
    macros=new PackagedDescriptorMacros();
  }
 else {
    return null;
  }
  return new MacroHelperImpl(moduleFile,macros);
}
