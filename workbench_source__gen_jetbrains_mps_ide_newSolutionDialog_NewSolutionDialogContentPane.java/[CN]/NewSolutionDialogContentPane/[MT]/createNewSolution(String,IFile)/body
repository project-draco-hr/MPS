{
  File dir=solutionDescriptorFile.toFile().getParentFile();
  if (!(dir.exists())) {
    dir.mkdirs();
  }
  SolutionDescriptor solutionDescriptor=new SolutionDescriptor();
  solutionDescriptor.setExternallyVisible(true);
  solutionDescriptor.setCompileInMPS(myThis.getCompileInMPS());
  String fileName=solutionDescriptorFile.getName();
  solutionDescriptor.setNamespace(fileName.substring(0,fileName.length() - 4));
  ModelRoot modelRoot=new ModelRoot();
  modelRoot.setPrefix("");
  modelRoot.setPath(solutionDescriptorFile.getParent().getAbsolutePath());
  solutionDescriptor.getModelRoots().add(modelRoot);
  SolutionDescriptorPersistence.saveSolutionDescriptor(solutionDescriptorFile,solutionDescriptor);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      ApplicationLevelVcsManager.instance().addFileToVcs(VFileSystem.refreshAndGetFile(solutionDescriptorFile),false);
    }
  }
,ModalityState.NON_MODAL);
  return myThis.getProject().addProjectSolution(solutionDescriptorFile.toFile());
}
