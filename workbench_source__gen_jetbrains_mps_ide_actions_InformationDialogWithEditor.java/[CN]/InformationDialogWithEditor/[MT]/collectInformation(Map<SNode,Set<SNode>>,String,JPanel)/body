{
  if (rootToChilds.isEmpty()) {
    return;
  }
  setCaption(panel,caption);
  final MPSTree tree=new MPSTree(){
    protected MPSTreeNode rebuild(){
      TextTreeNode rootTreeNode=new TextTreeNode("");
      rootTreeNode.setIcon(new EmptyIcon(10));
      for (      final SNode root : rootToChilds.keySet()) {
        SNodeTreeNode nodeTreeNode=new SNodeTreeNode(root,null,InformationDialogWithEditor.this.getOperationContext(),new Condition<SNode>(){
          public boolean met(          SNode candidate){
            return rootToChilds.get(root).contains(candidate);
          }
        }
);
        rootTreeNode.add(nodeTreeNode);
      }
      return rootTreeNode;
    }
  }
;
  tree.addTreeSelectionListener(new TreeSelectionListener(){
    public void valueChanged(    TreeSelectionEvent event){
      if (event.getNewLeadSelectionPath() == null) {
        return;
      }
      TreePath path=tree.getSelectionModel().getSelectionPath();
      if (path == null) {
        return;
      }
      Object nodeTreeNode=path.getLastPathComponent();
      if (!(nodeTreeNode instanceof SNodeTreeNode)) {
        return;
      }
      final SNode node=((SNodeTreeNode)nodeTreeNode).getSNode();
      ModelAccess.instance().runWriteActionInCommand(new Runnable(){
        public void run(){
          SNode root=node.getContainingRoot();
          SNode copiedRoot=SNodeOperations.copyNode(root);
          myEditor.setNode(copiedRoot);
          setEditorNode(root);
          highlightChanges(getCopiedNodes(rootToChilds.get(root),root,copiedRoot));
          if (node != root) {
            myEditor.selectNode(getCopiedNode(node,root,copiedRoot));
          }
        }
      }
);
      if (myMainPanel != null) {
        myMainPanel.updateUI();
      }
    }
  }
);
  tree.rebuildLater();
  panel.add(tree,BorderLayout.CENTER);
}
