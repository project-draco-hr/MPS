{
  Document doc=JDOMUtil.loadDocument(genSourcesIml);
  Element rootManager=Utils.getComponentWithName(doc,MODULE_ROOT_MANAGER);
  Set<String> contentRootUrls=new HashSet<String>();
  for (  File dir : sourceDirs) {
    contentRootUrls.add(PATH_START_MODULE + dir);
    Element contentRoot=Utils.getChildByAttribute(rootManager,CONTENT,URL,PATH_START_MODULE + dir);
    if (contentRoot == null) {
      contentRoot=new Element(CONTENT);
      contentRoot.setAttribute(URL,PATH_START_MODULE + dir);
      rootManager.addContent(contentRoot);
    }
    contentRoot.removeContent();
    List<String> sourceGenFolders=new ArrayList<String>();
    List<String> classesGenFolders=new ArrayList<String>();
    for (    File module : Utils.collectGeneratedInMPSModules(dir)) {
      sourceGenFolders.add(PATH_START_MODULE + Utils.getRelativeProjectPath(module) + "/"+ SOURCE_GEN_FOLDER);
      classesGenFolders.add(PATH_START_MODULE + Utils.getRelativeProjectPath(module) + "/"+ CLASSES_GEN_FOLDER);
    }
    Collections.sort(sourceGenFolders);
    Collections.sort(classesGenFolders);
    for (    String sourceGenFolder : sourceGenFolders) {
      Element sourceFolder=new Element(SOURCE_FOLDER);
      sourceFolder.setAttribute(URL,sourceGenFolder);
      sourceFolder.setAttribute("isTestSource","false");
      contentRoot.addContent(sourceFolder);
    }
    for (    String classesGenFolder : classesGenFolders) {
      Element excludeFolder=new Element(EXCLUDE_FOLDER);
      excludeFolder.setAttribute(URL,classesGenFolder);
      contentRoot.addContent(excludeFolder);
    }
  }
  List<Element> toRemove=new ArrayList<Element>();
  for (  Object _contentRoot : rootManager.getChildren(CONTENT)) {
    Element contentRoot=(Element)_contentRoot;
    if (!contentRootUrls.contains(contentRoot.getAttributeValue(URL))) {
      toRemove.add(contentRoot);
    }
  }
  for (  Element element : toRemove) {
    element.detach();
  }
  JDOMUtil.writeDocument(doc,genSourcesIml);
}
