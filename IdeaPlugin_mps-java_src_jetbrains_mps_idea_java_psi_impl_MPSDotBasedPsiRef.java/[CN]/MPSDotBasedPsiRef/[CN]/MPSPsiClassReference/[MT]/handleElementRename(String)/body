{
  scheduleRefUpdate(new Runnable(){
    @Override public void run(){
      SReference sref=getSReference();
      String role=sref.getRole();
      SNode source=sref.getSourceNode();
      if (sref instanceof StaticReference) {
        String oldTargetIdString=((StaticReference)sref).getTargetNodeId().toString();
        int lastDot=oldTargetIdString.lastIndexOf(".");
        String newTargetIdString;
        if (lastDot < 0) {
          newTargetIdString=Foreign.ID_PREFIX + newName;
        }
 else {
          newTargetIdString=oldTargetIdString.substring(0,lastDot + 1) + newName;
        }
        SNodeId newTargetId=new Foreign(newTargetIdString);
        SReference newRef=StaticReference.create(role,source,sref.getTargetSModelReference(),newTargetId);
        source.setReference(role,newRef);
      }
 else       if (sref instanceof DynamicReference) {
        ((DynamicReference)sref).setResolveInfo(newName);
      }
    }
  }
);
  return MPSDotBasedPsiRef.this;
}
