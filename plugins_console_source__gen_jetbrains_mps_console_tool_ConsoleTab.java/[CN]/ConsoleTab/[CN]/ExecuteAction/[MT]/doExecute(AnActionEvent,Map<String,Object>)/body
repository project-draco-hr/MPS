{
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      myCursor=null;
      TemporaryModels.getInstance().addMissingImports(myModel);
      final SNode lastCmd=SLinkOperations.getTarget(SLinkOperations.getTarget(myRoot,"commandHolder",true),"command",true);
      if ((lastCmd == null)) {
        return;
      }
      execute(lastCmd,new Runnable(){
        public void run(){
          SNodeOperations.deleteNode(SLinkOperations.getTarget(SLinkOperations.getTarget(myRoot,"commandHolder",true),"command",true));
          myNewCommand=null;
        }
      }
,new Runnable(){
        public void run(){
          SwingUtilities.invokeLater(new Runnable(){
            public void run(){
              setSelection();
            }
          }
);
        }
      }
);
    }
  }
);
}
