{
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      SModel loadedModel=loadHistoryModel(state);
      myRoot=SModelOperations.createNewRootNode(myModel,"jetbrains.mps.console.base.structure.ConsoleRoot",null);
      if (loadedModel == null || ListSequence.fromList(SModelOperations.getRoots(loadedModel,"jetbrains.mps.console.base.structure.ConsoleRoot")).isEmpty()) {
        SLinkOperations.setTarget(myRoot,"history",SConceptOperations.createNewNode("jetbrains.mps.console.base.structure.History",null),true);
      }
 else {
        SLinkOperations.setTarget(myRoot,"history",SLinkOperations.getTarget(ListSequence.fromList(SModelOperations.getRoots(loadedModel,"jetbrains.mps.console.base.structure.ConsoleRoot")).first(),"history",true),true);
      }
      SLinkOperations.setTarget(myRoot,"commandHolder",SConceptOperations.createNewNode("jetbrains.mps.console.base.structure.CommandHolder",null),true);
      TemporaryModels.getInstance().addMissingImports(myModel);
    }
  }
);
}
