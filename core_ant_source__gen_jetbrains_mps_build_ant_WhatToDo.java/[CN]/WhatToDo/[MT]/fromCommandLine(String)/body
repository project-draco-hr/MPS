{
  WhatToDo whatToDo=new WhatToDo();
  for (  String arg : args) {
    String[] argsplit=arg.split("\\s+");
    for (    String s : argsplit) {
      String[] propertyValuePair=s.split("=");
      if (propertyValuePair[0].equals(MODEL_FILE)) {
        whatToDo.addModelFile(new File(propertyValuePair[1]));
      }
 else       if (propertyValuePair[0].equals(EXCLUDE_FROM_DIFF_FILE)) {
        whatToDo.excludeFileFromDiff(new File(propertyValuePair[1]));
      }
 else       if (propertyValuePair[0].equals(MODULE_FILE)) {
        whatToDo.addModuleFile(new File(propertyValuePair[1]));
      }
 else       if (propertyValuePair[0].equals(MPS_LIBRARY)) {
        String[] nameValuePair=propertyValuePair[1].split("\\[|\\]");
        String name=nameValuePair[1];
        String[] strings=name.split(",");
        if (strings.length == 1) {
          whatToDo.addLibrary(name,new File(nameValuePair[2]),false);
        }
 else         if (strings[1].equals(LIBRARY_COMPILE)) {
          whatToDo.addLibrary(strings[0],new File(nameValuePair[2]),true);
        }
 else {
          System.err.println("Don't know what to do with input " + name);
        }
      }
 else       if (propertyValuePair[0].equals(MPS_MACRO)) {
        String[] nameValuePair=propertyValuePair[1].split("\\[|\\]");
        whatToDo.addMacro(nameValuePair[1],nameValuePair[2]);
      }
 else       if (propertyValuePair[0].equals(MPS_PROJECT)) {
        String[] nameValuePair=propertyValuePair[1].split("\\[|\\]");
        String projectName=nameValuePair[0];
        if (nameValuePair.length > 1) {
          String[] properties=nameValuePair[1].split(",");
          whatToDo.addProjectFile(new File(projectName),properties);
        }
 else {
          whatToDo.addProjectFile(new File(projectName));
        }
      }
 else       if (propertyValuePair[0].equals(FAIL_ON_ERROR)) {
        whatToDo.myFailOnError=Boolean.parseBoolean(propertyValuePair[1]);
      }
 else       if (propertyValuePair[0].equals(LOG_LEVEL)) {
        whatToDo.myLogLevel=Integer.parseInt(propertyValuePair[1]);
      }
 else       if (propertyValuePair[0].equals(MPS_PARAMETER)) {
        whatToDo.addParameter(propertyValuePair[1]);
      }
 else       if (propertyValuePair[0].equals(LOAD_BOOTSTAP_LIBRARIES)) {
        whatToDo.myLoadBootstrapLibraries=Boolean.parseBoolean(propertyValuePair[1]);
      }
 else       if (propertyValuePair.length == 2) {
        whatToDo.putProperty(propertyValuePair[0],propertyValuePair[1]);
      }
 else {
      }
    }
  }
  return whatToDo;
}
