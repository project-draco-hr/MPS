{
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      SNode methodCall=ExtractMethodWithExitPoints.this.createMethodCall(match,methodDeclaration);
      SNode ifNode=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.IfStatement",null);
      SLinkOperations.setTarget(ifNode,"condition",methodCall,true);
      SLinkOperations.setTarget(ifNode,"ifTrue",SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.StatementList",null),true);
      ListSequence.fromList(SLinkOperations.getTargets(SLinkOperations.getTarget(ifNode,"ifTrue",true),"statement",true)).addElement(ListSequence.fromList(ExtractMethodWithExitPoints.this.myAnalyzer.getIntenalExitPoints()).first());
      SNodeOperations.insertPrevSiblingChild(ListSequence.fromList(ExtractMethodWithExitPoints.this.myStatements).first(),ifNode);
      for (      SNode statement : ListSequence.fromList(ExtractMethodWithExitPoints.this.myStatements)) {
        SNodeOperations.deleteNode(statement);
      }
    }
  }
);
}
