{
  SNode ancestor=SNodeOperations.getAncestor(variableReference,"jetbrains.mps.bootstrap.helgins.structure.WhenConcreteStatement",false,false);
  if (ancestor != null) {
    SNode variableDeclaration=SLinkOperations.getTarget(variableReference,"variableDeclaration",false);
    if (variableDeclaration != null && !(SequenceOperations.contains(SNodeOperations.getAncestors(variableDeclaration,"jetbrains.mps.bootstrap.helgins.structure.WhenConcreteStatement",false),ancestor))) {
      if (!(SPropertyOperations.getBoolean(variableDeclaration,"isFinal"))) {
        TypeChecker.getInstance().reportTypeError(variableReference,"variable is used inside WHEN CONCRETE block. should be declared final","jetbrains.mps.bootstrap.helgins.helgins","1185875417873");
      }
    }
  }
}
