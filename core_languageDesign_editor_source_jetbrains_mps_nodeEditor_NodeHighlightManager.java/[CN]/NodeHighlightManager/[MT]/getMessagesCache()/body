{
synchronized (myRebuildCacheFlagsLock) {
    if (!myRebuildMessagesCacheFlag) {
      return myMessagesCache;
    }
    myRebuildMessagesCacheFlag=false;
  }
  myMessagesCache.clear();
synchronized (myMessagesLock) {
    if (myEditor.getRootCell() != null && !myMessages.isEmpty()) {
      rebuildMessages(myEditor.getRootCell());
    }
  }
  return myMessagesCache;
}
