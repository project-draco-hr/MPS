{
  if (!(checkValidity())) {
    return false;
  }
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    @Override public void run(){
      myProperties.saveTo(myLanguage.getModuleDescriptor());
      myLanguage.setLanguageDescriptor(myLanguage.getModuleDescriptor(),true);
      myLanguage.validateExtends();
      myLanguage.save();
    }
  }
,getOperationContext().getProject());
  ThreadUtils.runInUIThreadNoWait(new Runnable(){
    @Override public void run(){
      Project project=LanguagePropertiesDialog.this.getOperationContext().getProject();
      ProjectPane.getInstance(ProjectHelper.toIdeaProject(project)).selectModule(myLanguage,false);
    }
  }
);
  return true;
}
