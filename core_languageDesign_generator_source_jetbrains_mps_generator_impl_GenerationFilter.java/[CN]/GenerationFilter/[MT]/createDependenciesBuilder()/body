{
  if (!myGenerationContext.isGenerateDependencies()) {
    return new NullDependenciesBuilder();
  }
  DefaultDependenciesBuilder result=new DefaultDependenciesBuilder(myModel.getSModel(),myGenerationHashes);
  if (myUnchangedRoots.isEmpty() && myConditionalsUnchanged == false) {
    return result;
  }
  for (  SNode root : myUnchangedRoots) {
    propagateDependencies(result.getListener(root),mySavedDependencies.getDependenciesFor(root.getId()));
  }
  if (myConditionalsUnchanged) {
    propagateDependencies(result.getListener(null),mySavedDependencies.getDependenciesFor(ModelDigestUtil.HEADER));
  }
  return result;
}
