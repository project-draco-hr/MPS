{
  if (AbstractSequence.NULL_ARRAY_IS_SINGLETON) {
    if (array == null) {
      array=(U[])Sequence.nullSingletonArray();
    }
  }
  if (AbstractSequence.USE_NULL_SEQUENCE) {
    if (coll == null && array == null) {
      return NullCollectionSequence.instance();
    }
 else     if (coll == null) {
      coll=new ArrayList<U>();
    }
 else     if (array == null) {
      if (coll instanceof ICollectionSequence<?>) {
        return (ICollectionSequence<U>)coll;
      }
      final Collection<U> myColl=coll;
      return new CollectionSequence<U>(){
        @Override protected Collection<U> getCollection(){
          return myColl;
        }
      }
;
    }
  }
  List<U> input=Arrays.asList(array);
  if (AbstractSequence.IGNORE_NULL_VALUES) {
    for (    U u : input) {
      if (u != null) {
        coll.add(u);
      }
    }
  }
 else {
    coll.addAll(input);
  }
  if (coll instanceof ICollectionSequence<?>) {
    return (ICollectionSequence<U>)coll;
  }
  final Collection<U> myColl=coll;
  return new CollectionSequence<U>(){
    @Override protected Collection<U> getCollection(){
      return myColl;
    }
  }
;
}
