{
  Collection<SModelDescriptor> models=getModels();
  List<SNode> result=new ArrayList<SNode>();
  for (  SModelDescriptor model : models) {
    if (model == null) {
      continue;
    }
    Iterable<SNode> nodes;
    String conceptToCheck;
    if (myRootsOnly) {
      nodes=model.getSModel().getRootNodes();
      conceptToCheck=myTargetConcept;
    }
 else     if (myTargetConcept != null) {
      nodes=model.getSModel().getFastNodeFinder().getNodes(myTargetConcept,true);
      conceptToCheck=null;
    }
 else {
      nodes=((Iterable)new NodesIterable(model.getSModel()));
      conceptToCheck=null;
    }
    for (    SNode node : nodes) {
      if (conceptToCheck != null && !(SNodeUtil.isInstanceOf(node,SConceptRepository.getInstance().getConcept(conceptToCheck)))) {
        continue;
      }
      if ((prefix != null && prefix.length() > 0)) {
        String refText=getReferenceText(null,node);
        if (refText == null || !(refText.startsWith(prefix))) {
          continue;
        }
      }
      ListSequence.fromList(result).addElement(node);
    }
  }
  return result;
}
