{
  if (node == null)   return null;
  SNode type=null;
  NodeTypesComponent currentTypesComponent=getNodeTypesComponent();
  if (currentTypesComponent != null) {
    currentTypesComponent.addNodeToFrontier(node);
    currentTypesComponent.typeOfNodeCalled(node);
    if (addDependency) {
      currentTypesComponent.addDependcyOnCurrent(node);
    }
    if (ruleModel != null && ruleId != null) {
      currentTypesComponent.markNodeAsAffectedByRule(node,ruleModel,ruleId);
    }
    type=currentTypesComponent.getRawTypeFromContext(node);
  }
  SNode representator;
  if (type != null) {
    representator=getRepresentatorIfNecessary(type);
  }
 else {
    SNode var=createNewRuntimeTypesVariable();
    type=TypeChecker.asType(var);
    getMainContext().put(node,type);
    representator=getRepresentatorIfNecessary(type);
  }
  return representator;
}
