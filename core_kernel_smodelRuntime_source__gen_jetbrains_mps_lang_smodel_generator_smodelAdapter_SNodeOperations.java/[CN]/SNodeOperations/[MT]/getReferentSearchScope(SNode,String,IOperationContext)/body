{
  if (referenceNode == null) {
    return null;
  }
  SNode referenceNodeConcept=referenceNode.getConceptDeclarationNode();
  SNode referenceLinkDecl=SNodeOperations.cast(SModelSearchUtil.findLinkDeclaration(referenceNodeConcept,referenceRole),"jetbrains.mps.lang.structure.structure.LinkDeclaration");
  if (referenceLinkDecl == null) {
    return null;
  }
  String genuineRole=SModelUtil.getGenuineLinkRole(referenceLinkDecl);
  SearchScopeStatus status=ModelConstraintsUtil.getSearchScope(referenceNode.getParent(),referenceNode,referenceNodeConcept,genuineRole,referenceNode.getRoleLink(),context);
  if (status.isOk()) {
    return status.getSearchScope();
  }
  return null;
}
