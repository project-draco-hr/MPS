{
  if (node == null) {
    return null;
  }
  int metaLevel=(sameMetaLevel ? SModelUtil_new.getMetaLevel(node) : 0);
  if (ancestorConceptFqNames.length == 0) {
    return null;
  }
  if (root) {
    SNode rootParent=node.getContainingRoot();
    if (SNodeOperations._isInstanceOf(rootParent,ancestorConceptFqNames)) {
      if (!(sameMetaLevel) || SModelUtil_new.getMetaLevel(rootParent) == metaLevel) {
        return rootParent;
      }
    }
    return null;
  }
  SNode outputNode;
  if (inclusion) {
    outputNode=node;
  }
 else {
    outputNode=node.getParent();
  }
  if (outputNode == null) {
    return null;
  }
  if (SNodeOperations._isInstanceOf(outputNode,ancestorConceptFqNames)) {
    if (!(sameMetaLevel) || SModelUtil_new.getMetaLevel(outputNode) == metaLevel) {
      return outputNode;
    }
  }
  while ((outputNode=outputNode.getParent()) != null) {
    if (SNodeOperations._isInstanceOf(outputNode,ancestorConceptFqNames)) {
      if (!(sameMetaLevel) || SModelUtil_new.getMetaLevel(outputNode) == metaLevel) {
        return outputNode;
      }
    }
  }
  return outputNode;
}
