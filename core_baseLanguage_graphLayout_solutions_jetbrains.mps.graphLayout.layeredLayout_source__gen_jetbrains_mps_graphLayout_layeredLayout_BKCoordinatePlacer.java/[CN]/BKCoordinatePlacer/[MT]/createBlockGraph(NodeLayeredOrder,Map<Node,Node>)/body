{
  Graph blockGraph=new Graph();
  myBlocks=MapSequence.fromMap(new HashMap<Node,Node>());
  for (int layer=0; layer < order.getNumLayers(); layer++) {
    Node prevBlock=null;
    for (    Node node : ListSequence.fromList(order.getOrder(layer))) {
      if (MapSequence.fromMap(roots).get(node) == node) {
        MapSequence.fromMap(myBlocks).put(node,blockGraph.addNode());
      }
      Node currentBlock=MapSequence.fromMap(myBlocks).get(MapSequence.fromMap(roots).get(node));
      if (prevBlock != null) {
        prevBlock.addEdgeTo(currentBlock);
      }
      prevBlock=currentBlock;
    }
  }
  return blockGraph;
}
