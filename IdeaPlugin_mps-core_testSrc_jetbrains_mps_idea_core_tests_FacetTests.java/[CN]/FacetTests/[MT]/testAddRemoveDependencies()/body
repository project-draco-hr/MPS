{
  final Module module2=addModuleAndSetupFixture(myProjectBuilder);
  MPSFacet mpsFacet2=addMPSFacet(module2);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(module2).getModifiableModel();
      rootModel.addModuleOrderEntry(myModule);
      rootModel.commit();
    }
  }
);
  flushEDT();
  List<Dependency> solution2Dependencies=mpsFacet2.getSolution().getDependencies();
  assertEquals(2,solution2Dependencies.size());
  boolean found=false;
  for (  Dependency dependency : solution2Dependencies) {
    if (myFacet.getSolution().getModuleReference().equals(dependency.getModuleRef())) {
      found=true;
      break;
    }
  }
  assertTrue("Cross-Module dependency was not exposed in faced dependencies",found);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ModifiableRootModel rootModel=ModuleRootManager.getInstance(module2).getModifiableModel();
      for (      OrderEntry orderEntry : rootModel.getOrderEntries()) {
        if (orderEntry instanceof ModuleOrderEntry && myModule.equals(((ModuleOrderEntry)orderEntry).getModule())) {
          rootModel.removeOrderEntry(orderEntry);
          break;
        }
      }
      rootModel.commit();
    }
  }
);
  flushEDT();
  assertEquals(1,mpsFacet2.getSolution().getDependencies().size());
  assertFalse(myFacet.getSolution().getModuleReference().equals(mpsFacet2.getSolution().getDependencies().get(0).getModuleRef()));
}
