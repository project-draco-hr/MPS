{
  @NonNls final File modelRootDir=new File(getModuleHome(),"modelRoot");
  assertTrue(modelRootDir.mkdir());
  final SModuleReference solutionReference=myFacet.getSolution().getModuleReference();
  String modelRootPath=modelRootDir.getPath();
  MPSConfigurationBean configurationBean=myFacet.getConfiguration().getBean();
  DefaultModelRoot root=new DefaultModelRoot(FileSystem.getInstance().getFileSystemExt());
  root.setContentRoot(modelRootPath);
  root.addFile(DefaultModelRoot.SOURCE_ROOTS,modelRootPath);
  configurationBean.setModelRoots(Arrays.<ModelRoot>asList(root));
  myFacet.setConfiguration(configurationBean);
  flushEDT();
  runModelRead(new Runnable(){
    @Override public void run(){
      Solution repositorySolution=ModuleRepositoryFacade.getInstance().getModule(solutionReference,Solution.class);
      assertEquals(myFacet.getSolution(),repositorySolution);
      Iterable<ModelRoot> modelRoots=repositorySolution.getModelRoots();
      Iterator<ModelRoot> iterator=modelRoots.iterator();
      assertTrue(iterator.hasNext());
      ModelRoot theModelRoot=iterator.next();
      assertFalse(iterator.hasNext());
      assertEquals(modelRootDir.getPath(),((DefaultModelRoot)theModelRoot).getFiles(DefaultModelRoot.SOURCE_ROOTS).iterator().next());
    }
  }
);
  configurationBean=myFacet.getConfiguration().getBean();
  configurationBean.setModelRoots(new ArrayList<ModelRoot>());
  myFacet.setConfiguration(configurationBean);
  flushEDT();
  runModelRead(new Runnable(){
    @Override public void run(){
      Solution repositorySolution=ModuleRepositoryFacade.getInstance().getModule(solutionReference,Solution.class);
      assertFalse(repositorySolution.getModelRoots().iterator().hasNext());
    }
  }
);
}
