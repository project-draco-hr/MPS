{
  doTest(new Interaction(){
    @Override public void chooseLanguage(    BaseModuleModel baseModuleModel,    Callback callback){
      NavigationItem[] navigationItems=baseModuleModel.getElementsByName("baseLanguage",true,null);
      assertTrue(navigationItems.length > 0);
      callback.elementChosen(navigationItems[0]);
      callback.onClose();
    }
    @Override public Set<SLanguage> chooseAdditionalLanguages(    Set<SLanguage> set){
      return Collections.emptySet();
    }
  }
);
  SRepository repository=ProjectHelper.getProjectRepository(myProjectBuilder.getFixture().getProject());
  repository.getModelAccess().runReadAction(new Runnable(){
    @Override public void run(){
      SModel smodel=SModelFileTracker.getInstance(repository).findModel(VirtualFileUtils.toIFile(packageDir));
      assertNotNull("Model hasn't been created under the directory",smodel);
      Collection<SLanguage> importedLanguages=((SModelInternal)smodel).importedLanguageIds();
      assertTrue("Model is expected to have exactly one used language",importedLanguages.size() == 1);
      assertEquals("jetbrains.mps.baseLanguage",importedLanguages.iterator().next().getQualifiedName());
    }
  }
);
}
