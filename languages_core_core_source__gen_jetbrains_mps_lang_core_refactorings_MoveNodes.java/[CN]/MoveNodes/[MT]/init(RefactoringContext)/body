{
  ((RefactoringContext)refactoringContext).setLocal(true);
  final Wrappers._boolean result=new Wrappers._boolean(false);
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      if (((Object)refactoringContext.getParameter("target")) instanceof SNode) {
        SNode targetNode=((SNode)((Object)refactoringContext.getParameter("target")));
        SNode concept=SNodeOperations.getConceptDeclaration(targetNode);
        ConceptAndSuperConceptsScope superConceptsScope=new ConceptAndSuperConceptsScope(concept);
        List<SNode> linkDeclarations=(List<SNode>)superConceptsScope.getLinkDeclarationsExcludingOverridden();
        Iterable<SNode> childLinkDeclarations=ListSequence.fromList(linkDeclarations).where(new IWhereFilter<SNode>(){
          public boolean accept(          SNode it){
            return SPropertyOperations.hasValue(it,MetaAdapterFactory.getProperty(new UUID(-4094437568663370681l,-8968368868337559369l),1071489288298l,1071599937831l,"metaClass"),"aggregation","reference");
          }
        }
);
        Iterable<String> childLinksRoles=Sequence.fromIterable(childLinkDeclarations).select(new ISelector<SNode,String>(){
          public String select(          SNode it){
            return SModelUtil.getGenuineLinkRole(it);
          }
        }
);
        for (        SNode node : refactoringContext.getSelectedNodes()) {
          String childRole=node.getRoleInParent();
          if (!(Sequence.fromIterable(childLinksRoles).contains(childRole))) {
            return;
          }
          for (          SNode linkDeclaration : childLinkDeclarations) {
            if (SPropertyOperations.getString(linkDeclaration,MetaAdapterFactory.getProperty(new UUID(-4094437568663370681l,-8968368868337559369l),1071489288298l,1071599776563l,"role")).equals(childRole)) {
              if (!(SConceptOperations.isSuperConceptOf(SNodeOperations.asSConcept(SLinkOperations.getTarget(linkDeclaration,MetaAdapterFactory.getReferenceLink(new UUID(-4094437568663370681l,-8968368868337559369l),1071489288298l,1071599976176l,"target"))),SNodeOperations.asSConcept(SNodeOperations.getConceptDeclaration(node))))) {
                return;
              }
            }
          }
        }
        result.value=true;
      }
 else       if (((Object)refactoringContext.getParameter("target")) instanceof SModel) {
        result.value=ListSequence.fromList(refactoringContext.getSelectedNodes()).all(new IWhereFilter<SNode>(){
          public boolean accept(          SNode node){
            return SPropertyOperations.getBoolean(SNodeOperations.as(SNodeOperations.asNode(SNodeOperations.getConceptDeclaration(node)),MetaAdapterFactory.getConcept(new UUID(-4094437568663370681l,-8968368868337559369l),1071489090640l,"jetbrains.mps.lang.structure.structure.ConceptDeclaration")),MetaAdapterFactory.getProperty(new UUID(-4094437568663370681l,-8968368868337559369l),1071489090640l,1096454100552l,"rootable"));
          }
        }
);
      }
    }
  }
);
  return result.value;
}
