{
  List<SNode> paths=ListOperations.<SNode>createList();
  File dir=new File(PathManager.getHomePath() + File.separator + prefix.replace("/",File.separator));
  List<IModule> modulesList=MPSModuleRepository.getInstance().getAllModulesInDirectory(dir);
  Set<IModule> modulesInClasspath=new HashSet<IModule>();
  for (  IModule module : ListSequence.fromList(modulesList)) {
    if (module instanceof Language) {
      Language language=(Language)module;
      modulesInClasspath.add(language);
      modulesInClasspath.addAll(language.getRuntimeDependOnModules());
    }
  }
  for (  IModule module : SetSequence.fromSet(modulesInClasspath)) {
    String moduleProperName=Module_Behavior.extractModuleProperName_1235487584035(module);
    SNode path=SConceptOperations.createNewNode("jetbrains.mps.build.distrib.structure.SimplePath",null);
    SPropertyOperations.set(path,"path",prefix + "/" + moduleProperName+ "."+ AbstractModule.PACKAGE_SUFFIX);
    ListSequence.fromList(paths).addElement(path);
    if (module instanceof Language) {
      Language language=(Language)module;
      List<String> runtimeCP=language.getLanguageRuntimeClassPathItems();
      runtimeCP.removeAll(language.getClassPath());
      if (!(runtimeCP.isEmpty())) {
        path=SConceptOperations.createNewNode("jetbrains.mps.build.distrib.structure.SimplePath",null);
        SPropertyOperations.set(path,"path",prefix + "/" + moduleProperName+ "."+ AbstractModule.RUNTIME_JAR_SUFFIX);
        ListSequence.fromList(paths).addElement(path);
      }
    }
  }
  return ListSequence.fromList(paths).sort(new ISelector<SNode,Comparable<?>>(){
    public Comparable<?> select(    SNode it){
      return SPropertyOperations.getString(it,"path");
    }
  }
,true);
}
