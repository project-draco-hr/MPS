{
  EditorCell_Collection parent=cell.getParent();
  if (parent == null) {
    return (EditorUtil.isCollection(cell)) ? EditorUtil.findFirstSelectableCell((EditorCell_Collection)cell) : null;
  }
  EditorCell nextToRight=parent.findNextToRight(cell);
  if (nextToRight != null)   return nextToRight;
  EditorCell_Collection parentCollection=parent.getParent();
  if (parentCollection == null)   return null;
  EditorCell target=parentCollection.getNextCell(parent);
  while (target != null && !(EditorUtil.isCollection(target) || target.isSelectable())) {
    target=parentCollection.getNextCell(target);
  }
  while (target == null || !(EditorUtil.isCollection(target) || target.isSelectable())) {
    parent=parentCollection;
    parentCollection=parentCollection.getParent();
    if (parentCollection == null)     return null;
    target=parentCollection.getNextCell(parent);
    while (target != null && !(EditorUtil.isCollection(target) || target.isSelectable())) {
      target=parentCollection.getNextCell(target);
    }
  }
  if (!(EditorUtil.isCollection(target)))   return target;
  return EditorUtil.findFirstSelectableCell((EditorCell_Collection)target);
}
