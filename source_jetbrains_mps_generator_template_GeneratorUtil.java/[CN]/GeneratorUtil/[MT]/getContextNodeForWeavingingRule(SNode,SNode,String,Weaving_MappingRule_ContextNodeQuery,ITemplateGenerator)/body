{
  if (aspectId != null) {
    try {
      String methodName="templateWeavingRule_Context_" + aspectId;
      Object[] args=new Object[]{inputNode,generator};
      INodeBuilder nodeBuilder=(INodeBuilder)QueryMethod.invoke(methodName,args,ruleNode.getModel());
      if (nodeBuilder == null) {
        generator.showErrorMessage(inputNode,null,ruleNode,"Query Method returned null");
        return null;
      }
      return nodeBuilder.getTargetNode();
    }
 catch (    Throwable t) {
      generator.showErrorMessage(inputNode,null,ruleNode,t.getClass().getName());
      throw new RuntimeException(t);
    }
  }
  if (query != null) {
    String methodName=TemplateFunctionMethodName.weaving_MappingRule_ContextNodeQuery(query.getNode());
    try {
      return (SNode)QueryMethodGenerated.invoke(methodName,generator.getGeneratorSessionContext(),new WeavingMappingRuleContext(inputNode,generator),query.getModel());
    }
 catch (    Exception e) {
      generator.showErrorMessage(inputNode,null,ruleNode,"couldn't evaluate rule context query");
      LOG.error(e);
    }
  }
  return null;
}
