{
  visitNonPropertyEvent();
  if (!mayAffectSelection(event)) {
    return;
  }
  if (event.isAdded()) {
    for (SNode node=event.getChild(); node != null; node=node.getParent()) {
      if (myAllAddedChildren.contains(node)) {
        myLastAdded=myLastChildAdded;
        return;
      }
    }
    myAllAddedChildren.add(event.getChild());
    myLastAdded=myLastChildAdded=new ChildAddedSelectionHandler(event.getChild());
  }
 else {
    myLastRemoved=new ChildRemovedSelectionHandler(event.getParent(),event.getChildRole(),event.getChildIndex());
  }
}
