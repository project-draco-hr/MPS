{
  threadWatcher.waitUntilSettled(5000);
  disposeCaches();
  Logger.getRootLogger().removeAppender(app);
  Logger.getRootLogger().setLevel(oldLevel);
  Failure fail=null;
  if (!testsToIgnore.containsKey(desc) && (cacheOut.isNotEmpty() || cacheErr.isNotEmpty() || app.isNotEmpty()|| threadWatcher.isNotEmpty())) {
    fail=new Failure(desc,new UncleanTestExecutionException(cacheOut,cacheErr,app,threadWatcher));
  }
  cacheOut.clear();
  cacheErr.clear();
  if (fail != null) {
    super.fireTestFailure(fail);
  }
}
