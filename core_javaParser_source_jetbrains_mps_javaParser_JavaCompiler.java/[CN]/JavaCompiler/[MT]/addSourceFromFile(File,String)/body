{
  try {
    String fileContents=FileUtil.read(file);
    String str="package ";
    int packageIndex=fileContents.indexOf(str) + str.length();
    int i=packageIndex;
    StringBuilder classFQName=new StringBuilder();
    while (i < fileContents.length()) {
      char c=fileContents.charAt(i);
      i++;
      if (Character.isWhitespace(c) || c == ';') {
        break;
      }
      classFQName.append(c);
    }
    String packageNameFromFile=classFQName.toString();
    if (myPrefix != null) {
      if (!((myPrefix + packageNameWithoutPrefix).equals(packageNameFromFile))) {
        LOG.error("package name in a source file does not correpond to file path");
        return;
      }
    }
 else {
      if (packageNameFromFile.endsWith(packageNameWithoutPrefix)) {
        int index=packageNameFromFile.length() - packageNameWithoutPrefix.length();
        myPrefix=packageNameFromFile.substring(0,index - 1);
      }
 else {
        LOG.error("package name in a source file does not correpond to file path");
        return;
      }
    }
    SModel model=getModel(packageNameFromFile);
    String fileName;
    String nameAndExtension=file.getName();
    int offset=nameAndExtension.lastIndexOf('.');
    if (offset < 0) {
      fileName=nameAndExtension;
    }
 else {
      fileName=nameAndExtension.substring(0,offset);
    }
    classFQName.append(".");
    classFQName.append(fileName);
    myPackageFQNamesToModels.put(packageNameFromFile,model);
    addSource(classFQName.toString(),fileContents,model);
  }
 catch (  Throwable t) {
    LOG.error(t);
  }
}
