{
  GlobalScope scope=GlobalScope.getInstance();
  while (conceptDeclaration != null) {
    Language language=SModelUtil_new.getDeclaringLanguage(conceptDeclaration,scope);
    if (language != null) {
      String iconPath=Macros.languageDescriptor().expandPath(conceptDeclaration.getIconPath(),language.getDescriptorFile());
      if (iconPath != null) {
        Icon icon=ourPathsToIcons.get(iconPath);
        if (icon != null)         return icon;
        IFile file=FileSystem.getFile(iconPath);
        if (file.exists()) {
          byte[] image=new byte[(int)file.length()];
          InputStream is=null;
          try {
            is=file.openInputStream();
            int current=0;
            while (true) {
              int result=is.read(image,current,image.length - current);
              if (result == -1 || result == 0) {
                break;
              }
 else {
                current+=result;
              }
            }
          }
 catch (          IOException e) {
            LOG.error(e);
          }
 finally {
            try {
              if (is != null) {
                is.close();
              }
            }
 catch (            IOException e) {
              LOG.error(e);
            }
          }
          icon=new ImageIcon(image);
          ourPathsToIcons.put(iconPath,icon);
          return icon;
        }
      }
    }
    conceptDeclaration=conceptDeclaration.getExtends();
  }
  return Icons.DEFAULT_ICON;
}
