{
  try {
    monitor.start("Compiling...",1000 * modules.size());
    Set<IModule> toCompile=new LinkedHashSet<IModule>();
    Set<IModule> candidates=new HashSet<IModule>();
    candidates.addAll(modules);
    for (    IModule m : modules) {
      candidates.addAll(m.getAllDependOnModules(IModule.class));
    }
    for (    IModule c : candidates) {
      if (!isUpToDate(c)) {
        toCompile.add(c);
      }
    }
    for (    Set<IModule> cycle : new MakeScheduleBuilder().buildSchedule(toCompile)) {
      monitor.addText("Compiling module cycle: " + cycle + "...");
      compile(cycle);
    }
  }
  finally {
    monitor.finish();
  }
}
