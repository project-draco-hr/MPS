{
  ((MPSProject)MapSequence.fromMap(_params).get("project")).getModelAccess().executeCommand(new Runnable(){
    public void run(){
      AbstractModule from=SafeDeleteModuleDependency_Action.this.getModuleFrom(_params);
      final SModule to=SafeDeleteModuleDependency_Action.this.getModuleTo(_params);
      ModuleDescriptor descriptor=from.getModuleDescriptor();
      Collection<Dependency> dependencies=descriptor.getDependencies();
      List<Dependency> badDeps=CollectionSequence.fromCollection(((Collection<Dependency>)dependencies)).where(new IWhereFilter<Dependency>(){
        public boolean accept(        Dependency it){
          return it.getModuleRef().equals(to.getModuleReference());
        }
      }
).toListSequence();
      dependencies.removeAll(badDeps);
      from.save();
    }
  }
);
  ((Project)MapSequence.fromMap(_params).get("ideaProject")).getComponent(ProjectPluginManager.class).getTool(ModuleDependenies_Tool.class).resetAll();
}
