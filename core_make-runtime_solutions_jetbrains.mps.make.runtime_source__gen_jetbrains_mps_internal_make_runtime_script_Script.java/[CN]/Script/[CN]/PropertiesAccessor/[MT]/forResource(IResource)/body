{
  if (!(res instanceof IResourceWithProperties)) {
    return transProps;
  }
  IPropertiesIO pio=((IResourceWithProperties)res).getProperties();
  if (!(MapSequence.fromMap(allProperties).containsKey(pio.getKey()))) {
    Script.PropertiesWithBackstore props=new Script.PropertiesWithBackstore(transProps,pio);
    MapSequence.<Object,IPropertiesPool>fromMap(allProperties).put(pio.getKey(),props);
  }
  return MapSequence.<Object,IPropertiesPool>fromMap(allProperties).get(pio.getKey());
}
