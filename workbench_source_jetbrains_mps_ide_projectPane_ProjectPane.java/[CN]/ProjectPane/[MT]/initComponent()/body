{
  addListeners();
  super.initComponent();
  getPanel().setLayout(new BorderLayout());
  myToolbar.setFloatable(false);
  getPanel().add(myToolbar,BorderLayout.NORTH);
  JScrollPane scroller=new JScrollPane(myTree);
  scroller.setBorder(null);
  getPanel().add(scroller,BorderLayout.CENTER);
  myTree.addKeyListener(new KeyAdapter(){
    public void keyPressed(    KeyEvent e){
      if (e.getKeyCode() == KeyEvent.VK_F4 && e.getModifiers() == 0) {
        openEditor();
        e.consume();
      }
      if (e.getKeyCode() == KeyEvent.VK_ENTER && e.getModifiers() == 0) {
        openEditor();
        e.consume();
      }
    }
  }
);
  myToolbar.add(myPAndRToggle=new JToggleButton(){
{
      setAction(new AbstractAction("",Icons.PROP_AND_REF){
        public void actionPerformed(        ActionEvent e){
          setShowPropertiesAndReferences(!isShowPropertiesAndReferences());
        }
      }
);
      setToolTipText("Show properties and references");
    }
    public void updateUI(){
      setUI(new MPSToolBarButtonUI());
    }
  }
);
  myToolbar.add(myAutoscrollToSource=new JToggleButton(){
{
      setAction(new AbstractAction("",Icons.AUTOSCROLL_TO_SOURCE){
        public void actionPerformed(        ActionEvent e){
          myTree.setAutoOpen(!myTree.isAutoOpen());
        }
      }
);
      setToolTipText("Autoscroll to source");
    }
    public void updateUI(){
      setUI(new MPSToolBarButtonUI());
    }
  }
);
  myToolbar.add(myAutoscrollFromSource=new JToggleButton(){
{
      setAction(new AbstractAction("",Icons.AUTOSCROLL_FROM_SOURCE){
        public void actionPerformed(        ActionEvent e){
        }
      }
);
      setToolTipText("Autoscroll from source");
    }
    public void updateUI(){
      setUI(new MPSToolBarButtonUI());
    }
  }
);
  myToolbar.add(new JButton(){
{
      setAction(new AbstractAction("",jetbrains.mps.ide.findusages.view.icons.Icons.COLLAPSE_ICON){
        public void actionPerformed(        ActionEvent e){
          for (          MPSTreeNode rootChild : myTree.getRootNode()) {
            myTree.collapseAll(rootChild);
          }
        }
      }
);
      setToolTipText("Collapse all");
    }
    public void updateUI(){
      setUI(new MPSToolBarButtonUI());
    }
  }
);
  if (!IdeMain.isTestMode()) {
    ThreadUtils.runInUIThreadNoWait(new Runnable(){
      public void run(){
        rebuildTree();
      }
    }
);
  }
}
