{
  if (!moduleNode.isInitialized() && !moduleNode.hasInfiniteSubtree()) {
    moduleNode.init();
  }
  for (  MPSTreeNode node : moduleNode) {
    if (node instanceof SModelTreeNode) {
      SModelTreeNode modelNode=(SModelTreeNode)node;
      SModelDescriptor modelDescriptor=modelNode.getSModelDescriptor();
      SModelReference modelReference=modelDescriptor.getSModelReference();
      if (modelReference.equals(model.getSModelReference())) {
        return modelNode;
      }
    }
    if (node instanceof ProjectModuleTreeNode) {
      SModelTreeNode foundNode=findModelTreeNodeInModule(model,(ProjectModuleTreeNode)node);
      if (foundNode != null) {
        return foundNode;
      }
    }
  }
  return null;
}
