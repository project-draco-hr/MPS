{
  if (!(parentNode instanceof SModelTreeNode) && !parentNode.isInitialized() && !parentNode.hasInfiniteSubtree()) {
    parentNode.init();
  }
  if (parentNode instanceof SModelTreeNode) {
    SModelTreeNode parentSModelNode=(SModelTreeNode)parentNode;
    SModelDescriptor parentModelDescriptor=parentSModelNode.getSModelDescriptor();
    SModelReference parentModelRef=parentModelDescriptor.getSModelReference();
    SModelReference modelRef=model.getSModelReference();
    if (parentModelRef.equals(modelRef)) {
      return parentSModelNode;
    }
  }
  for (  MPSTreeNode node : parentNode) {
    SModelTreeNode foundNode=findModelTreeNodeAnywhere(model,node);
    if (foundNode != null) {
      return foundNode;
    }
  }
  return null;
}
