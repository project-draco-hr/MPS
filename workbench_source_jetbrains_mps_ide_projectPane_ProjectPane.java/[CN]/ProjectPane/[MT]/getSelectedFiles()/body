{
  List<VirtualFile> selectedFilesList=new LinkedList<VirtualFile>();
  List<SModelDescriptor> descriptors=getSelectedModels();
  if (descriptors != null) {
    for (    SModelDescriptor descriptor : descriptors) {
      IFile ifile=descriptor.getModelFile();
      if (ifile != null) {
        VirtualFile vfile=VFileSystem.getFile(ifile);
        if (vfile != null) {
          selectedFilesList.add(vfile);
        }
      }
    }
  }
  List<IModule> modules=getSelectedModules();
  if (modules != null) {
    for (    IModule module : modules) {
      File home=module.getBundleHome();
      if (home != null) {
        VirtualFile vfile=VFileSystem.getFile(home);
        if (vfile != null) {
          selectedFilesList.add(vfile);
        }
      }
      IFile ifile=module.getDescriptorFile();
      if (ifile != null) {
        VirtualFile vfile=VFileSystem.getFile(ifile);
        if (vfile != null) {
          selectedFilesList.add(vfile);
        }
      }
    }
  }
  if (selectedFilesList.size() == 0) {
    return null;
  }
  return selectedFilesList.toArray(new VirtualFile[selectedFilesList.size()]);
}
