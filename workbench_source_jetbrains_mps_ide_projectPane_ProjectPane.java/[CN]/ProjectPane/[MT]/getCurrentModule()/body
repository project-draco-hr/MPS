{
  TreePath[] selection=getTree().getSelectionPaths();
  if (selection == null)   return null;
  if (selection.length != 1)   return null;
  MPSTreeNode treeNode=(MPSTreeNode)selection[0].getLastPathComponent();
  while (treeNode != null && !(treeNode instanceof ProjectModuleTreeNode)) {
    treeNode=(MPSTreeNode)treeNode.getParent();
  }
  if (treeNode == null)   return null;
  return ((ProjectModuleTreeNode)treeNode).getModule();
}
