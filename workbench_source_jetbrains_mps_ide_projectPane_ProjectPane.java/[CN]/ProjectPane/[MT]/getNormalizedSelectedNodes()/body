{
  List<SNode> selectedNodes=new ArrayList<SNode>(getSelectedNodes());
  HashSet<SNode> unselectedNodes=new HashSet<SNode>();
  for (  SNode node : selectedNodes) {
    if (node == null)     continue;
    if (unselectedNodes.contains(node))     continue;
    unselectedNodes.addAll(node.getSubnodes());
  }
  selectedNodes.removeAll(unselectedNodes);
  return selectedNodes;
}
