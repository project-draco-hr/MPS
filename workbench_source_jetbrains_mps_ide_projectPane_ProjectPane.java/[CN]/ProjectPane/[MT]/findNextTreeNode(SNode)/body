{
  DefaultTreeModel model=(DefaultTreeModel)getTree().getModel();
  MPSTreeNode rootNode=(MPSTreeNode)model.getRoot();
  SModelDescriptor sModel=node.getModel().getModelDescriptor();
  SModelTreeNode sModelNode=findSModelTreeNode(rootNode,sModel);
  if (sModelNode == null)   return null;
  MPSTreeNode foundNode=findTreeNode(sModelNode,node);
  if (foundNode == null)   return null;
  DefaultMutableTreeNode parentNode=(DefaultMutableTreeNode)foundNode.getParent();
  TreeNode result=parentNode.getChildAfter(foundNode);
  if (result == null)   result=parentNode.getChildBefore(foundNode);
  if (result == null)   result=parentNode;
  return (MPSTreeNode)result;
}
