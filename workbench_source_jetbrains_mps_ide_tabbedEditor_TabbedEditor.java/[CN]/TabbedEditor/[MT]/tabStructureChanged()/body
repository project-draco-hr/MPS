{
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      final Project project=myOperationContext.getProject();
      final FileEditorManagerImpl manager=(FileEditorManagerImpl)FileEditorManager.getInstance(project);
      VirtualFile virtualFile=manager.getCurrentFile();
      if (virtualFile == null)       return;
      for (      FileEditor openedEditor : manager.getAllEditors()) {
        if (!(openedEditor instanceof MPSFileNodeEditor))         continue;
        final MPSFileNodeEditor openedMPSEditor=(MPSFileNodeEditor)openedEditor;
        if (ObjectUtils.equals(this,openedMPSEditor.getNodeEditor()))         continue;
        final IEditor mpsNodeEditor=openedMPSEditor.getNodeEditor();
        List<SNodePointer> openedNodes=ModelAccess.instance().runReadAction(new Computable<List<SNodePointer>>(){
          public List<SNodePointer> compute(){
            return mpsNodeEditor.getAllEditedNodes();
          }
        }
);
        if (mpsNodeEditor instanceof TabbedEditor || !getAllEditedNodes().contains(openedNodes.get(0)))         continue;
        boolean needToSelect=virtualFile == openedMPSEditor.getFile();
        if (!needToSelect) {
          manager.closeFile(openedMPSEditor.getFile());
        }
 else {
          SwingUtilities.invokeLater(new Runnable(){
            public void run(){
              Object memento=null;
              EditorComponent editorComponent=mpsNodeEditor.getCurrentEditorComponent();
              if (editorComponent != null) {
                memento=editorComponent.getEditorContext().createMemento(true);
              }
              SNode node=myNodePointer.getNode();
              new MPSEditorOpener(project).editNode(node,myOperationContext);
              final EditorComponent component=selectLinkedEditor(mpsNodeEditor.getCurrentlyEditedNode());
              component.getEditorContext().setMemento(memento);
              manager.closeFile(openedMPSEditor.getFile());
            }
          }
);
        }
        onTabSelectionChange();
      }
    }
  }
);
}
