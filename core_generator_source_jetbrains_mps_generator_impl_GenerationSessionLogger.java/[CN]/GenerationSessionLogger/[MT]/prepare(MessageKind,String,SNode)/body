{
  Message message=new Message(kind,text);
  if (node != null) {
    if (myOperationContext != null) {
      if (keepModel(node.getModel(),kind != MessageKind.ERROR)) {
        NodeWithContext context=new NodeWithContext(node,myOperationContext.getInvocationContext());
        message.setHintObject(context);
      }
    }
 else     if (node.isRegistered() && node.getModel() != null && !node.getModel().isTransient()) {
      message.setHintObject(new SNodePointer(node));
    }
  }
  return message;
}
