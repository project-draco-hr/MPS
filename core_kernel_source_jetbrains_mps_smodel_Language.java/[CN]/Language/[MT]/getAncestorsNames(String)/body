{
  if (myAncestorsNamesMap.containsKey(conceptFqName)) {
    return myAncestorsNamesMap.get(conceptFqName);
  }
 else {
    Set<String> result=new HashSet<String>();
    Set<String> parents=new HashSet<String>();
    AbstractConceptDeclaration declaration=findConceptDeclaration(NameUtil.shortNameFromLongName(conceptFqName));
    if (declaration == null) {
      return result;
    }
    result.add(conceptFqName);
    if (declaration instanceof ConceptDeclaration) {
      ConceptDeclaration cd=(ConceptDeclaration)declaration;
      if (cd.getExtends() != null) {
        String fqName=NameUtil.nodeFQName(cd.getExtends());
        parents.add(fqName);
        result.addAll(SModelUtil_new.getDeclaringLanguage(cd.getExtends(),GlobalScope.getInstance()).getAncestorsNames(fqName));
      }
      for (      InterfaceConceptReference icr : cd.getImplementses()) {
        String fqName=NameUtil.nodeFQName(icr.getIntfc());
        parents.add(fqName);
        result.addAll(SModelUtil_new.getDeclaringLanguage(icr.getIntfc(),GlobalScope.getInstance()).getAncestorsNames(fqName));
      }
    }
    if (declaration instanceof InterfaceConceptDeclaration) {
      InterfaceConceptDeclaration icd=(InterfaceConceptDeclaration)declaration;
      for (      InterfaceConceptReference icr : icd.getExtendses()) {
        String fqName=NameUtil.nodeFQName(icr.getIntfc());
        parents.add(fqName);
        result.addAll(SModelUtil_new.getDeclaringLanguage(icr.getIntfc(),GlobalScope.getInstance()).getAncestorsNames(fqName));
      }
    }
    myParentsNamesMap.put(conceptFqName,parents);
    myAncestorsNamesMap.put(conceptFqName,result);
    return result;
  }
}
