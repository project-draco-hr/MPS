{
  LanguageDescriptor languageDescriptor;
  if (handle.getDescriptor() != null) {
    languageDescriptor=(LanguageDescriptor)handle.getDescriptor();
    if (languageDescriptor.getId() == null) {
      languageDescriptor.setId(ModuleId.regular());
      LanguageDescriptorPersistence.saveLanguageDescriptor(handle.getFile(),languageDescriptor);
    }
  }
 else {
    languageDescriptor=createNewDescriptor(namespace,handle.getFile());
  }
  MPSModuleRepository repository=MPSModuleRepository.getInstance();
  IModule m=checkRegistered(languageDescriptor.getModuleReference(),handle.getFile());
  if (m != null) {
    return (Language)m;
  }
  Language language=new Language();
  language.myDescriptorFile=handle.getFile();
  language.setLanguageDescriptor(languageDescriptor,false);
  repository.registerModule(language,moduleOwner);
  LibrariesLoader.createLanguageLibs(moduleOwner,language,languageDescriptor,repository);
  return language;
}
