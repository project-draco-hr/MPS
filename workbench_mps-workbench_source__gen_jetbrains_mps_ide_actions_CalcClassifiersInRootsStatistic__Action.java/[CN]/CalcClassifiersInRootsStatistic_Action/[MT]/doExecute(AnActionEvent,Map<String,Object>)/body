{
  try {
    final Wrappers._int rootsCount=new Wrappers._int(0);
    final Wrappers._long newMembersOverallTime=new Wrappers._long(0);
    final Wrappers._long oldMembersOverallTime=new Wrappers._long(0);
    InternalActionsUtils.executeActionOnAllNodesInModal("find used concepts",((Project)MapSequence.fromMap(_params).get("project")),new _FunctionTypes._void_P1_E0<SNode>(){
      public void invoke(      final SNode node){
        if (node.isRoot()) {
          rootsCount.value++;
          String nodeName=node + "@" + node.getModel().getModelDescriptor().getLongName();
          boolean somethingPrinted=false;
          final Wrappers._T<List<SNode>> types=new Wrappers._T<List<SNode>>(ListSequence.fromList(new ArrayList<SNode>()));
          long typesCalcTime=CalcClassifiersInRootsStatistic_Action.this.calculateElapsedTime(new _FunctionTypes._void_P0_E0(){
            public void invoke(){
              types.value=CalcClassifiersInRootsStatistic_Action.this.calcAllClassifierTypesInRoot(node,_params);
            }
          }
,_params);
          if (typesCalcTime > 1000) {
            System.out.printf("%s: type calc time = %.3f%n",nodeName,typesCalcTime * 0.001);
            somethingPrinted=true;
          }
          final Set<SNode> classifiers=SetSequence.fromSet(new HashSet<SNode>());
          SetSequence.fromSet(classifiers).addSequence(ListSequence.fromList(types.value).select(new ISelector<SNode,SNode>(){
            public SNode select(            SNode it){
              return SLinkOperations.getTarget(it,"classifier",false);
            }
          }
).where(new IWhereFilter<SNode>(){
            public boolean accept(            SNode it){
              return (it != null);
            }
          }
));
          if (SetSequence.fromSet(classifiers).count() > 50) {
            System.out.printf("%s: classifier types = %d; classifiers = %d%n",nodeName,ListSequence.fromList(types.value).count(),SetSequence.fromSet(classifiers).count());
            somethingPrinted=true;
          }
          final Wrappers._T<List<SNode>> members=new Wrappers._T<List<SNode>>(ListSequence.fromList(new ArrayList<SNode>()));
          long oldMembersCalcTime=CalcClassifiersInRootsStatistic_Action.this.calculateElapsedTime(new _FunctionTypes._void_P0_E0(){
            public void invoke(){
              members.value=CalcClassifiersInRootsStatistic_Action.this.calcAllMembersOfClassifiers(classifiers,new _FunctionTypes._return_P1_E0<Iterable<SNode>,SNode>(){
                public Iterable<SNode> invoke(                SNode classifier){
                  return MpsScopesUtil.getMembersOld(classifier);
                }
              }
,_params);
            }
          }
,_params);
          if (ListSequence.fromList(members.value).count() > 4000) {
            System.out.printf("%s: members count = %d%n",nodeName,ListSequence.fromList(members.value).count());
            somethingPrinted=true;
          }
          if (oldMembersCalcTime > 500) {
            System.out.printf("%s: old members calc time = %.3f%n",nodeName,oldMembersCalcTime * 0.001);
            somethingPrinted=true;
          }
          oldMembersOverallTime.value+=oldMembersCalcTime;
          long newMembersCalcTime=CalcClassifiersInRootsStatistic_Action.this.calculateElapsedTime(new _FunctionTypes._void_P0_E0(){
            public void invoke(){
              members.value=CalcClassifiersInRootsStatistic_Action.this.calcAllMembersOfClassifiers(classifiers,new _FunctionTypes._return_P1_E0<Iterable<SNode>,SNode>(){
                public Iterable<SNode> invoke(                SNode classifier){
                  return MpsScopesUtil.getMembersNew(classifier);
                }
              }
,_params);
            }
          }
,_params);
          if (newMembersCalcTime > 500) {
            System.out.printf("%s: new members calc time = %.3f%n",nodeName,newMembersCalcTime * 0.001);
            somethingPrinted=true;
          }
          newMembersOverallTime.value+=newMembersCalcTime;
          if (somethingPrinted) {
            System.out.println();
          }
        }
      }
    }
);
    System.out.println("New members average time: " + newMembersOverallTime.value * 0.001 / rootsCount.value);
    System.out.println("Old members average time: " + oldMembersOverallTime.value * 0.001 / rootsCount.value);
  }
 catch (  Throwable t) {
    if (log.isErrorEnabled()) {
      log.error("User's action execute method failed. Action:" + "CalcClassifiersInRootsStatistic",t);
    }
  }
}
