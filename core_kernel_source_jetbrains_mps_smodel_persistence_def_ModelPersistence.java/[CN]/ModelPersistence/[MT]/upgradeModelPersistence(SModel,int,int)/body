{
  SModelReference reference=model.getSModelReference();
  int version=fromVersion;
  while (version < toVersion) {
    IModelWriter writer=modelWriters.get(++version);
    Document document=writer.saveModel(model,false);
    model.dispose();
    LOG.assertLog(modelReaders.get(version) != null);
    model=modelReaders.get(version).readModel(document,reference.getShortName(),reference.getStereotype());
  }
  LOG.info("persistence upgraded: " + fromVersion + "->"+ toVersion+ " "+ reference);
  model.setPersistenceVersion(toVersion);
  return model;
}
