{
  if (file instanceof TextPreviewFile)   return jetbrains.mps.workbench.make.Icons.GENERATED;
  if (file instanceof MPSNodeVirtualFile) {
    final MPSNodeVirtualFile nodeFile=(MPSNodeVirtualFile)file;
    return ModelAccess.instance().runReadAction(new Computable<Icon>(){
      public Icon compute(){
        SNode node=MPSEditorUtil.getCurrentEditedNode(project,nodeFile);
        if (node != null) {
          return IconManager.getIconWithoutAdditionalPart(node);
        }
        node=nodeFile.getNode();
        if (node != null) {
          return IconManager.getIconWithoutAdditionalPart(node);
        }
        return null;
      }
    }
);
  }
  if (file instanceof MPSLanguageVirtualFile) {
    return Icons.PROJECT_LANGUAGE_ICON;
  }
  return null;
}
