{
  final MPSProjectMigrationComponent migrationState=getProject().getComponent(MPSProjectMigrationComponent.class);
  if (migrationState != null && migrationState.isMigrationRequired() && migrationState.hasMigrationAgent()) {
    migrationState.addMigrationListener(new MPSProjectMigrationListener.DEFAULT(){
      @Override public void migrationFinished(      Project mpsProject){
        migrationState.removeMigrationListener(this);
        createAndRegisterTool(false);
      }
      @Override public void migrationAborted(      Project project){
        migrationState.removeMigrationListener(this);
      }
    }
);
  }
 else {
    createAndRegisterTool(true);
  }
}
