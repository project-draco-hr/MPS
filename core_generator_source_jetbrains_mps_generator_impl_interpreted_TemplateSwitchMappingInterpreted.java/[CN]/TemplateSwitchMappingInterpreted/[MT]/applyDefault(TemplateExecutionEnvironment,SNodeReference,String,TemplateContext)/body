{
  SNode defaultConsequence=RuleUtil.getSwitchDefaultConsequence(mySwitch);
  if (defaultConsequence == null) {
    SNodeReference modifies=getModifiesSwitch();
    if (modifies == null) {
      return null;
    }
    TemplateSwitchMapping switchMapping=environment.getGenerator().getSwitch(modifies);
    if (switchMapping == null) {
      return null;
    }
    return switchMapping.applyDefault(environment,templateSwitch,mappingName,context);
  }
  try {
    RuleConsequenceProcessor rcp=new RuleConsequenceProcessor(environment);
    if (!rcp.prepare(defaultConsequence,templateSwitch.resolve(MPSModuleRepository.getInstance()),context)) {
      environment.getGenerator().showErrorMessage(context.getInput(),templateSwitch.resolve(MPSModuleRepository.getInstance()),defaultConsequence,"error processing $SWITCH$/default");
      return null;
    }
    return rcp.processRuleConsequence(mappingName);
  }
 catch (  AbandonRuleInputException ex) {
    return Collections.emptyList();
  }
}
