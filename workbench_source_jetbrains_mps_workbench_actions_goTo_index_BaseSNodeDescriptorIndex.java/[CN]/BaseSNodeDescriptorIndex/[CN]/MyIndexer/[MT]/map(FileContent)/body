{
  final Map<String,SNodeDescriptor> result=new HashMap<String,SNodeDescriptor>();
  ModelAccess.instance().runIndexing(new Runnable(){
    public void run(){
      try {
        SModel model=inputData.getUserData(PARSED_MODEL);
        if (model == null) {
          model=ModelPersistence.readModel(inputData.getContentAsText());
          if (model != null) {
            model.setLoading(true);
          }
          inputData.putUserData(PARSED_MODEL,model);
        }
        if (model == null)         return;
        List<SNode> nodes=getNodesToIterate(model);
        for (        final SNode node : nodes) {
          String persistentName=node.getPersistentProperty(INamedConcept.NAME);
          String nodeName=(persistentName == null) ? "null" : persistentName;
          String conceptFqName=node.getConceptFqName();
          SModelReference modelRef=model.getSModelReference();
          int number=nodes.indexOf(node);
          SNodeDescriptor value=SNodeDescriptor.fromModelReference(nodeName,conceptFqName,modelRef,number);
          result.put("" + result.size(),value);
        }
      }
 catch (      JDOMException e) {
        handleException(e,inputData);
      }
catch (      IOException e) {
        handleException(e,inputData);
      }
    }
  }
);
  return result;
}
