{
  Element rootElement=new Element(MODEL);
  rootElement.setAttribute(NAMESPACE,sourceModel.getNamespace());
  Document document=new Document();
  document.setRootElement(rootElement);
  Element maxRefID=new Element(MAX_REFERENCE_ID);
  maxRefID.setAttribute(VALUE,"" + sourceModel.getMaxReferenceID());
  rootElement.addContent(maxRefID);
  for (  String languageNamespace : sourceModel.getLanguageNamespaces()) {
    Element languageElem=new Element(LANGUAGE);
    languageElem.setAttribute(NAMESPACE,languageNamespace);
    rootElement.addContent(languageElem);
  }
  Iterator<SModel.ImportElement> imports=sourceModel.importElements();
  while (imports.hasNext()) {
    SModel.ImportElement importElement=imports.next();
    Element importElem=new Element(IMPORT_ELEMENT);
    importElem.setAttribute(MODEL_REFERENCE_ID,"" + importElement.getReferenceID());
    String fqName=importElement.getModelFQName();
    importElem.setAttribute(NAME,NameUtil.nameFromFQName(fqName));
    importElem.setAttribute(NAMESPACE,NameUtil.namespaceFromFQName(fqName));
    importElem.setAttribute(STEREOTYPE,importElement.getModelKey().myStereotype);
    rootElement.addContent(importElem);
  }
  Iterator<SNode> iterator=sourceModel.roots();
  while (iterator.hasNext()) {
    SNode semanticNode=iterator.next();
    saveNode(rootElement,semanticNode);
  }
  return document;
}
