{
  StringBuffer sb=new StringBuffer();
  if (myMessageHandler.getGenerationErrors().size() > 0) {
    sb.append("Generation errors:\n");
    for (    String e : myMessageHandler.getGenerationErrors()) {
      sb.append("  ");
      sb.append(e);
      sb.append("\n");
    }
    sb.append("\n");
  }
  printCompilationResult(compilationResult,sb);
  if (testFailures.size() > 0) {
    sb.append("Test Failures:\n");
    for (    TestFailure failure : testFailures) {
      sb.append("  ");
      StringWriter writer=new StringWriter();
      failure.thrownException().printStackTrace(new PrintWriter(writer));
      sb.append(writer.getBuffer());
      sb.append("\n");
    }
    sb.append("\n");
  }
  if (Boolean.parseBoolean(myWhatToDo.getProperty(TestGenerationOnTeamcity.SHOW_DIFF))) {
    if (diffReports.size() > 0) {
      sb.append("Difference:\n");
      for (      String diffReport : diffReports) {
        sb.append("  ");
        sb.append(diffReport);
        sb.append("\n");
      }
      sb.append("\n");
    }
  }
  return myBuildServerMessageFormat.escapeBuildMessage(sb);
}
