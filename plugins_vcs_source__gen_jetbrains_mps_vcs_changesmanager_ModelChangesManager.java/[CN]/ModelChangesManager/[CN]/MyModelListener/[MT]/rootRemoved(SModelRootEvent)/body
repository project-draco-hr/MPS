{
  myCommandQueue.runTask(new Runnable(){
    public void run(){
      if (!(checkLoaded()) && !(isNewModel())) {
        return;
      }
      fireChangeUpdateStarted();
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          recursivelyChildRemoved(e.getRoot());
          removeChanges(OldChange.class,new _FunctionTypes._return_P1_E0<Boolean,OldChange>(){
            public Boolean invoke(            OldChange ch){
              return !(ch instanceof NewNodeChange || ch instanceof DeleteNodeChange) && ObjectUtils.equals(ch.getAffectedNodeId(),e.getRoot().getSNodeId());
            }
          }
);
          removeChildChanges(e.getRoot().getSNodeId());
          if (removeChanges(OldAddRootChange.class,new _FunctionTypes._return_P1_E0<Boolean,OldAddRootChange>(){
            public Boolean invoke(            OldAddRootChange ch){
              return ObjectUtils.equals(ch.getAffectedNodeId(),e.getRoot().getSNodeId());
            }
          }
) == 0) {
            addChange(new DeleteNodeChange(e.getRoot().getSNodeId(),SModelUtils.getNodeIds(e.getRoot().getChildren())),e.getRoot());
          }
        }
      }
);
      fireChangeUpdateFinished();
    }
  }
);
}
