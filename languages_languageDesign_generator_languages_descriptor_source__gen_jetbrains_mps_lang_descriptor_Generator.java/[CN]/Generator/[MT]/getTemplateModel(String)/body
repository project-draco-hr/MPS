{
  ReloadableModule module=(ReloadableModule)ModuleRepositoryFacade.getInstance().getModule(getReference());
  Class<TemplateModel> clazz=null;
  if (module != null && module.willLoad()) {
    try {
      clazz=(Class<TemplateModel>)module.getClass(modelName);
    }
 catch (    ClassNotFoundException e) {
      throw new IllegalStateException("Class not found for model " + modelName,e);
    }
  }
  if (clazz == null) {
    throw new IllegalStateException(String.format("Failed to obtain generator runtime class for model %s",modelName));
  }
  try {
    return clazz.getConstructor(TemplateModule.class).newInstance(this);
  }
 catch (  RuntimeException ex) {
    throw ex;
  }
catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
