{
  String title=mySettings.getTitle();
  if (myTree.getSelectionPath() == null) {
    throw new InvalidInputValueException(title + ": nothing is selected");
  }
  MPSTreeNode node=(MPSTreeNode)myTree.getSelectionPath().getLastPathComponent();
  if (node instanceof SModelTreeNode) {
    throw new InvalidInputValueException(title + ": selected value should not not be a model");
  }
  if (!(node instanceof SNodeTreeNode)) {
    throw new InvalidInputValueException(title + ": nothing is selected");
  }
  SNode sNode=((SNodeTreeNode)node).getSNode();
  if (!mySettings.met(sNode)) {
    throw new InvalidInputValueException(title + ": refactoring can't be applied to selected node");
  }
  myContext.setParameter(myParamName,sNode);
}
