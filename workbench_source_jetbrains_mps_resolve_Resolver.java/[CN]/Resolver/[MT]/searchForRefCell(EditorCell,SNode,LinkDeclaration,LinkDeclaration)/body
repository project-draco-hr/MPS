{
  Set<EditorCell> frontier=new HashSet<EditorCell>();
  Set<EditorCell> newFrontier=new HashSet<EditorCell>();
  EditorCell foundCell=null;
  frontier.add(editorCell);
  while (!frontier.isEmpty()) {
    for (    EditorCell cell : frontier) {
      LinkDeclaration userObject=cell.getLinkDeclaration();
      if (cell.getSNode() == sourceNode) {
        if (userObject == refLinkDeclaration) {
          return cell;
        }
        if (childLinkDeclaration != null && userObject == childLinkDeclaration) {
          if (foundCell == null)           foundCell=cell;
        }
      }
      if (cell instanceof EditorCell_Collection) {
        Iterator<EditorCell> cells=((EditorCell_Collection)cell).cells();
        newFrontier.addAll(IterableUtil.asCollection(IterableUtil.asIterable(cells)));
      }
    }
    frontier=newFrontier;
    newFrontier=new HashSet<EditorCell>();
  }
  return foundCell;
}
