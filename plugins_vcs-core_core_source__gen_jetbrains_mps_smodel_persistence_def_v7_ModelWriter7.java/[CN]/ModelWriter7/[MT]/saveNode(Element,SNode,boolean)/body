{
  saveNodeAttributes(nodeElement,node);
  for (  String propertyName : node.getPropertyNames()) {
    Element propertyElement=new Element(VCSPersistenceSupport.PROPERTY);
    propertyElement.setAttribute(VCSPersistenceSupport.NAME,myHelper.genName(node,propertyName));
    DocUtil.setNotNullAttribute(propertyElement,VCSPersistenceSupport.NAME_ID,myHelper.genNameId(node,propertyName));
    DocUtil.setNotNullAttribute(propertyElement,VCSPersistenceSupport.VALUE,node.getProperty(propertyName));
    nodeElement.addContent(propertyElement);
  }
  for (  SReference reference : node.getReferences()) {
    Element linkElement=new Element(VCSPersistenceSupport.LINK);
    linkElement.setAttribute(VCSPersistenceSupport.ROLE,myHelper.genRole(reference));
    DocUtil.setNotNullAttribute(linkElement,VCSPersistenceSupport.ROLE_ID,myHelper.genRoleId(reference));
    linkElement.setAttribute(VCSPersistenceSupport.TARGET_NODE_ID,myHelper.genTarget(reference));
    DocUtil.setNotNullAttribute(linkElement,VCSPersistenceSupport.RESOLVE_INFO,myHelper.genResolveInfo(reference));
    nodeElement.addContent(linkElement);
  }
  if (saveChildren) {
    for (    SNode childNode : node.getChildren()) {
      Element childElement=new Element(VCSPersistenceSupport.NODE);
      saveNode(childElement,childNode,true);
      nodeElement.addContent(childElement);
    }
  }
}
