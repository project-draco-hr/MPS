{
  myProject=project;
  FileEditorManagerListener editorManagerListener=new FileEditorManagerListener(){
    public void fileOpened(    FileEditorManager source,    VirtualFile file){
      updateInformation();
      FileEditor selectedEditor=source.getSelectedEditor(file);
      if (selectedEditor instanceof MPSFileNodeEditor) {
        MPSFileNodeEditor editor=(MPSFileNodeEditor)selectedEditor;
        fireEditorOpened(editor.getNodeEditor());
      }
    }
    public void fileClosed(    FileEditorManager source,    VirtualFile file){
      updateInformation();
    }
    public void selectionChanged(    FileEditorManagerEvent event){
      updateInformation();
    }
  }
;
  updateInformation();
  myMessageBusConnection=myProject.getMessageBus().connect();
  myMessageBusConnection.subscribe(FileEditorManagerListener.FILE_EDITOR_MANAGER,editorManagerListener);
  myMessageBusConnection.subscribe(FileEditorManagerListener.Before.FILE_EDITOR_MANAGER,new Before(){
    @Override public void beforeFileOpened(    FileEditorManager source,    VirtualFile file){
    }
    @Override public void beforeFileClosed(    FileEditorManager source,    VirtualFile file){
      updateInformation();
      FileEditor selectedEditor=source.getSelectedEditor(file);
      if (selectedEditor instanceof MPSFileNodeEditor) {
        MPSFileNodeEditor editor=(MPSFileNodeEditor)selectedEditor;
        fireEditorClosed(editor.getNodeEditor());
      }
    }
  }
);
}
