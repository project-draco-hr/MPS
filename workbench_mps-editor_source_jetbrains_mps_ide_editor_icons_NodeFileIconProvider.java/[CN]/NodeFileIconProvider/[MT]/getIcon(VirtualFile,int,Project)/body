{
  if (file instanceof MPSNodeVirtualFile) {
    final MPSNodeVirtualFile nodeFile=(MPSNodeVirtualFile)file;
    return ModelAccess.instance().runReadAction(new Computable<Icon>(){
      public Icon compute(){
        SNode node=MPSEditorUtil.getCurrentEditedNode(project,nodeFile);
        if (node != null) {
          return IconManager.getIconWithoutAdditionalPart(node);
        }
        node=nodeFile.getNode();
        if (node != null) {
          return IconManager.getIconWithoutAdditionalPart(node);
        }
        return null;
      }
    }
);
  }
  return null;
}
