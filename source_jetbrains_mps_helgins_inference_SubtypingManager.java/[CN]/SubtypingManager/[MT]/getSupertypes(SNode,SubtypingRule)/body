{
  if (rule.getApplicableNode() == null)   return null;
  AnalyzedTermDeclaration analyzedTermDeclaration=rule.getApplicableNode();
  VariableCondition termCondition=analyzedTermDeclaration.getCondition();
  ConditionMatcher conditionMatcher;
  try {
    conditionMatcher=new ConditionMatcher(termCondition);
  }
 catch (  InvalidConditionException ex) {
    error("invalid condition",ex);
    return null;
  }
  ExpressionContext expressionContext=new ExpressionContext();
  if (!(conditionMatcher.matchesCondition(term,expressionContext)))   return null;
  expressionContext.putNode(analyzedTermDeclaration,term);
  Object supertypeO=ExpressionEvaluatorManager.evaluate(expressionContext,rule.getSupertype());
  if (supertypeO instanceof SNode) {
    List<SNode> result=new ArrayList<SNode>();
    result.add((SNode)supertypeO);
    return result;
  }
  if (supertypeO instanceof List) {
    boolean isCorrect=true;
    for (    Object o : (List)supertypeO) {
      if (!(o instanceof SNode)) {
        isCorrect=false;
        break;
      }
    }
    if (isCorrect)     return (List<SNode>)supertypeO;
  }
  return null;
}
