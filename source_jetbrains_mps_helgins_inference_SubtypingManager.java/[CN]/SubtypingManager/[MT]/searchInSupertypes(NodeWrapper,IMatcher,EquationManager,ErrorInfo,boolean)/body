{
  StructuralNodeSet<?> frontier=new StructuralNodeSet();
  StructuralNodeSet<?> newFrontier=new StructuralNodeSet();
  StructuralNodeSet<?> yetPassed=new StructuralNodeSet();
  frontier.add(subRepresentator.getNode());
  while (!frontier.isEmpty()) {
    StructuralNodeSet<?> ancestors=new StructuralNodeSet();
    for (    SNode node : frontier) {
      ancestors.addAllStructurally(collectImmediateSupertypes(node,isWeak));
      for (      SNode passedNode : yetPassed) {
        ancestors.removeStructurally(passedNode);
      }
      ancestors.removeStructurally(node);
    }
    ArrayList<SNode> ancestorsSorted=new ArrayList<SNode>(ancestors);
    Collections.sort(ancestorsSorted,new Comparator<SNode>(){
      public int compare(      SNode o1,      SNode o2){
        return o2.depth() - o1.depth();
      }
    }
);
    for (    SNode ancestor : ancestorsSorted) {
      if (superRepresentator.matchesWith(NodeWrapper.createNodeWrapper(ancestor),equationManager,errorInfo)) {
        return true;
      }
    }
    newFrontier.addAllStructurally(ancestors);
    yetPassed.addAllStructurally(ancestors);
    frontier=newFrontier;
    newFrontier=new StructuralNodeSet();
  }
  return false;
}
