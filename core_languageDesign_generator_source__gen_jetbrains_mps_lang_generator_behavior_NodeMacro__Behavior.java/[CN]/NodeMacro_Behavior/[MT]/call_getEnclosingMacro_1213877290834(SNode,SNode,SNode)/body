{
  if (currentNode == null) {
    return null;
  }
  SNode result=null;
  for (  SNode currentAttribute : currentNode.getAllAttributes()) {
    if (SNodeOperations.isInstanceOf(currentAttribute,"jetbrains.mps.lang.generator.structure.NodeMacro")) {
      if (currentAttribute == currentMacro) {
        break;
      }
      result=SNodeOperations.cast(currentAttribute,"jetbrains.mps.lang.generator.structure.NodeMacro");
    }
  }
  if (result != null) {
    return result;
  }
  return NodeMacro_Behavior.call_getEnclosingMacro_1213877290834(thisNode,null,SNodeOperations.getParent(currentNode));
}
