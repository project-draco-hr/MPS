{
  int resultingExpressionPriority=getPriority(SNodeOperations.getConceptDeclaration(resultNode)).ordinal();
  SNode targetNode=contextNode;
  for (SNode parentNode=SNodeOperations.getParent(targetNode); parentNode != null && SNodeOperations.isInstanceOf(parentNode,"jetbrains.mps.baseLanguage.structure.Expression") && getPriority(SNodeOperations.getConceptDeclaration(parentNode)).ordinal() < resultingExpressionPriority; parentNode=SNodeOperations.getParent(targetNode)) {
    if (SNodeOperations.isInstanceOf(parentNode,"jetbrains.mps.baseLanguage.structure.IMethodCall") || SNodeOperations.isInstanceOf(parentNode,"jetbrains.mps.baseLanguage.structure.ParenthesizedExpression")) {
      break;
    }
    targetNode=SNodeOperations.cast(parentNode,"jetbrains.mps.baseLanguage.structure.Expression");
  }
  return targetNode;
}
