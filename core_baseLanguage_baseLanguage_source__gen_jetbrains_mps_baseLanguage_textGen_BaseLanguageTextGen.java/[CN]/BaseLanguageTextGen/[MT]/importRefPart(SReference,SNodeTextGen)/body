{
  if (ref == null) {
    return;
  }
  String shortName=null;
  String packageName=null;
  if (ref instanceof DynamicReference) {
    shortName=ref.getResolveInfo();
    SModelReference modelReference=ref.getTargetSModelReference();
    if (modelReference != null) {
      packageName=modelReference.getLongName();
    }
    int dot=shortName.lastIndexOf(".");
    if (dot >= 0) {
      packageName=shortName.substring(0,dot);
      shortName=shortName.substring(dot + 1);
    }
  }
 else {
    SNode target=ref.getTargetNodeSilently();
    if (target == null) {
      return;
    }
    shortName=(SNodeOperations.isInstanceOf(target,"jetbrains.mps.baseLanguage.structure.Classifier") ? SPropertyOperations.getString(SNodeOperations.cast(target,"jetbrains.mps.baseLanguage.structure.Classifier"),"nestedName") : target.getResolveInfo());
    packageName=BaseLanguageTextGen.getPackageName(target,textGen);
  }
  BaseLanguageTextGen.appendClsName(packageName,shortName,false,textGen);
}
