{
  SNode errorNode=reporter.getSNode();
  Set<IErrorReporter> reporters=MapSequence.fromMap(myNodesToErrors).get(errorNode);
  if (reporters == null) {
    reporters=SetSequence.fromSet(new HashSet<IErrorReporter>());
    MapSequence.fromMap(myNodesToErrors).put(errorNode,reporters);
  }
  SetSequence.fromSet(reporters).addElement(reporter);
  addModelListener(SNodeOperations.getModel(ruleNode).getModelDescriptor());
  addModelListener(modelDescriptor);
  for (  SNode additional : additionalNodes) {
    addModelListener(SNodeOperations.getModel(additional).getModelDescriptor());
  }
  Set<SNode> dependencies=SetSequence.fromSetWithValues(new HashSet<SNode>(),additionalNodes);
  SetSequence.fromSet(dependencies).addElement(reporter.getSNode());
  for (  SNode dependency : dependencies) {
    Set<SNode> errorNodes=MapSequence.fromMap(myAdditionalToErrorNodes).get(dependency);
    if (errorNodes == null) {
      errorNodes=SetSequence.fromSet(new HashSet<SNode>());
      MapSequence.fromMap(myAdditionalToErrorNodes).put(dependency,errorNodes);
    }
    SetSequence.fromSet(errorNodes).addElement(errorNode);
  }
  Set<SNode> additional=MapSequence.fromMap(myErrorNodesToAdditional).get(errorNode);
  if (additional == null) {
    additional=SetSequence.fromSet(new HashSet<SNode>());
    MapSequence.fromMap(myErrorNodesToAdditional).put(errorNode,additional);
  }
  SetSequence.fromSet(additional).addSequence(SetSequence.fromSet(dependencies));
}
