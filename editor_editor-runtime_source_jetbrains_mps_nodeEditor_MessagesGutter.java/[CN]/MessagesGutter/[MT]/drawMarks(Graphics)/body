{
  removeBadMessages();
  Graphics2D g=(Graphics2D)graphics;
  List<SimpleEditorMessage> editorMessages=new ArrayList<SimpleEditorMessage>(myMessages);
  Collections.sort(editorMessages,new Comparator<SimpleEditorMessage>(){
    public int compare(    SimpleEditorMessage o1,    SimpleEditorMessage o2){
      if (o1 == o2)       return 0;
      if (o1 == null)       return -1;
      if (o2 == null)       return 1;
      if (o1 instanceof EditorMessage == o2 instanceof EditorMessage) {
        if (o1 instanceof EditorMessage) {
          if (((EditorMessage)o1).getStatus() == ((EditorMessage)o2).getStatus()) {
            return getMessageStart(o1) - getMessageStart(o2);
          }
 else {
            return ((EditorMessage)o1).getStatus().ordinal() - ((EditorMessage)o2).getStatus().ordinal();
          }
        }
 else {
          return getMessageStart(o1) - getMessageStart(o2);
        }
      }
 else {
        return o1 instanceof EditorMessage ? 1 : -1;
      }
    }
  }
);
  for (  SimpleEditorMessage msg : editorMessages) {
    if (msg == null || msg instanceof EditorMessage && !((EditorMessage)msg).isValid(myEditorComponent)) {
      continue;
    }
    int x=myRightToLeft ? 3 : 5;
    int width=Icons.OK.getIconWidth() - 1;
    if (!(msg instanceof EditorMessage)) {
      width/=2;
      width+=1;
      x=myRightToLeft ? width + 2 : 0;
    }
    Color color=msg.getColor();
    int messageY=getMessageStart(msg);
    int messageHeight=Math.max(getMessageHeight(msg),3);
    if (color == null)     continue;
    g.setColor(color);
    g.fillRect(x + 1,messageY,width - 2,messageHeight);
    Color brighter=color.brighter();
    g.setColor(brighter);
    UIUtil.drawLine(g,x,messageY,x,messageY + messageHeight);
    UIUtil.drawLine(g,x + 1,messageY,x + width - 2,messageY);
    Color darker=ColorUtil.shift(color,0.75);
    g.setColor(darker);
    UIUtil.drawLine(g,x + 1,messageY + messageHeight,x + width - 2,messageY + messageHeight);
    UIUtil.drawLine(g,x + width - 2,messageY,x + width - 2,messageY + messageHeight - 1);
  }
}
