{
  int height=msg.getHeight(myEditorComponent);
  if (msg instanceof EditorMessage) {
    EditorCell cell=((EditorMessage)msg).getCell(myEditorComponent);
    if (cell != null) {
      while (cell instanceof EditorCell_Collection) {
        cell=((EditorCell_Collection)cell).lastCell();
      }
      if (cell != null) {
        height-=cell.getHeight();
      }
    }
  }
  return (int)(height * (((double)getMessagesAreaHeight()) / ((double)myEditorComponent.getHeight()))) + 3;
}
