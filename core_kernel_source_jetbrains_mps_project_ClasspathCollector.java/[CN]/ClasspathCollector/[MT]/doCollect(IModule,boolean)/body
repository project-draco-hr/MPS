{
  try {
    myStack.push(current);
    if (myVisited.contains(current))     return;
    myVisited.add(current);
    if (includeStubSolutions || !isStubSolution(current)) {
      addPart(current.getClassPathItem());
    }
    for (    IModule dep : ModuleUtil.getAllDependOnModules(current)) {
      doCollect(dep,includeStubSolutions);
    }
    for (    Language l : ModuleUtil.getAllUsedLanguages(current)) {
      myStack.push(l);
      addPart(l.getLanguageRuntimeClasspath());
      for (      IModule runtimeModule : l.getRuntimeDependOnModules()) {
        doCollect(runtimeModule,includeStubSolutions);
      }
      myStack.pop();
    }
    if (current instanceof Language) {
      Language l=(Language)current;
      doCollect(Core_Language.get(),includeStubSolutions);
      for (      Language extended : l.getExtendedLanguages()) {
        doCollect(extended,includeStubSolutions);
      }
    }
  }
  finally {
    myStack.pop();
  }
}
