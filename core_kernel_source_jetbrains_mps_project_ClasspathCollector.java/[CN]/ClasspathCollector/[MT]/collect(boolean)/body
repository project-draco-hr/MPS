{
  for (  IModule m : myStart) {
    doCollect(m,true);
  }
  CompositeClassPathItem result=new CompositeClassPathItem();
  if (includeStubSolutions) {
    result.add(CommonPaths.getJDKClassPath());
    result.add(CommonPaths.getMPSClassPath());
    for (    Solution s : MPSModuleRepository.getInstance().getAllSolutions()) {
      if (s.isStub()) {
        result.add(s.getClassPathItem());
      }
    }
  }
  for (  IClassPathItem item : myResult) {
    result.add(item);
  }
  return result.optimize();
}
