{
  SNode root=node.getContainingRoot();
  if (root == null) {
    root=node.getTopmostAncestor();
  }
  if (useNewTypeSystem) {
    return new TypeCheckingContextNew(root,myTypeChecker,true);
  }
  return new TypeCheckingContext(root,myTypeChecker,true);
}
