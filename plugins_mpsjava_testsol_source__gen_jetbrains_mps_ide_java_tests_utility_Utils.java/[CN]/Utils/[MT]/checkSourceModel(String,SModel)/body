{
  try {
    JavaParser parser=new JavaParser();
    DirParser dirParser=new DirParser(ourModule,null,null);
    SModel result=SModelRepository.getInstance().getModelDescriptor(new SModelReference("jetbrains.mps.ide.java.testMaterial.placeholder","")).getSModel();
    for (    SNode r : ListSequence.fromList(SModelOperations.getRoots(result,null))) {
      SNodeOperations.detachNode(r);
    }
    List<SNode> nodes=dirParser.parseDir(parser,new File(dirPath));
    for (    SNode n : ListSequence.fromList(nodes)) {
      SModelOperations.addRootNode(result,n);
    }
    parser.tryResolveRoots(nodes);
    Map<SNode,SNode> referentMap=MapSequence.fromMap(new HashMap<SNode,SNode>());
    buildModelNodeMap(result,expected,referentMap);
    boolean wereErrors=compare2models(result,expected,referentMap);
    Assert.assertFalse(wereErrors);
  }
 catch (  JavaParseException e) {
    throw new RuntimeException(e);
  }
}
