{
  return new RunProfileState(){
    @Nullable public ExecutionResult execute(    Executor executor,    @NotNull ProgramRunner runner) throws ExecutionException {
      final ConsoleViewImpl consoleView_22042010=JavaConsoleCreator.createConsoleView(MPSDataKeys.PROJECT.getData(environment.getDataContext()));
      JComponent consoleComponent_22042010=null;
      Runnable consoleDispose_22042010=null;
      final List<AnAction> actions_22042010=ListSequence.fromList(new ArrayList<AnAction>());
      ProcessHandler handler_22042010=null;
      final Project project_22042010=environment.getProject();
      try {
        final ConfigRunParameters javaRunParameters=DefaultCustomMpsApplication_Configuration.this.getStateObject().myJavaRunParameters.copy();
        final SNode node=DefaultCustomMpsApplication_Configuration.this.getNodeForExecution(environment.getProject(),(javaRunParameters).getMake());
{
          ListSequence.fromList(actions_22042010).addSequence(ListSequence.fromList(new _FunctionTypes._return_P0_E0<List<AnAction>>(){
            public List<AnAction> invoke(){
{
                final List<AnAction> actionsList=ListSequence.fromListAndArray(new ArrayList<AnAction>(),consoleView_22042010.createConsoleActions());
                return actionsList;
              }
            }
          }
.invoke()));
          consoleComponent_22042010=consoleView_22042010.getComponent();
          consoleDispose_22042010=new Runnable(){
            public void run(){
              Disposer.dispose(consoleView_22042010);
            }
          }
;
          final Wrappers._T<ExecutionException> ex=new Wrappers._T<ExecutionException>(null);
          handler_22042010=(ProcessHandler)new _FunctionTypes._return_P0_E1<DefaultProcessHandler,ExecutionException>(){
            public DefaultProcessHandler invoke() throws ExecutionException {
              try {
                final SNode configuration=DefaultCustomMpsApplication_Configuration.this.getConfiguration(node);
                if (configuration == null) {
                  throw new ExecutionException("Configuration is not selected.");
                }
                final Wrappers._boolean isMPSBuildIncluded=new Wrappers._boolean();
                ModelAccess.instance().runReadAction(new Runnable(){
                  public void run(){
                    SNode mpsbuild=ListSequence.fromList(SNodeOperations.getDescendants(node,"jetbrains.mps.build.custommps.structure.MPSBuild",false,new String[]{})).first();
                    if ((mpsbuild == null)) {
                      mpsbuild=ListSequence.fromList(SNodeOperations.getDescendants(node,"jetbrains.mps.build.custommps.structure.MPSDistribution",false,new String[]{})).first();
                    }
                    isMPSBuildIncluded.value=AbstractProjectComponent_Behavior.call_included_1213877333807(mpsbuild,configuration);
                  }
                }
);
                final Wrappers._T<EditableSModelDescriptor> model=new Wrappers._T<EditableSModelDescriptor>();
                final Wrappers._T<ModuleContext> context=new Wrappers._T<ModuleContext>();
                ModelAccess.instance().runReadAction(new Runnable(){
                  public void run(){
                    model.value=((EditableSModelDescriptor)SNodeOperations.getModel(node).getModelDescriptor());
                    context.value=new ModuleContext(model.value.getModule(),project_22042010);
                  }
                }
);
                File file=GenerateTextFromBuild.generate(configuration,model.value,context.value,project_22042010,true);
                if (file == null) {
                  throw new ExecutionException("No executable file were generated.");
                }
                if (isMPSBuildIncluded.value) {
                  String path=file.getAbsolutePath();
                  String suffix=".xml";
                  file=new File(path.substring(0,path.length() - suffix.length()) + DistribConfiguration_Behavior.getSuffix_1240229578757() + suffix);
                }
                AntScriptRunner runner=new AntScriptRunner(javaRunParameters);
                Process process=runner.run(file);
                return new DefaultProcessHandler(consoleView_22042010,process,runner.getCommandString());
              }
 catch (              ExecutionException e) {
                ex.value=e;
                return null;
              }
            }
          }
.invoke();
          if (ex.value != null) {
            throw ex.value;
          }
        }
      }
 catch (      Throwable t) {
        if (t instanceof ExecutionException) {
          throw (ExecutionException)t;
        }
 else {
          Logger.getLogger(DefaultCustomMpsApplication_Configuration.class).error(t);
          throw new ExecutionException("Execution code threw an exception: " + t.getMessage(),t);
        }
      }
      if (handler_22042010 == null) {
        throw new ExecutionException("Process handler is null");
      }
      return new DefaultCustomMpsApplication_Configuration.MyExecutionResult(handler_22042010,ListSequence.fromList(actions_22042010).toGenericArray(AnAction.class),new DefaultCustomMpsApplication_Configuration.MyExecutionConsole(consoleComponent_22042010,consoleDispose_22042010));
    }
    public RunnerSettings getRunnerSettings(){
      return null;
    }
    public ConfigurationPerRunnerSettings getConfigurationSettings(){
      return null;
    }
  }
;
}
