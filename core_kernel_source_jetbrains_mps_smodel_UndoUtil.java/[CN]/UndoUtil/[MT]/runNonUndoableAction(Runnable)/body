{
  if (!ThreadUtils.isEventDispatchThread()) {
    r.run();
  }
 else {
    if (ourUndoBlocked) {
      LOG.errorWithTrace("non-undoable actions can not be nested");
      return;
    }
    setUndoBlocked();
    try {
      r.run();
    }
  finally {
      setUndoUnblocked();
    }
  }
}
