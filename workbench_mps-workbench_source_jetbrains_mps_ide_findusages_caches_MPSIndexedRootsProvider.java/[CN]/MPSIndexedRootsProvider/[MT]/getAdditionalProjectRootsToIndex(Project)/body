{
  final Set<VirtualFile> files=new HashSet<VirtualFile>();
  final jetbrains.mps.project.Project mpsProject=ProjectHelper.toMPSProject(project);
  mpsProject.getModelAccess().runReadAction(new Runnable(){
    @Override public void run(){
      for (      final SModule m : mpsProject.getRepository().getModules()) {
        for (        String path : getIndexablePaths(m)) {
          VirtualFile file=VirtualFileUtils.getVirtualFile(path);
          if (file == null)           continue;
          files.add(file);
        }
      }
    }
  }
);
  return files;
}
