{
  SearchResults results=new SearchResults();
{
    SNode searchedNode=searchQuery.getNodePointer().getNode();
    results.getSearchedNodePointers().add(new SNodePointer(searchedNode));
    List<SNode> derived=new ArrayList<SNode>();
    ListOperations.addElement(derived,(SNode)searchedNode);
    while (!(SequenceOperations.isEmpty(derived))) {
      Set<SReference> resRefs=FindUsagesManager.getInstance().findUsages(SequenceOperations.getFirst(derived),searchQuery.getScope());
      for (      SReference reference : resRefs) {
        SNode node=reference.getSourceNode();
        if (SNodeOperations.isInstanceOf(SNodeOperations.getParent(node,null,false,false),"jetbrains.mps.baseLanguage.structure.Interface")) {
          if (SNodeOperations.hasRole(node,"jetbrains.mps.baseLanguage.structure.Interface","extendedInterface")) {
            ListOperations.addElement(derived,SNodeOperations.getParent(node,null,false,false));
          }
        }
      }
      for (      SReference reference : resRefs) {
        SNode node=reference.getSourceNode();
        if (SNodeOperations.isInstanceOf(SNodeOperations.getParent(node,null,false,false),"jetbrains.mps.baseLanguage.structure.ClassConcept")) {
          if (SNodeOperations.hasRole(node,"jetbrains.mps.baseLanguage.structure.ClassConcept","implementedInterface")) {
            results.getSearchResults().add(new SearchResult(new SNodePointer(node),"Implementing Classes"));
          }
        }
      }
      ListOperations.removeElement(derived,SequenceOperations.getFirst(derived));
    }
  }
  return results;
}
