{
  if (selection == null || selection.getSelectedCells().size() == 0) {
    TextBuilder.getEmptyTextBuilder();
  }
  List<EditorCell> selectedCells=selection.getSelectedCells();
  EditorCell firstSelectedCell=selectedCells.get(0);
  if (selectedCells.size() == 1) {
    return firstSelectedCell.renderText();
  }
  EditorCell_Collection parentCell=firstSelectedCell.getParent();
  CellLayout layout=parentCell.getCellLayout();
  return layout.doLayoutText(selectedCells);
}
