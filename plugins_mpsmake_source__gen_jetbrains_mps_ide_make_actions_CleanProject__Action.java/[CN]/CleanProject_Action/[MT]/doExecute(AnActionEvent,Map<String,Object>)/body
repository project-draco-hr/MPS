{
  final Set<SModule> modulesToBuild=SetSequence.fromSet(new LinkedHashSet<SModule>());
  SetSequence.fromSet(modulesToBuild).addSequence(ListSequence.fromList(event.getData(MPSCommonDataKeys.MPS_PROJECT).getProjectModules(SModule.class)));
  ProgressManager.getInstance().run(new Task.Modal(event.getData(CommonDataKeys.PROJECT),"Cleaning",true){
    @Override public void run(    @NotNull final ProgressIndicator indicator){
      event.getData(MPSCommonDataKeys.MPS_PROJECT).getModelAccess().runReadAction(new Runnable(){
        public void run(){
          ModuleMaker maker=new ModuleMaker();
          maker.clean(modulesToBuild,new ProgressMonitorAdapter(indicator));
        }
      }
);
    }
  }
);
}
