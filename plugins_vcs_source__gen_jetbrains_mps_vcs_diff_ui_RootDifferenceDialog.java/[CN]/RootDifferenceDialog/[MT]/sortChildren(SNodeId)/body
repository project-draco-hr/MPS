{
  SNode newNode=myNewModel.getNodeById(nodeId);
  SNode oldNode=myOldModel.getNodeById(nodeId);
  if (newNode == null || oldNode == null) {
    return;
  }
  LinkedHashSet<String> rolesOrder=new LinkedHashSet<String>();
  for (  SNode child : oldNode.getChildrenIterable()) {
    rolesOrder.add(child.getRole_());
  }
  MultiMap<String,SNode> childrenForRoles=new MultiMap<String,SNode>();
  for (  SNode child : newNode.getChildrenIterable()) {
    childrenForRoles.putValue(child.getRole_(),child);
  }
  for (  SNode child : newNode.getChildren()) {
    newNode.removeChild(child);
  }
  for (  String role : rolesOrder) {
    for (    SNode child : childrenForRoles.get(role)) {
      newNode.addChild(role,child);
    }
  }
}
