{
  myModelDialog=modelDialog;
  myRootId=rootId;
  myOldEditor=addEditor(0,myModelDialog.getChangeSet().getOldModel());
  myNewEditor=addEditor(1,myModelDialog.getChangeSet().getNewModel());
  linkEditors(true);
  linkEditors(false);
  JSplitPane splitPane=new JSplitPane(JSplitPane.VERTICAL_SPLIT,myTopPanel,myBottomPanel);
  splitPane.setResizeWeight(0.7);
  RootDifferenceDialog.MyGoToNeighbourRootActions neighbourActions=new RootDifferenceDialog.MyGoToNeighbourRootActions();
  final NextPreviousTraverser neighbourTraverser=new NextPreviousTraverser(myChangeGroupLayouts,myNewEditor.getMainEditor());
  myActionGroup=ActionUtils.groupFromActions(neighbourActions.previous(),neighbourActions.next(),Separator.getInstance(),neighbourTraverser.previousAction(),neighbourTraverser.nextAction(),Separator.getInstance(),new RevertRootsAction(myModelDialog){
    protected SNodeId[] getRoots(){
      return new SNodeId[]{myRootId};
    }
    protected void after(){
      rehighlight();
    }
  }
);
  myActionToolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,myActionGroup,true);
  neighbourTraverser.setActionToolbar(myActionToolbar);
  myContainer.add(myActionToolbar.getComponent(),BorderLayout.NORTH);
  myContainer.add(splitPane,BorderLayout.CENTER);
  myContainer.add(myStatusBar,BorderLayout.SOUTH);
  highlightAllChanges();
  if (firstChange != null) {
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        neighbourTraverser.goToBounds(firstChange);
      }
    }
);
  }
 else {
    neighbourTraverser.goToFirstChangeLater();
  }
  final Dimension size=DimensionService.getInstance().getSize(getDimensionServiceKey());
  if (size == null) {
    DimensionService.getInstance().setSize(getDimensionServiceKey(),DialogDimensionsSettings.generateDialogDimensions(-100,-100).getDimensions());
  }
  init();
}
