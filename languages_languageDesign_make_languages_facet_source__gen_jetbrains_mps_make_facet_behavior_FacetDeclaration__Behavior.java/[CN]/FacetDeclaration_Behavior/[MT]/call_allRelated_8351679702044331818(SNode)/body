{
  Set<SNode> result=SetSequence.fromSet(new LinkedHashSet<SNode>());
  Queue<SNode> queue=QueueSequence.fromQueueAndArray(new LinkedList<SNode>(),__thisNode__);
  while (QueueSequence.fromQueue(queue).isNotEmpty()) {
    SNode fd=QueueSequence.fromQueue(queue).removeFirstElement();
    if (!(SetSequence.fromSet(result).contains(fd))) {
      SetSequence.fromSet(result).addElement(fd);
      QueueSequence.fromQueue(queue).addSequence(ListSequence.fromList(SLinkOperations.getChildren(fd,MetaAdapterFactory.getContainmentLink(0x696c11654a59463bL,0xbc5d902caab85dd0L,0x5912a2ab1cd24c13L,0x5979ed6d2b21b300L,"required"))).select(new ISelector<SNode,SNode>(){
        public SNode select(        SNode it){
          return SLinkOperations.getTarget(it,MetaAdapterFactory.getReferenceLink(0x696c11654a59463bL,0xbc5d902caab85dd0L,0x5979ed6d2b21b2f2L,0x5979ed6d2b21b2f3L,"facet"));
        }
      }
));
      QueueSequence.fromQueue(queue).addSequence(ListSequence.fromList(SLinkOperations.getChildren(fd,MetaAdapterFactory.getContainmentLink(0x696c11654a59463bL,0xbc5d902caab85dd0L,0x5912a2ab1cd24c13L,0x5979ed6d2b21b301L,"optional"))).select(new ISelector<SNode,SNode>(){
        public SNode select(        SNode it){
          return SLinkOperations.getTarget(it,MetaAdapterFactory.getReferenceLink(0x696c11654a59463bL,0xbc5d902caab85dd0L,0x5979ed6d2b21b2f2L,0x5979ed6d2b21b2f3L,"facet"));
        }
      }
));
    }
  }
  return result;
}
