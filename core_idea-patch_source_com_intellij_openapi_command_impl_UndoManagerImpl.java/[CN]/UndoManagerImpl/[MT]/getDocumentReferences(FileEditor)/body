{
  if (editor instanceof MPSFileNodeEditor) {
    MPSFileNodeEditor mpsEditor=(MPSFileNodeEditor)editor;
    Set<DocumentReference> result=new java.util.HashSet<DocumentReference>();
    result.addAll(Arrays.asList(mpsEditor.getDocumentReferences()));
    return result;
  }
  Set<DocumentReference> result=new THashSet<DocumentReference>();
  Document[] documents=editor == null ? null : TextEditorProvider.getDocuments(editor);
  if (documents != null) {
    for (    Document each : documents) {
      Document original=getOriginal(each);
      VirtualFile f=FileDocumentManager.getInstance().getFile(each);
      if (f != null && !f.isValid())       continue;
      result.add(DocumentReferenceManager.getInstance().create(original));
    }
  }
  return result;
}
