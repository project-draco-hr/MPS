{
  Element registry=new Element(ModelPersistence9.REGISTRY);
  for (  LangInfo ul : myMetaInfo.getLanguagesInUse()) {
    Element lang=new Element(ModelPersistence9.REGISTRY_LANGUAGE);
    lang.setAttribute(ModelPersistence9.ID,myIdEncoder.toText(ul.getLanguageId()));
    lang.setAttribute(ModelPersistence9.NAME,ul.getName());
    registry.addContent(lang);
    for (    ConceptInfo ci : ul.getConceptsInUse()) {
      Element conceptElement=new Element(ModelPersistence9.REGISTRY_CONCEPT);
      conceptElement.setAttribute(ModelPersistence9.ID,myIdEncoder.toText(ci.getConceptId()));
      conceptElement.setAttribute(ModelPersistence9.NAME,ci.getName());
      conceptElement.setAttribute(ModelPersistence9.FLAGS,ci.getImplementationKindText());
      conceptElement.setAttribute(ModelPersistence9.INDEX,ci.getIndex());
      for (      PropertyInfo pi : ci.getPropertiesInUse()) {
        Element e=new Element(ModelPersistence9.REGISTRY_PROPERTY);
        e.setAttribute(ModelPersistence9.ID,myIdEncoder.toText(pi.getPropertyId()));
        e.setAttribute(ModelPersistence9.NAME,pi.getName());
        e.setAttribute(ModelPersistence9.INDEX,pi.getIndex());
        conceptElement.addContent(e);
      }
      for (      AssociationLinkInfo li : ci.getAssociationsInUse()) {
        Element e=new Element(ModelPersistence9.REGISTRY_ASSOCIATION);
        e.setAttribute(ModelPersistence9.ID,myIdEncoder.toText(li.getLinkId()));
        e.setAttribute(ModelPersistence9.NAME,li.getName());
        e.setAttribute(ModelPersistence9.INDEX,li.getIndex());
        conceptElement.addContent(e);
      }
      for (      AggregationLinkInfo li : ci.getAggregationsInUse()) {
        Element e=new Element(ModelPersistence9.REGISTRY_AGGREGATION);
        e.setAttribute(ModelPersistence9.ID,myIdEncoder.toText(li.getLinkId()));
        e.setAttribute(ModelPersistence9.NAME,li.getName());
        e.setAttribute(ModelPersistence9.INDEX,li.getIndex());
        if (li.isUnordered()) {
          e.setAttribute(ModelPersistence9.UNORDERED,Boolean.TRUE.toString());
        }
        conceptElement.addContent(e);
      }
      lang.addContent(conceptElement);
    }
  }
  return registry;
}
