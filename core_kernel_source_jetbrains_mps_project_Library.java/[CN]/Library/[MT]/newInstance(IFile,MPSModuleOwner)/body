{
  Library solution=new Library();
  LibraryDescriptor descriptor;
  if (descriptorFile.exists()) {
    descriptor=LibraryDescriptorPersistence.loadLibraryDescriptor(descriptorFile);
    if (descriptor.getUUID() == null) {
      descriptor.setUUID(UUID.randomUUID().toString());
      LibraryDescriptorPersistence.saveLibraryDescriptor(descriptorFile,descriptor);
    }
  }
 else {
    descriptor=new LibraryDescriptor();
    descriptor.setUUID(UUID.randomUUID().toString());
  }
  solution.myDescriptorFile=descriptorFile;
  MPSModuleRepository repository=MPSModuleRepository.getInstance();
  if (repository.existsModule(descriptor.getModuleReference())) {
    LOG.error("Loading module " + descriptor.getNamespace() + " for the second time");
    return repository.getLibrary(descriptor.getModuleReference());
  }
  solution.setLibraryDescriptor(descriptor,false);
  repository.addModule(solution,moduleOwner);
  return solution;
}
