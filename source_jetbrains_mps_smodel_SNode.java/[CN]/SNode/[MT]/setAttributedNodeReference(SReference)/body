{
  final SReference oldReference=myAttributedNodeReference;
  if (reference == null) {
    myAttributedNodeReference=null;
  }
 else {
    myAttributedNodeReference=SReference.newInstance(ATTRIBUTED_NODE,this,reference);
  }
  if (!getModel().isLoading()) {
    UndoManager.instance().undoableActionPerformed(new IUndoableAction(){
      public void undo() throws UnexpectedUndoException {
        setAttributedNodeReference(oldReference);
      }
    }
);
  }
  if (oldReference != null) {
    getModel().fireReferenceRemovedEvent(oldReference);
  }
  if (reference != null) {
    getModel().fireReferenceAddedEvent(reference);
  }
}
