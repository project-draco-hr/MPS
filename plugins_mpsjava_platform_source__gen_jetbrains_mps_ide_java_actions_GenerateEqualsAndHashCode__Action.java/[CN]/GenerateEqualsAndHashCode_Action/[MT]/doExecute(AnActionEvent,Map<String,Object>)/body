{
  SNode classConcept=GenerateEqualsAndHashCode_Action.this.getClassConcept(_params);
  SNodeReference[] fields;
  fields=Sequence.fromIterable(((Iterable<SNode>)BHReflection.invoke(classConcept,SMethodTrimmedId.create("fields",MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c108ca66L,"jetbrains.mps.baseLanguage.structure.ClassConcept"),"4_LVZ3pC27C")))).select(new ISelector<SNode,SNodeReference>(){
    public SNodeReference select(    SNode it){
      return SNodeOperations.getPointer(it);
    }
  }
).toGenericArray(SNodeReference.class);
  SelectFieldsDialog selectFieldsDialog=new SelectFieldsDialog(fields,true,((MPSProject)MapSequence.fromMap(_params).get("mpsProject")));
  selectFieldsDialog.setTitle("Choose fields to be included in equals() and hashCode()");
  selectFieldsDialog.show();
  if (!(selectFieldsDialog.isOK())) {
    return;
  }
  SNodeReference[] selectedFields=Sequence.fromIterable(((Iterable<SNodeReference>)selectFieldsDialog.getSelectedElements())).toGenericArray(SNodeReference.class);
  final SNode thisExp=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf93d4da00cL,"jetbrains.mps.baseLanguage.structure.ThisExpression")),null);
  final SNode equalsDeclaration=_quotation_createNode_x9xljz_a0m0a(thisExp,thisExp,classConcept,classConcept);
  SNode thatDeclaration=SLinkOperations.getTarget(SNodeOperations.cast(ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(equalsDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).last(),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc67c7f0L,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclarationStatement")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc67c7f0L,0xf8cc67c7f1L,"localVariableDeclaration"));
  SNode thatRef=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,"jetbrains.mps.baseLanguage.structure.VariableReference")),null);
  SLinkOperations.setTarget(thatRef,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,0xf8cc6bf960L,"variableDeclaration"),thatDeclaration);
  SNode fieldRefLocal=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,"jetbrains.mps.baseLanguage.structure.VariableReference")),null);
  SNode fieldRefOperation=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x116b483d77aL,"jetbrains.mps.baseLanguage.structure.FieldReferenceOperation")),null);
  for (  SNodeReference fieldPtr : selectedFields) {
    SNode field=SNodeOperations.cast(fieldPtr.resolve(((MPSProject)MapSequence.fromMap(_params).get("mpsProject")).getRepository()),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c108ca68L,"jetbrains.mps.baseLanguage.structure.FieldDeclaration"));
    SLinkOperations.setTarget(fieldRefLocal,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,0xf8cc6bf960L,"variableDeclaration"),field);
    SLinkOperations.setTarget(fieldRefOperation,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x116b483d77aL,0x116b484a653L,"fieldDeclaration"),field);
    SNode checkStmt;
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x10f0ad8bde4L,"jetbrains.mps.baseLanguage.structure.PrimitiveType"))) {
      if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d327fdL,"jetbrains.mps.baseLanguage.structure.FloatType"))) {
        checkStmt=_quotation_createNode_x9xljz_a0a0a0f0u0a(thatRef,SNodeOperations.copyNode(fieldRefOperation),SNodeOperations.copyNode(fieldRefLocal));
      }
 else       if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d451a6L,"jetbrains.mps.baseLanguage.structure.DoubleType"))) {
        checkStmt=_quotation_createNode_x9xljz_a0a0a0a5a02a0(thatRef,SNodeOperations.copyNode(fieldRefOperation),SNodeOperations.copyNode(fieldRefLocal));
      }
 else {
        checkStmt=_quotation_createNode_x9xljz_a0a0a0a5a02a0_0(thatRef,SNodeOperations.copyNode(fieldRefOperation),SNodeOperations.copyNode(fieldRefLocal));
      }
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d819f7L,"jetbrains.mps.baseLanguage.structure.ArrayType"))) {
      checkStmt=_quotation_createNode_x9xljz_a0a0a5a02a0(SNodeOperations.copyNode(fieldRefLocal),thatRef,SNodeOperations.copyNode(fieldRefOperation));
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101de48bf9eL,"jetbrains.mps.baseLanguage.structure.ClassifierType"))) {
      checkStmt=_quotation_createNode_x9xljz_a0a0b5a02a0(thatRef,SNodeOperations.copyNode(fieldRefOperation),SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),thatRef,SNodeOperations.copyNode(fieldRefOperation));
    }
 else {
      checkStmt=_quotation_createNode_x9xljz_a0a0a5a02a0_0(thatRef,SNodeOperations.copyNode(fieldRefOperation),SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),thatRef,SNodeOperations.copyNode(fieldRefOperation));
    }
    ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(equalsDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(checkStmt);
  }
  SNodeFactoryOperations.addNewChild(SLinkOperations.getTarget(equalsDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"),SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b215L,"jetbrains.mps.baseLanguage.structure.Statement")));
  ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(equalsDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(_quotation_createNode_x9xljz_a0a22a0());
  ListSequence.fromList(SLinkOperations.getChildren(classConcept,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,0x4a9a46de59132803L,"member"))).addElement(equalsDeclaration);
  SNode hashCodeDeclaration=ListSequence.fromList(SLinkOperations.getChildren(classConcept,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,0x4a9a46de59132803L,"member"))).addElement(_quotation_createNode_x9xljz_a0a0z0a());
  SNode resultDeclaration=_quotation_createNode_x9xljz_a0ab0a();
  SNode resultReference=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,"jetbrains.mps.baseLanguage.structure.VariableReference")),null);
  SLinkOperations.setTarget(resultReference,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,0xf8cc6bf960L,"variableDeclaration"),SLinkOperations.getTarget(resultDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc67c7f0L,0xf8cc67c7f1L,"localVariableDeclaration")));
  SNode tempDeclaration=_quotation_createNode_x9xljz_a0db0a();
  SNode tempReference=SNodeFactoryOperations.createNewNode(SNodeFactoryOperations.asInstanceConcept(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,"jetbrains.mps.baseLanguage.structure.VariableReference")),null);
  SLinkOperations.setTarget(tempReference,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,0xf8cc6bf960L,"variableDeclaration"),SLinkOperations.getTarget(tempDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc67c7f0L,0xf8cc67c7f1L,"localVariableDeclaration")));
  if (Sequence.fromIterable(((Iterable<SNode>)BHReflection.invoke(classConcept,SMethodTrimmedId.create("fields",MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c108ca66L,"jetbrains.mps.baseLanguage.structure.ClassConcept"),"4_LVZ3pC27C")))).any(new IWhereFilter<SNode>(){
    public boolean accept(    SNode it){
      return SNodeOperations.isInstanceOf(SLinkOperations.getTarget(it,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d451a6L,"jetbrains.mps.baseLanguage.structure.DoubleType"));
    }
  }
)) {
    ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(hashCodeDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(tempDeclaration);
  }
  ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(hashCodeDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(resultDeclaration);
  for (  SNodeReference fieldPtr : selectedFields) {
    final SNode field=SNodeOperations.cast(fieldPtr.resolve(((MPSProject)MapSequence.fromMap(_params).get("mpsProject")).getRepository()),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c108ca68L,"jetbrains.mps.baseLanguage.structure.FieldDeclaration"));
    SLinkOperations.setTarget(fieldRefLocal,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c77f1e98L,0xf8cc6bf960L,"variableDeclaration"),field);
    SNode calcStatement;
    SNode mulExpression=_quotation_createNode_x9xljz_a0d0ib0a(resultReference);
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d22479L,"jetbrains.mps.baseLanguage.structure.IntegerType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0e0ib0a(resultReference,SNodeOperations.copyNode(fieldRefLocal),mulExpression);
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc67c7f3L,"jetbrains.mps.baseLanguage.structure.LongType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0a4a43a0(mulExpression,SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),resultReference);
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d5b617L,"jetbrains.mps.baseLanguage.structure.ByteType")) || SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d4f826L,"jetbrains.mps.baseLanguage.structure.CharType")) || SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940cc380dL,"jetbrains.mps.baseLanguage.structure.ShortType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0b4a43a0(SNodeOperations.copyNode(fieldRefLocal),mulExpression,resultReference);
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d451a6L,"jetbrains.mps.baseLanguage.structure.DoubleType"))) {
      ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(hashCodeDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(_quotation_createNode_x9xljz_a0a0a2e0ib0a(tempReference,SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal)));
      calcStatement=_quotation_createNode_x9xljz_a0b0c4a43a0(resultReference,mulExpression,tempReference,tempReference);
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d327fdL,"jetbrains.mps.baseLanguage.structure.FloatType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0d4a43a0(resultReference,mulExpression,SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal));
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x11d47da71ecL,"jetbrains.mps.baseLanguage.structure.StringType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0e4a43a0(resultReference,mulExpression,SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal));
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf940d819f7L,"jetbrains.mps.baseLanguage.structure.ArrayType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0f4a43a0(mulExpression,SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),resultReference);
    }
 else     if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(field,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101de48bf9eL,"jetbrains.mps.baseLanguage.structure.ClassifierType"))) {
      calcStatement=_quotation_createNode_x9xljz_a0a0g4a43a0(SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),mulExpression,resultReference);
    }
 else {
      calcStatement=_quotation_createNode_x9xljz_a0a0a4a43a0_0(SNodeOperations.copyNode(fieldRefLocal),SNodeOperations.copyNode(fieldRefLocal),mulExpression,resultReference);
    }
    ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(hashCodeDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(calcStatement);
  }
  ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(hashCodeDeclaration,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b1fcL,0xf8cc56b1ffL,"body")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b200L,0xf8cc6bf961L,"statement"))).addElement(_quotation_createNode_x9xljz_a0a53a0(resultReference));
  ((EditorContext)MapSequence.fromMap(_params).get("editorContext")).select(equalsDeclaration);
}
