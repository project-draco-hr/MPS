{
  SNode parent=SNodeOperations.getParent(expr);
  if (!(SNodeOperations.isInstanceOf(parent,"jetbrains.mps.baseLanguage.structure.BinaryOperation"))) {
    return null;
  }
  SNode parentOp=SNodeOperations.cast(parent,"jetbrains.mps.baseLanguage.structure.BinaryOperation");
  boolean right=toRight && SLinkOperations.getTarget(parentOp,"leftExpression",true) == expr;
  boolean left=!(toRight) && SLinkOperations.getTarget(parentOp,"rightExpression",true) == expr;
  if (right || left) {
    return parentOp;
  }
  return getBinOp(parentOp,toRight);
}
