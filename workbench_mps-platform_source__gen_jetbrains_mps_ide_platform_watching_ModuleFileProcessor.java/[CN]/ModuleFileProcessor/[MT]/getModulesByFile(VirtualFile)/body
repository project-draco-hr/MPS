{
  final Wrappers._T<List<IModule>> res=new Wrappers._T<List<IModule>>(ListSequence.fromList(new ArrayList<IModule>()));
  MPSModuleRepository repo=MPSModuleRepository.getInstance();
  final IFile mpsFile=FileSystem.getInstance().getFileByPath(file.getPath());
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      if (file.isDirectory()) {
        res.value=ModuleFileTracker.getInstance().findModulesUnderDir(file.getPath());
      }
 else {
        IModule module=ModuleFileTracker.getInstance().getModuleByFile(mpsFile);
        res.value=(module == null ? Collections.<IModule>emptyList() : Collections.singletonList(module));
      }
    }
  }
);
  return res.value;
}
