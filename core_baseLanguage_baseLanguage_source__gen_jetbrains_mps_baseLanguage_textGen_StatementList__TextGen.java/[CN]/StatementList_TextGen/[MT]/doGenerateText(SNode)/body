{
  int size=ListSequence.fromList(SLinkOperations.getTargets(node,"statement",true)).count();
  for (int i=0; i < size; i++) {
    SNode statement=ListSequence.fromList(ListSequence.fromList(SLinkOperations.getTargets(node,"statement",true)).toListSequence()).getElement(i);
    if ((i == size - 1) && (LastStatementUtil.canMakeReturnStatement(statement,null))) {
      SNode expressionStatement=SNodeOperations.cast(statement,"jetbrains.mps.baseLanguage.structure.ExpressionStatement");
      SNode returnStatement=SNodeOperations.cast(ReturnStatement.newInstance(SNodeOperations.getModel(statement)).getNode(),"jetbrains.mps.baseLanguage.structure.ReturnStatement");
      SNode expression=SNodeOperations.copyNode(SLinkOperations.getTarget(expressionStatement,"expression",true));
      SLinkOperations.setNewChild(expressionStatement,"expression","jetbrains.mps.baseLanguage.structure.Expression");
      SLinkOperations.setTarget(returnStatement,"expression",expression,true);
      statement=returnStatement;
      TextGenManager.instance().appendNodeText(this.getContext(),this.getBuffer(),statement,this.getSNode());
      SLinkOperations.setNewChild(returnStatement,"expression","jetbrains.mps.baseLanguage.structure.Expression");
      SLinkOperations.setTarget(expressionStatement,"expression",expression,true);
    }
 else {
      TextGenManager.instance().appendNodeText(this.getContext(),this.getBuffer(),statement,this.getSNode());
    }
  }
}
