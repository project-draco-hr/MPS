{
  String role=(String)targetCell.getUserObject(EditorCell.ROLE);
  if (role != null)   return role;
  EditorCell_Collection actualCollection=(targetCell instanceof EditorCell_Collection) ? (EditorCell_Collection)targetCell : targetCell.getParent();
  if (actualCollection != null)   role=actualCollection.getCellNodesRole();
  while (actualCollection != null && role == null) {
    actualCollection=actualCollection.getParent();
    if (actualCollection == null)     break;
    role=actualCollection.getCellNodesRole();
  }
  if (role == null) {
    SNode pasteTarget=targetCell.getSNode();
    role=pasteTarget.getRole_();
  }
  return role;
}
