{
  final List<IFile> newFiles=new ArrayList<IFile>();
  final List<IFile> updatedFiles=new ArrayList<IFile>();
  for (  IFile file : writtenFiles) {
    if (file.exists()) {
      updatedFiles.add(file);
    }
 else {
      newFiles.add(file);
    }
  }
  ModelAccess.instance().runWriteInEDT(new Runnable(){
    @Override public void run(){
      for (      IFile file : newFiles) {
        OutputStream out=null;
        try {
          byte[] content=StreamUtil.loadFromStream(new FileInputStream(file.getPath()));
          out=file.openOutputStream();
          out.write(content);
        }
 catch (        IOException e) {
          LOG.error(null,e);
        }
 finally {
          FileUtil.closeFileSafe(out);
        }
      }
      for (      IFile file : updatedFiles) {
        FileSystem.getInstance().refresh(file);
      }
    }
  }
);
}
