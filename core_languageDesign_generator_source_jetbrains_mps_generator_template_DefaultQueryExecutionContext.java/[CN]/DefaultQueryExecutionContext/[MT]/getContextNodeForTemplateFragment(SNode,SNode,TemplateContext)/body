{
  TemplateFragment fragment=TemplateFragment_AnnotationLink.getTemplateFragment((BaseConcept)templateFragmentNode.getAdapter());
  TemplateFragment_ContextNodeQuery query=fragment.getContextNodeQuery();
  if (query != null) {
    String methodName=TemplateFunctionMethodName.templateFragment_ContextNodeQuery(query.getNode());
    try {
      return (SNode)QueryMethodGenerated.invoke(methodName,generator.getGeneratorSessionContext(),new TemplateFragmentContext(mainContextNode,templateFragmentNode,context,generator),query.getModel());
    }
 catch (    NoSuchMethodException e) {
      generator.getLogger().warning(templateFragmentNode,"cannot find context node method for template fragment '" + methodName + "' : evaluate to null");
      return null;
    }
catch (    Exception e) {
      generator.showErrorMessage(context.getInput(),null,templateFragmentNode,"cannot evaluate template fragment context query");
      generator.getLogger().handleException(e);
      return null;
    }
  }
  return mainContextNode;
}
