{
  if (name.startsWith("java.")) {
    return Class.forName(name,false,BOOTSTRAP_CLASSLOADER);
  }
  Class<?> clazz=getClassFromCache(name);
  if (clazz != null) {
    return clazz;
  }
synchronized (this) {
    clazz=getClassFromCache(name);
    if (clazz != null) {
      return clazz;
    }
    try {
      clazz=findInSelfAndDependencies(name);
      if (resolve) {
        resolveClass(clazz);
      }
      return clazz;
    }
 catch (    ClassNotFoundException e) {
      throw e;
    }
catch (    RuntimeException re) {
      LOG.error("Exception during class loading",re);
      throw new ClassNotFoundException(name,re);
    }
 finally {
      if (clazz != null) {
        myClasses.put(name,clazz);
      }
 else {
        LOG.warn("Unable to load class: " + name + " using ModuleClassLoader of "+ mySupport.getModule().getModuleName()+ " module. It is recommended to use loadOwnClass() in such cases.",new Throwable());
      }
      myLoadedClasses.add(name);
    }
  }
}
