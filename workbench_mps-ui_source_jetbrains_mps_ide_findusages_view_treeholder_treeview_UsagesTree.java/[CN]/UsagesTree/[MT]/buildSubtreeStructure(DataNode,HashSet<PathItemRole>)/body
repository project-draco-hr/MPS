{
  List<UsagesTreeNode> children=new ArrayList<UsagesTreeNode>();
  for (  DataNode child : root.getChildren()) {
    children.addAll(buildSubtreeStructure(child,nodeCategories));
  }
  BaseNodeData data=root.getData();
  if (nodeCategories.contains(data.getRole()) || data.isResultNode()) {
    UsagesTreeNode node=new UsagesTreeNode("");
    node.setNodeIdentifier(data.getPlainText());
    node.setUserObject(root);
    for (    UsagesTreeNode child : children) {
      node.add(child);
    }
    children.clear();
    children.add(node);
  }
  return children;
}
