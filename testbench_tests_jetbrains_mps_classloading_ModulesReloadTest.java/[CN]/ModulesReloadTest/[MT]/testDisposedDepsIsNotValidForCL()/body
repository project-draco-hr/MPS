{
  final Language l1=createLanguage();
  addClassTo(l1);
  final Language l2=createLanguage();
  final Language l3=createLanguage();
  final Wrapper<Dependency> dep12=new Wrapper<Dependency>();
  final Wrapper<Dependency> dep13=new Wrapper<Dependency>();
  myAccess.runWriteAction(new Runnable(){
    @Override public void run(){
      dep12.setValue(l1.addDependency(l2.getModuleReference(),false));
      dep13.setValue(l1.addDependency(l3.getModuleReference(),false));
    }
  }
);
  Assert.assertTrue(classIsLoadableFromModule(l1));
  removeModule(l2);
  Assert.assertTrue(!classIsLoadableFromModule(l1));
  removeModule(l3);
  Assert.assertTrue(!classIsLoadableFromModule(l1));
  myAccess.runWriteAction(new Runnable(){
    @Override public void run(){
      l1.removeDependency(dep12.getValue());
    }
  }
);
  Assert.assertTrue(!classIsLoadableFromModule(l1));
  myAccess.runWriteAction(new Runnable(){
    @Override public void run(){
      l1.removeDependency(dep13.getValue());
    }
  }
);
  Assert.assertTrue(classIsLoadableFromModule(l1));
}
