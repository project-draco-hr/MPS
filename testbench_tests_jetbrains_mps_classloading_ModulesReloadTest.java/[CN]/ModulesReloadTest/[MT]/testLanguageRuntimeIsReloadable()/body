{
  final Reference<Language> language=new Reference<Language>();
  final Reference<Solution> runtime=new Reference<Solution>();
  final Reference<Solution> solution=new Reference<Solution>();
  getModelAccess().runWriteAction(new Runnable(){
    @SuppressWarnings("ConstantConditions") @Override public void run(){
      runtime.set(createSolution(SolutionKind.PLUGIN_OTHER));
      addClassTo(runtime.get());
      Assert.assertTrue(classIsLoadableFromModule(runtime.get()));
      language.set(createLanguage(runtime.get().getModuleReference()));
      solution.set(createSolution(SolutionKind.PLUGIN_OTHER));
      addUsedLanguage(solution.get(),language.get());
      removeModule(language.get());
      Language sameLanguage=createLanguage(language.get().getModuleDescriptor().getId(),language.get().getModuleName(),runtime.get().getModuleReference());
      solution.get().reload();
      Assert.assertTrue(classIsLoadableFromModule(solution.get()));
    }
  }
);
}
