{
  super(editorComponent);
  if (cellInfo != null) {
    throw new SelectionStoreException("Non-null CellInfo objet passed as a parameter: " + cellInfo);
  }
  myRole=properties.get(ROLE_PROPERTY_NAME);
  if (myRole == null) {
    throw new SelectionStoreException("Role property missed");
  }
  String modelId=properties.get(MODEL_ID_PROPERTY_NAME);
  if (modelId == null) {
    throw new SelectionStoreException("Model ID property missed");
  }
  SModelDescriptor sModelDescriptor=SModelRepository.getInstance().getModelDescriptor(SModelReference.fromString(modelId));
  if (sModelDescriptor == null) {
    throw new SelectionRestoreException();
  }
  SModel sModel=sModelDescriptor.getSModel();
  myFirstNode=findNode(sModel,properties,FIRST_NODE_ID_PROPERTY_NAME);
  myLastNode=findNode(sModel,properties,LAST_NODE_ID_PROPERTY_NAME);
  myParentNode=findNode(sModel,properties,PARENT_NODE_ID_PROPERTY_NAME);
  if (myParentNode != myFirstNode.getParent() || myParentNode != myLastNode.getParent()) {
    throw new SelectionRestoreException();
  }
  if (!myRole.equals(myFirstNode.getRole()) || !myRole.equals(myLastNode.getRole())) {
    throw new SelectionRestoreException();
  }
  initSelectedCells();
}
