{
  if (!(myModule instanceof Language)) {
    return;
  }
  myLanguage=((Language)myModule);
{
    final SearchScope scope=CommandUtil.createScope(myModule);
    QueryExecutionContext context=new QueryExecutionContext(){
      public SearchScope getDefaultSearchScope(){
        return scope;
      }
    }
;
    Collection<SNode> allSideTransformActions=CommandUtil.instances(CommandUtil.createConsoleScope(null,false,context),MetaAdapterFactory.getConcept(0xaee9cad2acd44608L,0xaef20004f6a1cdbdL,0x108fad1c116L,"jetbrains.mps.lang.actions.structure.SideTransformHintSubstituteActions"));
    for (    SNode actions : CollectionSequence.fromCollection(allSideTransformActions)) {
      for (      SNode builder : ListSequence.fromList(SLinkOperations.getChildren(actions,MetaAdapterFactory.getContainmentLink(0xaee9cad2acd44608L,0xaef20004f6a1cdbdL,0x108fad1c116L,0x108fad1c117L,"actionsBuilder")))) {
        addBuilderToMap(actions,builder);
        addBuilderToMenuMap(actions,builder);
      }
    }
    Set<SNode> actionsKeySet=myActionsToConceptAndTagToBuilder.keySet();
    for (    SNode actions : SetSequence.fromSet(actionsKeySet)) {
      Map<Pair<SNode,String>,List<SNode>> conceptAndTagToBuilder=myActionsToConceptAndTagToBuilder.get(actions);
      for (      Pair<SNode,String> key : SetSequence.fromSet(conceptAndTagToBuilder.keySet())) {
        migrateSideTransformActions(actions,key.o1,key.o2,conceptAndTagToBuilder.get(key));
      }
    }
    Iterable<SNode> cellsWithTags=CollectionSequence.fromCollection(CommandUtil.instances(CommandUtil.createConsoleScope(null,false,context),MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xf9eafb9a39L,"jetbrains.mps.lang.editor.structure.EditorCellModel"))).where(new IWhereFilter<SNode>(){
      public boolean accept(      SNode it){
        return Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(it,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x11beb039542L,0x11beb040d06L,"styleItem")),MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x11abb1e8d85L,"jetbrains.mps.lang.editor.structure.SideTransformAnchorTagStyleClassItem"))).isNotEmpty();
      }
    }
);
    for (    SNode cell : Sequence.fromIterable(cellsWithTags)) {
      String tag=SPropertyOperations.getString_def(Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(cell,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x11beb039542L,0x11beb040d06L,"styleItem")),MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x11abb1e8d85L,"jetbrains.mps.lang.editor.structure.SideTransformAnchorTagStyleClassItem"))).first(),MetaAdapterFactory.getProperty(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x11abb1e8d85L,0x11abb1e8d86L,"tag"),null);
      if (eq_t05i67_a0b0h0c0l(tag,"")) {
        continue;
      }
      SNode concept=SLinkOperations.getTarget(SNodeOperations.getNodeAncestor(cell,MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xfba0eb7c50L,"jetbrains.mps.lang.editor.structure.BaseEditorComponent"),false,false),MetaAdapterFactory.getReferenceLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x10f7df344a9L,0x10f7df451aeL,"conceptDeclaration"));
      if (concept == null) {
        continue;
      }
      SNode menu=null;
      if (isDefinedInLanguage(concept,myLanguage)) {
        menu=myMainMenus.get(new Pair<SNode,String>(concept,tag));
      }
 else {
        SModule module=SNodeOperations.getModel(concept).getModule();
        if (module instanceof Language) {
          menu=findMainNamedMenu(module,tag,concept);
        }
      }
      if (menu == null) {
        continue;
      }
      if (SNodeOperations.isInstanceOf(menu,MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x16be955f384efce1L,"jetbrains.mps.lang.editor.structure.TransformationMenu_Default"))) {
        SLinkOperations.setTarget(cell,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xf9eafb9a39L,0x3a52dff8e5ebd740L,"transformationMenu"),SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x5d3b34577b3cff0cL,"jetbrains.mps.lang.editor.structure.TransformationMenuReference_Default")));
        SLinkOperations.setTarget(SNodeOperations.cast(SLinkOperations.getTarget(cell,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xf9eafb9a39L,0x3a52dff8e5ebd740L,"transformationMenu")),MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x5d3b34577b3cff0cL,"jetbrains.mps.lang.editor.structure.TransformationMenuReference_Default")),MetaAdapterFactory.getReferenceLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x169efbc9a90a41c1L,0x169efbc9a91440deL,"concept"),concept);
      }
 else       if (SNodeOperations.isInstanceOf(menu,MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x4e0f93d8a0ac4ee8L,"jetbrains.mps.lang.editor.structure.TransformationMenu_Named"))) {
        SLinkOperations.setTarget(cell,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xf9eafb9a39L,0x3a52dff8e5ebd740L,"transformationMenu"),SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x5d3b34577b3cff09L,"jetbrains.mps.lang.editor.structure.TransformationMenuReference_Named")));
        SLinkOperations.setTarget(SNodeOperations.cast(SLinkOperations.getTarget(cell,MetaAdapterFactory.getContainmentLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0xf9eafb9a39L,0x3a52dff8e5ebd740L,"transformationMenu")),MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x5d3b34577b3cff09L,"jetbrains.mps.lang.editor.structure.TransformationMenuReference_Named")),MetaAdapterFactory.getReferenceLink(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x5d3b34577b3cff09L,0x5d3b34577b3cff0aL,"menu"),SNodeOperations.cast(menu,MetaAdapterFactory.getConcept(0x18bc659203a64e29L,0xa83a7ff23bde13baL,0x4e0f93d8a0ac4ee8L,"jetbrains.mps.lang.editor.structure.TransformationMenu_Named")));
      }
    }
  }
}
