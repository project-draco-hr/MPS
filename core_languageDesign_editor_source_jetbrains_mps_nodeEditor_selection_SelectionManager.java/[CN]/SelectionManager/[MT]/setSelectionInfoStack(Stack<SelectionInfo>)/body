{
  Selection oldSelection=getSelection();
  if (isSameSelectionStack(selectionStack)) {
    if (!isSelectionStackValid()) {
      mySelectionStack.clear();
      doChangeSelection(oldSelection,getSelection());
    }
    return;
  }
  mySelectionStack.clear();
  for (  SelectionInfo nextSelectionInfo : selectionStack) {
    Selection selection=nextSelectionInfo.createSelection(myEditorComponent);
    if (selection == null) {
      mySelectionStack.clear();
      break;
    }
    mySelectionStack.push(selection);
  }
  doChangeSelection(oldSelection,getSelection());
}
