{
  if (myCellWithSelectedBraces != null) {
    myCellWithSelectedBraces.setBracesSelected(false);
    myCellWithSelectedBraces=null;
  }
  if (getStyle().get(StyleAttributes.MATCHING_LABEL) == null) {
    if (getCaretPosition() == 0) {
      EditorCell cell=getPrevLeaf();
      if (cell instanceof EditorCell_Label) {
        EditorCell_Label label=(EditorCell_Label)cell;
        if (label.getBounds().getMaxX() == getBounds().getMinX() && getLeftInset() == 0) {
          myCellWithSelectedBraces=label;
          label.setBracesSelected(true);
        }
      }
    }
 else     if (getCaretPosition() == getText().length()) {
      EditorCell cell=getNextLeaf();
      if (cell instanceof EditorCell_Label) {
        EditorCell_Label label=(EditorCell_Label)cell;
        if (label.getBounds().getMinX() == getBounds().getMaxX() && getRightInset() == 0) {
          myCellWithSelectedBraces=label;
          label.setBracesSelected(true);
        }
      }
    }
  }
}
