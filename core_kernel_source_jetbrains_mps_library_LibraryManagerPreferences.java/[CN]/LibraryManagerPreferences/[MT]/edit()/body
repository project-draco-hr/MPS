{
  int index=myLibrariesList.getSelectedIndex();
  if (index == -1) {
    return;
  }
  Library l=(Library)myListModel.get(index);
  if (!l.canSetPath()) {
    JOptionPane.showMessageDialog(myMainPanel,"You can't edit a predefined library","Error",JOptionPane.ERROR_MESSAGE);
    return;
  }
  String path;
  if (UseTreeFileChooser.get()) {
    TreeFileChooser chooser=new TreeFileChooser();
    chooser.setMode(TreeFileChooser.MODE_DIRECTORIES);
    IFile result=chooser.showDialog(JOptionPane.getFrameForComponent(myMainPanel));
    if (result == null)     return;
    path=result.getAbsolutePath();
  }
 else {
    final JFileChooser chooser=new SmartFileChooser();
    chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
    if (chooser.showDialog(myMainPanel,"Select") != JFileChooser.APPROVE_OPTION) {
      return;
    }
    path=chooser.getSelectedFile().getAbsolutePath();
  }
  l.setPath(path);
  updateModel();
}
