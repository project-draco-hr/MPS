{
  int lastIndex=table.rowAtPoint(new Point(0,clip.y + clip.height - 1));
  if (lastIndex == -1) {
    lastIndex=table.getRowCount() - 1;
  }
  return lastIndex;
}
