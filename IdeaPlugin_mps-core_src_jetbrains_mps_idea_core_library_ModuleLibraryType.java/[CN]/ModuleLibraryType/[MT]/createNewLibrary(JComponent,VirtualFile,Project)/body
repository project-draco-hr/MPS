{
  List<ModuleReference> availableSolutions=calculateVisibleModules(Collections.<VirtualFile>emptySet());
  ChooseElementsDialog<ModuleReference> chooser=new ModuleReferenceChooserDialog(project,availableSolutions);
  chooser.show();
  List<ModuleReference> chosenElements=chooser.getChosenElements();
  if (chosenElements.isEmpty()) {
    return null;
  }
  String name=ModuleLibrariesUtil.LIBRARY_PREFIX + chosenElements.get(0).getModuleFqName();
  if (chosenElements.size() > 1) {
    name+="...";
  }
  final Set<OrderRoot> roots=createRootsFor(chosenElements);
  return new NewLibraryConfiguration(name,this,createDefaultProperties()){
    @Override public void addRoots(    @NotNull LibraryEditor editor){
      editor.addRoots(roots);
    }
  }
;
}
