{
  TemplateMappingConfiguration tmcA=newMapConfig("A",false);
  TemplateMappingConfiguration tmcB=newMapConfig("B",false);
  TemplateMappingConfiguration tmcC=newMapConfig("C",false);
  TemplateMappingConfiguration tmcD=newMapConfig("D",false);
  TemplateMappingConfiguration tmcE=newMapConfig("E",false);
  final List<TemplateMappingConfiguration> allConfigs=Arrays.asList(tmcA,tmcB,tmcC,tmcD,tmcE);
  mySolver.prepare(allConfigs);
  addStrict(tmcA,tmcD);
  addStrict(tmcB,tmcD);
  addStrict(tmcC,tmcD);
  addCoherentConfigs(tmcB,tmcE);
  final List<GenerationPhase> phases=mySolver.solve();
  assertFalse(myConflicts.hasConflicts());
  assertEquals(2,phases.size());
  final List<Group> groupsPhase1=phases.get(0).getGroups();
  final List<Group> groupsPhase2=phases.get(1).getGroups();
  assertEquals(3,groupsPhase1.size());
  assertEquals(1,groupsPhase2.size());
  final Set<Group> expectedPhase1=asSet(tmcA,tmcC);
  expectedPhase1.add(new Group(tmcB).union(new Group(tmcE)));
  assertEquals(expectedPhase1,new HashSet<Group>(groupsPhase1));
  assertEquals(new Group(tmcD),groupsPhase2.get(0));
}
