{
  TemplateMappingConfiguration tmcA=newMapConfig("A",false);
  TemplateMappingConfiguration tmcB=newMapConfig("B",false);
  TemplateMappingConfiguration tmcC=newMapConfig("C",false);
  TemplateMappingConfiguration tmcD=newMapConfig("D",false);
  TemplateMappingConfiguration tmcX=newMapConfig("X",false);
  TemplateMappingConfiguration tmcY=newMapConfig("Y",false);
  final List<TemplateMappingConfiguration> allConfigs=Arrays.asList(tmcA,tmcB,tmcC,tmcD,tmcX,tmcY);
  mySolver.prepare(allConfigs);
  addWeak(tmcA,tmcB);
  addStrict(tmcB,tmcC);
  addWeak(tmcB,tmcD);
  addStrict(tmcX,tmcA);
  addWeak(tmcY,tmcA);
  final List<GenerationPhase> phases=mySolver.solve();
  assertFalse(myConflicts.hasConflicts());
  assertEquals(4,phases.size());
  List<Group> groupsPhase1=phases.get(0).getGroups();
  List<Group> groupsPhase2=phases.get(1).getGroups();
  List<Group> groupsPhase3=phases.get(2).getGroups();
  List<Group> groupsPhase4=phases.get(3).getGroups();
  assertEquals(2,groupsPhase1.size());
  assertEquals(1,groupsPhase2.size());
  assertEquals(1,groupsPhase3.size());
  assertEquals(2,groupsPhase4.size());
  assertEquals(asSet(tmcX,tmcY),new HashSet<Group>(groupsPhase1));
  assertEquals(new Group(tmcA),groupsPhase2.get(0));
  assertEquals(new Group(tmcB),groupsPhase3.get(0));
  assertEquals(asSet(tmcC,tmcD),new HashSet<Group>(groupsPhase4));
}
