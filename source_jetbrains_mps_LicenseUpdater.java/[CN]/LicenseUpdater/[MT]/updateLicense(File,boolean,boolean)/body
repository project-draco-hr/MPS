{
  if (FileUtil.isIgnoredDir(current.getName()))   return;
  if (current.isDirectory()) {
    File[] files=current.listFiles();
    if (files == null)     return;
    for (    File f : files) {
      if (f.isDirectory()) {
        if (isSourceDir(f.getName()) && !inSourceGen) {
          updateLicense(f,true,inSourceGen);
        }
 else         if (isSourceGenDir(f.getName())) {
          updateLicense(f,inSourceDir,true);
        }
 else {
          updateLicense(f,inSourceDir,inSourceGen);
        }
      }
 else {
        updateLicense(f,inSourceDir,inSourceGen);
      }
    }
  }
 else   if (inSourceDir && !inSourceGen && current.getName().endsWith(".java")) {
    System.out.println("updating " + current);
    String contents=FileUtil.read(current);
    int packIndex=contents.indexOf("package");
    String withoutLicense=contents.substring(packIndex);
    withoutLicense=withoutLicense.replace("\n",LINE_SEPARATOR);
    String withLicense=LICENSE_TEXT + withoutLicense;
    FileUtil.write(current,withLicense);
  }
}
