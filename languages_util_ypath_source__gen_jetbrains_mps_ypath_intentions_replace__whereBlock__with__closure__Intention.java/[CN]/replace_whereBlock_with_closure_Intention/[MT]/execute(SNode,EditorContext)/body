{
  SNode cl=SNodeFactoryOperations.createNewNode("jetbrains.mps.baseLanguage.closures.structure.ClosureLiteral",null);
  SNode scpd=SNodeFactoryOperations.addNewChild(cl,"parameter","jetbrains.mps.baseLanguage.collections.structure.SmartClosureParameterDeclaration");
  SNode cp=SLinkOperations.getTarget(SLinkOperations.getTarget(node,"whereBlock",true),"parameter",true);
  SPropertyOperations.set(scpd,"name",SPropertyOperations.getString(cp,"name"));
  SLinkOperations.setTarget(cl,"body",SNodeOperations.detachNode(SLinkOperations.getTarget(SLinkOperations.getTarget(node,"whereBlock",true),"body",true)),true);
  for (  SNode dsc : ListSequence.<SNode>fromList(SNodeOperations.getDescendants(SLinkOperations.getTarget(cl,"body",true),"jetbrains.mps.baseLanguage.structure.ClosureParameterReference",false,new String[]{}))) {
    if (SLinkOperations.getTarget(SNodeOperations.cast(dsc,"jetbrains.mps.baseLanguage.structure.ClosureParameterReference"),"closureParameter",false) == cp) {
      SNode pr=SNodeFactoryOperations.replaceWithNewChild(dsc,"jetbrains.mps.baseLanguage.structure.ParameterReference");
      SLinkOperations.setTarget(pr,"variableDeclaration",scpd,false);
    }
  }
  SLinkOperations.setTarget(node,"filter",cl,true);
  SLinkOperations.setTarget(node,"whereBlock",null,true);
}
