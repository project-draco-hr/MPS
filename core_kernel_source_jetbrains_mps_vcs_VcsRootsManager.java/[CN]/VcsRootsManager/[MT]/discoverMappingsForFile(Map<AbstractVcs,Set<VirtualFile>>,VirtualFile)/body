{
  if (file == null)   return;
  AbstractVcs vcs=myVcsManager.findVersioningVcs(file);
  if (vcs == null)   return;
  VirtualFile parent=file;
  while (true) {
    if (parent == null) {
      break;
    }
    if (vcs.isVersionedDirectory(parent)) {
      file=parent;
      parent=parent.getParent();
    }
 else {
      break;
    }
  }
  Set<VirtualFile> files=vcss.get(vcs);
  if (files == null) {
    files=new HashSet<VirtualFile>();
    vcss.put(vcs,files);
  }
  files.add(file);
}
