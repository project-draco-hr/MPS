{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      if (myExcludedRoots.contains(vcsRoot)) {
        return;
      }
      boolean result=myUiHelper.showAddVcsRootsDialog(myProject,vcsRoot,sm);
      if (result) {
        List<VcsDirectoryMapping> vcsDirectoryMappings=new ArrayList<VcsDirectoryMapping>(myVcsManager.getDirectoryMappings());
        vcsDirectoryMappings.add(new VcsDirectoryMapping(vcsRoot.getPath(),myVcsManager.findVersioningVcs(vcsRoot).getName()));
        myVcsManager.setDirectoryMappings(vcsDirectoryMappings);
      }
 else {
        myExcludedRoots.add(vcsRoot);
      }
    }
  }
,ModalityState.NON_MODAL);
}
