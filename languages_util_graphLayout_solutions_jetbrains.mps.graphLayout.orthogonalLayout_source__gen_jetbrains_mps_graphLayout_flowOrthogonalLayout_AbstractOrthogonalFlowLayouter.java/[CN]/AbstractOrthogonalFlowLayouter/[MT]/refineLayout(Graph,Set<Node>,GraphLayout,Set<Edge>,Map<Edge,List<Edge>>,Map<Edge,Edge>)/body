{
  GraphLayout initialLayout=GraphLayoutFactory.createGraphLayout(graph);
  for (  Node node : SetSequence.<Node>fromSet(initialNodes)) {
    initialLayout.setLayoutFor(node,layout.getNodeLayout(node));
  }
  for (  Edge edge : SetSequence.<Edge>fromSet(initialEdges)) {
    List<Point> edgeLayout=ListSequence.<Point>fromList(new ArrayList<Point>());
    Node cur=edge.getSource();
    for (    Edge historyEdge : ListSequence.<Edge>fromList(MapSequence.<Edge,List<Edge>>fromMap(history).get(edge))) {
      List<Point> historyLayout=layout.getEdgeLayout(historyEdge);
      if (historyEdge.getSource() != cur) {
        historyLayout=ListSequence.<Point>fromList(historyLayout).reversedList();
      }
      ListSequence.<Point>fromList(edgeLayout).addSequence(ListSequence.<Point>fromList(historyLayout));
      cur=historyEdge.getOpposite(cur);
    }
    initialLayout.setLayoutFor(edge,edgeLayout);
  }
  for (  Edge edge : SetSequence.<Edge>fromSet(MapSequence.fromMap(labeledEdges).keySet())) {
    initialLayout.setLabelLayout(edge,layout.getLabelLayout(MapSequence.<Edge,Edge>fromMap(labeledEdges).get(edge)));
  }
  return initialLayout;
}
