{
  if (ourMemberAccessModifier != null) {
    _role=ourMemberAccessModifier.getNewChildRole(myModel,myConceptFqName,_role);
  }
  final String role=_role;
  SNode parentOfChild=child.getParent();
  if (parentOfChild != null) {
    throw new RuntimeException(child.getDebugText() + " already has parent: " + parentOfChild.getDebugText()+ "\n"+ "Couldn't add it to: "+ this.getDebugText());
  }
  if (child.isRoot()) {
    throw new RuntimeException(child.getDebugText() + " is root node. Can't add it as a child");
  }
  if (getTopmostAncestor() == child) {
    throw new RuntimeException("Trying to create a cyclic tree");
  }
  ModelChange.assertLegalNodeChange(this);
  children_insertAfter(anchor,child);
  child.myRoleInParent=InternUtil.intern(role);
  if (isRegistered()) {
    child.registerInModel(getModel());
  }
 else {
    child.changeModel(getModel());
  }
  if (UndoHelper.needRegisterUndo(getModel())) {
    UndoHelper.addUndoableAction(new InsertChildAtUndoableAction(this,anchor,_role,child));
  }
  if (ModelChange.needFireEvents(getModel(),this)) {
    getModel().fireChildAddedEvent(this,role,child,anchor);
  }
}
