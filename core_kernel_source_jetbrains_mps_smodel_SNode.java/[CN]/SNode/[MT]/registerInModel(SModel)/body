{
  if (model != myModel) {
    if (myModel != null) {
      LOG.errorWithTrace("couldn't register node which is already registered in '" + myModel.getReference() + "'");
      return;
    }
  }
  SRepository repo=model.getRepository();
  if (repo != null) {
    attach(repo);
  }
  model.registerNode(this);
  myModel=model;
  myModelForUndo=model;
  for (  SReference ref : myReferences) {
    ref.makeIndirect();
  }
  UnregisteredNodes.instance().remove(this);
  for (SNode child=firstChild(); child != null; child=child.treeNext()) {
    child.registerInModel(model);
  }
}
