{
  if (ourMemberAccessModifier != null) {
    role=ourMemberAccessModifier.getNewReferentRole(myModel,myConceptFqName,role);
  }
  if (target == null) {
    if (myReferences == null)     return;
    for (    SReference reference : myReferences) {
      if (!reference.getRole().equals(role))       continue;
      removeReferenceInternal(reference);
      return;
    }
    return;
  }
  List<SReference> toDelete=new ArrayList<SReference>();
  if (myReferences != null) {
    for (    SReference reference : myReferences) {
      if (reference.getRole().equals(role)) {
        toDelete.add(reference);
      }
    }
  }
  if (toDelete.size() > 1) {
    LOG.errorWithTrace("ERROR! " + toDelete.size() + " references found for role '"+ role+ "' in "+ org.jetbrains.mps.openapi.model.SNodeUtil.getDebugText(this));
  }
  for (  SReference reference : toDelete) {
    removeReferenceInternal(reference);
  }
  addReferenceInternal(SReference.create(role,this,((SNode)target)));
}
