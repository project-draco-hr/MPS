{
  if (myRepository == null)   return;
  if (myRepository instanceof DisposedRepository) {
    showDisposedMessage();
    return;
  }
synchronized (REPO_LOCK) {
    if (myRepository == null)     return;
    if (myRepository instanceof DisposedRepository) {
      showDisposedMessage();
      return;
    }
    myRepository.getModelAccess().checkReadAccess();
    if (myModel != null && myModel.isUpdateMode())     return;
    myRepository.getModelAccess().checkWriteAccess();
    if (!UndoHelper.getInstance().isInsideUndoableCommand()) {
      throw new IllegalModelChangeError("registered node can only be modified inside undoable command or in 'loading' model " + org.jetbrains.mps.openapi.model.SNodeUtil.getDebugText(this));
    }
  }
}
