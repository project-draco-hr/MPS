{
  ModuleBuildTarget target=(ModuleBuildTarget)buildTarget;
  final List<JavaSourceRootDescriptor> result=new ArrayList<JavaSourceRootDescriptor>();
  JpsMPSModuleExtension mpsModule=JpsMPSExtensionService.getInstance().getExtension(target.getModule());
  if (mpsModule == null) {
    throw new IllegalStateException("MPS module could not be found " + target.getModule());
  }
  File outputTmpRoot=getTmpOutputRoot(mpsModule.getModule(),dataPaths);
  boolean useTransientOutputFolder=mpsModule.getConfiguration().isUseTransientOutputFolder();
  File generatorOutputRoot=new File(mpsModule.getConfiguration().getGeneratorOutputPath());
  File outputRoot=useTransientOutputFolder ? outputTmpRoot : generatorOutputRoot;
  if (useTransientOutputFolder || !isGenOutputUnderSourceRoot(target,mpsModule)) {
    addRoot(result,target,outputRoot);
  }
 else {
    addRoot(result,target,outputRoot);
  }
  return result;
}
