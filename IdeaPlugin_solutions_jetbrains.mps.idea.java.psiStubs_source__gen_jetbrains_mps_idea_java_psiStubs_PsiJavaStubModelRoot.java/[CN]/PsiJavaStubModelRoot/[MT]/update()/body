{
  ModelAccess.assertLegalWrite();
  Map<PsiJavaStubDataSource,SModel> oldModelMap=new HashMap<PsiJavaStubDataSource,SModel>(myModels);
  Map<PsiJavaStubDataSource,SModel> newModelMap=getModelMap();
  for (  IMapping<PsiJavaStubDataSource,SModel> pair : MapSequence.fromMap(oldModelMap)) {
    if (MapSequence.fromMap(newModelMap).containsKey(pair.key())) {
      continue;
    }
    unregister(pair.value());
  }
  for (  SModel model : Sequence.fromIterable(MapSequence.fromMap(newModelMap).values())) {
    register(model);
  }
  myModels=newModelMap;
  syncDirectoryMap();
}
