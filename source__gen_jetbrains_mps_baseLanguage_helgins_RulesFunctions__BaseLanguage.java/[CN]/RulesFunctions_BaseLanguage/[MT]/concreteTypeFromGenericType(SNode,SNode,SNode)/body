{
  SNode returnType=SNodeOperations.copyNode(type);
{
    Pattern_1 pattern_1181217694220=new Pattern_1(genericClassifier);
    SNode coercedNode_1181217694219=TypeChecker.getInstance().getRuntimeSupport().coerce(instanceType,pattern_1181217694220);
    if (coercedNode_1181217694219 != null) {
      List<SNode> actualParams=pattern_1181217694220.PatternVar;
      for (      SNode child : SNodeOperations.getDescendants(returnType,null,true)) {
        if (SNodeOperations.isInstanceOf(child,"jetbrains.mps.baseLanguage.structure.TypeVariableReference")) {
          SNode tvr=child;
          SNode tvd=SLinkOperations.getTarget(tvr,"typeVariableDeclaration",false);
          int index=SequenceOperations.indexOf(SLinkOperations.getTargets(genericClassifier,"typeVariableDeclaration",true),tvd);
          SNode actualParam=(index < actualParams.size() ? actualParams.get(index) : new QuotationClass_31().createNode());
          if (returnType == tvr) {
            returnType=SNodeOperations.copyNode(actualParam,TypeChecker.getInstance().getRuntimeTypesModel());
          }
 else {
            SNodeOperations.replaceWithAnother(tvr,SNodeOperations.copyNode(actualParam));
          }
        }
      }
    }
  }
  return returnType;
}
