{
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          LocalFileSystem lfs=LocalFileSystem.getInstance();
          VirtualFile sourceFolderFile=lfs.refreshAndFindFileByIoFile(new File(path));
          if (sourceFolderFile == null)           return;
          Module module=ModuleUtil.findModuleForFile(sourceFolderFile,myProject);
          if (module == null)           return;
          ModifiableRootModel model=ModuleRootManager.getInstance(module).getModifiableModel();
          ContentEntry entry=model.getContentEntries()[0];
          entry.addSourceFolder(sourceFolderFile,false);
          model.commit();
        }
      }
);
    }
  }
,ModalityState.NON_MODAL);
}
