{
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          Module module=myProject.getComponent(ModuleManager.class).getModules()[0];
          ModifiableRootModel model=module.getComponent(ModuleRootManager.class).getModifiableModel();
          ContentEntry entry=model.getContentEntries()[0];
          LocalFileSystem lfs=LocalFileSystem.getInstance();
          VirtualFile sourceFolderFile=lfs.refreshAndFindFileByIoFile(new File(path));
          if (sourceFolderFile != null) {
            entry.addSourceFolder(sourceFolderFile,false);
          }
          model.commit();
        }
      }
);
    }
  }
,ModalityState.NON_MODAL);
}
