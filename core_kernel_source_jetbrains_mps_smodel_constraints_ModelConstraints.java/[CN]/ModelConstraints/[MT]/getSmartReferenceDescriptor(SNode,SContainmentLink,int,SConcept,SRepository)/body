{
  SReferenceLink smartReference=ReferenceConceptUtil.getCharacteristicReference(smartConcept);
  if (smartReference == null) {
    return new ErrorReferenceDescriptor("smartConcept has no characteristic reference: " + smartConcept.getName());
  }
  SNodeReference sourceNode=smartReference.getTargetConcept().getSourceNode();
  if (sourceNode == null) {
    return new ErrorReferenceDescriptor("smartConcept has no source node: " + smartConcept.getName());
  }
  SNode linkDeclaration=link == null ? null : link.getDeclarationNode();
  String role=link == null ? null : link.getName();
  return new OkReferenceDescriptor(smartConcept,smartReference.getName(),false,role,index,null,sourceNode.resolve(repository),enclosingNode,linkDeclaration,null);
}
