{
  ModelAccess.assertLegalRead();
  final SNode smartReference=ReferenceConceptUtil.getCharacteristicReference(smartConcept);
  if (smartReference == null) {
    return new ErrorReferenceDescriptor("smartConcept has no characteristic reference: " + smartConcept.getName());
  }
  SNode linkDeclaration=role != null ? enclosingNode.getLinkDeclaration(role) : null;
  if (linkDeclaration != null && SNodeUtil.getLinkDeclaration_IsReference(linkDeclaration)) {
    return new ErrorReferenceDescriptor("for reference role smartConcept should be null");
  }
  return new OkReferenceDescriptor(null,smartConcept,enclosingNode,null,role,SModelUtil.getGenuineLinkRole(smartReference),index,SModelUtil.getLinkDeclarationTarget(smartReference),linkDeclaration);
}
