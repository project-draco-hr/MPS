{
  System.err.println("DEBUG: scoper = " + SPropertyOperations.getString(SNodeOperations.getConceptDeclaration(pos.current),"name") + " parent = "+ SPropertyOperations.getString(SNodeOperations.getConceptDeclaration(SNodeOperations.getParent(pos.current)),"name")+ " role "+ pos.role+ " index "+ pos.index);
  Scope scope=pos.getScope(SConceptOperations.findConceptDeclaration("jetbrains.mps.baseLanguage.structure.VariableDeclaration"));
  if (scope == null) {
    System.err.println("DEBUG: scope is null");
  }
 else {
    System.err.println("DEBUG: got scope");
  }
  Iterable<SNode> nodesInScope=scope.getAvailableElements(new String(x.token));
  if (Sequence.fromIterable(nodesInScope).count() > 0) {
    System.err.println("DEBUG: there are elements");
    SNode firstInScope=Sequence.fromIterable(nodesInScope).iterator().next();
    System.out.println("DEBUG: scope element's concept = " + SPropertyOperations.getString(SNodeOperations.getConceptDeclaration(firstInScope),"name"));
    if (SNodeOperations.isInstanceOf(firstInScope,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration")) {
      SNode locVarRef=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.LocalVariableReference",null);
      SLinkOperations.setTarget(locVarRef,"variableDeclaration",SNodeOperations.cast(firstInScope,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration"),false);
      insertAt(pos,locVarRef);
      return locVarRef;
    }
 else {
      return null;
    }
  }
 else {
    System.err.println("DEBUG: there are NO elements in SCOPER");
    Scope scope2=Scope.getScope(myAnchorNode,null,SConceptOperations.findConceptDeclaration("jetbrains.mps.baseLanguage.structure.VariableDeclaration"));
    nodesInScope=scope2.getAvailableElements(new String(x.token));
    if (Sequence.fromIterable(nodesInScope).count() > 0) {
      System.err.println("DEBUG: there are elements");
      SNode firstInScope=Sequence.fromIterable(nodesInScope).iterator().next();
      System.out.println("DEBUG: scope element's concept = " + SPropertyOperations.getString(SNodeOperations.getConceptDeclaration(firstInScope),"name"));
      if (SNodeOperations.isInstanceOf(firstInScope,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration")) {
        SNode locVarRef=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.LocalVariableReference",null);
        SLinkOperations.setTarget(locVarRef,"variableDeclaration",SNodeOperations.cast(firstInScope,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration"),false);
        insertAt(pos,locVarRef);
        return locVarRef;
      }
 else {
        return null;
      }
    }
 else {
      System.err.println("DEBUG: there are NO elements AT ALL");
      return null;
    }
  }
}
