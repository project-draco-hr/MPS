{
  if (currentChar() != '[') {
    error("");
    return null;
  }
  myOffset++;
  if (currentChar() == ']') {
    myOffset++;
    return new ListValue();
  }
  Object first=getValueOrResult();
  boolean isMap=first instanceof Pair;
  if (isMap) {
    ListMapValue listMapValue=new ListMapValue();
    Pair<String,GDBValue> result=(Pair<String,GDBValue>)first;
    while (true) {
      if (currentChar() == ',') {
        listMapValue.addProperty(result.o1,result.o2);
        myOffset++;
      }
 else       if (currentChar() == ']') {
        listMapValue.addProperty(result.o1,result.o2);
        myOffset++;
        return listMapValue;
      }
 else {
        error("");
        return null;
      }
      result=readResult();
    }
  }
 else {
    ListValue listValue=new ListValue();
    GDBValue value=(GDBValue)listValue;
    listValue.add((GDBValue)first);
    while (true) {
      if (currentChar() == ',') {
        listValue.add(value);
        myOffset++;
      }
 else       if (currentChar() == ']') {
        listValue.add(value);
        myOffset++;
        return listValue;
      }
 else {
        error("");
        return null;
      }
      value=readValue();
    }
  }
}
