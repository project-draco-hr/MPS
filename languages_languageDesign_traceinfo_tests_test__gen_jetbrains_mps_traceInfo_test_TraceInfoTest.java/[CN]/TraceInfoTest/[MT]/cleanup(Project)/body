{
  ModelAccess.instance().flushEventQueue();
  ThreadUtils.runInUIThreadAndWait(new Runnable(){
    @Override public void run(){
      ActiveEnvironment.getInstance().disposeProject(p.getProjectFile());
      IdeEventQueue.getInstance().flushQueue();
      System.gc();
    }
  }
);
}
