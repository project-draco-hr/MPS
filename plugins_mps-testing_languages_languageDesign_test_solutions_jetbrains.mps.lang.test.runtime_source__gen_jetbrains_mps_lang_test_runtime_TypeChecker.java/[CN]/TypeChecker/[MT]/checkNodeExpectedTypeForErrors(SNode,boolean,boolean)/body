{
  Assert.assertFalse("should be false (never used anyway)",allowErrors || allowWarnings);
  ITypeContextOwner owner=new DefaultTypecheckingContextOwner();
  SNode containingRoot=node.getContainingRoot();
  TypeContextManager.getInstance().runTypeCheckingAction(owner,containingRoot,new TypeChecker.CheckingAction(node,allowErrors,allowWarnings){
    public void checkOperation(    TypeCheckingContext context,    SNode operation){
      if (SNodeOperations.isInstanceOf(operation,"jetbrains.mps.lang.test.structure.NodeExpectedTypeProperty")) {
        SNode type1=jetbrains.mps.typesystem.inference.TypeChecker.getInstance().getInequalitiesForHole(node,false).getExpectedType();
        SNode type2=SLinkOperations.getTarget(SNodeOperations.cast(operation,"jetbrains.mps.lang.test.structure.NodeExpectedTypeProperty"),"type",true);
        TypeChecker.assertTypesAreTheSame(type1,type2);
      }
    }
  }
);
}
