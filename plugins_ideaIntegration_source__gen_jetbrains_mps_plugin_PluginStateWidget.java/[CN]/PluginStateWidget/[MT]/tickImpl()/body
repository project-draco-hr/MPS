{
  PluginStateWidget.State state=myState.get();
  if (state == PluginStateWidget.State.CONNECTED) {
    if (isConnected()) {
      if (canOperate()) {
        return;
      }
 else {
        setNewState(state,PluginStateWidget.State.CONNECTED_BAD_PROJECT);
      }
    }
 else {
      setNewState(state,PluginStateWidget.State.TRYING_TO_CONNECT);
    }
  }
 else   if (state == PluginStateWidget.State.CONNECTED_BAD_PROJECT) {
    if (isConnected()) {
      if (canOperate()) {
        setNewState(state,PluginStateWidget.State.CONNECTED);
      }
    }
 else {
      setNewState(state,PluginStateWidget.State.TRYING_TO_CONNECT);
    }
  }
 else   if (state == PluginStateWidget.State.DISCONNECTED) {
    if (MPSPlugin.getInstance().openConnectionPresent()) {
      if (isConnected()) {
        if (canOperate()) {
          setNewState(state,PluginStateWidget.State.CONNECTED);
        }
 else {
          setNewState(state,PluginStateWidget.State.CONNECTED_BAD_PROJECT);
        }
      }
    }
  }
 else   if (state == PluginStateWidget.State.TRYING_TO_CONNECT) {
    if (isConnected()) {
      if (canOperate()) {
        setNewState(state,PluginStateWidget.State.CONNECTED);
      }
 else {
        setNewState(state,PluginStateWidget.State.CONNECTED_BAD_PROJECT);
      }
    }
 else {
      int newDelay=(int)(myTimer.getDelay() * DELAY_MUL);
      if (newDelay <= CRITICAL_DELAY) {
        myTimer.setNewDelay(newDelay);
      }
 else {
        setNewState(state,PluginStateWidget.State.DISCONNECTED);
      }
    }
  }
}
