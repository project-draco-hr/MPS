{
  List<VarPositionInfo> resultList=ListSequence.fromList(new ArrayList<VarPositionInfo>());
  VarPositionInfo secondGuess=null;
  for (  Set<VarPositionInfo> val : MapSequence.fromMap(this.myRootToVarPositions).values()) {
    for (    VarPositionInfo element : val) {
      if (ObjectUtils.equals(element.getFileName(),file)) {
        if (element.getStartLine() <= line && line <= element.getEndLine()) {
          ListSequence.fromList(resultList).addElement(element);
        }
 else         if (line >= element.getEndLine() && element.getVarName().equals(varName)) {
          if (secondGuess == null || secondGuess.getEndLine() <= element.getEndLine()) {
            secondGuess=element;
          }
        }
      }
    }
  }
  if (ListSequence.fromList(resultList).isEmpty() && secondGuess == null) {
    return null;
  }
  Iterable<VarPositionInfo> sorted=ListSequence.fromList(resultList).sort(new ISelector<VarPositionInfo,Comparable<?>>(){
    public Comparable<?> select(    VarPositionInfo it){
      return it;
    }
  }
,true);
  String nodeId=null;
  for (  VarPositionInfo varPosition : sorted) {
    if (varPosition.getVarName().equals(varName)) {
      nodeId=varPosition.getNodeId();
      break;
    }
  }
  if (nodeId == null) {
    if (secondGuess == null) {
      return null;
    }
    nodeId=secondGuess.getNodeId();
  }
  return model.getNodeById(nodeId);
}
