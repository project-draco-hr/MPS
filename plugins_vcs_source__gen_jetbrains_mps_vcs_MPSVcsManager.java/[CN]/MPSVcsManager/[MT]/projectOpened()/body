{
  DiskMemoryConflictResolver.setResolver(new DiskMemoryConflictResolverImpl());
  if (ApplicationManager.getApplication().isUnitTestMode() || myProject.isDefault()) {
    return;
  }
  final MergeDriverNotification mergeDriverNotification=MergeDriverNotification.getInstance(myProject);
  mergeDriverNotification.showNotificationIfNeeded();
  myMessageBusConnection=myProject.getMessageBus().connect();
  VcsListener vcsListener=new VcsListener(){
    public void directoryMappingChanged(){
      mergeDriverNotification.showNotificationIfNeeded();
    }
  }
;
  myMessageBusConnection.subscribe(ProjectLevelVcsManager.VCS_CONFIGURATION_CHANGED,vcsListener);
  if (InternalFlag.isInternalMode()) {
    SourceRevision.setProvider(new MPSSourceRevision());
  }
  FileStatusManager.getInstance(myProject).addFileStatusListener(myFileStatusListener);
}
