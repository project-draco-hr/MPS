{
  return ModelAccess.instance().runReadAction(new Computable<EditorCell>(){
    public EditorCell compute(){
      DfsTraverser traverser=new DfsTraverser(myCurrent,myForward);
      SNode selectedNode=myCurrent.getSNode();
      while (traverser.getCurrent() != null) {
        EditorCell current=traverser.getCurrent();
        SNode currentNode=current.getSNode();
        if (!selectedNode.isAncestorOf(currentNode)) {
          return null;
        }
        if (current.getRole() != null) {
          String role=current.getRole();
          LinkDeclaration linkDeclaration=(LinkDeclaration)BaseAdapter.fromNode(currentNode.getLinkDeclaration(role));
          if (linkDeclaration != null && linkDeclaration.getMetaClass() == LinkMetaclass.aggregation && (linkDeclaration.getSourceCardinality() == Cardinality._0__n || linkDeclaration.getSourceCardinality() == Cardinality._1__n)) {
            return current;
          }
 else {
            return new ChildrenCollectionFinder(current,true).find();
          }
        }
        traverser.next();
      }
      return null;
    }
  }
);
}
