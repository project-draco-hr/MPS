{
  return ModelAccess.instance().runReadAction(new Computable<EditorCell>(){
    public EditorCell compute(){
      DfsTraverser traverser=new DfsTraverser(myCurrent,myForward);
      SNode selectedNode=myCurrent.getSNode();
      while (traverser.getCurrent() != null) {
        EditorCell current=traverser.getCurrent();
        SNode currentNode=current.getSNode();
        if (!selectedNode.isAncestorOf(currentNode)) {
          return null;
        }
        if (current.getRole() != null) {
          String role=current.getRole();
          SNode linkDeclaration=currentNode.getLinkDeclaration(role);
          if (linkDeclaration != null && !SNodeUtil.getLinkDeclaration_IsReference(linkDeclaration) && SModelUtil.isMultipleLinkDeclaration(linkDeclaration)) {
            return current;
          }
 else {
            return new ChildrenCollectionFinder(current,true).find();
          }
        }
        traverser.next();
      }
      return null;
    }
  }
);
}
