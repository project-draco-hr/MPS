{
  try {
    Map<SNodeId,SNode> roots=new HashMap<SNodeId,SNode>();
    for (    SNode n : model.getRootNodes()) {
      roots.put(n.getNodeId(),SNodeOperations.cast(n,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,"jetbrains.mps.baseLanguage.structure.Classifier")));
    }
    StubReferenceFactory refFactory=new StubReferenceFactory(myModule,model);
    for (    IFile classfile : getTopClassFiles()) {
      ClassifierLoader rootLoader=new ClassifierLoader(classfile,myOnlyPublic,mySkipPrivate);
      SNodeId nodeId=rootLoader.createNodeId();
      SNode root=roots.get(nodeId);
      if (root != null) {
        rootLoader.updateClassifier(root,refFactory);
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Exception",e);
  }
}
