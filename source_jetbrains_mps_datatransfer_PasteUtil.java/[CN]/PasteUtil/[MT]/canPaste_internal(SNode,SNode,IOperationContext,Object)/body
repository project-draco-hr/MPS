{
  ProjectPane projectPane=operationContext.getComponent(ProjectPane.class);
  if (pasteTarget.getModel() != pasteNode.getModel()) {
    return PASTE_N_A;
  }
  boolean canPasteToRoot=canPasteToRoot(pasteTarget,pasteNode,operationContext);
  boolean canPasteToTarget=canPasteToTarget(pasteTarget,pasteNode,pasteTarget.getRole_(),operationContext);
  if (invoker == projectPane) {
    if (canPasteToRoot) {
      return PASTE_TO_ROOT;
    }
    if (canPasteToTarget) {
      return PASTE_TO_TARGET;
    }
  }
 else {
    if (canPasteToTarget) {
      return PASTE_TO_TARGET;
    }
    if (canPasteToRoot) {
      return PASTE_TO_ROOT;
    }
  }
  if (canPasteToParent(pasteTarget,pasteNode,pasteTarget.getRole_(),operationContext)) {
    return PASTE_TO_PARENT;
  }
  return PASTE_N_A;
}
