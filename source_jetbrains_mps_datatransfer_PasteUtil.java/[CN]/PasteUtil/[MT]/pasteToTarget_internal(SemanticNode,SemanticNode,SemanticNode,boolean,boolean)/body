{
  ConceptDeclaration pasteTargetType=Language.getTypeDeclaration(pasteTarget);
  ConceptDeclaration pasteNodeType=Language.getTypeDeclaration(pasteNode);
  if (pasteTargetType == null || pasteNodeType == null) {
    return false;
  }
  final SemanticLinkDeclaration linkDeclaration=findListlikeMetalink(pasteTargetType,pasteNodeType);
  if (linkDeclaration == null) {
    return false;
  }
  if (reallyPaste) {
    CommandProcessor.instance().executeCommand(null,new Runnable(){
      public void run(){
        if (linkDeclaration.getMetaClass() == LinkMetaclass.aggregation) {
          CommandUtil.insertChild(pasteTarget,anchorNode,linkDeclaration.getRole(),pasteNode,pasteBefore);
        }
 else {
          CommandUtil.insertReferent(pasteTarget,anchorNode,linkDeclaration.getRole(),pasteNode,pasteBefore);
        }
      }
    }
,"paste");
  }
  return true;
}
