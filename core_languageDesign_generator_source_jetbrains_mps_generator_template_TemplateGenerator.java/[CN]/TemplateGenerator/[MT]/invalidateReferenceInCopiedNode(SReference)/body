{
  if (reference.isExternal())   return;
  if (reference instanceof DynamicReference)   return;
  SNode outputNode=reference.getSourceNode();
  SNode inputNode=findInputNodeById(outputNode.getSNodeId());
  if (inputNode == null)   return;
  SReference inputReference=inputNode.getReference(reference.getRole());
  if (inputReference == null)   return;
  outputNode.removeReference(reference);
  SNode inputTargetNode=inputReference.getTargetNode();
  if (inputTargetNode == null) {
    showErrorMessage(inputNode,"bad reference '" + inputReference.getRole() + "' in input node "+ inputNode.getDebugText());
    return;
  }
  ReferenceInfo_CopiedInputNode refInfo=new ReferenceInfo_CopiedInputNode(inputReference.getRole(),outputNode,inputReference.getSourceNode(),inputTargetNode);
  PostponedReference postponedReference=new PostponedReference(refInfo,this);
  outputNode.addReference(postponedReference);
}
