{
  ModelAccess.assertLegalWrite();
  Set<org.jetbrains.mps.openapi.model.SModelReference> loaded=new HashSet<org.jetbrains.mps.openapi.model.SModelReference>();
  SModelRepository smRepo=SModelRepository.getInstance();
  for (  SModel model : getModels()) {
    loaded.add(model.getModelReference());
    if (smRepo.getModelDescriptor(model.getModelReference()) == null) {
      smRepo.registerModelDescriptor((SModelDescriptor)model,getModule());
      myModels.add(model);
    }
  }
  Iterator<SModel> it=myModels.iterator();
  while (it.hasNext()) {
    SModel model=it.next();
    if (loaded.contains(model.getModelReference()))     continue;
    smRepo.unRegisterModelDescriptor((SModelDescriptor)model,getModule());
    it.remove();
  }
}
