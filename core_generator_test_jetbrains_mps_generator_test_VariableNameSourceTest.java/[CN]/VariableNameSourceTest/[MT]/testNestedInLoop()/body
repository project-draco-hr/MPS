{
  VariableNameSource ns=new VariableNameSource("x",new AtomicInteger(0));
  ns.newName();
  ArrayList<String> names=new ArrayList<>();
  for (int i=0; i < 3; i++) {
    nestedUse(1,ns.next(),names);
  }
  myErrors.checkThat(ns.getActualName(),CoreMatchers.equalTo("x"));
  myErrors.checkThat(ns.getNewName(),CoreMatchers.equalTo("x1"));
  myErrors.checkThat(names,CoreMatchers.equalTo(Arrays.asList("x1","x2","x1","x1","x3","x1","x1","x4","x1")));
}
