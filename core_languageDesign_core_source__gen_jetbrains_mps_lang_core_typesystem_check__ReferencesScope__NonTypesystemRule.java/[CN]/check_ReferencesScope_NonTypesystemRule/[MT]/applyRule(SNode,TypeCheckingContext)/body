{
  long t0=new Date().getTime();
  int cnt=0;
  IOperationContext context=typeCheckingContext.getOperationContext();
  if (context == null || !(ReferencesScopeCheckingOptionEditor.ourRefScopeChecking)) {
    return;
  }
  SNode node=baseConcept;
  AbstractConceptDeclaration concept=node.getConceptDeclarationAdapter();
  for (  SReference ref : node.getReferences()) {
    final SNode target=ref.getTargetNode();
    SearchScopeStatus sss=ModelConstraintsUtil.getSearchScope(node.getParent(),node,concept,ref.getRole(),context);
    if (sss.isError()) {
{
        BaseIntentionProvider intentionProvider=null;
        IErrorTarget errorTarget=new NodeErrorTarget();
        IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(node,sss.getMessage(),"r:cec599e3-51d2-48a7-af31-989e3cbd593c(jetbrains.mps.lang.core.typesystem)","4942048232752368615",intentionProvider,errorTarget);
      }
    }
 else     if (sss.isDefault()) {
    }
 else     if (sss.getSearchScope().findNode(new Condition<SNode>(){
      public boolean met(      SNode n){
        return n == target;
      }
    }
) == null) {
      String name=target.getName();
{
        BaseIntentionProvider intentionProvider=null;
        IErrorTarget errorTarget=new NodeErrorTarget();
        IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(node,"reference" + ((name == null ? "" : " " + name)) + " ("+ ref.getRole()+ ") is out of"+ ((sss.isDefault() ? " global" : " search"))+ " scope","r:cec599e3-51d2-48a7-af31-989e3cbd593c(jetbrains.mps.lang.core.typesystem)","4942048232752376292",intentionProvider,errorTarget);
      }
    }
    ++cnt;
  }
  ReferencesScopeCheckingOptionEditor.ourTime+=new Date().getTime() - t0;
  ReferencesScopeCheckingOptionEditor.ourRefs+=cnt;
  ++ReferencesScopeCheckingOptionEditor.ourNodes;
}
