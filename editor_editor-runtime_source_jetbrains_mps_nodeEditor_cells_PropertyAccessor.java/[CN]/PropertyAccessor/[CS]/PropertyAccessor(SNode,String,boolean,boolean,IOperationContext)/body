{
  myNode=node;
  myPropertyName=propertyName;
  myReadOnly=readOnly || SModelOperations.isReadOnly(node.getModel());
  myAllowEmptyText=allowEmptyText;
  myPropertyDeclaration=NodeReadAccessCasterInEditor.runReadTransparentAction(new Computable<SNodeReference>(){
    @Override public SNodeReference compute(){
      SNode propertyDeclaration=((jetbrains.mps.smodel.SNode)myNode).getPropertyDeclaration(myPropertyName);
      return propertyDeclaration != null ? propertyDeclaration.getReference() : null;
    }
  }
);
  myRepository=context.getProject().getRepository();
}
