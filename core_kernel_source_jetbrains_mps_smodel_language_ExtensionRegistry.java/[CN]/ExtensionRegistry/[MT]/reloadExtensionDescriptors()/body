{
  ModelAccess.assertLegalWrite();
  for (  ExtensionDescriptor desc : myExtensionDescriptors.values()) {
    unregisterExtensionDescriptor(desc);
  }
  myExtensionDescriptors.clear();
  Set<IModule> existing=new HashSet<IModule>(myModuleToNamespace.keySet());
  for (  IModule mod : MPSModuleRepository.getInstance().getAllModules()) {
    String namespace=mod.getModuleFqName();
    if (myExtensionDescriptors.containsKey(namespace))     continue;
    existing.remove(mod);
    ExtensionDescriptor desc=findExtensionDescriptor(mod);
    if (desc == null)     continue;
    myModuleToNamespace.put(mod,namespace);
    myExtensionDescriptors.put(namespace,desc);
    registerExtensionDescriptor(desc);
  }
  for (  IModule mod : existing) {
    myModuleToNamespace.remove(mod);
  }
}
