{
  EditorCell cell=findCell(node,cellId);
  if (cell instanceof EditorCell_Label) {
    EditorCell_Label labelCell=(EditorCell_Label)cell;
    boolean isFirstPositionRequested=caretPosition == 0;
    boolean isLastPositionRequested=caretPosition == -1 || (caretPosition != 0 && caretPosition == labelCell.getText().length());
    EditorCell_Label refinedCell=refineUsingCursorPositioningRules(labelCell,cellId,isFirstPositionRequested,isLastPositionRequested);
    if (refinedCell != null) {
      if (refinedCell != labelCell) {
        if (isFirstPositionRequested) {
          isLastPositionRequested=true;
        }
        if (isLastPositionRequested) {
          caretPosition=0;
        }
      }
      if (isLastPositionRequested) {
        caretPosition=refinedCell.getText().length();
      }
      setSelection(refinedCell,caretPosition);
      return;
    }
  }
  clearSelection();
}
