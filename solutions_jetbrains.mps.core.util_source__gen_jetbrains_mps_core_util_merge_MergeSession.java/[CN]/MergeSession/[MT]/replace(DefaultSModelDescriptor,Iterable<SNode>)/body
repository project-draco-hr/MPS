{
  SModel existing=descriptor.getSModel();
  if (existing == null) {
    messageHandler.handle(new Message(MessageKind.ERROR,"no " + descriptor.getSModelReference().getLongName() + " model"));
    return;
  }
  final SModel newmodel=new SModel(descriptor.getSModelReference());
  newmodel.getSModelHeader().updateDefaults(descriptor.getSModelHeader());
  Sequence.fromIterable(mergeLists(SModelOperations.getRoots(existing,null),roots,newmodel)).visitAll(new IVisitor<SNode>(){
    public void visit(    SNode it){
      newmodel.addRoot(it);
    }
  }
);
  MapSequence.fromMap(newContent).put(descriptor,newmodel);
}
