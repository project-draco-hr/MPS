{
  Language language=SModelUtil.getDeclaringLanguage(thisNode);
  List<SNode> result=new ArrayList<SNode>();
  if (language == null) {
    return result;
  }
  for (  Generator g : language.getGenerators()) {
    for (    SModel sd : g.getOwnTemplateModels()) {
      SModel m=sd;
      for (      SNode node : ListSequence.fromList(SModelOperations.roots(m,null))) {
        if (SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1092059087312l,"jetbrains.mps.lang.generator.structure.TemplateDeclaration")) && SLinkOperations.getTarget(SNodeOperations.cast(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1092059087312l,"jetbrains.mps.lang.generator.structure.TemplateDeclaration")),MetaAdapterFactory.getReferenceLink(new UUID(-5475912601019530992l,-8082971551085732881l),1092059087312l,1168285871518l,"applicableConcept")) == thisNode || SLinkOperations.getTarget(AttributeOperations.getAttribute(node,new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation")),MetaAdapterFactory.getReferenceLink(new UUID(-5475912601019530992l,-8082971551085732881l),1168619357332l,1168619429071l,"applicableConcept")) == thisNode) {
          ListSequence.fromList(result).addElement(node);
        }
 else         if (SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1095416546421l,"jetbrains.mps.lang.generator.structure.MappingConfiguration")) || SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1112730859144l,"jetbrains.mps.lang.generator.structure.TemplateSwitch"))) {
          for (          SNode r : ListSequence.fromList(SNodeOperations.getNodeDescendants(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1167169308231l,"jetbrains.mps.lang.generator.structure.BaseMappingRule"),false,new SAbstractConcept[]{}))) {
            if (SLinkOperations.getTarget(r,MetaAdapterFactory.getReferenceLink(new UUID(-5475912601019530992l,-8082971551085732881l),1167169308231l,1167169349424l,"applicableConcept")) == thisNode || (SPropertyOperations.getBoolean(r,MetaAdapterFactory.getProperty(new UUID(-5475912601019530992l,-8082971551085732881l),1167169308231l,1167272244852l,"applyToConceptInheritors")) && Sequence.fromIterable(AbstractConceptDeclaration_Behavior.call_getAllSuperConcepts_2992811758677902956(thisNode,false)).contains(SLinkOperations.getTarget(r,MetaAdapterFactory.getReferenceLink(new UUID(-5475912601019530992l,-8082971551085732881l),1167169308231l,1167169349424l,"applicableConcept"))))) {
              ListSequence.fromList(result).addElement(r);
            }
          }
          for (          SNode r : ListSequence.fromList(SNodeOperations.getNodeDescendants(node,MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1219952072943l,"jetbrains.mps.lang.generator.structure.DropRootRule"),false,new SAbstractConcept[]{}))) {
            if (Sequence.fromIterable(AbstractConceptDeclaration_Behavior.call_getAllSuperConcepts_2992811758677902956(thisNode,true)).contains(SLinkOperations.getTarget(r,MetaAdapterFactory.getReferenceLink(new UUID(-5475912601019530992l,-8082971551085732881l),1219952072943l,1219952338328l,"applicableConcept")))) {
              ListSequence.fromList(result).addElement(r);
            }
          }
        }
      }
    }
  }
  return result;
}
