{
  try {
    FeatureUsageTracker.getInstance().triggerFeatureUsed("refactoring.introduceField");
    final Wrappers._boolean mustBeStatic=new Wrappers._boolean();
    final SNode nodeToRefactor=ModelAccess.instance().runReadAction(new Computable<SNode>(){
      public SNode compute(){
        return SNodeOperations.getNodeAncestor(((SNode)MapSequence.fromMap(_params).get("node")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c37f506fL,"jetbrains.mps.baseLanguage.structure.Expression"),true,false);
      }
    }
);
    ((EditorContext)MapSequence.fromMap(_params).get("editorContext")).getRepository().getModelAccess().runReadAction(new Runnable(){
      public void run(){
        SNode current=SNodeOperations.getParent(nodeToRefactor);
        while (current != null) {
          if (SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf93c84351fL,"jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration")) || SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbbebabf0aL,"jetbrains.mps.baseLanguage.structure.StaticMethodDeclaration")) || SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x11c7538039dL,"jetbrains.mps.baseLanguage.structure.StaticInitializer"))) {
            mustBeStatic.value=true;
            break;
          }
          if (SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8c108ca68L,"jetbrains.mps.baseLanguage.structure.FieldDeclaration")) || SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xf8cc56b21dL,"jetbrains.mps.baseLanguage.structure.InstanceMethodDeclaration")) || SNodeOperations.isInstanceOf(current,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x118f0b909f7L,"jetbrains.mps.baseLanguage.structure.InstanceInitializer"))) {
            mustBeStatic.value=false;
            break;
          }
          current=SNodeOperations.getParent(current);
        }
        mustBeStatic.value=false;
      }
    }
);
    final AbstractIntroduceFieldRefactoring introducer=(mustBeStatic.value ? new IntroduceStaticFieldRefactoring() : new IntroduceFieldRefactoring());
    final Wrappers._T<String> error=new Wrappers._T<String>();
    ((EditorContext)MapSequence.fromMap(_params).get("editorContext")).getRepository().getModelAccess().runWriteAction(new Runnable(){
      public void run(){
        error.value=introducer.init(nodeToRefactor,((EditorComponent)MapSequence.fromMap(_params).get("component")));
      }
    }
);
    if (error.value == null) {
      IntroduceFieldDialog dialog=new IntroduceFieldDialog(((Project)MapSequence.fromMap(_params).get("project")),introducer,((EditorContext)MapSequence.fromMap(_params).get("editorContext")),mustBeStatic.value);
      dialog.show();
    }
 else {
      JOptionPane.showMessageDialog(((EditorComponent)MapSequence.fromMap(_params).get("component")),error.value,"Error",JOptionPane.ERROR_MESSAGE);
    }
  }
 catch (  Throwable t) {
    if (LOG.isEnabledFor(Level.ERROR)) {
      LOG.error("User's action execute method failed. Action:" + "IntroduceField",t);
    }
  }
}
