{
  if (myDistributedLocksMode) {
    return false;
  }
  final boolean[] res=new boolean[]{false};
  if (!getWriteLock().tryLock()) {
    return false;
  }
  getWriteLock().unlock();
  final Project project=p != null ? p : CurrentProjectAccessUtil.getProjectFromUI();
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          if (getWriteLock().tryLock()) {
            try {
              new CommandRunnable(r,project).run();
            }
  finally {
              getWriteLock().unlock();
            }
            res[0]=true;
          }
        }
      }
);
    }
  }
,"",null,UndoConfirmationPolicy.DO_NOT_REQUEST_CONFIRMATION);
  return res[0];
}
