{
  if (write) {
    boolean wasLocked=false;
    try {
      while (!getWriteLock().tryLock(100,TimeUnit.MILLISECONDS)) {
      }
      wasLocked=true;
    }
 catch (    InterruptedException e) {
    }
 finally {
      if (wasLocked) {
        getWriteLock().unlock();
      }
    }
  }
 else {
    getReadLock().lock();
    getReadLock().unlock();
  }
}
