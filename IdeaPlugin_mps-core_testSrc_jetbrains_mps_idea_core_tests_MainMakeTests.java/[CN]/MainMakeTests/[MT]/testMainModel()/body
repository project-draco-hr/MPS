{
  CompilerManagerImpl.testSetup();
  ModuleRootManager mrm=ModuleRootManager.getInstance(myFacet.getModule());
  VirtualFile[] srs=mrm.getSourceRoots();
  assertTrue(srs.length == 2);
  assertEquals("models",srs[0].getName());
  VirtualFile[] children=srs[0].getChildren();
  assertTrue(children.length == 1);
  assertEquals("main.mps",children[0].getName());
  final VirtualFile module=srs[0].getParent();
  assertNotExists(module,"source_gen");
  CompilerManager cm=CompilerManager.getInstance(myFacet.getModule().getProject());
  assertCompiles(cm);
  getVFS().refresh(false);
  assertExists(module,"source_gen");
  assertExists(module,"source_gen/main");
  assertTrue(module.findFileByRelativePath("source_gen/main").getChildren().length == 5);
  MPSCompiler2[] mpscs=cm.getCompilers(MPSCompiler2.class);
  assertSame(1,mpscs.length);
  VirtualFile cachesOutputDir=getVFS().findFileByPath(MPSCompilerPaths.getCachesOutputPath(mpscs[0],myFacet.getModule(),false));
  assertExists(cachesOutputDir,"main");
}
