{
  try {
    if (sp.getManager() == null)     return null;
    String moduleId=sp.getManager().getModuleId();
    String className=sp.getManager().getClassName();
    if (m.getModuleReference().getModuleId().equals(ModuleId.fromString(moduleId))) {
      return (BaseStubModelRootManager)BaseStubModelRootManager.create((AbstractModule)m,className);
    }
    return (BaseStubModelRootManager)BaseStubModelRootManager.create(moduleId,className);
  }
 catch (  ManagerNotFoundException e) {
    LOG.error("Can't create stub manager " + sp.getManager().getClassName() + " for "+ sp.getPath(),e);
    return null;
  }
}
