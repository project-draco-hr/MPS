{
  SNode matched=null;
  if (SNodeOperations.isInstanceOf(realType,"jetbrains.mps.lang.typesystem.structure.MeetType")) {
    matched=whichTypeMatching(SLinkOperations.getTargets(realType,"argument",true),absType);
  }
 else   if (isTypeMatching(realType,absType)) {
    matched=realType;
  }
  if ((matched != null)) {
    if (SNodeOperations.isInstanceOf(absType,"jetbrains.mps.baseLanguage.structure.TypeVariableReference")) {
      (map=getMap(map)).put(SPropertyOperations.getString(SLinkOperations.getTarget(absType,"typeVariableDeclaration",false),"name"),SNodeOperations.copyNode(matched));
    }
 else {
      int idx=0;
      List<SNode> mptypes=SLinkOperations.getTargets(absType,"parameter",true);
      List<SNode> rptypes=SLinkOperations.getTargets(matched,"parameter",true);
      for (int i=0; i < ListSequence.fromList(mptypes).count() && i < ListSequence.fromList(rptypes).count(); i=i + 1) {
        map=matchType(ListSequence.fromList(mptypes).getElement(i),ListSequence.fromList(rptypes).getElement(i),getMap(map));
      }
    }
  }
  return map;
}
