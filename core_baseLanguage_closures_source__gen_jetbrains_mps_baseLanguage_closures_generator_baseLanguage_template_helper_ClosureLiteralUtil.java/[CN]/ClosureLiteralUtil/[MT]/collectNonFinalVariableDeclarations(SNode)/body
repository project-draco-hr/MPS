{
  List<SNode> vrefs=new ArrayList<SNode>();
  for (  SNode desc : SNodeOperations.getDescendants(cl,null,false)) {
    if (SNodeOperations.isInstanceOf(desc,"jetbrains.mps.baseLanguage.structure.VariableReference") && cl == SNodeOperations.getAncestor(desc,"jetbrains.mps.baseLanguage.closures.structure.ClosureLiteral",false,false)) {
      SNode vd=SLinkOperations.getTarget(desc,"variableDeclaration",false);
      if (cl != SNodeOperations.getAncestor(vd,"jetbrains.mps.baseLanguage.closures.structure.ClosureLiteral",false,false)) {
        if (!(SPropertyOperations.getBoolean(vd,"isFinal")) && (SNodeOperations.isInstanceOf(vd,"jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration") || SNodeOperations.isInstanceOf(vd,"jetbrains.mps.baseLanguage.structure.ParameterDeclaration"))) {
          ListSequence.fromList(vrefs).addElement(SLinkOperations.getTarget(desc,"variableDeclaration",false));
        }
      }
    }
  }
  return vrefs;
}
