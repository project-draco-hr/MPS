{
  try {
    final Set<String> usedConcepts=SetSequence.fromSet(new HashSet<String>());
    InternalActionsUtils.executeActionOnAllNodesInModal("find used concepts",((Project)MapSequence.fromMap(_params).get("ideaProject")),new _FunctionTypes._void_P1_E0<SNode>(){
      public void invoke(      SNode node){
        for (        SAbstractConcept c : new DepthFirstConceptIterator(node.getConcept())) {
          SetSequence.fromSet(usedConcepts).addElement(c.getQualifiedName());
        }
      }
    }
);
    List<SNodeReference> concepts=ListSequence.fromList(InternalActionsUtils.getAllConcepts()).where(new IWhereFilter<SNodeReference>(){
      public boolean accept(      final SNodeReference it){
        final Wrappers._boolean isOk=new Wrappers._boolean(false);
        ((MPSProject)MapSequence.fromMap(_params).get("project")).getModelAccess().runReadAction(new Runnable(){
          public void run(){
            SNode concept=SNodeOperations.cast(it.resolve(MPSModuleRepository.getInstance()),MetaAdapterFactory.getConcept(new UUID(-4094437568663370681l,-8968368868337559369l),1169125787135l,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration"));
            isOk.value=(concept != null) && (BehaviorReflection.invokeVirtual(Boolean.TYPE,concept,"virtual_isDeprecated_1224609060727",new Object[]{}) || !(SetSequence.fromSet(usedConcepts).contains(NameUtil.nodeFQName(concept))));
          }
        }
);
        return isOk.value;
      }
    }
).toListSequence();
    InternalActionsUtils.showUsagesViewForNodes(((Project)MapSequence.fromMap(_params).get("ideaProject")),concepts);
  }
 catch (  Throwable t) {
    if (LOG.isEnabledFor(Level.ERROR)) {
      LOG.error("User's action execute method failed. Action:" + "FindUnusedAndDeprecatedConcepts",t);
    }
  }
}
