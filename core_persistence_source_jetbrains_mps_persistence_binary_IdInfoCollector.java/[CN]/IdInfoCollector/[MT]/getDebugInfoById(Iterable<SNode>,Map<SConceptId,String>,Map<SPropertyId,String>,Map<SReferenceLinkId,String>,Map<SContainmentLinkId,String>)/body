{
  for (  SNode root : rootNodes) {
    for (    SNode n : SNodeUtil.getDescendants(root)) {
      SConceptId conceptId=IdHelper.getConceptId(n.getConcept());
      if (conceptId != null) {
        conceptIds.put(conceptId,n.getConcept().getQualifiedName());
      }
      if (n.getParent() != null) {
        SContainmentLink link=n.getContainmentLink();
        SContainmentLinkId linkId=IdHelper.getLinkId(link);
        linkIds.put(linkId,link.getRoleName());
        SConceptId linkConceptId=linkId.getConceptId();
        if (!conceptIds.containsKey(linkConceptId)) {
          String conceptName=getConceptName(linkConceptId);
          if (conceptName != null) {
            conceptIds.put(linkConceptId,conceptName);
          }
        }
      }
      for (      SProperty prop : n.getProperties()) {
        SPropertyId propId=IdHelper.getPropertyId(prop);
        propIds.put(propId,prop.getName());
        SConceptId propConceptId=propId.getConceptId();
        if (!conceptIds.containsKey(propConceptId)) {
          String conceptName=getConceptName(propConceptId);
          if (conceptName != null) {
            conceptIds.put(propConceptId,conceptName);
          }
        }
      }
      for (      SReference ref : n.getReferences()) {
        SReferenceLinkId refId=IdHelper.getRefId(ref.getLink());
        refIds.put(refId,ref.getRole());
        SConceptId refConceptId=refId.getConceptId();
        if (!conceptIds.containsKey(refConceptId)) {
          String conceptName=getConceptName(refConceptId);
          if (conceptName != null) {
            conceptIds.put(refConceptId,conceptName);
          }
        }
      }
    }
  }
}
