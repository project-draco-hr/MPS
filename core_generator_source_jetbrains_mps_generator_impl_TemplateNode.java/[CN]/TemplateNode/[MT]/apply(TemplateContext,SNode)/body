{
  for (int i=0; i < myTemplateProperties.length; ) {
    outputNode.setProperty(myTemplateProperties[i++],myTemplateProperties[i++]);
  }
  for (  PropertyMacro pm : myMacroProperties) {
    pm.expand(context,outputNode);
  }
  for (  Map.Entry<String,MacroResolver> e : myMacroRefs.entrySet()) {
    final String refMacroRole=e.getKey();
    final MacroResolver mr=e.getValue();
    ReferenceInfo_Macro refInfo=new ReferenceInfo_Macro(mr,outputNode,refMacroRole,context);
    PostponedReference postponedReference=myGenerator.register(new PostponedReference(refInfo));
    postponedReference.setReferenceInOutputSourceNode();
  }
}
