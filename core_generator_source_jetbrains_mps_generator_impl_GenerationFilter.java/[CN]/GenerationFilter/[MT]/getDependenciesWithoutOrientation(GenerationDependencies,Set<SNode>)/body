{
  Map<String,Set<String>> graph=new HashMap<String,Set<String>>();
  for (  SNode n : selectedRoots) {
    graph.put(n.getId(),new HashSet<String>());
  }
  graph.put(CONDITIONALS_ID,new HashSet<String>());
  for (  GenerationRootDependencies rd : dependencies.getRootDependencies()) {
    String id=rd.getRootId();
    if (id == null) {
      id=CONDITIONALS_ID;
    }
    Set<String> currentDeps=graph.get(id);
    if (currentDeps != null) {
      currentDeps.addAll(rd.getLocal());
      if (rd.isDependsOnConditionals()) {
        currentDeps.add(CONDITIONALS_ID);
      }
    }
    if (rd.isDependsOnConditionals()) {
      graph.get(CONDITIONALS_ID).add(id);
    }
    for (    String s : rd.getLocal()) {
      Set<String> r=graph.get(s);
      if (r != null) {
        r.add(id);
      }
    }
  }
  return graph;
}
