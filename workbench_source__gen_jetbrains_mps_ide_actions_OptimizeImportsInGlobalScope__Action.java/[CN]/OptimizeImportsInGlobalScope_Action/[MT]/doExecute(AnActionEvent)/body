{
  try {
    for (    IModule module : ListSequence.fromList(MPSModuleRepository.getInstance().getAllModules())) {
      String report="";
      OptimizeImportsHelper helper=new OptimizeImportsHelper(OptimizeImportsInGlobalScope_Action.this.context);
      if (module instanceof Solution) {
        report=helper.optimizeSolutionImports(((Solution)module));
      }
 else       if (module instanceof Language) {
        report=helper.optimizeLanguageImports(((Language)module));
      }
      module.save();
      SModelRepository.getInstance().saveAll();
      System.out.println(report);
    }
    ClassLoaderManager.getInstance().reloadAll(new EmptyProgressIndicator());
  }
 catch (  Throwable t) {
    if (log.isErrorEnabled()) {
      log.error("User's action execute method failed. Action:" + "OptimizeImportsInGlobalScope",t);
    }
  }
}
