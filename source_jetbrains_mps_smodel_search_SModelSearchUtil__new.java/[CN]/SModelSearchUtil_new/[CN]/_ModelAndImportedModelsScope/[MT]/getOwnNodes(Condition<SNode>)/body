{
  if (myModels == null) {
    myModels=myModel.allImportedModels(myScope);
    myModels.add(0,myModel.getModelDescriptor());
  }
  List<SNode> result=new LinkedList<SNode>();
  if (myRootsOnly) {
    for (    SModelDescriptor model : myModels) {
      result.addAll(model.getSModel().getRoots(condition));
    }
  }
 else {
    for (    SModelDescriptor model : myModels) {
      try {
        if (condition instanceof IsInstanceCondition) {
          IsInstanceCondition isInstance=(IsInstanceCondition)condition;
          result.addAll(model.getFastNodeFinder().getNodes(isInstance.getConceptDeclaration(),true));
        }
 else {
          result.addAll(model.getSModel().allNodes(condition));
        }
      }
 catch (      Throwable t) {
        LOG.error("error collecting nodes form model " + model,t);
      }
    }
  }
  return result;
}
