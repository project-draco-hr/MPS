{
  List<File> homeFolders=new ArrayList<File>();
  if (mpsHomeArg == null || !(mpsHomeArg.isDirectory())) {
    homeFolders.add(getAntJARRelativeHome());
    mpsHomeArg=resolveMPSHome(antProject,false);
  }
  if (mpsHomeArg != null) {
    File lib=new File(mpsHomeArg,"lib");
    if (lib.isDirectory()) {
      homeFolders.add(lib);
    }
  }
  if (homeFolders.isEmpty()) {
    homeFolders.add(getAntJARRelativeHome());
  }
  List<File> result=new ArrayList<File>();
  for (  String name : CLASSPATH) {
    File file=null;
    for (    File home : homeFolders) {
      File f=new File(home,name);
      if (f.isFile()) {
        file=f;
        break;
      }
    }
    if (file == null) {
      throw new BuildException("cannot find `" + name + "' in "+ homeFolders.toString());
    }
 else {
      result.add(file);
    }
  }
  return result;
}
