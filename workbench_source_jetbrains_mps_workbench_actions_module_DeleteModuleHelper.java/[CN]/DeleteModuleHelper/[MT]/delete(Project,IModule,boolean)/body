{
  MPSProject mpsProject=project.getComponent(MPSProjectHolder.class).getMPSProject();
  if (!mpsProject.isProjectModule(module) && !deleteFiles) {
    JOptionPane.showMessageDialog(WindowManager.getInstance().getFrame(project),"Non-project modules can only be deleted with files deletion enabled","Can't delete module",JOptionPane.WARNING_MESSAGE);
  }
  if (mpsProject.isProjectModule(module)) {
    if (module instanceof Language) {
      mpsProject.removeProjectLanguage((Language)module);
    }
 else     if (module instanceof Solution) {
      mpsProject.removeProjectSolution((Solution)module);
    }
 else     if (module instanceof DevKit) {
      mpsProject.removeProjectDevKit((DevKit)module);
    }
 else {
      reportUnsupportedModuleType(module);
    }
    project.save();
  }
  if (deleteFiles) {
    for (    SModelDescriptor model : module.getOwnModelDescriptors()) {
      DeleteModelHelper.delete(module,model,true);
    }
    module.getDescriptorFile().delete();
    MPSModuleRepository.getInstance().removeModule(module);
  }
}
