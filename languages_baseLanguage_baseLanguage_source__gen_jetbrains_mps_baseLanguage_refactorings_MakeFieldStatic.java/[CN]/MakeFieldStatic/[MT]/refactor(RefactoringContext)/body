{
  SNode newDeclaration=_quotation_createNode_so6etp_a0a0a(SNodeOperations.copyNode(SLinkOperations.getTarget(((SNode)refactoringContext.getParameter("declaration")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x112670d273fL,0x112670d886aL,"visibility"))),SNodeOperations.copyNode(SLinkOperations.getTarget(((SNode)refactoringContext.getParameter("declaration")),MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x450368d90ce15bc3L,0x4ed4d318133c80ceL,"type"))),SPropertyOperations.getString(((SNode)refactoringContext.getParameter("declaration")),MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")));
  SNode declarationClassifier=SNodeOperations.getNodeAncestor(((SNode)refactoringContext.getParameter("declaration")),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,"jetbrains.mps.baseLanguage.structure.Classifier"),false,false);
  ListSequence.fromList(SLinkOperations.getChildren(declarationClassifier,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,0x4a9a46de59132803L,"member"))).addElement(newDeclaration);
  for (  SearchResult<SNode> result : ListSequence.fromList(((SearchResults<SNode>)refactoringContext.getParameter("usages")).getSearchResults())) {
    SNode usage=result.getObject();
    SNode replacing;
    if (SNodeOperations.isInstanceOf(usage,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x116b483d77aL,"jetbrains.mps.baseLanguage.structure.FieldReferenceOperation"))) {
      replacing=SNodeOperations.getParent(usage);
    }
 else {
      replacing=usage;
    }
    SNode newReference;
    if (SNodeOperations.getNodeAncestor(usage,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,"jetbrains.mps.baseLanguage.structure.Classifier"),false,false) != declarationClassifier) {
      newReference=_quotation_createNode_so6etp_a0a0e0d0a(declarationClassifier,newDeclaration);
    }
 else {
      newReference=_quotation_createNode_so6etp_a0a0a4a3a0(newDeclaration);
    }
    SNodeOperations.replaceWithAnother(replacing,newReference);
  }
  SNodeOperations.deleteNode(((SNode)refactoringContext.getParameter("declaration")));
}
