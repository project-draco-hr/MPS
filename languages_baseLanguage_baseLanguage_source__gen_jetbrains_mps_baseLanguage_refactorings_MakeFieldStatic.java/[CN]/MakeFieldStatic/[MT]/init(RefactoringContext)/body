{
  final SNode node=refactoringContext.getSelectedNode();
  refactoringContext.getRepository().getModelAccess().runReadAction(new Runnable(){
    public void run(){
      if (SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1068390468200l,"jetbrains.mps.baseLanguage.structure.FieldDeclaration"))) {
        refactoringContext.setParameter("declaration",SNodeOperations.cast(node,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1068390468200l,"jetbrains.mps.baseLanguage.structure.FieldDeclaration")));
      }
 else {
        refactoringContext.setParameter("declaration",SNodeOperations.cast(Sequence.fromIterable(SNodeOperations.getReferences(node)).first().getTargetNode(),MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1068390468200l,"jetbrains.mps.baseLanguage.structure.FieldDeclaration")));
      }
      refactoringContext.setParameter("usages",FindUtils.getSearchResults(new EmptyProgressMonitor(),((SNode)refactoringContext.getParameter("declaration")),GlobalScope.getInstance(),"jetbrains.mps.baseLanguage.findUsages.FieldUsages_Finder"));
      refactoringContext.setParameter("hasExternalUsages",false);
      for (      SearchResult<SNode> result : ListSequence.fromList(((SearchResults<SNode>)refactoringContext.getParameter("usages")).getSearchResults())) {
        if (SNodeOperations.getContainingRoot(result.getObject()) != SNodeOperations.getContainingRoot(((SNode)refactoringContext.getParameter("declaration")))) {
          refactoringContext.setParameter("hasExternalUsages",true);
        }
      }
    }
  }
);
  return true;
}
