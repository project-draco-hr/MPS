{
  if (!canBePossiblyFolded())   return;
  if (isFolded()) {
    getEditor().setFolded(this,true);
    return;
  }
  setFolded(true);
  final EditorComponent editorComponent=getEditor();
  adjustSelectionToFoldingState(editorComponent);
  editorComponent.addMouseListener(myUnfoldCollectionMouseListener=new MouseAdapter(){
    public void mouseClicked(    MouseEvent e){
      if (getBounds().contains(e.getPoint())) {
        editorComponent.clearSelectionStack();
        editorComponent.changeSelection(getFoldedCell());
        unfold();
      }
    }
  }
);
  if (!programmaticaly) {
    getEditorContext().flushEvents();
    getEditor().relayout();
  }
}
