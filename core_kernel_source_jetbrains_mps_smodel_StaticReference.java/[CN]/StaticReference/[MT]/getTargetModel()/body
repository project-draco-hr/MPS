{
  if (!isExternal()) {
    return getSourceNode().getModel();
  }
  SModelReference targetModelReference=getTargetSModelReference();
  if (targetModelReference == null) {
    return null;
  }
  SModelDescriptor current=getSourceNode().getModel().getModelDescriptor();
  SModelDescriptor modelDescriptor=null;
  if (current != null) {
    modelDescriptor=current.resolveModel(targetModelReference);
  }
 else   if (SModelRepository.getInstance() != null) {
    modelDescriptor=SModelRepository.getInstance().getModelDescriptor(targetModelReference);
  }
  if (modelDescriptor == null) {
    return null;
  }
  SModel model=modelDescriptor.getSModel();
  if (model == null) {
    error("failed to get model '" + getTargetSModelReference() + "' from model desctiptor");
  }
  return model;
}
