{
  TemplateContext applyContext=new DefaultTemplateContext(context.getEnvironment(),context.getInput(),null);
  if (myArguments.length > 0) {
    applyContext=applyContext.subContext(getArgumentsAsMap());
  }
  if (myIsTemplateDeclNode) {
    final TemplateContainer tc=getTemplates();
    environment.getTracer().pushTemplateNode(getTemplateNode());
    try {
      return tc.apply(context);
    }
  finally {
      environment.getTracer().closeTemplateNode(getTemplateNode());
    }
  }
 else {
    return environment.getTemplateProcessor().apply(myTemplateNode,applyContext);
  }
}
