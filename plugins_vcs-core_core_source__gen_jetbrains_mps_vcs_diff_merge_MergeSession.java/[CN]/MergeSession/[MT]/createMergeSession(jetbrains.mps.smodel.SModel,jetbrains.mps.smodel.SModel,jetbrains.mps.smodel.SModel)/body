{
  jetbrains.mps.smodel.SModel resModel=CopyUtil.copyModel(base);
  SModelDescriptor resMD=resModel.getModelDescriptor();
  SModelDescriptor baseMD=base.getModelDescriptor();
  SModelDescriptor mineMD=mine.getModelDescriptor();
  SModelDescriptor repMD=repository.getModelDescriptor();
  if (resModel instanceof DefaultSModel) {
    int pv=Math.max(getPersistenceVersion(baseMD),Math.max(getPersistenceVersion(mineMD),getPersistenceVersion(repMD)));
    ((DefaultSModel)resModel).setPersistenceVersion(pv);
  }
  return new MergeSession(baseMD,mineMD,repMD,resMD);
}
