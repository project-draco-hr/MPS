{
  MergeSessionState stateCopy=new MergeSessionState(state);
  ListSequence.fromList(SModelOperations.getRoots(((org.jetbrains.mps.openapi.model.SModel)myResultModel.getModelDescriptor()),null)).visitAll(new IVisitor<SNode>(){
    public void visit(    SNode r){
      SNodeOperations.deleteNode(r);
    }
  }
);
  CopyUtil.clearModelProperties(myResultModel.getModelDescriptor());
  UnregisteredNodes.instance().clear();
  CopyUtil.copyModelProperties(stateCopy.myResultModel.getModelDescriptor(),myResultModel.getModelDescriptor());
  ListSequence.fromList(SModelOperations.getRoots(((org.jetbrains.mps.openapi.model.SModel)stateCopy.myResultModel.getModelDescriptor()),null)).visitAll(new IVisitor<SNode>(){
    public void visit(    SNode r){
      SModelOperations.addRootNode(((org.jetbrains.mps.openapi.model.SModel)myResultModel.getModelDescriptor()),r);
    }
  }
);
  myResolvedChanges=stateCopy.myResolvedChanges;
  myNodeCopier.setState(stateCopy.myIdReplacementCache,myResultModel);
}
