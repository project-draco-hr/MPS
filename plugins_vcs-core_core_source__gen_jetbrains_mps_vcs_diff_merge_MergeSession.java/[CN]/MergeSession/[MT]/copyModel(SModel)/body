{
  SModelReference ref=m.getReference();
  SModel copy=(m instanceof DefaultSModel ? new DefaultSModel(ref) : new jetbrains.mps.smodel.SModel(ref));
  CopyUtil.copyModelContentAndPreserveIds(m,copy);
  CopyUtil.copyModelProperties(m,copy);
  return copy;
}
