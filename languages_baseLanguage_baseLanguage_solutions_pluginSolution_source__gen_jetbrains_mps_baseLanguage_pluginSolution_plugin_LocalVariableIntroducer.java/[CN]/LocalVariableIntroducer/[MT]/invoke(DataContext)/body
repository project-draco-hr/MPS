{
  if (myRefactoring.hasDuplicates()) {
    AnAction thisOnly=new AnAction("Replace this occurence only"){
      public void actionPerformed(      AnActionEvent e){
        myRefactoring.setReplacingAll(false);
        execute();
      }
    }
;
    AnAction allOccurences=new AnAction("Replace all " + NameUtil.formatNumericalString(ListSequence.fromList(myRefactoring.getDuplicates()).count() + 1,"occurence")){
      public void actionPerformed(      AnActionEvent e){
        myRefactoring.setReplacingAll(true);
        execute();
      }
    }
;
    ListPopup popup=JBPopupFactory.getInstance().createActionGroupPopup("Multiple occurences found",ActionUtils.groupFromActions(thisOnly,allOccurences),dataContext,null,false);
    popup.show(getRelativePoint());
  }
 else {
    execute();
  }
}
