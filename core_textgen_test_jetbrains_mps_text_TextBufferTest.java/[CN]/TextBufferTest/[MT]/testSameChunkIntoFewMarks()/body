{
  TextBuffer tb=createTextBuffer();
  final String[] lines={"ABC","DEF","GHI"};
  final ArrayList<TextMark> marks=new ArrayList<TextMark>();
  for (  String line : lines) {
    marks.add(tb.pushMark().popMark());
    tb.area().append(line).newLine();
  }
  tb.pushTextArea(new BasicToken("comment"));
  tb.area().append("// XXX").newLine();
  tb.popTextArea();
  final BufferLayout l=tb.newLayout();
  for (  TextMark m : marks) {
    l.replace(m,new BasicToken("comment"));
  }
  BufferSnapshot t=tb.snapshot(l);
  StringBuilder expected=new StringBuilder();
  for (  String line : lines) {
    expected.append("// XXX").append(myLineSep);
    expected.append(line).append(myLineSep);
  }
  Assert.assertEquals(expected.toString(),t.getText().toString());
}
