{
  File dir=new File(myThis.getDevkitDir());
  if (!(dir.exists())) {
    dir.mkdirs();
  }
  DevkitDescriptor descriptor=new DevkitDescriptor();
  descriptor.setNamespace(myThis.getDevkitName());
  IFile devkitFile=OldFileSystem.getFile(devkitPath);
  DevkitDescriptorPersistence.saveDevKitDescriptor(descriptor,devkitFile);
  DevKit devkit=myThis.getProject().addProjectDevKit(devkitFile);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      VirtualFile file=VFileSystem.refreshAndGetFile(devkitPath);
      VcsMigrationUtil.getHandler().addFilesToVcs(Collections.singletonList(file),false,true);
    }
  }
,ModalityState.NON_MODAL);
  return devkit;
}
