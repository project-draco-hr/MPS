{
  AbstractMigrationScriptHelper.MigrationScope migrationScope=new AbstractMigrationScriptHelper.MigrationScope();
  if (applyToSelection) {
    for (    SModelDescriptor model : models) {
      migrationScope.addModel(model);
    }
    for (    IModule module : modules) {
      migrationScope.addModule(module);
      if (module instanceof Language) {
        Language language=(Language)module;
        for (        Generator generator : language.getGenerators()) {
          migrationScope.addModule(generator);
        }
      }
    }
  }
  if (migrationScope.isEmpty()) {
    for (    IModule module : GlobalScope.getInstance().getVisibleModules()) {
      migrationScope.addModule(module);
    }
  }
  return migrationScope;
}
