{
  Set<SModel> modelsToMigration=SetSequence.fromSet(new HashSet<SModel>());
  if (applyToSelection) {
    SetSequence.fromSet(modelsToMigration).addSequence(SetSequence.fromSet(collectModelsForMigration(models,modules)));
  }
  if (SetSequence.fromSet(modelsToMigration).isEmpty()) {
    SetSequence.fromSet(modelsToMigration).addSequence(SetSequence.fromSet(collectModelsForMigration(Collections.<SModel>emptySet(),GlobalScope.getInstance().getModules())));
  }
  return new ModelsScope(modelsToMigration);
}
