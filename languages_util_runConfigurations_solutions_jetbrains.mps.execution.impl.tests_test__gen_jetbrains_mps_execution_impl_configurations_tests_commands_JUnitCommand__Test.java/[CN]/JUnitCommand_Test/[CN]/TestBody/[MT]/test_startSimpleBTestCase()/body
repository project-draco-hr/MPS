{
  final Wrappers._T<ITestNodeWrapper> pointer=new Wrappers._T<ITestNodeWrapper>();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      SModel model=SModelRepository.getInstance().getModelDescriptor(new SModelReference("jetbrains.mps.execution.impl.configurations.tests.commands.sandbox","tests")).getSModel();
      SNode mainNode=ListSequence.fromList(SModelOperations.getRoots(model,"jetbrains.mps.lang.core.structure.INamedConcept")).findFirst(new IWhereFilter<SNode>(){
        public boolean accept(        SNode it){
          return eq_16es9m_a0a0a0a0a0a1a0a0a0a1a0a(SPropertyOperations.getString(it,"name"),SimpleBTestCase_Test.class.getSimpleName());
        }
      }
);
      pointer.value=TestNodeWrapperFactory.tryToWrap(mainNode);
    }
  }
);
  List<ITestNodeWrapper> nodeWrappers=ListSequence.fromListAndArray(new ArrayList<ITestNodeWrapper>(),pointer.value);
  ProcessHandler process=new Junit_Command().createProcess(nodeWrappers);
  TestRunState runState=new TestRunState(nodeWrappers);
  CheckTestStateListener checkListener=new CheckTestStateListener(nodeWrappers,ListSequence.fromList(new ArrayList<ITestNodeWrapper>()));
  runState.addListener(checkListener);
  TestEventsDispatcher eventsDispatcher=new TestEventsDispatcher(runState);
  OutputRedirector.redirect(process,new UnitTestProcessListener(eventsDispatcher));
  int exitcode=ProcessHandlerBuilder.startAndWait(process,3000000);
  if (exitcode > 0) {
    Assert.fail("Exit code is not 0 but " + exitcode);
  }
 else   if (exitcode < 0) {
    Assert.fail("Process running too long.");
  }
  if (StringUtils.isNotEmpty(checkListener.getMessages())) {
    Assert.fail(checkListener.getMessages());
  }
}
