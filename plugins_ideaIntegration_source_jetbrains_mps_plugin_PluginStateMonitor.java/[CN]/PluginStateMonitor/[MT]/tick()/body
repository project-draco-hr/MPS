{
  LOG.assertLog(!ThreadUtils.isEventDispatchThread(),"You should not do this in EDT");
synchronized (LOCK) {
    if (myState == State.CONNECTED) {
      if (isConnected()) {
        if (canOperate()) {
          return;
        }
 else {
          setNewState(State.CONNECTED_BAD_PROJECT);
        }
      }
 else {
        setNewState(State.TRYING_TO_CONNECT);
      }
    }
 else     if (myState == State.CONNECTED_BAD_PROJECT) {
      if (isConnected()) {
        if (canOperate()) {
          setNewState(State.CONNECTED);
        }
 else {
          return;
        }
      }
 else {
        setNewState(State.TRYING_TO_CONNECT);
      }
    }
 else     if (myState == State.DISCONNECTED) {
      if (MPSPlugin.getInstance().openConnectionPresent()) {
        if (isConnected()) {
          if (canOperate()) {
            setNewState(State.CONNECTED);
          }
 else {
            setNewState(State.CONNECTED_BAD_PROJECT);
          }
        }
      }
    }
 else     if (myState == State.TRYING_TO_CONNECT) {
      if (isConnected()) {
        if (canOperate()) {
          setNewState(State.CONNECTED);
        }
 else {
          setNewState(State.CONNECTED_BAD_PROJECT);
        }
      }
 else {
        int newDelay=(int)(myTimer.getDelay() * DELAY_MUL);
        if (newDelay <= CRITICAL_DELAY) {
          myTimer.setNewDelay(newDelay);
        }
 else {
          setNewState(State.DISCONNECTED);
        }
      }
    }
  }
}
