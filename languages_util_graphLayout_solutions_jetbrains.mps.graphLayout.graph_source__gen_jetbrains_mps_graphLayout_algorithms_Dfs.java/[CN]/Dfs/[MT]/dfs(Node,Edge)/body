{
  MapSequence.<Node,Integer>fromMap(myDfsState).put(node,DURING);
  preprocess(node,from);
  for (  Edge edge : ListSequence.<Edge>fromList(node.getEdges(myDirection)).where(myEdgeFilter)) {
    if (edge != from) {
      processEdge(edge,node);
      Node target=edge.getOpposite(node);
      if (MapSequence.<Node,Integer>fromMap(myDfsState).get(target) == BEFORE) {
        dfs(target,edge);
      }
    }
  }
  postprocess(node,from);
  MapSequence.<Node,Integer>fromMap(myDfsState).put(node,AFTER);
}
