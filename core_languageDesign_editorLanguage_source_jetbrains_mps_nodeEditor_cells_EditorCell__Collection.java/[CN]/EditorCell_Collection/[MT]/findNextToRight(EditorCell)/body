{
  EditorCell_Collection rootCell=this;
  while (rootCell.getParent() != null && (!(rootCell.getParent().getCellLayout() instanceof CellLayout_Vertical) || rootCell.getParent().lastCell() == rootCell)) {
    rootCell=rootCell.getParent();
  }
class NextToRightCondition extends EditorCellCondition {
    private EditorCell myCellToCompare;
    private boolean myToStart=false;
    private boolean myCollection;
    public NextToRightCondition(    EditorCell cellToCompare){
      this.myCellToCompare=cellToCompare;
      myCollection=cellToCompare instanceof EditorCell_Collection;
    }
    public void checkLeafCell(    EditorCell cell){
      if (cell == myCellToCompare) {
        myToStart=true;
        return;
      }
      if (myToStart && !cell.isSelectable()) {
      }
 else       if (myToStart) {
        setFoundCell(cell);
        setToStop(true);
      }
    }
    public boolean checkNotLeafCell(    EditorCell editorCell){
      if (!myCollection)       return true;
      if (editorCell == myCellToCompare) {
        myToStart=true;
        return false;
      }
      if (myToStart) {
        setFoundCell(editorCell);
        setToStop(true);
      }
      return true;
    }
  }
  NextToRightCondition nextToRightCondition=new NextToRightCondition(editorCell);
  rootCell.iterateTreeUntilCondition(nextToRightCondition);
  return nextToRightCondition.getFoundCell();
}
