{
  if (!g.getClipBounds().intersects(getBounds())) {
    return;
  }
  if (isFolded()) {
    String s=FOLDED_TEXT;
    Font editorFont=EditorSettings.getInstance().getDefaultEditorFont().deriveFont(Font.BOLD);
    FontMetrics metrics=getEditor().getFontMetrics(editorFont);
    g.setFont(editorFont);
    int x=myX;
    g.setColor(Color.lightGray);
    g.fillRect(x,myY,(int)metrics.stringWidth(s),myHeight);
    g.setColor(Color.DARK_GRAY);
    g.drawString(s,x,myY + myHeight - metrics.getDescent());
  }
 else {
    if (!isSelectionPaintedOnAncestor()) {
      paintBackground(g);
    }
    paintSelectionIfRequired(g);
    paintContent(g);
    for (    EditorCell child : this) {
      child.paint(g);
    }
    paintDecorations(g);
  }
}
