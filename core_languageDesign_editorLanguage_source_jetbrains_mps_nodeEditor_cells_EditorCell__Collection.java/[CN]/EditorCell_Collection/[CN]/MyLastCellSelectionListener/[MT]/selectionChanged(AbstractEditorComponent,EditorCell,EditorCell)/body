{
  if (myClosingBrace.isSelected() || myOpeningBrace.isSelected()) {
    notifyBraceSelected();
    return;
  }
  EditorCell deepestSelection=editor.getDeepestSelectedCell();
  EditorCell lastSelectableLeaf=findLastSelectableLeaf();
  EditorCell firstSelectableLeaf=findFirstSelectableLeaf();
  if (deepestSelection instanceof EditorCell_Brace) {
    EditorCell_Collection braceOwner=deepestSelection.getParent();
    if (braceOwner.myClosingBrace == deepestSelection && braceOwner.findLastSelectableLeaf() == lastSelectableLeaf) {
      enableBraces();
      return;
    }
    if (braceOwner.myOpeningBrace == deepestSelection && braceOwner.findFirstSelectableLeaf() == firstSelectableLeaf) {
      enableBraces();
      return;
    }
  }
  if (lastSelectableLeaf == deepestSelection || firstSelectableLeaf == deepestSelection) {
    enableBraces();
  }
 else {
    disableBraces();
  }
}
