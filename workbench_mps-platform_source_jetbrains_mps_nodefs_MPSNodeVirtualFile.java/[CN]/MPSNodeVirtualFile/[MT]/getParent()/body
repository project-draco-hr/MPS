{
  if (myNode == null || myNode.getModelReference() == null)   return null;
  return new ModelAccessHelper(myRepoFiles.getRepository()).runReadAction(new Computable<VirtualFile>(){
    @Override public VirtualFile compute(){
      if (myNode == null) {
        return null;
      }
      org.jetbrains.mps.openapi.model.SModelReference modelRef=myNode.getModelReference();
      if (modelRef.resolve(myRepoFiles.getRepository()) == null) {
        return null;
      }
      MPSModelVirtualFile modelVFile=myRepoFiles.getFileFor(modelRef);
      if (modelVFile != null) {
        return modelVFile.getParent();
      }
      return null;
    }
  }
);
}
