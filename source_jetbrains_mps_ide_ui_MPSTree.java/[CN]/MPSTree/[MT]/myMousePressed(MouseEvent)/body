{
  TreePath path=getPathForLocation(e.getX(),e.getY());
  if (path == null)   return;
  if (e.isControlDown()) {
    addSelectionPath(path);
  }
 else   if (e.isShiftDown()) {
    int[] rows=getSelectionRows();
    int pathRow=getRowForPath(path);
    int firstRow=rows[0];
    int lastRow=rows[rows.length - 1];
    int last=Math.max(firstRow,pathRow);
    int first=Math.min(lastRow,pathRow);
    addSelectionInterval(first,last);
  }
 else {
    setSelectionPath(path);
  }
  if (path.getLastPathComponent() instanceof MPSTreeNode && e.getClickCount() == 2) {
    setSelectionPath(path);
    MPSTreeNode node=(MPSTreeNode)path.getLastPathComponent();
    node.doubleClick();
    e.consume();
  }
  if (e.isPopupTrigger())   showPopup(e);
}
