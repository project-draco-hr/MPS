{
  if ((node == null)) {
    return;
  }
  SetSequence.fromSet(myTargetLanguages).addElement(node.getConcept().getLanguage().getQualifiedName());
  for (  SNode n : jetbrains.mps.util.SNodeOperations.getChildren(node)) {
    if (safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.IfMacro"))) {
      if (SLinkOperations.getTarget(SNodeOperations.cast(n,"jetbrains.mps.lang.generator.structure.IfMacro"),"alternativeConsequence",true) != null) {
        scanControlNode(SLinkOperations.getTarget(SNodeOperations.cast(n,"jetbrains.mps.lang.generator.structure.IfMacro"),"alternativeConsequence",true));
      }
      scanQueryNode(SLinkOperations.getTarget(SNodeOperations.cast(n,"jetbrains.mps.lang.generator.structure.IfMacro"),"conditionFunction",true));
    }
 else     if (safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.NodeMacro")) || safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation")) || safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.PropertyMacro"))|| safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.ReferenceMacro"))|| safeIsInstanceOf(n,SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.TemplateFragment"))) {
      scanQueryNode(n);
    }
 else {
      scanTemplateNode(n);
    }
  }
}
