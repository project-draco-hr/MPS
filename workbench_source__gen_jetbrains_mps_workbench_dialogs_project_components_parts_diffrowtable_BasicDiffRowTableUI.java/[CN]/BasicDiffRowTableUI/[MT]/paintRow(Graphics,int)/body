{
  Rectangle rect=g.getClipBounds();
  int column=0;
  boolean drawn=false;
  int draggedColumnIndex=-1;
  Rectangle draggedCellRect=null;
  Dimension spacing=table.getIntercellSpacing();
  JTableHeader header=table.getTableHeader();
  Rectangle cellRect=new Rectangle();
  cellRect.height=((DiffRowTable)table).getRowHeight(row) + spacing.height;
  cellRect.y=0;
  for (int i=0; i < row; i++) {
    cellRect.y+=((DiffRowTable)table).getRowHeight(i) + spacing.height;
  }
  Enumeration enumeration=table.getColumnModel().getColumns();
  while (enumeration.hasMoreElements()) {
    TableColumn aColumn=(TableColumn)enumeration.nextElement();
    cellRect.width=aColumn.getWidth() + spacing.width;
    if (cellRect.intersects(rect)) {
      drawn=true;
      if ((header == null) || (aColumn != header.getDraggedColumn())) {
        this.paintCell(g,cellRect,row,column);
      }
 else {
        g.setColor(table.getParent().getBackground());
        g.fillRect(cellRect.x,cellRect.y,cellRect.width,cellRect.height);
        draggedCellRect=new Rectangle(cellRect);
        draggedColumnIndex=column;
      }
    }
 else {
      if (drawn) {
        break;
      }
    }
    cellRect.x+=cellRect.width;
    column++;
  }
  if (draggedColumnIndex != -1 && draggedCellRect != null) {
    draggedCellRect.x+=header.getDraggedDistance();
    g.setColor(table.getBackground());
    g.fillRect(draggedCellRect.x,draggedCellRect.y,draggedCellRect.width,draggedCellRect.height);
    g.setColor(table.getGridColor());
    int x1=draggedCellRect.x;
    int y1=draggedCellRect.y;
    int x2=x1 + draggedCellRect.width - 1;
    int y2=y1 + draggedCellRect.height - 1;
    if (table.getShowVerticalLines()) {
      g.drawLine(x2,y1,x2,y2);
    }
    if (table.getShowHorizontalLines()) {
      g.drawLine(x1,y2,x2,y2);
    }
    this.paintCell(g,draggedCellRect,row,draggedColumnIndex);
  }
}
