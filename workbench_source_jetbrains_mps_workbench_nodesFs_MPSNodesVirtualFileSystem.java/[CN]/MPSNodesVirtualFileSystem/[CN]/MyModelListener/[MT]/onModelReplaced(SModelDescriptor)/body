{
  for (  Entry<SNodePointer,MPSNodeVirtualFile> entry : myVirtualFiles.entrySet()) {
    if (entry.getKey().getModel() != sm)     continue;
    SNode node=entry.getKey().getNode();
    MPSNodeVirtualFile file=entry.getValue();
    if (node == null) {
      if (file.isValid()) {
        fireBeforeFileDeletion(this,file);
      }
      fireFileDeleted(this,file,file.getName(),null);
    }
 else {
      String oldName=file.getName();
      String newName=node.getName();
      if (!oldName.equals(newName)) {
        fireBeforePropertyChange(this,file,VirtualFile.PROP_NAME,oldName,newName);
        file.updateFields();
        firePropertyChanged(this,file,VirtualFile.PROP_NAME,oldName,newName);
      }
    }
  }
}
