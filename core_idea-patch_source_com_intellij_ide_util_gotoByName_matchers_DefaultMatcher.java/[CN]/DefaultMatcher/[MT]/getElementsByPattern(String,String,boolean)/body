{
  String namePattern=getShortNamePattern(fullPattern);
  String qualifierPattern=getQualifierPattern(fullPattern);
  boolean empty=namePattern.length() == 0 || namePattern.equals("@");
  if (empty && !canShowListForEmptyPattern())   return Collections.emptySet();
  String newPattern=namePattern.startsWith("@") ? namePattern.substring(1) : namePattern;
  if (!nameMatches(newPattern,shortName))   return Collections.emptySet();
  List<Object> sameNameElements=new SmartList<Object>();
  final Object[] elements=myModel.getElementsByName(shortName,checkboxState,namePattern);
  Set<Object> result=new HashSet<Object>();
  if (elements.length > 1) {
    sameNameElements.clear();
    for (    final Object element : elements) {
      if (matchesQualifier(element,qualifierPattern)) {
        sameNameElements.add(element);
      }
    }
    sortByProximity(sameNameElements);
    for (    Object element : sameNameElements) {
      result.add(element);
    }
  }
 else   if (elements.length == 1 && matchesQualifier(elements[0],qualifierPattern)) {
    result.add(elements[0]);
  }
  return result;
}
