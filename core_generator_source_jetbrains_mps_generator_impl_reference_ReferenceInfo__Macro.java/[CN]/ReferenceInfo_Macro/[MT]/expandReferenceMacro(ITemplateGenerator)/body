{
  Object result=resolveReference();
  if (result instanceof SNode) {
    myOutputTargetNode=(SNode)result;
  }
 else   if (result != null) {
    myResolveInfoForDynamicResolve=(String)result;
  }
  if (myOutputTargetNode == null) {
    return;
  }
  if (myOutputTargetNode.getModel() == generator.getInputModel()) {
    SNode outputTargetNode_output=generator.findCopiedOutputNodeForInputNode(myOutputTargetNode);
    if (outputTargetNode_output != null) {
      myOutputTargetNode=outputTargetNode_output;
    }
 else {
      SNode macroNode=getMacroNodeRef() == null ? null : getMacroNodeRef().resolve(MPSModuleRepository.getInstance());
      generator.getLogger().warning(getOutputSourceNode(),"reference macro returned node from input model; role: " + getReferenceRole() + " in "+ SNodeUtil.getDebugText(getOutputSourceNode()),GeneratorUtil.describeIfExists(myOutputTargetNode,"target node in input model"),GeneratorUtil.describeIfExists(macroNode,"reference macro"));
      generator.getGeneratorSessionContext().keepTransientModel(generator.getInputModel(),true);
    }
  }
}
