{
  expandReferenceMacro(generator);
  if (myOutputTargetNode != null) {
    return createStaticReference(myOutputTargetNode);
  }
  if (myResolveInfoForDynamicResolve != null) {
    return createDynamicReference(myResolveInfoForDynamicResolve,getMacroNodeRef());
  }
  if (isRequired(generator.getLogger())) {
    return createInvalidReference(generator,myResolver.getDefaultResolveInfo());
  }
  return null;
}
