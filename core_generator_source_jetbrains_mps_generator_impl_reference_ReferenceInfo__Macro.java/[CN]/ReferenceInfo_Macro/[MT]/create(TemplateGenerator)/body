{
  expandReferenceMacro(generator);
  if (myOutputTargetNode != null) {
    return createStaticReference(myOutputTargetNode);
  }
  if (myResolveInfoForDynamicResolve != null) {
    final SReference dr=createDynamicReference(myResolveInfoForDynamicResolve,null,getMacroNodeRef());
    generator.registerDynamicReference(dr);
    return dr;
  }
  if (isRequired(generator.getLogger())) {
    return createInvalidReference(generator,myResolver.getDefaultResolveInfo());
  }
  return null;
}
