{
  if (session.getObject(RELOAD_REFACTORING_SESSION_FLAG) == null) {
    session.putObject(RELOAD_REFACTORING_SESSION_FLAG,new HashSet<SModelReference>());
  }
  Set<SModelReference> reloadedModels=(Set<SModelReference>)session.getObject(RELOAD_REFACTORING_SESSION_FLAG);
  if (!reloadedModels.contains(smodel.getReference())) {
    if (smodel instanceof EditableSModel) {
      ((EditableSModel)smodel).save();
      MPSPsiModel psiModel=myPsiProvider.getPsi(smodel);
      psiModel.reloadAll();
    }
    reloadedModels.add(smodel.getReference());
  }
}
