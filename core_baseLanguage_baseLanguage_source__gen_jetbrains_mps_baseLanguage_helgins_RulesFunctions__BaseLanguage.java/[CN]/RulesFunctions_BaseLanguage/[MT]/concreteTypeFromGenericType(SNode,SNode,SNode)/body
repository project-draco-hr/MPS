{
  SNode returnType=SNodeOperations.copyNode(type);
  if (genericClassifier == null) {
    return returnType;
  }
{
    Pattern_8 pattern_=new Pattern_8(genericClassifier);
    SNode coercedNode_=TypeChecker.getInstance().getRuntimeSupport().coerce(instanceType,pattern_);
    if (coercedNode_ != null) {
      List<SNode> actualParams=pattern_.PatternVar;
      for (      SNode child : SNodeOperations.getDescendants(returnType,null,true)) {
        if (SNodeOperations.isInstanceOf(child,"jetbrains.mps.baseLanguage.structure.TypeVariableReference")) {
          SNode tvr=child;
          SNode tvd=SLinkOperations.getTarget(tvr,"typeVariableDeclaration",false);
          int index=ListSequence.fromList(SLinkOperations.getTargets(genericClassifier,"typeVariableDeclaration",true)).indexOf(tvd);
          SNode actualParam=(index < actualParams.size() && index >= 0 ? actualParams.get(index) : new QuotationClass_27().createNode());
          if (returnType == tvr) {
            returnType=SNodeOperations.copyNode(actualParam);
          }
 else {
            SNodeOperations.replaceWithAnother(tvr,SNodeOperations.copyNode(actualParam));
          }
        }
      }
    }
  }
  return returnType;
}
