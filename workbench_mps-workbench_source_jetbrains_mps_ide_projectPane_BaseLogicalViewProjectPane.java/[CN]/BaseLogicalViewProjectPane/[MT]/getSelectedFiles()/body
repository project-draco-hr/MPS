{
  List<VirtualFile> selectedFilesList=new LinkedList<VirtualFile>();
  List<SModelDescriptor> descriptors=getSelectedModels();
  if (descriptors != null) {
    for (    SModelDescriptor descriptor : descriptors) {
      if (!(descriptor instanceof DefaultSModelDescriptor))       continue;
      DefaultSModelDescriptor emd=(DefaultSModelDescriptor)descriptor;
      IFile ifile=emd.getModelFile();
      if (ifile == null)       continue;
      VirtualFile vfile=VirtualFileUtils.getVirtualFile(ifile);
      if (vfile == null)       continue;
      selectedFilesList.add(vfile);
    }
  }
  List<SModule> modules=getSelectedModules();
  if (modules != null) {
    for (    SModule m : modules) {
      if (!(m instanceof AbstractModule))       continue;
      AbstractModule module=(AbstractModule)m;
      IFile home=module.getBundleHome();
      if (home != null) {
        VirtualFile vfile=VirtualFileUtils.getVirtualFile(home);
        if (vfile != null) {
          selectedFilesList.add(vfile);
        }
      }
      IFile ifile=module.getDescriptorFile();
      if (ifile != null) {
        VirtualFile vfile=VirtualFileUtils.getVirtualFile(ifile);
        if (vfile != null) {
          selectedFilesList.add(vfile);
        }
      }
    }
  }
  if (selectedFilesList.size() == 0) {
    return null;
  }
  return selectedFilesList.toArray(new VirtualFile[selectedFilesList.size()]);
}
