{
  MPSTreeNode treeNode=(MPSTreeNode)getSelectedTreeNode(TreeNode.class);
  while (treeNode != null && !(treeNode instanceof jetbrains.mps.ide.projectPane.logicalview.nodes.ProjectModuleTreeNode)) {
    treeNode=(MPSTreeNode)treeNode.getParent();
  }
  if (treeNode == null)   return null;
  return ((ProjectModuleTreeNode)treeNode).getModule();
}
