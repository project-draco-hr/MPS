{
  if (model.getModule() instanceof TransientModelsModule) {
    ttrace.push("recycling",false);
    ((jetbrains.mps.smodel.SModelInternal)model).disposeFastNodeFinder();
    final boolean discardTransients=!myGenerationOptions.isSaveTransientModels();
    if (force || (discardTransients && !mySessionContext.isTransientModelToKeep(model))) {
      mySessionContext.getModule().removeModel(model);
    }
    ttrace.pop();
  }
}
