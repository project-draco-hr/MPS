{
  SemanticNode anchorNode=(anchorCell != null ? anchorCell.getSemanticNode() : null);
  if (anchorNode != null) {
    while (anchorNode != null && anchorNode.getParent() != myOwnerNode) {
      anchorNode=anchorNode.getParent();
    }
  }
  myInsertedNode=createNodeToInsert();
  if (LinkMetaclass.parseValue(myRefernceMetaclass) == LinkMetaclass.aggregation) {
    getOwner().insertChild(anchorNode,myReferenceRole,myInsertedNode,insertBefore);
  }
 else {
    getOwner().insertReferent(anchorNode,myReferenceRole,myInsertedNode,insertBefore);
  }
  AbstractEditorComponent editor=editorContext.getNodeEditorComponent();
  editor.pushKeyboardHandler(this);
  editor.rebuildEditorContent();
  EditorCell selectableLeaf=myInsertCell.findFirstSelectableLeaf();
  if (selectableLeaf != null) {
    editor.changeSelection(selectableLeaf);
  }
}
