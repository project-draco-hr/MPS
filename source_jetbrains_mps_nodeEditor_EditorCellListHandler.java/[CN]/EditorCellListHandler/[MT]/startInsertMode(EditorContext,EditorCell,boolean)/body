{
  SemanticNode anchorNode=(anchorCell != null ? anchorCell.getSemanticNode() : null);
  if (anchorNode != null) {
    while (anchorNode != null && anchorNode.getParent() != myOwnerNode) {
      anchorNode=anchorNode.getParent();
    }
  }
  myInsertedNode=createNodeToInsert();
  getOwner().insertReference(anchorNode,insertBefore,myReferenceRole,myInsertedNode,myRefernceMetaclass);
  AbstractEditorComponent editor=editorContext.getNodeEditorComponent();
  editor.pushKeyboardHandler(this);
  editor.rebuildEditorContent();
  EditorCell selectableLeaf=myInsertCell.findFirstSelectableLeaf();
  if (selectableLeaf != null) {
    editor.changeSelection(selectableLeaf);
  }
}
