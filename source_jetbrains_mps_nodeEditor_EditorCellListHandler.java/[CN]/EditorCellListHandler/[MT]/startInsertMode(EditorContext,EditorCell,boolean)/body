{
  SemanticNode anchorNode=(anchorCell != null ? anchorCell.getSemanticNode() : null);
  if (anchorNode != null) {
    Iterator<SemanticNode> listElementsIter=getOwner().children(getChildRole());
    List<SemanticNode> listElements=new LinkedList<SemanticNode>();
    while (listElementsIter.hasNext()) {
      listElements.add(listElementsIter.next());
    }
    while (anchorNode != null && !listElements.contains(anchorNode)) {
      anchorNode=anchorNode.getParent();
    }
  }
  myInsertedNode=createNodeToInsert();
  getOwner().insertChild(anchorNode,getChildRole(),myInsertedNode,insertBefore);
  AbstractEditorComponent editor=editorContext.getNodeEditorComponent();
  editor.pushKeyboardHandler(this);
  editor.rebuildEditorContent();
  if (myInsertCell != null) {
    EditorCell selectableLeaf=myInsertCell.findFirstSelectableLeaf();
    if (selectableLeaf != null) {
      editor.changeSelection(selectableLeaf);
    }
  }
}
