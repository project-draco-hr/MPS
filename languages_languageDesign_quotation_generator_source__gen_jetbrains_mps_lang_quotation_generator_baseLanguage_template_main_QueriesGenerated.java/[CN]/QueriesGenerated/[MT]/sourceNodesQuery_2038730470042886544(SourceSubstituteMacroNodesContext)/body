{
  SNode root=SLinkOperations.getTarget(_context.getNode(),MetaAdapterFactory.getContainmentLink(new UUID(4184707567256882268l,-4914423608129972907l),1196350785113l,1196350785114l,"quotedNode"));
  List<SNode> result=ListSequence.fromList(new ArrayList<SNode>());
  List<SNode> frontier=ListSequence.fromList(new ArrayList<SNode>());
  ListSequence.fromList(frontier).addElement(root);
  List<SNode> newFrontier=ListSequence.fromList(new ArrayList<SNode>());
  while (ListSequence.fromList(frontier).isNotEmpty()) {
    for (    SNode node : frontier) {
      for (      SNode child : SNodeOperations.getChildren(node)) {
        if (!(SNodeOperations.isInstanceOf(child,MetaAdapterFactory.getConcept(new UUID(4184707567256882268l,-4914423608129972907l),1196350785110l,"jetbrains.mps.lang.quotation.structure.AbstractAntiquotation")))) {
          for (          SReference reference : child.getReferences()) {
            if (AttributeOperations.getAttribute(child,new IAttributeDescriptor.LinkAttribute("jetbrains.mps.lang.quotation.structure.ReferenceAntiquotation",reference.getRole())) != null || AttributeOperations.getAttribute(child,new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.quotation.structure.Antiquotation")) != null || AttributeOperations.getAttribute(child,new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.quotation.structure.ListAntiquotation")) != null) {
              continue;
            }
            SNode targetNode=reference.getTargetNode();
            if (SNodeOperations.getNodeAncestor(targetNode,MetaAdapterFactory.getConcept(new UUID(4184707567256882268l,-4914423608129972907l),1196350785113l,"jetbrains.mps.lang.quotation.structure.Quotation"),false,false) == SNodeOperations.getNodeAncestor(child,MetaAdapterFactory.getConcept(new UUID(4184707567256882268l,-4914423608129972907l),1196350785113l,"jetbrains.mps.lang.quotation.structure.Quotation"),false,false)) {
              SNode referenceNode=SModelOperations.createNewNode(_context.getOutputModel(),null,MetaAdapterFactory.getConcept(new UUID(4184707567256882268l,-4914423608129972907l),2038730470042956328l,"jetbrains.mps.lang.quotation.structure.GeneratorInternal_InternalReferenceHolder"));
              SLinkOperations.setTarget(referenceNode,MetaAdapterFactory.getReferenceLink(new UUID(4184707567256882268l,-4914423608129972907l),2038730470042956328l,2038730470042956329l,"role"),(SNode)reference.getLink().getDeclarationNode());
              SLinkOperations.setTarget(referenceNode,MetaAdapterFactory.getReferenceLink(new UUID(4184707567256882268l,-4914423608129972907l),2038730470042956328l,2038730470042970044l,"targetNode"),targetNode);
              SLinkOperations.setTarget(referenceNode,MetaAdapterFactory.getReferenceLink(new UUID(4184707567256882268l,-4914423608129972907l),2038730470042956328l,2038730470042970053l,"sourceNode"),child);
              ListSequence.fromList(result).addElement(referenceNode);
            }
          }
          ListSequence.fromList(newFrontier).addElement(child);
        }
      }
    }
    frontier=newFrontier;
    newFrontier=ListSequence.fromList(new ArrayList<SNode>());
  }
  return result;
}
