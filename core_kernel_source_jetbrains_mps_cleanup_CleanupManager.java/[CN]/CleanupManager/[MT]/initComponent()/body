{
  CommandProcessor.getInstance().addCommandListener(new CommandAdapter(){
    public void beforeCommandFinished(    CommandEvent event){
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          cleanup();
        }
      }
);
    }
  }
);
}
