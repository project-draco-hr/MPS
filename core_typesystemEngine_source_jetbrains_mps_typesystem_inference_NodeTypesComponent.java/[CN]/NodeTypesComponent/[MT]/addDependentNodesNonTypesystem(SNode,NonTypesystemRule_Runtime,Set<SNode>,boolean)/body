{
  Map<SNode,Map<NonTypesystemRule_Runtime,WeakSet<SNode>>> mapToNodesWithNTRules=isTypedTerm ? myTypedTermsToDependentNodesWithNTRules : myNodesToDependentNodesWithNTRules;
  for (  SNode nodeToDependOn : nodesToDependOn) {
    if (nodeToDependOn == null)     continue;
    Map<NonTypesystemRule_Runtime,WeakSet<SNode>> dependentNodes=mapToNodesWithNTRules.get(nodeToDependOn);
    if (dependentNodes == null) {
      dependentNodes=new THashMap<NonTypesystemRule_Runtime,WeakSet<SNode>>(1);
      mapToNodesWithNTRules.put(nodeToDependOn,dependentNodes);
    }
    WeakSet<SNode> nodes=dependentNodes.get(rule);
    if (nodes == null) {
      nodes=new WeakSet<SNode>(1);
      dependentNodes.put(rule,nodes);
    }
    nodes.add(sNode);
  }
}
