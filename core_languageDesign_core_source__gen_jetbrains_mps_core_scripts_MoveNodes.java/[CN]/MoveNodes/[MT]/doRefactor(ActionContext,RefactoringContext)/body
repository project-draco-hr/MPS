{
{
    List<SNode> nodes=(List<SNode>)actionContext.getNodes();
    SModel targetModel=null;
    List<SNode> movedNodes=null;
    if (((Object)refactoringContext.getParameter("target")) instanceof SModelDescriptor) {
      targetModel=((SModelDescriptor)((Object)refactoringContext.getParameter("target"))).getSModel();
      movedNodes=refactoringContext.moveNodesToModel(nodes,targetModel);
    }
    if (((Object)refactoringContext.getParameter("target")) instanceof SNode) {
      SNode targetNode=(SNode)((Object)refactoringContext.getParameter("target"));
      movedNodes=refactoringContext.moveNodesToNode(nodes,ListSequence.fromList(nodes).getElement(0).getRole_(),targetNode);
      targetModel=targetNode.getModel();
    }
    if (targetModel != null) {
      IModule module=targetModel.getModelDescriptor().getModule();
      MPSProject project=actionContext.getMPSProject();
      if (project != null) {
        final IOperationContext operationContext=new ModuleContext(module,project);
        if (operationContext != null) {
          refactoringContext.setParameter("nodeToOpen",ListSequence.fromList(movedNodes).first());
        }
      }
    }
  }
}
