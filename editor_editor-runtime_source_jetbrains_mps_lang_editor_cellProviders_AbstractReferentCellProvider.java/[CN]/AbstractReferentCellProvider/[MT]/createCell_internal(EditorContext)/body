{
  SNode node=getSNode();
  if (myErrorText != null) {
    return createErrorCell(myErrorText,node,context);
  }
  SNode referentNode=null;
  if (myIsAggregation) {
    referentNode=node.getChild(myGenuineRole);
  }
 else {
    SReference reference=node.getReference(myGenuineRole);
    if (reference != null) {
      referentNode=reference.getTargetNode();
      if (referentNode == null || context.getScope().getModelDescriptor(referentNode.getModel().getSModelReference()) == null) {
        String rinfo=reference.getResolveInfo();
        myErrorText=rinfo != null ? rinfo : "?" + SModelUtil.getLinkDeclarationRole(myLinkDeclaration) + "?";
        return createErrorCell(myErrorText,node,context);
      }
    }
  }
  if (referentNode == null) {
    EditorCell_Label noRefCell=myIsCardinality1 ? new EditorCell_Error((jetbrains.mps.nodeEditor.EditorContext)context,node,myNoTargetText) : new EditorCell_Constant((jetbrains.mps.nodeEditor.EditorContext)context,node,"");
    noRefCell.setText("");
    noRefCell.setEditable(true);
    noRefCell.setDefaultText(myNoTargetText);
    noRefCell.setAction(CellActionType.DELETE,new CellAction_DeleteEasily(getSNode()));
    if (myIsAggregation) {
      noRefCell.setAction(CellActionType.INSERT,new CellAction_Insert(getSNode(),myGenuineRole));
      noRefCell.setAction(CellActionType.INSERT_BEFORE,new CellAction_Insert(getSNode(),myGenuineRole));
    }
    noRefCell.setCellId("empty_" + SModelUtil.getLinkDeclarationRole(myLinkDeclaration));
    return noRefCell;
  }
  return createRefCell(context,referentNode,node);
}
