{
  SNode typeCopy=SNodeOperations.copyNode(type);
  for (  SNode typeVariableRef : ListSequence.fromList(SNodeOperations.getNodeDescendants(typeCopy,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x102467229d8L,"jetbrains.mps.baseLanguage.structure.TypeVariableReference"),false,new SAbstractConcept[]{}))) {
    if (!(SetSequence.fromSet(typeParams).contains(SLinkOperations.getTarget(typeVariableRef,MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x102467229d8L,0x1024673a581L,"typeVariableDeclaration"))))) {
      continue;
    }
    if (SNodeOperations.isInstanceOf(SNodeOperations.getParent(typeVariableRef),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110daeaa84aL,"jetbrains.mps.baseLanguage.structure.UpperBoundType")) && SNodeOperations.hasRole(typeVariableRef,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110daeaa84aL,0x110daeaa84bL,"bound")) || SNodeOperations.isInstanceOf(SNodeOperations.getParent(typeVariableRef),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110dae9d53dL,"jetbrains.mps.baseLanguage.structure.LowerBoundType")) && SNodeOperations.hasRole(typeVariableRef,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110dae9d53dL,0x110dae9f25bL,"bound"))) {
      SNodeOperations.replaceWithNewChild(SNodeOperations.getParent(typeVariableRef),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110dae5f4a3L,"jetbrains.mps.baseLanguage.structure.WildCardType"));
    }
 else {
      SNodeOperations.replaceWithNewChild(typeVariableRef,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x110dae5f4a3L,"jetbrains.mps.baseLanguage.structure.WildCardType"));
    }
  }
  return typeCopy;
}
