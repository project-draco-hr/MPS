{
  if (typeByTypeVar.isEmpty()) {
    return type;
  }
  SNode typeCopy=SNodeOperations.copyNode(type);
  for (  SNode typeVariableRef : ListSequence.fromList(SNodeOperations.getDescendants(typeCopy,"jetbrains.mps.baseLanguage.structure.TypeVariableReference",false,new String[]{}))) {
    SNode resolvedType=GenericTypesUtil.getTypeByTypeVariable(typeVariableRef,typeByTypeVar);
    if (resolvedType != typeVariableRef) {
      SNodeOperations.replaceWithAnother(typeVariableRef,SNodeOperations.copyNode(resolvedType));
    }
  }
  return typeCopy;
}
