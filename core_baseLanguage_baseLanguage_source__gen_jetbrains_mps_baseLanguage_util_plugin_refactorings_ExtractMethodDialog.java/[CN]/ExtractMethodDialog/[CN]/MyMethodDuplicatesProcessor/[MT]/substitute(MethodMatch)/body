{
  final Wrappers._T<ExtractMethodRefactoring> refactoring=new Wrappers._T<ExtractMethodRefactoring>();
  ModelAccess.instance().runWriteAction(new Runnable(){
    public void run(){
      refactoring.value=ExtractMethodFactory.createRefactoring(ExtractMethodFactory.createParameters(duplicate.getNodes()));
    }
  }
);
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      refactoring.value.replaceMatch(duplicate,MyMethodDuplicatesProcessor.this.myMethod);
    }
  }
);
}
