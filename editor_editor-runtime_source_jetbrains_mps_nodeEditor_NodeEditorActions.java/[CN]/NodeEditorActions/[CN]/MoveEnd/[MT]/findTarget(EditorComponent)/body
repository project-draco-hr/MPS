{
  Selection selection=editorComponent.getSelectionManager().getSelection();
  if (selection == null) {
    return null;
  }
  List<EditorCell> selectedCells=selection.getSelectedCells();
  EditorCell cell=selectedCells.get(selectedCells.size() - 1);
  while (getNextAlignedLeaf(cell) != null) {
    cell=getNextAlignedLeaf(cell);
  }
  if (cell != selectedCells.get(0)) {
    return cell;
  }
 else {
    return CellTraversalUtil.getLastLeaf(cell);
  }
}
