{
  jetbrains.mps.nodeEditor.EditorComponent editor=(jetbrains.mps.nodeEditor.EditorComponent)context.getEditorComponent();
  EditorCell selection=editor.getSelectedCell();
  if (selection == null) {
    return;
  }
  Rectangle rect=editor.getVisibleRect();
  int height=(int)rect.getHeight();
  height=isDown ? height : -height;
  int caretX=selection.getCaretX();
  int y=selection.getY() + (selection.getHeight() / 2);
  int newY=y + height;
  EditorCell target=editor.findCellWeak(caretX,newY);
  if (target == null) {
    target=isDown ? CellFinderUtil.findLastSelectableLeaf(editor.myRootCell) : CellFinderUtil.findFirstSelectableLeaf(editor.myRootCell);
    editor.changeSelection(target);
  }
 else {
    target.setCaretX(caretX);
    editor.changeSelection(target);
  }
}
