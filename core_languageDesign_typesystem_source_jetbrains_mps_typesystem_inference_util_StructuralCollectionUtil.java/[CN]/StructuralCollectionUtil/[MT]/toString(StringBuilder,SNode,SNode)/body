{
  result.append(node.getConceptFqName());
  result.append("(");
  Set<String> roles=new TreeSet<String>(node.getChildRoles(true));
  for (  String role : roles) {
    for (    SNode child : node.getChildren(role)) {
      toString(result,root,child);
      result.append(";");
    }
  }
  for (  SReference ref : node.getReferences()) {
    if (!ref.isExternal()) {
      SNode target=ref.getTargetNode();
      if (!target.isDescendantOf(root,true)) {
        result.append(target);
      }
    }
 else {
      result.append(ref.getTargetNodeId());
    }
  }
  result.append(")");
}
