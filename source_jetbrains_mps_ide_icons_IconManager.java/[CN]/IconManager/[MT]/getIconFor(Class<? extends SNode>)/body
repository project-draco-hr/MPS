{
  GlobalScope scope=GlobalScope.getInstance();
  ConceptDeclaration conceptDeclaration=SModelUtil.findConceptDeclaration(cls,scope);
  while (conceptDeclaration != null) {
    Language language=SModelUtil_new.getDeclaringLanguage((jetbrains.mps.bootstrap.structureLanguage.structure.ConceptDeclaration)BaseAdapter.fromNode(conceptDeclaration),scope);
    if (language != null) {
      String iconPath=Macros.languageDescriptor().expandPath(conceptDeclaration.getIconPath(),language.getDescriptorFile());
      if (iconPath != null) {
        Icon icon=ourPathsToIcons.get(iconPath);
        if (icon != null)         return icon;
        File file=new File(iconPath);
        if (file.exists()) {
          icon=new ImageIcon(iconPath);
          ourPathsToIcons.put(iconPath,icon);
          return icon;
        }
      }
    }
    conceptDeclaration=conceptDeclaration.getExtends();
  }
  return Icons.DEFAULT_ICON;
}
