{
  for (  SReference ref : ListSequence.fromList(SNodeOperations.getDescendants(newNode,null,true,new String[]{})).translate(new ITranslator2<SNode,SReference>(){
    public Iterable<SReference> translate(    SNode n){
      return SNodeOperations.getReferences(n);
    }
  }
)) {
    SModelReference targetModelRef=ref.getTargetSModelReference();
    ((jetbrains.mps.smodel.SModel)model).addModelImport(targetModelRef,false);
    IModule sourceModule=check_4tnolf_a0d0a0o(model.getModelDescriptor());
    IModule targetModule=check_4tnolf_a0e0a0o(SModelRepository.getInstance().getModelDescriptor(targetModelRef));
    if (sourceModule != null && targetModule != null) {
      if (!(new GlobalModuleDependenciesManager(sourceModule).getModules(GlobalModuleDependenciesManager.Deptype.VISIBLE).contains(targetModule))) {
        sourceModule.addDependency(targetModule.getModuleReference(),false);
      }
    }
  }
}
