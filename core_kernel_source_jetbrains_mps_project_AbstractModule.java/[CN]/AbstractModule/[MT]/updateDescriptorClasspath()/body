{
  if (!isPackaged())   return;
  ModuleDescriptor descriptor=getModuleDescriptor();
  if (descriptor != null) {
    Set<String> visited=new HashSet<String>();
    List<ClassPathEntry> remove=new ArrayList<ClassPathEntry>();
    for (    ClassPathEntry entry : descriptor.getClassPaths()) {
      IFile cp=FileSystem.getFile(entry.getPath());
      if ((!cp.exists()) || cp.isDirectory() || visited.contains(cp.getAbsolutePath())) {
        remove.add(entry);
      }
      visited.add(entry.getPath());
    }
    descriptor.getClassPaths().removeAll(remove);
    String bundleHomePath=getBundleHome().getPath();
    if (!visited.contains(bundleHomePath)) {
      ClassPathEntry bundleHome=new ClassPathEntry();
      descriptor.getClassPaths().add(bundleHome);
      bundleHome.setPath(bundleHomePath);
    }
  }
}
