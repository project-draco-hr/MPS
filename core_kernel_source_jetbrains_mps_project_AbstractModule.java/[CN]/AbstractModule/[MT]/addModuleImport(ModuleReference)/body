{
  ModelAccess.instance().runWriteActionInCommand(new Runnable(){
    public void run(){
      D descriptor=getModuleDescriptor();
      if (descriptor == null)       return;
      for (      Dependency dependency : descriptor.getDependencies()) {
        if (moduleRef.equals(dependency.getModuleRef())) {
          return;
        }
      }
      Dependency dep=new Dependency();
      dep.setModuleRef(moduleRef);
      descriptor.getDependencies().add(dep);
      setModuleDescriptor(descriptor);
      save();
    }
  }
);
}
