{
  if (ModelAccess.instance().canWrite()) {
    return creator.invoke();
  }
  ConcurrentMap<K,V> cache=ModelAccess.instance().getRepositoryStateCache(repositoryKey);
  if (cache == null) {
    return creator.invoke();
  }
  V v=cache.get(key);
  if (v != null) {
    return v;
  }
  v=NodeReadAccessCasterInEditor.runReadTransparentAction(new Computable<V>(){
    @Override public V compute(){
      return creator.invoke();
    }
  }
);
  if (v != null) {
    cache.putIfAbsent(key,v);
  }
  return v;
}
