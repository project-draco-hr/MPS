{
  if (myGenerator.getProgressMonitor().isCanceled()) {
    if (myGenerator.getGenerationTracer().isTracing()) {
      LOG.info("generation canceled when processing branch:");
      logCurrentGenerationBranch(myGenerator,false);
    }
    throw new GenerationCanceledException();
  }
  Map<String,SNode> old=myGenerator.setPreviousInputNodesByMappingName(myInputNodesByMappingName);
  try {
    List<SNode> outputNodes=createOutputNodesForTemplateNode(mappingName,templateNode,inputNode,0);
    if (outputNodes == null) {
      throw new TemplateProcessingFailureException();
    }
    return outputNodes;
  }
 catch (  StackOverflowError e) {
    LOG.error("generation thread run out of stack space :(");
    if (myGenerator.getGenerationTracer().isTracing()) {
      LOG.error("failed branch was:");
      logCurrentGenerationBranch(myGenerator,true);
    }
 else {
      LOG.error("try to increase JVM stack size (-Xss option)");
      LOG.error("to get more diagnostic generate model with the 'save transient models' option");
    }
    throw new GenerationFailureException("couldn't process template",inputNode,templateNode,null,e);
  }
 finally {
    myGenerator.setPreviousInputNodesByMappingName(old);
  }
}
