{
  setupEnvironment();
  for (  File file : myWhatToDo.getMPSProjectFiles()) {
    if (!file.getName().endsWith(MPSExtentions.DOT_MPS_PROJECT))     continue;
    final MPSProject p=TestMain.loadProject(file);
    info("Loaded project " + p);
    LinkedHashSet<MPSProject> projects=new LinkedHashSet<MPSProject>();
    projects.add(p);
    LinkedHashSet<IModule> modules=new LinkedHashSet<IModule>();
    LinkedHashSet<SModelDescriptor> models=new LinkedHashSet<SModelDescriptor>();
    collectModelsToGenerate(modules,models);
    executeTask(p,projects,modules,models);
    ThreadUtils.runInUIThreadAndWait(new Runnable(){
      public void run(){
        p.dispose();
        IdeEventQueue.getInstance().flushQueue();
        System.gc();
      }
    }
);
    for (int i=0; i < 3; i++) {
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
          }
        }
);
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
  showStatistic();
}
