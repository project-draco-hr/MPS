{
  if (!(dataSource instanceof StreamDataSource)) {
    throw new UnsupportedDataSourceException(dataSource);
  }
  String modelName=options.get(OPTION_MODELNAME);
  if (modelName == null) {
    throw new IOException("modelName is not provided");
  }
  final SModelHeader header=SModelHeader.create(ModelPersistence.LAST_VERSION);
  final SModelReference modelReference=PersistenceFacade.getInstance().createModelReference(null,SModelId.generate(),modelName);
  header.setModelReference(modelReference);
  final DefaultSModelDescriptor rv=new DefaultSModelDescriptor(new PersistenceFacility(this,(StreamDataSource)dataSource),header);
  if (dataSource.getTimestamp() != -1) {
    rv.replace(new DefaultSModel(modelReference,header));
  }
  return rv;
}
