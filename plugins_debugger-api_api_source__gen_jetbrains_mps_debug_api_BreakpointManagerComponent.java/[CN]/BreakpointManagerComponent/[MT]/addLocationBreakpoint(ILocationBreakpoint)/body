{
  SNode node=breakpoint.getLocation().getSNode();
  if (node != null) {
    SNode root=node.getContainingRoot();
    if (root != null) {
      SNodePointer rootPointer=new SNodePointer(root);
      Set<ILocationBreakpoint> breakpointsForRoot=myRootsToBreakpointsMap.get(rootPointer);
      if (breakpointsForRoot == null) {
        breakpointsForRoot=new HashSet<ILocationBreakpoint>();
        myRootsToBreakpointsMap.put(rootPointer,breakpointsForRoot);
      }
      for (      ILocationBreakpoint breakpointForRoot : breakpointsForRoot) {
        if (breakpointForRoot.getLocation().getNodePointer().equals(breakpoint.getLocation().getNodePointer())) {
          LOG.error("Trying to add a second breakpoint for node",breakpointForRoot.getLocation().getSNode());
          break;
        }
      }
      breakpointsForRoot.add(breakpoint);
    }
  }
}
