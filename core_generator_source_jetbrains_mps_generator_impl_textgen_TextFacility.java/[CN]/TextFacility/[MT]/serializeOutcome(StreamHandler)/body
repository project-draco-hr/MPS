{
  boolean success=true;
  for (  TextGenerationResult result : getTextGenOutcome()) {
    SNode outputRootNode=result.getRoot();
    Object contents=result.getResult();
    if (contents == TextGen.NO_TEXTGEN)     continue;
    String name=TextGen.getFileName(outputRootNode);
    if (name == null) {
      String t=String.format("Can't create file with no name. Root node [%s] in model %s",outputRootNode.getNodeId(),outputRootNode.getModel().getReference().getModelName());
      myErrors.add(new Message(MessageKind.ERROR,t).setHintObject(new jetbrains.mps.smodel.SNodePointer(outputRootNode)));
      success=false;
      continue;
    }
    if (contents instanceof String) {
      streamHandler.saveStream(name,(String)contents);
    }
 else {
      streamHandler.saveStream(name,(byte[])contents);
    }
  }
  for (  GenerationRootDependencies rdep : myGenStatus.getUnchangedDependencies()) {
    for (    String fname : rdep.getFiles()) {
      streamHandler.touch(fname);
    }
  }
  return success ? Status.NO_ERRORS : new Status.ERROR("Failed to serialize textgen outcome");
}
