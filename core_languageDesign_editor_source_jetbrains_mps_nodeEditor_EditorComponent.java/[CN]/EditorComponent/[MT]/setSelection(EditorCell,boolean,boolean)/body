{
  if (resetLastCaretX) {
    resetLastCaretX();
  }
  if (clearStack) {
    deactivateSubstituteChooser();
    myNodeRangeSelection.deactivate();
    mySelectionManager.setSelection(newSelectedCell);
  }
 else   if (getSelectedCell() != newSelectedCell) {
    deactivateSubstituteChooser();
    myNodeRangeSelection.deactivate();
    mySelectionManager.pushSelection(mySelectionManager.createSelection(newSelectedCell));
  }
  if (newSelectedCell != null) {
    showCellInViewPort(newSelectedCell);
  }
  repaint();
}
