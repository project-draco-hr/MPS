{
  if (keyStroke != null) {
    if (!myActionProxies.containsKey(keyStroke)) {
      EditorComponent.MPSActionProxy proxy=new MPSActionProxy();
      myActionProxies.put(keyStroke,proxy);
      registerKeyboardAction(proxy,keyStroke,WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
      return proxy;
    }
 else {
      MPSActionProxy proxy=myActionProxies.get(keyStroke);
      List<BaseAction> activeActionsBefore=proxy.getActiveActions();
      proxy.add(ActionPlaces.EDITOR_POPUP,action);
      if (!activeActionsBefore.isEmpty() && proxy.isActionActive(action)) {
        StringBuilder actionNames=new StringBuilder();
        for (        BaseAction a : activeActionsBefore) {
          actionNames.append(a.getClass().getSimpleName()).append(";");
        }
        actionNames.delete(actionNames.length() - 1,actionNames.length());
        LOG.warning("Action " + action.getClass().getSimpleName() + " is being registered for shortcut <"+ keyStroke.toString()+ ">"+ " for which an action "+ actionNames+ " is already registered, and both are active");
      }
      return proxy;
    }
  }
  return null;
}
