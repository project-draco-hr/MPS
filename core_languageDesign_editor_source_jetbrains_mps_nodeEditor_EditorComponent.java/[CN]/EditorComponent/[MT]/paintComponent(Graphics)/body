{
  Graphics2D g=(Graphics2D)gg;
  turnOnAliasingIfPossible(g);
  g.setColor(getBackground());
  Rectangle bounds=g.getClipBounds();
  g.fillRect(bounds.x,bounds.y,bounds.width,bounds.height);
  EditorCell deepestCell=getDeepestSelectedCell();
  if (deepestCell instanceof EditorCell_Label) {
    EditorCell_Label label=(EditorCell_Label)deepestCell;
    g.setColor(CARET_ROW_COLOR);
    g.fillRect(0,deepestCell.getY(),getWidth(),deepestCell.getHeight() - deepestCell.getTopInset() - deepestCell.getBottomInset());
    g.setColor(new Color(230,230,190));
    g.fillRect(deepestCell.getX() + label.getLeftInset(),deepestCell.getY(),deepestCell.getWidth() - label.getLeftInset() - label.getRightInset(),deepestCell.getHeight() - deepestCell.getTopInset() - deepestCell.getBottomInset());
  }
  List<AdditionalPainter> additionalPainters;
synchronized (myAdditionalPaintersLock) {
    additionalPainters=new ArrayList<AdditionalPainter>(myAdditionalPainters);
  }
  Collections.sort(additionalPainters,new Comparator<AdditionalPainter>(){
    @Override public int compare(    AdditionalPainter o1,    AdditionalPainter o2){
      if (o1.isAbove(o2,EditorComponent.this))       return 1;
      if (o2.isAbove(o1,EditorComponent.this))       return -1;
      return 0;
    }
  }
);
  for (  AdditionalPainter additionalPainter : additionalPainters) {
    if (!additionalPainter.paintsAbove()) {
      additionalPainter.paint(g,this);
    }
  }
  EditorSettings setting=EditorSettings.getInstance();
  g.setColor(Color.LIGHT_GRAY);
  int boundPosition=myRootCell.getX() + setting.getVerticalBoundWidth();
  g.drawLine(boundPosition,0,boundPosition,getHeight());
  if (myRootCell != null) {
    myRootCell.paint(g);
  }
  for (  AdditionalPainter additionalPainter : additionalPainters) {
    if (additionalPainter.paintsAbove()) {
      additionalPainter.paint(g,this);
    }
  }
}
