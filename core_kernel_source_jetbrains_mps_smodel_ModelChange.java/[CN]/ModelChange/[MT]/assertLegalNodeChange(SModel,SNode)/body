{
  if (model == null)   return;
  if (((jetbrains.mps.smodel.SModel)model).canFireEvent() && node.getModel() != null && !UndoHelper.getInstance().isInsideUndoableCommand()) {
    throw new IllegalModelChangeError("registered node can only be modified inside undoable command or in 'loading' model " + SNodeUtil.getDebugText(node));
  }
}
