{
  final Wrappers._T<String> name=new Wrappers._T<String>(CreateFromUsageUtil.getText(editorContext));
  if (name.value == null || name.value.length() == 0) {
    name.value="map_" + SPropertyOperations.getString(SLinkOperations.getTarget(node,"applicableConcept",false),"name");
  }
  final SNode rule=node;
  CreateFromUsageUtil.showCreateNewRootMenu(editorContext,new Condition<SNode>(){
    public boolean met(    SNode n){
      SNode c=(SNode)n;
      if (SConceptOperations.isExactly(c,"jetbrains.mps.lang.generator.structure.TemplateSwitch")) {
        return false;
      }
      if (SConceptOperations.isExactly(c,"jetbrains.mps.lang.generator.structure.MappingConfiguration")) {
        return false;
      }
      if (SConceptOperations.isExactly(c,"jetbrains.mps.lang.generator.structure.TemplateDeclaration")) {
        return false;
      }
      if (SConceptOperations.isExactly(c,"jetbrains.mps.lang.generator.structure.MappingScript")) {
        return false;
      }
      return true;
    }
  }
,new Setter<SNode>(){
    public void set(    SNode root){
      if (!(SNodeOperations.isInstanceOf(root,"jetbrains.mps.lang.core.structure.INamedConcept"))) {
        return;
      }
      SPropertyOperations.set(SNodeOperations.cast(root,"jetbrains.mps.lang.core.structure.INamedConcept"),"name",name.value);
      SNodeAccessUtil.setProperty(root,SNodeUtil.property_BaseConcept_virtualPackage,SPropertyOperations.getString(SNodeOperations.cast(SNodeOperations.getContainingRoot(node),"jetbrains.mps.lang.core.structure.BaseConcept"),"virtualPackage"));
      SLinkOperations.setTarget(AttributeOperations.getAttribute(root,new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation")),"applicableConcept",SLinkOperations.getTarget(rule,"applicableConcept",false),false);
      SLinkOperations.setTarget(rule,"template",SNodeOperations.cast(root,"jetbrains.mps.lang.core.structure.INamedConcept"),false);
    }
  }
);
}
