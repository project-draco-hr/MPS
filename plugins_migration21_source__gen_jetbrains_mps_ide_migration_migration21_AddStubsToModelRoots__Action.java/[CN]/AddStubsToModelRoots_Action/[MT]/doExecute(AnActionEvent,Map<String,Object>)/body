{
  try {
    for (    IModule module : ListSequence.fromList(MPSModuleRepository.getInstance().getAllModules())) {
      ModuleDescriptor descriptor=module.getModuleDescriptor();
      if (descriptor == null) {
        continue;
      }
      List<ModelRoot> modelRoots=ListSequence.fromList(new ArrayList<ModelRoot>());
      Iterator<ModelRoot> mr_it=Sequence.fromIterable(descriptor.getModelRoots()).iterator();
      ModelRoot mr_var;
      while (mr_it.hasNext()) {
        mr_var=mr_it.next();
        if (!(ListSequence.fromList(modelRoots).contains(mr_var))) {
          ListSequence.fromList(modelRoots).addElement(mr_var);
        }
      }
      Iterator<ModelRoot> sm_it=Sequence.fromIterable(descriptor.getStubModelEntries()).iterator();
      ModelRoot sm_var;
      while (sm_it.hasNext()) {
        sm_var=sm_it.next();
        if (!(ListSequence.fromList(modelRoots).contains(sm_var))) {
          ListSequence.fromList(modelRoots).addElement(sm_var);
        }
      }
      descriptor.getModelRoots().clear();
      descriptor.getModelRoots().addAll(modelRoots);
      module.setModuleDescriptor(descriptor,false);
      module.save();
    }
    ClassLoaderManager.getInstance().reloadAll(new EmptyProgressMonitor());
  }
 catch (  Throwable t) {
    if (log.isErrorEnabled()) {
      log.error("User's action execute method failed. Action:" + "AddStubsToModelRoots",t);
    }
  }
}
