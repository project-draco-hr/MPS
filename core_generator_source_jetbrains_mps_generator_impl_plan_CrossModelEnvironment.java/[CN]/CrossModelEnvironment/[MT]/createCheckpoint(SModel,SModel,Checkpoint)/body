{
  String longName=NameUtil.getModelLongName(originalModel);
  String stereotype="cp-" + step.getName();
  final String transientModelName=longName + '@' + stereotype;
  final SModelReference mr=PersistenceFacade.getInstance().createModelReference(myModule.getModuleReference(),jetbrains.mps.smodel.SModelId.generate(),transientModelName);
  SModel checkpointModel=myModule.createTransientModel(mr);
  new CloneUtil(transientModel,checkpointModel).cloneModelWithImports();
  myModule.addModelToKeep(mr,true);
  CheckpointState cpState=new CheckpointState(checkpointModel,step,transientModel.getReference());
  publishCheckpoint(originalModel.getReference(),cpState);
  return cpState;
}
