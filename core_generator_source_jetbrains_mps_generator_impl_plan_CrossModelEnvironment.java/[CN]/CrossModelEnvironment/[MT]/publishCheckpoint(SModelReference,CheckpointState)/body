{
  myModule.addModelToKeep(cpState.getCheckpointModel().getReference(),true);
  List<CheckpointState> checkpoints=myCheckpoints.get(originalModel);
  if (checkpoints == null) {
    myCheckpoints.put(originalModel,checkpoints=new ArrayList<CheckpointState>(3));
  }
 else {
    for (Iterator<CheckpointState> it=checkpoints.iterator(); it.hasNext(); ) {
      CheckpointState next=it.next();
      if (next.getCheckpoint().equals(cpState.getCheckpoint())) {
        myModule.forgetModel(next.getCheckpointModel().getReference(),true);
        it.remove();
        break;
      }
    }
  }
  checkpoints.add(cpState);
}
