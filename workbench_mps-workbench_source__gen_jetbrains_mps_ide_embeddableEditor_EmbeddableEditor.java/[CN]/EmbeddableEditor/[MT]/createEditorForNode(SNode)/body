{
  SModel nodeModel;
  if (SNodeOperations.getModel(node) == null) {
    if (!(editable)) {
      nodeModel=TemporaryModels.getInstance().create(true,TempModuleOptions.forDefaultModule());
      SModelOperations.addRootNode(nodeModel,node);
      TemporaryModels.getInstance().addMissingImports(nodeModel);
    }
 else {
      throw new IllegalStateException("For nodes not from repository edit mode is disabled");
    }
  }
 else {
    nodeModel=SNodeOperations.getModel(node);
  }
  IOperationContext context=new ModuleContext(nodeModel.getModule(),project);
  return new MPSFileNodeEditor(context,MPSNodesVirtualFileSystem.getInstance().getFileFor(node));
}
