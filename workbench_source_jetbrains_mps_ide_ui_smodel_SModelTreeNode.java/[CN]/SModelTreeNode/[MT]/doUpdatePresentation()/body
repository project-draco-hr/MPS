{
  SModelDescriptor sm=getSModelDescriptor();
  Icon icon=Icons.MODEL_ICON;
  if (getSModelDescriptor() != null) {
    icon=IconManager.getIconFor(getSModelDescriptor());
  }
  if ((sm instanceof EditableSModelDescriptor) && sm.isInitialized() && SModelRepository.getInstance().isChanged(((EditableSModelDescriptor)sm))) {
    icon=new LayeredIcon(icon,Icons.MODIFIED_ICON);
  }
  setIcon(icon);
  GenerationStatus generationStatus=getGenerationStatus();
  setAdditionalText(generationStatus.getMessage());
  if (myModelDescriptor != null) {
    setNodeIdentifier(myModelDescriptor.toString());
  }
 else {
    setNodeIdentifier("");
  }
  if (checkForErrors() && myModelDescriptor != null && myModelDescriptor.isInitialized()) {
    final IScope scope=getOperationContext().getScope();
    List<String> errors=ModelAccess.instance().runReadAction(new Computable<List<String>>(){
      public List<String> compute(){
        List<String> errorsList=new ModelValidator(getSModelDescriptor().getSModel()).validate(scope);
        boolean isValid=errorsList.isEmpty();
        setErrorState(isValid ? ErrorState.NONE : ErrorState.ERROR);
        return errorsList;
      }
    }
);
    if (errors.isEmpty()) {
      setTooltipText(null);
    }
 else {
      String result="<html>";
      for (      String r : errors) {
        result+=r + "<br>";
      }
      setTooltipText(result);
    }
  }
  setText(calculateText());
}
