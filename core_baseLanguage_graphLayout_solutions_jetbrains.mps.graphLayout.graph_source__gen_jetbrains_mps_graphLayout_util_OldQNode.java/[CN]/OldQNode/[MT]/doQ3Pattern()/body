{
  OldPQTreeNode newQNode=new OldQNode();
  newQNode.setState(OldPQTreeNode.State.PARTIAL);
  boolean firstPartial=true;
  for (  OldPQTreeNode child : ListSequence.fromList(getChildren())) {
    if (child.getState() == OldPQTreeNode.State.PARTIAL) {
      List<OldPQTreeNode> partialChildren=child.getChildren();
      if (firstPartial) {
        if (ListSequence.fromList(partialChildren).first().getState() == OldPQTreeNode.State.FULL) {
          partialChildren=ListSequence.fromList(partialChildren).reversedList();
        }
      }
 else {
        if (ListSequence.fromList(partialChildren).first().getState() == OldPQTreeNode.State.EMPTY) {
          partialChildren=ListSequence.fromList(partialChildren).reversedList();
        }
      }
      for (      OldPQTreeNode partialChild : ListSequence.fromList(partialChildren)) {
        newQNode.addLastChild(partialChild);
      }
      firstPartial=false;
    }
 else {
      newQNode.addLastChild(child);
    }
  }
  return newQNode;
}
