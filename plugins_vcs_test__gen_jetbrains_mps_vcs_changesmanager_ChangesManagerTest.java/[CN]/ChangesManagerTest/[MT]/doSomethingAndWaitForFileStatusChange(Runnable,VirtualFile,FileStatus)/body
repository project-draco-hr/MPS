{
  waitForSomething(new Runnable(){
    public void run(){
      final FileStatus statusBefore=myFileStatusManager.getStatus(file);
      final Wrappers._T<FileStatusListener> listener=new Wrappers._T<FileStatusListener>();
      final _FunctionTypes._void_P0_E0 stopIfNeeded=new _FunctionTypes._void_P0_E0(){
        public void invoke(){
          if ((expectedFileStatus == null ? statusBefore != myFileStatusManager.getStatus(file) : expectedFileStatus == myFileStatusManager.getStatus(file))) {
            myFileStatusManager.removeFileStatusListener(listener.value);
            try {
              Thread.sleep(100);
            }
 catch (            InterruptedException e) {
              e.printStackTrace();
            }
            waitCompleted();
          }
        }
      }
;
      listener.value=new FileStatusListener(){
        @Override public void fileStatusesChanged(){
          stopIfNeeded.invoke();
        }
        @Override public void fileStatusChanged(        @NotNull VirtualFile f){
          stopIfNeeded.invoke();
        }
      }
;
      myFileStatusManager.addFileStatusListener(listener.value);
      task.run();
      VcsDirtyScopeManager.getInstance(myIdeaProject).fileDirty(file);
      myChangeListManager.scheduleUpdate();
      stopIfNeeded.invoke();
    }
  }
);
}
