{
  LOG.debug("Getting model " + modelReference + " from "+ fileName);
  SModelRepository modelRepository=SModelRepository.getInstance();
  SModelDescriptor modelDescriptor=modelRepository.getModelDescriptor(modelReference);
  if (modelDescriptor == null) {
    IFile modelFile=FileSystem.getInstance().getFileByPath(fileName);
    DefaultSModelDescriptor md=new DefaultSModelDescriptor(modelFile,modelReference,d);
    if (fireModelCreated) {
      modelRepository.createNewModel(md);
    }
 else {
      modelRepository.registerModelDescriptor(md);
    }
    return md;
  }
  IFile newFile=FileSystem.getInstance().getFileByPath(fileName);
  DefaultSModelDescriptor dsm=(DefaultSModelDescriptor)modelDescriptor;
  if (!newFile.equals(dsm.getModelFile())) {
    ((DefaultSModelDescriptor)modelDescriptor).changeModelFile(newFile);
  }
  modelRepository.registerModelDescriptor(modelDescriptor,owner);
  return modelDescriptor;
}
