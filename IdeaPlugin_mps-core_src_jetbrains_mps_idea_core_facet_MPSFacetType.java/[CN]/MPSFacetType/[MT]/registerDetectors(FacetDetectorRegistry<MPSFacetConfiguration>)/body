{
  FacetDetector<VirtualFile,MPSFacetConfiguration> detector=new MPSFacetDetector();
  final boolean[] detected=new boolean[]{false};
  VirtualFileFilter filter=new VirtualFileFilter(){
    public boolean accept(    VirtualFile file){
      if (detected[0])       return true;
      detected[0]=true;
      if (MPSExtentions.MODEL.equals(file.getExtension())) {
        registry.customizeDetectedFacetPresentation(new MPSFacetPresentation());
        return true;
      }
      return false;
    }
  }
;
  registry.registerUniversalDetector(MPSFileTypeFactory.MODEL_FILE_TYPE,filter,detector);
}
