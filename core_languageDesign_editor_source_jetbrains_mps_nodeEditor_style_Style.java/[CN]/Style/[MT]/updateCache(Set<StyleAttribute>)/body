{
  Object[] oldCachedValues=myCachedAttributeValues;
  myCachedAttributeValues=new Object[StyleAttributes.getAttributesCount()];
  System.arraycopy(oldCachedValues,0,myCachedAttributeValues,0,myCachedAttributeValues.length);
  Set<StyleAttribute> changedAttributes=new StyleAttributeSet();
  for (  StyleAttribute attribute : attributes) {
    Object parentValue=getParentStyle() == null ? null : getParentStyle().get(attribute);
    Object currentValue=myAttributeValues[attribute.getIndex()];
    if (parentValue != null || currentValue != null) {
      if (currentValue instanceof AttributeCalculator) {
        currentValue=((AttributeCalculator)currentValue).calculate(myEditorCell);
      }
      Object newValue=attribute.combine(parentValue,currentValue);
      if (!EqualUtil.equals(newValue,oldCachedValues[attribute.getIndex()])) {
        changedAttributes.add(attribute);
      }
      myCachedAttributeValues[attribute.getIndex()]=newValue;
    }
  }
  if (!changedAttributes.isEmpty()) {
    for (    Style style : myChildren) {
      style.updateCache(changedAttributes);
    }
    fireStyleChanged(new StyleChangeEvent(this,changedAttributes));
  }
}
