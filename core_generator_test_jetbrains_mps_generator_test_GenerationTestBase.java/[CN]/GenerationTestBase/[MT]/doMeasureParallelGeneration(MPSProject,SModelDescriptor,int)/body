{
  GeneratorManager gm=p.getProject().getComponent(GeneratorManager.class);
  GenerationOptions options=GenerationOptions.getDefaults().generateInParallel(false,1).rebuildAll(true).strictMode(true).reporting(false,true,false,2).incremental(false,null).create();
  IncrementalTestGenerationHandler generationHandler=new IncrementalTestGenerationHandler();
  gm.generateModels(Collections.singletonList(descr),ModuleContext.create(descr,p.getProject()),generationHandler,new EmptyProgressIndicator(),generationHandler.getMessageHandler(),options);
  assertNoDiff(generationHandler.getExistingContent(),generationHandler.getGeneratedContent());
  options=GenerationOptions.getDefaults().generateInParallel(false,1).rebuildAll(true).strictMode(true).reporting(false,true,false,2).incremental(false,null).create();
  generationHandler=new IncrementalTestGenerationHandler();
  long start=System.nanoTime();
  gm.generateModels(Collections.singletonList(descr),ModuleContext.create(descr,p.getProject()),generationHandler,new EmptyProgressIndicator(),generationHandler.getMessageHandler(),options);
  long singleThread=System.nanoTime() - start;
  options=GenerationOptions.getDefaults().generateInParallel(true,threads).rebuildAll(true).strictMode(true).reporting(false,true,false,2).incremental(false,null).create();
  generationHandler=new IncrementalTestGenerationHandler();
  start=System.nanoTime();
  gm.generateModels(Collections.singletonList(descr),ModuleContext.create(descr,p.getProject()),generationHandler,new EmptyProgressIndicator(),generationHandler.getMessageHandler(),options);
  long severalThreads=System.nanoTime() - start;
  assertNoDiff(generationHandler.getExistingContent(),generationHandler.getGeneratedContent());
  if (DEBUG) {
    System.out.println("Single thread: " + singleThread / 1000000 / 1000. + ", 4 threads: " + severalThreads / 1000000 / 1000.);
  }
}
