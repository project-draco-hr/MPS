{
  HashSet<SemanticNode> children=new HashSet<SemanticNode>();
  children.add(node);
  Iterator<SemanticNode> it=node.depthFirstChildren();
  for (; it.hasNext(); ) {
    SemanticNode child=it.next();
    children.add(child);
  }
  it=node.depthFirstChildren();
  for (; it.hasNext(); ) {
    SemanticNode child=it.next();
    List<SemanticReference> references=child.getReferences();
    for (    SemanticReference reference : references) {
      if (!children.contains(reference.getTargetNode())) {
        resolve(reference,child);
      }
    }
  }
}
