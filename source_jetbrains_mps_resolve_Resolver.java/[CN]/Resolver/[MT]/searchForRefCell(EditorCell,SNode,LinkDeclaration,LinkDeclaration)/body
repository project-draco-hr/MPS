{
  Set<EditorCell> frontier=new HashSet<EditorCell>();
  Set<EditorCell> newFrontier=new HashSet<EditorCell>();
  frontier.add(editorCell);
  while (!frontier.isEmpty()) {
    for (    EditorCell cell : frontier) {
      Object userObject=cell.getUserObject(EditorCell.METAINFO_LINK_DECLARATION);
      if (cell.getSNode() == sourceNode && (userObject == refLinkDeclaration || userObject == childLinkDeclaration)) {
        return cell;
      }
      if (cell instanceof EditorCell_Collection) {
        newFrontier.addAll(CollectionUtil.iteratorAsList(((EditorCell_Collection)cell).cells()));
      }
    }
    frontier=newFrontier;
    newFrontier=new HashSet<EditorCell>();
  }
  return null;
}
