{
  try {
    DataSource source=model.getSource();
    IFile iFile=null;
    if (source instanceof FileDataSource) {
      iFile=((FileDataSource)source).getFile();
    }
 else     if (source instanceof FilePerRootDataSource) {
      String rootName=ModelAccess.instance().runReadAction(new Computable<String>(){
        public String compute(){
          return node.getName();
        }
      }
);
      iFile=((FilePerRootDataSource)source).getFile(rootName + "." + MPSExtentions.MODEL_ROOT);
    }
    VirtualFile vFile=VirtualFileUtils.getVirtualFile(iFile);
    AbstractVcs vcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(vFile);
    VcsRevisionNumber revisionNumber=vcs.getDiffProvider().getCurrentRevision(vFile);
    ContentRevision revision=vcs.getDiffProvider().createFileContent(revisionNumber,vFile);
    final Wrappers._T<SModel> newModel=new Wrappers._T<SModel>();
    final Wrappers._T<SNodeId> id=new Wrappers._T<SNodeId>();
    final Wrappers._T<String> title=new Wrappers._T<String>();
    ModelAccess.instance().runReadAction(new Runnable(){
      public void run(){
        newModel.value=node.getModel();
        id.value=node.getNodeId();
        title.value=node.getName();
      }
    }
);
    List<DiffContent> contents=ListSequence.fromListAndArray(new ArrayList<DiffContent>(),DiffContentFactory.getInstance().create(revision.getContent(),vFile.getFileType()),DiffContentFactory.getInstance().create(project,vFile));
    List<String> titles=ListSequence.fromListAndArray(new ArrayList<String>(),revisionNumber.asString() + " (Read-Only)","Your Version");
    DiffRequest request=new SimpleDiffRequest(title.value,contents,titles);
    request.putUserData(ModelDiffViewer.DIFF_SHOW_ROOTID,id.value);
    request.putUserData(ModelDiffViewer.DIFF_NAVIGATE_TO,bounds);
    DiffManager.getInstance().showDiff(project,request);
  }
 catch (  VcsException e) {
    if (LOG.isEnabledFor(Level.WARN)) {
      LOG.warn("",e);
    }
    Messages.showErrorDialog(project,"Can't show difference due to the following error: " + e.getMessage(),"Error");
  }
}
