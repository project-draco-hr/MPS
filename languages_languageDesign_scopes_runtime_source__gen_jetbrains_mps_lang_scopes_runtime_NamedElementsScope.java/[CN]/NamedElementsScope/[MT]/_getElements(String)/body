{
  if (optimized == null) {
    if (accessCount++ > ACCESS_COUNT_LIMIT || prefix == null) {
      if (log.isDebugEnabled()) {
        log.debug("optimize on " + accessCount + " counts "+ optimized);
      }
      optimize();
    }
  }
  if (optimized == null) {
    return getElements(prefix);
  }
 else {
    if (prefix == null) {
      return MapSequence.fromMap(optimized).values();
    }
 else {
      return SetSequence.fromSet(MapSequence.fromMap(optimized).keySet()).where(new IWhereFilter<String>(){
        public boolean accept(        String it){
          return it.startsWith(prefix);
        }
      }
).select(new ISelector<String,SNode>(){
        public SNode select(        String it){
          return MapSequence.fromMap(optimized).get(it);
        }
      }
);
    }
  }
}
