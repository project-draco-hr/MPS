{
  if (editor.isCellSwapInProgress())   return;
  if (oldSelection != null && !EditorUtil.isValidCell(oldSelection)) {
    editor.flushEvents();
    ModelAccess.instance().runWriteActionInCommand(new Runnable(){
      public void run(){
        Object memento=editor.getEditorContext().createMemento();
        EditorUtil.validateCell(oldSelection,null,true,true,false);
        editor.flushEvents();
        editor.getEditorContext().setMemento(memento);
      }
    }
);
  }
}
