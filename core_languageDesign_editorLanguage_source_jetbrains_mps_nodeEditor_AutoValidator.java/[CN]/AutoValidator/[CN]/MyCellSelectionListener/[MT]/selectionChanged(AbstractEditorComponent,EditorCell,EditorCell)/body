{
  if (editor.isCellSwapInProgress())   return;
  if (oldSelection != null && (!EditorUtil.isValidCell(oldSelection) || oldSelection instanceof EditorCell_RTHint)) {
    final CellInfo cellInfo=oldSelection.getCellInfo();
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        ModelAccess.instance().runWriteActionInCommand(new Runnable(){
          public void run(){
            if (!EditorUtil.isValidCell(oldSelection)) {
              EditorCell cell=cellInfo.findCell(editor);
              if (cell != null) {
                Object memento=editor.getEditorContext().createMemento();
                EditorUtil.validateCell(cell,null,true,true,false);
                editor.flushEvents();
                editor.getEditorContext().setMemento(memento);
              }
            }
            if (oldSelection instanceof EditorCell_RTHint) {
              oldSelection.getSNode().removeRightTransformHint();
            }
          }
        }
);
      }
    }
);
  }
}
