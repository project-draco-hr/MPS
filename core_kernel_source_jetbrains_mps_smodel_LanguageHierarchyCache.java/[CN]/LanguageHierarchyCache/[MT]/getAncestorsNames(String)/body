{
  if (myAncestorsNamesMap.containsKey(conceptFqName)) {
    return Collections.unmodifiableSet(myAncestorsNamesMap.get(conceptFqName));
  }
 else {
    return NodeReadAccessCaster.runReadTransparentAction(new Computable<Set<String>>(){
      public Set<String> compute(){
        Set<String> result=new LinkedHashSet<String>();
        AbstractConceptDeclaration declaration=SModelUtil_new.findConceptDeclaration(conceptFqName,GlobalScope.getInstance());
        Set<String> parents=new LinkedHashSet<String>();
        if (declaration == null) {
          return result;
        }
        result.add(conceptFqName);
        if (declaration instanceof ConceptDeclaration) {
          ConceptDeclaration cd=(ConceptDeclaration)declaration;
          ConceptDeclaration extendedConcept=cd.getExtends();
          if (extendedConcept != null) {
            String fqName=NameUtil.nodeFQName(extendedConcept);
            Language declaringLanguage=SModelUtil.getDeclaringLanguage(fqName,GlobalScope.getInstance());
            if (declaringLanguage != null) {
              parents.add(fqName);
              result.addAll(getAncestorsNames(fqName));
            }
          }
          for (          InterfaceConceptReference icr : cd.getImplementses()) {
            InterfaceConceptDeclaration interfaceConcept=icr.getIntfc();
            if (interfaceConcept == null)             continue;
            String fqName=NameUtil.nodeFQName(interfaceConcept);
            Language declaringLanguage=SModelUtil.getDeclaringLanguage(fqName,GlobalScope.getInstance());
            if (declaringLanguage == null)             continue;
            parents.add(fqName);
            result.addAll(getAncestorsNames(fqName));
          }
        }
        if (declaration instanceof InterfaceConceptDeclaration) {
          InterfaceConceptDeclaration icd=(InterfaceConceptDeclaration)declaration;
          for (          InterfaceConceptReference icr : icd.getExtendses()) {
            InterfaceConceptDeclaration interfaceConcept=icr.getIntfc();
            if (interfaceConcept == null)             continue;
            String fqName=NameUtil.nodeFQName(interfaceConcept);
            Language declaringLanguage=SModelUtil.getDeclaringLanguage(fqName,GlobalScope.getInstance());
            if (declaringLanguage == null)             continue;
            parents.add(fqName);
            result.addAll(getAncestorsNames(fqName));
          }
        }
        myParentsNamesMap.put(conceptFqName,parents);
        myAncestorsNamesMap.put(conceptFqName,result);
        return Collections.unmodifiableSet(result);
      }
    }
);
  }
}
