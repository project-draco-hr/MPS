{
  IFile file=getDataFile(module);
  SModel model;
  FileDataSource dataSource=new FileDataSource(file);
  ModelFactory factory=PersistenceRegistry.getInstance().getModelFactory(MPSExtentions.MODEL);
  Map<String,String> options=MapSequence.<String,String>fromMapAndKeysArray(new HashMap<String,String>(),ModelFactory.OPTION_MODELNAME,ModelFactory.OPTION_MODULEREF).withValues("migrationData",dataModule.getModuleReference().toString());
  try {
    model=factory.create(dataSource,options);
  }
 catch (  IOException e) {
    throw new RuntimeException();
  }
  for (  Tuples._2<MigrationScriptReference,SNode> p : Sequence.fromIterable(data)) {
    SNode stepData=SModelOperations.createNewRootNode(model,"jetbrains.mps.lang.migration.util.structure.StepData",null);
    SLinkOperations.setTarget(stepData,"script",createMigrationScriptReference_hzite5_a0b0g0a(p._0().getModuleReference().toString(),p._0().getFromVersion()),true);
    SLinkOperations.setTarget(stepData,"data",p._1(),true);
  }
  try {
    factory.save(model,dataSource);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  ModelSaveException e) {
    throw new RuntimeException(e);
  }
}
