{
  SModelRepository modelRepository=SModelRepository.getInstance();
  Map<SModelReference,Integer> dependencies=refactoringContext.getStructureModification().getDependencies();
  Set<SModelDescriptor> result=new HashSet<SModelDescriptor>();
  for (  SModelReference ref : dependencies.keySet())   result.add(modelRepository.getModelDescriptor(ref));
  for (  SModelDescriptor descr : modelRepository.getModelDescriptors()) {
    if (!SModelStereotype.isUserModel(descr) || descr.getLoadingState() == ModelLoadingState.NOT_LOADED)     continue;
    for (    ImportElement elem : SModelOperations.getAllImportElements(descr.getSModel())) {
      if (dependencies.containsKey(elem.getModelReference())) {
        result.add(descr);
        break;
      }
    }
  }
  return result;
}
