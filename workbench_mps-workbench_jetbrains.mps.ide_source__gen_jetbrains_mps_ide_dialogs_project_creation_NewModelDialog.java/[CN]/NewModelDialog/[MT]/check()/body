{
  Object selected=myModelRoots.getSelectedItem();
  if (!((selected instanceof ModelRoot))) {
    setErrorText("Model root is not selected");
    return false;
  }
  ModelRoot mr=((ModelRoot)selected);
  String modelName=myModelName.getText();
  if (modelName.length() == 0) {
    setErrorText("Empty model name isn't allowed");
    return false;
  }
  if (modelName.lastIndexOf(".") == modelName.length()) {
    setErrorText("Empty model short name isn't allowed");
    return false;
  }
  if (myModule instanceof Language) {
    if (LanguageAspectSupport.isLanguageModelNameForbidden(modelName)) {
      String shortName=modelName.substring(modelName.lastIndexOf(".") + 1);
      setErrorText("This name isn't allowed because '" + shortName + "' is language aspect name");
    }
  }
  if (!(SourceVersion.isName(modelName))) {
    setErrorText("Model name should be valid Java package");
    return false;
  }
  if (!(mr.canCreateModels())) {
    setErrorText("Can't create a model under this model root");
    return false;
  }
  if (!(mr.canCreateModel(getFqName())) && !(myModule instanceof Language)) {
    setErrorText("Can't create a model with this name under this model root");
    return false;
  }
  if (!(mr.canCreateModel(getFqName())) && myModule instanceof Language && !(mr instanceof FileBasedModelRoot)) {
    setErrorText("Can't create a model with this name under this model root");
    return false;
  }
  setErrorText(null);
  return true;
}
