{
  rebuildNow();
  TreeUtil.expandAll(this);
  myActions=getRootActions();
  Sequence.fromIterable(myActions).visitAll(new IVisitor<BaseAction>(){
    public void visit(    BaseAction a){
      a.registerCustomShortcutSet(a.getShortcutSet(),DiffModelTree.this);
    }
  }
);
  setCellRenderer(new ColoredTreeCellRenderer(){
    @Override public void customizeCellRenderer(    JTree p0,    Object value,    boolean p2,    boolean p3,    boolean p4,    int p5,    boolean p6){
      if (value instanceof DiffModelTree.TreeNode) {
        ((DiffModelTree.TreeNode)value).renderTreeNode(this);
      }
    }
  }
);
  setPopupGroup(ActionUtils.groupFromActions(Sequence.fromIterable(myActions).toGenericArray(BaseAction.class)),ActionPlaces.CHANGES_VIEW_POPUP);
  addMouseListener(new DiffModelTree.MyMouseListener());
  getSelectionModel().addTreeSelectionListener(new TreeSelectionListener(){
    public void valueChanged(    TreeSelectionEvent e){
      DiffModelTree.RootTreeNode[] node=getSelectedNodes(DiffModelTree.RootTreeNode.class,null);
      if (node == null || node.length != 1) {
        onUnselect();
      }
 else {
        onSelectRoot(node[0].getRootId());
      }
    }
  }
);
}
