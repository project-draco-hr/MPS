{
  Set<SDependency> dependencies=new HashSet<SDependency>();
  dependencies.addAll(IterableUtil.asCollection(super.getDeclaredDependencies()));
  for (  SModuleReference language : getExtendedLanguageRefs()) {
    final SModule langModule=language.resolve(getRepository());
    if (langModule != null) {
      dependencies.add(new SDependencyImpl(langModule,SDependencyScope.EXTENDS,true));
    }
  }
  if (BootstrapLanguages.coreLanguage() == null)   throw new IllegalStateException("Repository is not in a valid state: core language is not present");
  dependencies.add(new SDependencyImpl(BootstrapLanguages.coreLanguage(),SDependencyScope.DEFAULT,true));
  return dependencies;
}
