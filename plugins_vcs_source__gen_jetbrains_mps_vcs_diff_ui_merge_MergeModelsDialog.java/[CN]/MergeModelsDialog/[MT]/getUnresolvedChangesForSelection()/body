{
  Iterable<ModelChange> changesForRoots;
  if (myMergeTree.getSelectedNodes(DiffModelTree.ModelTreeNode.class,null).length == 1) {
    changesForRoots=myMergeSession.getAllChanges();
  }
 else {
    changesForRoots=Sequence.fromIterable(Sequence.fromArray(myMergeTree.getSelectedNodes(DiffModelTree.RootTreeNode.class,null))).select(new ISelector<DiffModelTree.RootTreeNode,SNodeId>(){
      public SNodeId select(      DiffModelTree.RootTreeNode rtn){
        return rtn.getRootId();
      }
    }
).translate(new ITranslator2<SNodeId,ModelChange>(){
      public Iterable<ModelChange> translate(      SNodeId root){
        return (root == null ? myMergeSession.getMetadataChanges() : myMergeSession.getChangesForRoot(root));
      }
    }
);
  }
  return Sequence.fromIterable(changesForRoots).where(new IWhereFilter<ModelChange>(){
    public boolean accept(    ModelChange ch){
      return !(myMergeSession.isChangeResolved(ch));
    }
  }
);
}
