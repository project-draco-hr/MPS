{
  if ((projectName == null || projectName.length() == 0)) {
    for (    Project project : ProjectManager.getInstance().getOpenProjects()) {
      if (project != null) {
        test.setProject(project);
        break;
      }
    }
    if (test.getProject() == null) {
      Assert.fail("MPS Project was not specified in test class, no currently open project were found.");
    }
  }
 else {
    String expandPath=MacrosFactory.getGlobal().expandPath(projectName);
    test.setProject(TestMain.PROJECT_CONTAINER.getProject(expandPath));
  }
}
