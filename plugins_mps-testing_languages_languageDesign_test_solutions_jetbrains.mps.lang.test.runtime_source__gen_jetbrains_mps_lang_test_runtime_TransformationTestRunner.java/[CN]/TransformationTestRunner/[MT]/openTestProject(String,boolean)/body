{
  if (reopenProject) {
    for (    final Project project : ActiveEnvironment.get().openedProjects()) {
      try {
        SwingUtilities.invokeAndWait(new Runnable(){
          public void run(){
            project.dispose();
          }
        }
);
      }
 catch (      Exception e) {
        if (LOG.isEnabledFor(Priority.ERROR)) {
          LOG.error("",e);
        }
      }
    }
  }
  if ((projectPathName == null || projectPathName.length() == 0)) {
    if (LOG.isEnabledFor(Priority.WARN)) {
      LOG.warn("Project path is empty");
    }
    return anyOpenedProject();
  }
 else {
    String expandedProjectPath=MacrosFactory.getGlobal().expandPath(projectPathName);
    File projectPath=new File(expandedProjectPath);
    Project project=ActiveEnvironment.get().openProject(projectPath);
    return project;
  }
}
