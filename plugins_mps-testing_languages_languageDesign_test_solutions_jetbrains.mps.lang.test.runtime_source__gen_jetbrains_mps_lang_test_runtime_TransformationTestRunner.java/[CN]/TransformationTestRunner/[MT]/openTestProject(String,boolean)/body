{
  String expandedProjectPath=MacrosFactory.getGlobal().expandPath(projectPathName);
  File projectToOpen=new File(expandedProjectPath);
  if ((expandedProjectPath == null || expandedProjectPath.length() == 0)) {
    if (LOG.isEnabledFor(Level.WARN)) {
      LOG.warn("Project path is empty");
    }
    Project openedProject=anyOpenedProject();
    if (reopenProject) {
      openedProject.dispose();
    }
  }
 else {
    if (reopenProject) {
      Project openedProject=myEnvironment.openProject(projectToOpen);
      openedProject.dispose();
    }
  }
  return myEnvironment.openProject(projectToOpen);
}
