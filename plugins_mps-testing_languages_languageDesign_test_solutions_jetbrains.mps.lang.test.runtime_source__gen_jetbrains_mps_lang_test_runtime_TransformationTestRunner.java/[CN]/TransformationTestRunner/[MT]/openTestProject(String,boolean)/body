{
  if (reopenProject) {
    ActiveEnvironment.getInstance().disposeProject(new File(projectPathName));
  }
  if ((projectPathName == null || projectPathName.length() == 0)) {
    if (LOG.isEnabledFor(Priority.WARN)) {
      LOG.warn("Project path is empty");
    }
    return anyOpenedProject();
  }
 else {
    String expandedProjectPath=MacrosFactory.getGlobal().expandPath(projectPathName);
    File projectPath=new File(expandedProjectPath);
    Project project=ActiveEnvironment.getInstance().openProject(projectPath);
    return project;
  }
}
