{
  test.setProject(testProject);
  ThreadUtils.runInUIThreadAndWait(new Runnable(){
    @Override public void run(){
      ModelAccess.instance().runWriteActionInCommand(new Runnable(){
        public void run(){
          initialize(test,modelName);
        }
      }
,testProject);
    }
    private void initialize(    final TransformationTest test,    final String modelName){
      SModel modelDescriptor=findModel(modelName);
      test.setModelDescriptor(modelDescriptor);
      test.init();
    }
    private SModel findModel(    final String modelName){
      SModel modelDescriptor=SModelRepository.getInstance().getModelDescriptor(PersistenceFacade.getInstance().createModelReference(modelName));
      if (modelDescriptor == null) {
        Assert.fail("Can't find model " + modelName + " in projects "+ Arrays.toString(ProjectManager.getInstance().getOpenProjects())+ ".");
      }
      return modelDescriptor;
    }
  }
);
}
