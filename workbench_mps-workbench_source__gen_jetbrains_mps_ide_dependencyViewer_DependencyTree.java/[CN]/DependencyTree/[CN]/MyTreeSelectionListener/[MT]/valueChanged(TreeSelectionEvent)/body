{
  TreePath[] paths=getSelectionPaths();
  if (paths == null || paths.length == 0) {
    return;
  }
  Scope scope=new Scope();
  for (  TreePath path : paths) {
    MPSTreeNode node=(MPSTreeNode)path.getLastPathComponent();
    if (node instanceof SModelTreeNode) {
      scope.add(((SModelTreeNode)node).getSModelDescriptor());
    }
    if (node instanceof ProjectModuleTreeNode) {
      scope.add(((ProjectModuleTreeNode)node).getModule());
    }
    if (node instanceof SNodeTreeNode) {
      scope.add(((SNodeTreeNode)node).getSNode());
    }
    if (node instanceof NamespaceTextNode) {
      for (      SModule module : ((NamespaceTextNode)node).getModulesUnder()) {
        scope.add(module);
      }
      for (      SModelDescriptor model : ((NamespaceTextNode)node).getModelsUnder()) {
        scope.add(model);
      }
    }
    if (node instanceof PackageNode) {
      for (      jetbrains.mps.smodel.SNode nodeUnder : ((PackageNode)node).getNodesUnderPackage()) {
        scope.add(nodeUnder);
      }
    }
  }
  myParent.updateTargetsView(scope);
}
