{
  final List<List<V>> cycles=ListSequence.fromList(new ArrayList<List<V>>());
  Sequence.fromIterable(ws).sort(new ISelector<CycleDetector.Wrapper<V>,Comparable<?>>(){
    public Comparable<?> select(    CycleDetector.Wrapper<V> w){
      return w.endTime;
    }
  }
,false).where(new IWhereFilter<CycleDetector.Wrapper<V>>(){
    public boolean accept(    CycleDetector.Wrapper<V> w){
      return !(w.entered);
    }
  }
).visitAll(new IVisitor<CycleDetector.Wrapper<V>>(){
    public void visit(    final CycleDetector.Wrapper<V> w){
      dfsVisitProc(w,new _FunctionTypes._void_P1_E0<CycleDetector.Wrapper<V>>(){
        public void invoke(        CycleDetector.Wrapper<V> ww){
        }
      }
,new _FunctionTypes._void_P1_E0<CycleDetector.Wrapper<V>>(){
        public void invoke(        CycleDetector.Wrapper<V> ww){
          w.successor(ww);
        }
      }
,backward);
      if (ListSequence.fromList(w.successors).isNotEmpty()) {
        List<V> cycle=ListSequence.fromListAndArray(new ArrayList<V>(),w.vertex);
        collectSuccessors(w,cycle);
        ListSequence.fromList(cycles).addElement(cycle);
      }
    }
  }
);
  return cycles;
}
