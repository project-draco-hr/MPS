{
  VirtualFile[] files=newLibrary.getFiles(OrderRootType.CLASSES);
  Collection<Solution> allModules=ModuleRepositoryFacade.getInstance().getAllModules(Solution.class);
  for (  VirtualFile file : files) {
    for (    Solution solution : allModules) {
      if (!(solution instanceof SolutionIdea) && !(solution instanceof StubSolution)) {
        VirtualFile solutionBundleHome=SolutionLibraryType.getJarFile(solution.getBundleHome().getPath());
        if (solutionBundleHome != null && solutionBundleHome.equals(file)) {
          addLibrary(newLibrary,solution.getModuleReference());
        }
      }
    }
  }
}
