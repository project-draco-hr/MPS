{
  return new IJob(){
    public IResult execute(    final Iterable<IResource> input,    final IMonitor monitor,    final IVariablesPool pool){
      Iterable<IResource> _output_21gswx_a0a=null;
switch (0) {
case 0:
        FileProcessor fileProc=new FileProcessor();
      for (      IResource resource : input) {
        GResource gr=(GResource)resource;
        if (!(gr.data.status().isOk())) {
          Logger.getLogger("jetbrains.mps.make.TextGen").error("Generation was not OK");
          return new IResult.FAILURE(_output_21gswx_a0a);
        }
        IFile targetDir=FileSystem.getInstance().getFileByPath(gr.data.module().getOutputFor(gr.data.model()));
        JavaStreamHandler javaStreamHandler=new JavaStreamHandler(gr.data.model(),targetDir,fileProc);
        try {
          ModelGenerationStatusManager mgsm=ModelGenerationStatusManager.getInstance();
          BLDependenciesCache bldc=BLDependenciesCache.getInstance();
          TraceInfoCache tic=TraceInfoCache.getInstance();
          GenerationDependenciesCache gdc=GenerationDependenciesCache.getInstance();
          if (mgsm == null || bldc == null || tic == null || gdc == null) {
            Logger.getLogger("jetbrains.mps.make.TextGen").error("Something's wrong" + mgsm + bldc+ tic+ gdc);
          }
          if (!(new TextGenerator(javaStreamHandler,mgsm.getCacheGenerator(),bldc.getGenerator(),tic.getGenerator(),gdc.getGenerator()).handleOutput(pool.<Generator_Facet.Target_ixz87t_a.Variables>variables(new ITarget.Name("Parameters"),Generator_Facet.Target_ixz87t_a.Variables.class).operationContext(),gr.data.status()))) {
            Logger.getLogger("jetbrains.mps.make.TextGen").error("TextGenerator returned false");
            return new IResult.FAILURE(_output_21gswx_a0a);
          }
          _output_21gswx_a0a=Sequence.fromIterable(_output_21gswx_a0a).concat(Sequence.fromIterable(Sequence.<IResource>singleton(gr)));
        }
  finally {
          javaStreamHandler.dispose();
        }
      }
    fileProc.saveGeneratedFiles();
  Logger.getLogger("jetbrains.mps.make.TextGen").error("TextGen completed");
default :
return new IResult.SUCCESS(_output_21gswx_a0a);
}
}
}
;
}
