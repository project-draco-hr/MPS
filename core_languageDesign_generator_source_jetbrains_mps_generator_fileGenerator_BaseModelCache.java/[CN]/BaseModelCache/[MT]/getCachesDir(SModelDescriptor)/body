{
  IModule module=sm.getModule();
  String outputPath=module.getGeneratorOutputPath();
  if (outputPath == null)   return null;
  if (module.isPackaged()) {
    String suffix=outputPath;
    int index=outputPath.replace("\\","/").lastIndexOf("/");
    if (index >= 0) {
      suffix=outputPath.substring(index + 1);
    }
    IFile descriptorFile;
    if (module instanceof Generator) {
      descriptorFile=((Generator)module).getSourceLanguage().getDescriptorFile();
    }
 else {
      descriptorFile=module.getDescriptorFile();
    }
    return FileGenerationUtil.getDefaultOutputDir(sm,descriptorFile.getParent().getParent().child(FileGenerationUtil.getCachesPath(suffix)));
  }
 else {
    IFile cachesDir=FileSystem.getFile(FileGenerationUtil.getCachesOutputDir(new File(outputPath)));
    return FileGenerationUtil.getDefaultOutputDir(sm,cachesDir);
  }
}
