{
  myAllCaches.registerCache(this);
  myFileGeneratorManager.addCachesGenerator(new CacheGenerator(){
    public File generateCache(    CacheGenerationContext context){
      T cache=BaseModelCache.this.generateCache(context);
      if (cache == null)       return null;
      SModelDescriptor model=context.getOriginalInputModel();
synchronized (myCache) {
        myCache.put(model,cache);
      }
      IFile cacheFile=getCacheFile(model);
      if (cacheFile == null)       return null;
      OutputStream os=null;
      try {
        os=cacheFile.openOutputStream();
        save(cache,os);
      }
 catch (      IOException e) {
        LOG.error(e);
      }
 finally {
        if (os != null) {
          try {
            os.close();
          }
 catch (          IOException e) {
            LOG.error(e);
          }
        }
      }
      return cacheFile.toFile();
    }
  }
);
}
