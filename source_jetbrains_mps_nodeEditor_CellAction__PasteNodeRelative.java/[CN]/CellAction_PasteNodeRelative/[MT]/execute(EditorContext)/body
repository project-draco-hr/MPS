{
  LOG.assertInCommand();
  IOperationContext operationContext=context.getOperationContext();
  EditorCell selectedCell=context.getNodeEditorComponent().getSelectedCell();
  SNode anchorNode=selectedCell.getSNode();
  PasteNodeData pasteNodeData=CopyPasteUtil.getPasteNodeDataFromClipboard(anchorNode.getModel());
  List<SNode> pasteNodes=pasteNodeData.getNodes();
  Set<SReference> outgoingReferences=pasteNodeData.getOutgoingReferences();
  PasteNodeUtil.pasteRelative(anchorNode,pasteNodes.get(0),myPasteBefore,operationContext);
  anchorNode=pasteNodes.get(0);
  for (int i=1; i < pasteNodes.size(); i++) {
    SNode node=pasteNodes.get(i);
    PasteNodeUtil.pasteRelative(anchorNode,node,false,operationContext);
    anchorNode=node;
  }
  Resolver.resolveReferences(outgoingReferences,operationContext);
}
