{
  final SModelReference mr=templateNode.getModelReference();
  GeneratorQueryProvider queryProvider=myQueries.get(mr);
  if (queryProvider != null) {
    return queryProvider;
  }
  TemplateModel templateModel=myTemplateModels.get(mr);
  if (templateModel == null) {
    myLog.error(templateNode,"Attempt to generate with generator not included into the plan");
    queryProvider=instantiateProvider(templateNode,myLog);
  }
 else {
    queryProvider=templateModel.getQueryProvider();
  }
  if (queryProvider == null) {
    queryProvider=new QueryProviderBase(1){
    }
;
  }
  myQueries.put(mr,queryProvider);
  return queryProvider;
}
