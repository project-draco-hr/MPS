{
  ModelAccess.assertLegalRead();
  myLock.writeLock().lock();
  try {
    if (myPaths.containsKey(path)) {
      return;
    }
    if (modelRoot instanceof FileSystemListener) {
      myListenerDependencies.add((FileSystemListener)modelRoot);
    }
 else     if (modelRoot != null && modelRoot.getModule() instanceof FileSystemListener) {
      myListenerDependencies.add((FileSystemListener)modelRoot.getModule());
    }
    IFile file=FileSystem.getInstance().getFileByPath(path);
    PathListener listener=new PathListener(file,this);
    myPaths.put(path,listener);
    if (!(myListeners.isEmpty())) {
      FileSystem.getInstance().addListener(listener);
    }
  }
  finally {
    myLock.writeLock().unlock();
  }
}
