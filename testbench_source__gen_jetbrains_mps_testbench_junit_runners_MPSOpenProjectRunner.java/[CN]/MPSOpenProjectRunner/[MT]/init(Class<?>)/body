{
  String projectPath=getProjectPath(testClass);
  BasicConfigurator.configure();
  Logger.getRootLogger().setLevel(Level.INFO);
  IdeMain.setTestMode(IdeMain.TestMode.CORE_TEST);
  TestMain.configureMPS();
  initPathMacros();
  try {
    SwingUtilities.invokeAndWait(new Runnable(){
      @Override public void run(){
        ModelAccess.instance().runWriteAction(new Runnable(){
          public void run(){
            LibraryInitializer.getInstance().update();
          }
        }
);
      }
    }
);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  if (ourMPSProject != null) {
    throw new InitializationError("One MPS project was already openned in this java process: " + ourMPSProject.getName() + " (on trying to open: "+ projectPath+ ")");
  }
  ourMPSProject=TestMain.PROJECT_CONTAINER.getProject(projectPath);
  ModelAccess.instance().flushEventQueue();
}
