{
  super(parent,windowTitle);
  setModal(modal);
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      myDifferenceComponent=new ModelDifferenceComponent(context){
        @Override protected void doubleClickOnNode(        final SNode node){
          final SNode rootNode=ModelAccess.instance().runReadAction(new Computable<SNode>(){
            public SNode compute(){
              return node.getContainingRoot();
            }
          }
);
          final RootDifferenceDialog dialog=new RootDifferenceDialog(context.getMainFrame(),newModel,oldModel,false,modal);
          ModelAccess.instance().runReadAction(new Runnable(){
            public void run(){
              dialog.init(context,rootNode,contentTitles[1],contentTitles[0]);
            }
          }
);
          dialog.showDialog();
          updateDiff(oldModel,newModel);
        }
      }
;
      myDifferenceComponent.showDifference(oldModel,newModel);
    }
  }
);
  myFocusTrackback=new FocusTrackback(this,parent,false);
  WindowAdapter focusListener=new WindowAdapter(){
    public void windowOpened(    WindowEvent e){
      if (myDifferenceComponent != null) {
        myDifferenceComponent.requestFocusInWindow();
        myFocusTrackback.registerFocusComponent(myDifferenceComponent);
      }
    }
  }
;
  addWindowListener(focusListener);
  myFocusWatcher=new FocusWatcher(){
    protected void focusLostImpl(    final FocusEvent e){
      myFocusTrackback.consume();
    }
  }
;
  myFocusWatcher.install(myDifferenceComponent);
}
