{
  if (!FileSystem.isPackaged(ifile)) {
    return new File(ifile.getAbsolutePath());
  }
  OutputStream os=null;
  InputStream is=null;
  try {
    File tmpFile=File.createTempFile(ifile.getName(),"tmp");
    tmpFile.deleteOnExit();
    is=new BufferedInputStream(ifile.openInputStream());
    os=new BufferedOutputStream(new FileOutputStream(tmpFile));
    int c;
    while ((c=is.read()) != -1) {
      os.write(c);
    }
    return tmpFile;
  }
 catch (  IOException ex) {
    throw new RuntimeException(ex);
  }
 finally {
    try {
      if (is != null) {
        is.close();
      }
    }
 catch (    IOException ignore) {
    }
    try {
      if (os != null) {
        os.close();
      }
    }
 catch (    IOException ignore) {
    }
  }
}
