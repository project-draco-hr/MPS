{
  Set<SModule> loadedModules=new LinkedHashSet<SModule>();
  try {
    monitor.start("Loading modules...",toLoad.size());
    for (    SModule module : toLoad) {
      ModuleClassLoader classLoader=createModuleClassLoader(module);
      putClassLoader(module,classLoader);
      if (getClassLoadingProgress(module) == ClassLoadingProgress.UNLOADED)       loadedModules.add(module);
      onLoaded(module);
      monitor.advance(1);
    }
  }
  finally {
    monitor.done();
  }
  return loadedModules;
}
