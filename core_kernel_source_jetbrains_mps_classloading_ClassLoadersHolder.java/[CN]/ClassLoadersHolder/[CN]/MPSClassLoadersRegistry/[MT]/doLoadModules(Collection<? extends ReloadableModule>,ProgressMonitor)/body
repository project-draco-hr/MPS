{
  try {
    monitor.start("Loading modules...",toLoad.size());
    for (    ReloadableModule module : toLoad) {
      SModuleReference moduleReference=module.getModuleReference();
      ClassLoadingProgress progress=getClassLoadingProgress(moduleReference);
      if (progress == ClassLoadingProgress.UNLOADED) {
        throw new IllegalStateException("Module " + moduleReference + " is in UNLOADED state, i.e. the class loading clients know nothing about this module");
      }
 else       if (progress == ClassLoadingProgress.LAZY_LOADED) {
        ModuleClassLoader classLoader=createModuleClassLoader(module);
        putClassLoader(moduleReference,classLoader);
        onLoaded(moduleReference);
      }
      monitor.advance(1);
    }
  }
  finally {
    monitor.done();
  }
}
