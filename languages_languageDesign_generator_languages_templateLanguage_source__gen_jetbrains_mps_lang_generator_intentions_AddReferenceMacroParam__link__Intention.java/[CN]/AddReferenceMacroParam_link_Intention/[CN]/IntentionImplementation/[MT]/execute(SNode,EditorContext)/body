{
  SNode referenceMacro=EditingUtil.addReferenceMacro(node,editorContext.getSelectedCell());
  SNode referentValue=SNodeFactoryOperations.createNewNode("jetbrains.mps.lang.generator.structure.ReferenceMacro_GetReferent",null);
  SNode dotExpression=SNodeFactoryOperations.createNewNode("jetbrains.mps.baseLanguage.structure.DotExpression",null);
  SNode linkAccess=SNodeFactoryOperations.createNewNode("jetbrains.mps.lang.smodel.structure.SLinkAccess",null);
  SLinkOperations.setTarget(linkAccess,"link",myParameter,false);
  SLinkOperations.setTarget(dotExpression,"operation",linkAccess,true);
  SLinkOperations.setTarget(dotExpression,"operand",SNodeFactoryOperations.createNewNode("jetbrains.mps.lang.generator.structure.TemplateFunctionParameter_sourceNode",null),true);
  SNode expressionStatement=SNodeFactoryOperations.createNewNode("jetbrains.mps.baseLanguage.structure.ExpressionStatement",null);
  SLinkOperations.setTarget(expressionStatement,"expression",dotExpression,true);
  ListSequence.fromList(SLinkOperations.getTargets(SLinkOperations.getTarget(referentValue,"body",true),"statement",true)).addElement(expressionStatement);
  SLinkOperations.setTarget(referenceMacro,"referentFunction",referentValue,true);
  SelectionUtil.selectLabelCellAnSetCaret(editorContext,referenceMacro,SelectionManager.FIRST_CELL,2);
}
