{
  HashMap<SNode,SNode> mapping=new HashMap<SNode,SNode>();
  SNode result=clone(node,mapping,true);
  for (  SNode sourceNode : mapping.keySet()) {
    mapping.get(sourceNode).setId(sourceNode.getSNodeId());
  }
  addReferences(node,mapping,true,cloneRefs);
  return result;
}
