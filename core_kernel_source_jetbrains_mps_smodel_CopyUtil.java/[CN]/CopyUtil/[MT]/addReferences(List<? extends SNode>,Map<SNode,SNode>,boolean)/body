{
  for (  SNode node : sourceNodes) {
    SNode target=mapping.get(node);
    for (    SReference ref : node.getReferences()) {
      SNode targetNode=ref.getTargetNode();
      if (targetNode == null) {
        if (ref instanceof StaticReference) {
          StaticReference staticReference=(StaticReference)ref;
          target.addReference(new StaticReference(staticReference.getRole(),staticReference.getSourceNode(),staticReference.getTargetModelUID(),staticReference.getTargetNodeId(),staticReference.getResolveInfo()));
        }
      }
 else       if (mapping.containsKey(targetNode)) {
        target.setReferent(ref.getRole(),mapping.get(targetNode),false);
      }
 else {
        target.setReferent(ref.getRole(),targetNode,false);
      }
    }
    List<SNode> childList=new ArrayList<SNode>();
    for (    String role : node.getChildRoles(copyAttributes)) {
      for (      SNode child : node.getChildren(role)) {
        childList.add(child);
      }
    }
    addReferences(childList,mapping,copyAttributes);
  }
}
