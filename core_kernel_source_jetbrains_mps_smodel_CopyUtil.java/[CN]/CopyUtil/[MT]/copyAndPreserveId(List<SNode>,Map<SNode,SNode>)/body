{
  List<SNode> result=clone(nodes,mapping);
  for (  SNode sourceNode : mapping.keySet()) {
    ((jetbrains.mps.smodel.SNode)mapping.get(sourceNode)).setId(sourceNode.getNodeId());
  }
  for (  SNode node : nodes) {
    addReferences(node,mapping,false);
  }
  return result;
}
