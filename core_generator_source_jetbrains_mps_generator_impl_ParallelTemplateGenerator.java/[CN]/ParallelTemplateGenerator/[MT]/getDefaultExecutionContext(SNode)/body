{
  if (ROOT_PER_THREAD) {
    if (inputNode == null || inputNode.getModel() == null) {
      return super.getDefaultExecutionContext(null);
    }
    inputNode=inputNode.getContainingRoot();
    if (inputNode.getModel() == getInputModel()) {
      DefaultQueryExecutionContext context;
      if (myRootContext == null) {
        myRootContext=new HashMap<SNode,DefaultQueryExecutionContext>();
        context=null;
      }
 else {
        context=myRootContext.get(inputNode);
      }
      if (context == null) {
        context=new DefaultQueryExecutionContext(this,false);
        myRootContext.put(inputNode,context);
      }
      return context;
    }
  }
  return super.getDefaultExecutionContext(inputNode);
}
