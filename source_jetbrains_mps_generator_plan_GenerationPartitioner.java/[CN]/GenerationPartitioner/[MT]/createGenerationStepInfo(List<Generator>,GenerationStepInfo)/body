{
  Set<MappingConfiguration> processedMappings;
  Set<MappingConfiguration> deferredMappings;
  if (prevStepInfo != null) {
    processedMappings=new HashSet<MappingConfiguration>(prevStepInfo.getMappings());
    processedMappings.addAll(prevStepInfo.getMappingsProcessedOnEarlierSteps());
    deferredMappings=prevStepInfo.getMappingsToProcessOnLaterSteps();
  }
 else {
    processedMappings=new HashSet<MappingConfiguration>();
    deferredMappings=new HashSet<MappingConfiguration>();
  }
  List<List<MappingConfiguration>> mappingSets=doPartitioning(null,generators,processedMappings,deferredMappings);
  List<MappingConfiguration> mappingsForThisStep;
  Set<MappingConfiguration> mappingsToProcessOnLaterSteps=new HashSet<MappingConfiguration>();
  if (mappingSets.isEmpty()) {
    mappingsForThisStep=new ArrayList<MappingConfiguration>();
  }
 else {
    mappingsForThisStep=mappingSets.get(0);
    if (mappingSets.size() == 1) {
      mappingsToProcessOnLaterSteps.addAll(mappingSets.get(0));
    }
 else {
      for (int i=1; i < mappingSets.size(); i++) {
        mappingsToProcessOnLaterSteps.addAll(mappingSets.get(i));
      }
    }
  }
  return new GenerationStepInfo(mappingsForThisStep,processedMappings,mappingsToProcessOnLaterSteps);
}
