{
  SourcePosition sourcePosition=breakpoint.getSourcePosition();
  if (sourcePosition == null) {
    return null;
  }
  String className=null;
  PsiClass psiClass=JVMNameUtil.getClassAt(sourcePosition);
  if (psiClass == null) {
    return null;
  }
  if (PsiUtil.isLocalOrAnonymousClass(psiClass)) {
    PsiClass parentClass=getTopLevelParentClass(psiClass);
    if (parentClass == null) {
      return null;
    }
    className=JVMNameUtil.getNonAnonymousClassName(parentClass);
  }
 else {
    className=JVMNameUtil.getNonAnonymousClassName(psiClass);
  }
  if (className == null) {
    return null;
  }
  return GeneratedSourcePosition.fromLocation(breakpoint.getProject(),className,sourcePosition.getFile().getName(),breakpoint.getLineIndex() + 1);
}
