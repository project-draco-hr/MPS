{
  Integer[] labels=(Integer[])PrepStatementUtil.getPrepData(_context.getNode(),_context.getGenerator());
  int BEGIN=labels[0];
  int END=labels[1];
  List<SNode> results=new ArrayList<SNode>();
  List<SNode> stmts=StatementListUtil.selectStatementsUntilControlStatement(_context.getNode());
  do {
    int beginLabel=BEGIN;
    int endLabel=END;
    SNode lastStmt=null;
    SNode slist=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.StatementList",null);
    for (    SNode stmt : stmts) {
      SNode tmp=SNodeOperations.copyNode(stmt);
      SLinkOperations.addChild(slist,"statement",tmp);
      PrepStatementUtil.copyPrepData(stmt,tmp,_context.getGenerator());
      WrappersUtils.copyPrepData(stmt,tmp,_context.getGenerator());
      lastStmt=stmt;
    }
    SNode cstmt=null;
    if ((lastStmt != null)) {
      cstmt=StatementListUtil.nextSibling(lastStmt);
    }
 else {
      List<SNode> allstmts=(List<SNode>)SLinkOperations.getTargets(_context.getNode(),"statement",true);
      cstmt=(allstmts.size() > 0 ? allstmts.get(0) : null);
    }
    stmts=null;
    if ((cstmt != null)) {
      labels=(Integer[])PrepStatementUtil.getPrepData(cstmt,_context.getGenerator());
      endLabel=(labels != null ? labels[0] : -1);
      lastStmt=StatementListUtil.nextSibling(cstmt);
      while ((lastStmt != null)) {
        stmts=StatementListUtil.selectStatementsUntilControlStatement(_context.getNode(),lastStmt);
        if (stmts.size() == 0) {
          cstmt=lastStmt;
          lastStmt=StatementListUtil.nextSibling(lastStmt);
        }
 else {
          labels=(Integer[])PrepStatementUtil.getPrepData(cstmt,_context.getGenerator());
          BEGIN=(labels != null ? labels[labels.length - 1] : -1);
          break;
        }
      }
    }
    results.add(slist);
    PrepStatementUtil.putPrepData(slist,new Integer[]{beginLabel,endLabel},_context.getGenerator());
  }
 while (stmts != null && stmts.size() > 0);
  return results;
}
