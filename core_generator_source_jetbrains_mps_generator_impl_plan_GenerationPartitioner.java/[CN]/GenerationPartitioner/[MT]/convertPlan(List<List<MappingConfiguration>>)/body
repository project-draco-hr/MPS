{
  List<List<TemplateMappingConfiguration>> result=new ArrayList<List<TemplateMappingConfiguration>>();
  Map<SModelDescriptor,TemplateModel> descriptor2model=new HashMap<SModelDescriptor,TemplateModel>();
  for (  List<MappingConfiguration> step : plan) {
    List<TemplateMappingConfiguration> s=new ArrayList<TemplateMappingConfiguration>(step.size());
    for (    MappingConfiguration c : step) {
      SModelDescriptor d=c.getModel().getModelDescriptor();
      TemplateModel m=descriptor2model.get(d);
      if (m == null) {
        m=new TemplateModelInterpreted(c.getModel());
        descriptor2model.put(d,m);
      }
      s.add(new TemplateMappingConfigurationInterpreted(m,c.getNode()));
    }
    result.add(s);
  }
  return result;
}
