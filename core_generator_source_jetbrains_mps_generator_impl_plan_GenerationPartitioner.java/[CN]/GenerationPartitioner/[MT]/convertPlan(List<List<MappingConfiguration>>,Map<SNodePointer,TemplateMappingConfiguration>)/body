{
  List<List<TemplateMappingConfiguration>> result=new ArrayList<List<TemplateMappingConfiguration>>();
  for (  List<MappingConfiguration> step : plan) {
    List<TemplateMappingConfiguration> s=new ArrayList<TemplateMappingConfiguration>(step.size());
    for (    MappingConfiguration c : step) {
      TemplateMappingConfiguration configuration=mappingsMap.get(new SNodePointer(c.getNode()));
      if (configuration == null) {
        throw new IllegalStateException("unknown configuration found: " + c.getName());
      }
      s.add(configuration);
    }
    result.add(s);
  }
  return result;
}
