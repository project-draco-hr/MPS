{
  List<SModule> result=new ArrayList<SModule>();
  for (  SModule mod : MPSModuleRepository.getInstance().getModules()) {
    if (mod instanceof SolutionIdea) {
      Module ideaModule=((SolutionIdea)mod).getIdeaModule();
      if (ideaScope.isSearchInModuleContent(ideaModule)) {
        result.add(mod);
      }
    }
 else {
      if (!suppressSearchInLibraries && ideaScope.isSearchInLibraries()) {
        result.add(mod);
      }
    }
  }
  return result;
}
