{
  DataContext dataContext=event.getDataContext();
  RunContentDescriptor runContentDescriptor=RunContentManager.RUN_CONTENT_DESCRIPTOR.getData(dataContext);
  Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  ProcessHandler processHandler;
  if (runContentDescriptor != null) {
    processHandler=runContentDescriptor.getProcessHandler();
  }
 else {
    RunContentDescriptor selected=ExecutionManager.getInstance(project).getContentManager().getSelectedContent();
    if (selected == null) {
      selected=ExecutionManager.getInstance(project).getContentManager().getSelectedContent(DefaultDebugExecutor.getDebugExecutorInstance());
    }
    processHandler=(selected == null ? null : selected.getProcessHandler());
  }
  return DebugSessionManagerComponent.getInstance(project).getDebugSession(processHandler);
}
