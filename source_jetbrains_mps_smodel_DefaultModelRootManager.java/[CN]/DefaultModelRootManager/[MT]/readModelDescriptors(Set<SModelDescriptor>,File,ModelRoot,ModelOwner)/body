{
  if (!dir.isDirectory()) {
    return;
  }
  File[] files=dir.listFiles(new FilenameFilter(){
    public boolean accept(    File dir,    String name){
      return name.endsWith(".mps");
    }
  }
);
  for (int i=0; i < files.length; i++) {
    File file=files[i];
    String modelFQName=PathManager.getModelFQName(file,new File(modelRoot.getPath()),modelRoot.getPrefix());
    String stereotype=PathManager.getModelStereotype(file,new File(modelRoot.getPath()),modelRoot.getPrefix());
    SModelUID modelUID=new SModelUID(modelFQName,stereotype);
    SModelDescriptor modelDescriptor=MPSFileModelDescriptor.getInstance(file.getAbsolutePath(),modelUID,owner);
    LOG.debug("I've read model descriptor " + modelDescriptor.getFQName() + "\n"+ "Model root is "+ modelRoot.getPath()+ " "+ modelRoot.getPrefix());
    modelDescriptors.add(modelDescriptor);
    if (modelRoot.getIsSynchronizedWithJava()) {
      IdeMain.instance().getProject().getRootManager().addImportedModel(modelDescriptor);
    }
  }
  File[] dirs=dir.listFiles();
  for (int i=0; i < dirs.length; i++) {
    File childDir=dirs[i];
    if (childDir.isDirectory()) {
      readModelDescriptors(modelDescriptors,childDir,modelRoot,owner);
    }
  }
}
