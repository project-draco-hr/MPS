{
  super.setUp();
  this.context=new Mockery();
  final IFacet fmake=Mocks.facet(context,"Make");
  final IFacet fgen=Mocks.facet(context,"Gen");
  final ITarget tgen=Mocks.target(context,"gen");
  final IFacet ftextgen=Mocks.facet(context,"Textgen");
  final ITarget ttextgen=Mocks.target(context,"textgen");
  context.checking(new Expectations(){
{
      atLeast(1).of(fgen).required();
      will(returnValue(Sequence.fromArray(new IFacet.Name[]{fmake.getName()})));
      atLeast(1).of(fgen).targets(with(aNonNull(Map.class)));
      will(returnValue(Sequence.fromArray(new ITarget[]{tgen})));
      atLeast(1).of(ftextgen).required();
      will(returnValue(Sequence.fromArray(new IFacet.Name[]{fmake.getName(),fgen.getName()})));
      atLeast(1).of(ftextgen).targets(with(aNonNull(Map.class)));
      will(returnValue(Sequence.fromArray(new ITarget[]{ttextgen})));
    }
  }
);
  FacetRegistry.getInstance().register(fmake);
  FacetRegistry.getInstance().register(fgen);
  FacetRegistry.getInstance().register(ftextgen);
  Mocks.allowing(context,fmake);
  Mocks.allowing(context,fgen);
  Mocks.allowing(context,ftextgen);
  this.facets=new IFacet[]{fmake,fgen,ftextgen};
}
