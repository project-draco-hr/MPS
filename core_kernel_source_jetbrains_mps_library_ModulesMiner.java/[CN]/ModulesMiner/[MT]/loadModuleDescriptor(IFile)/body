{
  try {
    String filePath=file.getPath();
    if (filePath.endsWith(META_INF_MODULE_XML)) {
      DeploymentDescriptor deploymentDescriptor=DeploymentDescriptorPersistence.loadDeploymentDescriptor(file);
      ModuleDescriptor result=null;
      IFile realDescriptorFile=getRealDescriptorFile(filePath,deploymentDescriptor);
      if (realDescriptorFile != null) {
        result=loadModuleDescriptor(realDescriptorFile);
      }
      if (result != null) {
        result.setDeploymentDescriptor(deploymentDescriptor);
      }
      return result;
    }
 else {
      return DescriptorIOFacade.getInstance().fromFileType(file).readFromFile(file);
    }
  }
 catch (  Exception t) {
    LOG.error("Fail to load module from descriptor " + file.getPath(),t);
    return null;
  }
}
