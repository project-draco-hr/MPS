{
  try {
    String filePath=file.getPath();
    if (filePath.endsWith(META_INF_MODULE_XML)) {
      DeploymentDescriptor deploymentDescriptor=DeploymentDescriptorPersistence.loadDeploymentDescriptor(file);
      ModuleDescriptor result=null;
      IFile realDescriptorFile=getRealDescriptorFile(filePath,deploymentDescriptor);
      if (realDescriptorFile != null) {
        result=loadModuleDescriptor(realDescriptorFile);
      }
      if (result != null) {
        result.setDeploymentDescriptor(deploymentDescriptor);
      }
      return result;
    }
 else {
      String extension=getModuleExtension(file.getName());
      Class<? extends IModule> cls=myExtensionsToModuleTypes.get(extension);
      if (cls == Language.class) {
        return LanguageDescriptorPersistence.loadLanguageDescriptor(file);
      }
 else       if (cls == Solution.class) {
        return SolutionDescriptorPersistence.loadSolutionDescriptor(file);
      }
 else {
        return DevkitDescriptorPersistence.loadDevKitDescriptor(file);
      }
    }
  }
 catch (  Exception t) {
    LOG.error("Fail to load module from descriptor " + file.getPath(),t);
    return null;
  }
}
