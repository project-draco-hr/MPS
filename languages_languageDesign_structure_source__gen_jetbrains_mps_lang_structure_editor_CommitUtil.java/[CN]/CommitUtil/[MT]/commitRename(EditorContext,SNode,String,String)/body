{
  boolean refactor=false;
  if (oldValue != null) {
    if (oldValue.equals(newValue)) {
      return;
    }
    int res=JOptionPane.showConfirmDialog(editorContext.getNodeEditorComponent(),"Renaming " + "this element" + " can break your model. It is advised to use refactoring for this. Execute refactoring?","Rename " + "element",JOptionPane.YES_NO_CANCEL_OPTION);
    if (res == JOptionPane.CANCEL_OPTION) {
      return;
    }
    refactor=res == JOptionPane.YES_OPTION;
  }
  if (refactor) {
    refactorRenameNode(editorContext.getOperationContext(),node,newValue);
  }
 else {
    ModelAccess.instance().runWriteActionInCommand(new Runnable(){
      public void run(){
        if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.structure.structure.LinkDeclaration")) {
          SPropertyOperations.set(SNodeOperations.cast(node,"jetbrains.mps.lang.structure.structure.LinkDeclaration"),"role",newValue);
        }
 else {
          SPropertyOperations.set(SNodeOperations.cast(node,"jetbrains.mps.lang.core.structure.INamedConcept"),"name",newValue);
        }
      }
    }
);
  }
}
