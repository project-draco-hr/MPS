{
  int i;
  long start;
  long waited;
  do {
    start=System.currentTimeMillis();
    for (i=0; i < REQUIRE_MAX_TRIES && !tryRead(r); ++i) {
      try {
        Thread.sleep((1 << i) * 100);
      }
 catch (      InterruptedException ignore) {
      }
    }
    waited=System.currentTimeMillis() - start;
  }
 while (i >= REQUIRE_MAX_TRIES && !confirmActionCancellation());
  if (i >= REQUIRE_MAX_TRIES) {
    throw new TimeOutRuntimeException("Failed to acquire write lock after having waited for " + waited + "ms");
  }
}
