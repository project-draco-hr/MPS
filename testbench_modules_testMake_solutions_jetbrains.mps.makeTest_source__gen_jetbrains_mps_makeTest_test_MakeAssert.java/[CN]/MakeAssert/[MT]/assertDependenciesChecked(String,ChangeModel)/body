{
  final Project project=launchProject();
  Assert.assertNotNull("project is not loaded",project);
  final ChangeModelProcessor changeModelProcessor=new ChangeModelProcessor(project,modelName,changer);
  final IGenerationHandler filesGenHandler=getFilesGenHandler();
  changeModelProcessor.changeStep(filesGenHandler);
  final DiffGenerationHandler genHandler=new DiffGenerationHandler(true);
  changeModelProcessor.generateTestModel(genHandler);
  changeModelProcessor.generateModelToChange(genHandler);
  final Boolean[] returnValue=new Boolean[]{null};
  final SModel testModel=changeModelProcessor.getTestModel();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      try {
        SNode test=ListSequence.fromList(SModelOperations.getRoots(testModel,null)).first();
        String className=NameUtil.nodeFQName(test);
        genHandler.compile(new EmptyProgressMonitor());
        ClassLoader classLoader=genHandler.getCompiler().getClassLoader(MakeAssert.class.getClassLoader());
        Class testClass=classLoader.loadClass(className);
        Method method=testClass.getMethods()[0];
        returnValue[0]=(Boolean)method.invoke(null);
        System.out.println("Test " + className + "."+ method.getName()+ " return "+ returnValue[0]);
        changeModelProcessor.revertStep(filesGenHandler);
        changeModelProcessor.generateModelToChange(filesGenHandler);
      }
 catch (      Throwable t) {
        disposeProject(project.getComponent(MPSProject.class));
        t.printStackTrace();
        Assert.fail("Exception: " + t);
      }
    }
  }
);
  disposeProject(project.getComponent(MPSProject.class));
  Assert.assertFalse(MESSAGE_DEPENDENCY_NOT_CHECKED,returnValue[0]);
}
