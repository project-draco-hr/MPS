{
  int height=msg.getHeight(myEditorComponent);
  EditorCell cell=msg.getCell(myEditorComponent);
  if (cell != null) {
    while (cell instanceof EditorCell_Collection) {
      cell=cell.getLastChild();
    }
    height-=cell.getHeight();
  }
  return (int)(height * (((double)getMessagesAreaHeight()) / ((double)myEditorComponent.getHeight()))) + 3;
}
