{
  if (node == null)   return null;
  fireNodeTypeAccessed(node);
  NodeTypesComponentsRepository tcr=NodeTypesComponentsRepository.getInstance();
  if (isGenerationMode() || isTransformationTestMode()) {
    TypeCheckingContext context=myPerformanceTracer == null ? tcr.createIsolatedTypeCheckingContext(node) : tcr.createTracingTypeCheckingContext(node);
    SNode result=context.getTypeOf(node,this);
    context.dispose();
    return result;
  }
 else {
    TypeCheckingContext context=tcr.createTypeCheckingContext(node);
    if (context == null)     return null;
    return context.getTypeOf(node,this);
  }
}
