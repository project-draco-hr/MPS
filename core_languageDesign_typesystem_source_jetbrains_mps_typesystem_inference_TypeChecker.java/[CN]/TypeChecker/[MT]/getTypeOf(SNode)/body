{
  if (node == null)   return null;
  if (NodeTypesComponentsRepository.getInstance().createTypeCheckingContext(node).isInEditorQueries()) {
    return getTypeOf_resolveMode(node,true);
  }
 else   if (myIsGeneration && TypesystemPreferencesComponent.getInstance().isGenerationOptimizationEnabled()) {
    return getTypeOf_generationMode(node);
  }
 else {
    return getTypeOf_normalMode(node);
  }
}
