{
  if (node == null)   return null;
  fireNodeTypeAccessed(node);
  TypeCheckingContext context;
  if (isGenerationMode() || isTransformationTestMode()) {
    SNode componentNode=node;
    if (isTransformationTestMode()) {
      componentNode=node.getContainingRoot();
    }
    if (myPerformanceTracer == null) {
      context=TypeContextManager.getInstance().createTypeCheckingContext(node);
    }
 else {
      context=TypeContextManager.getInstance().createTracingTypeCheckingContext(node);
    }
  }
 else {
    context=TypeContextManager.getInstance().getContextForEditedRootNode(node.getContainingRoot(),TypeContextManager.DEFAULT_OWNER);
  }
  if (context == null)   return null;
  return context.getTypeOf(node,this);
}
