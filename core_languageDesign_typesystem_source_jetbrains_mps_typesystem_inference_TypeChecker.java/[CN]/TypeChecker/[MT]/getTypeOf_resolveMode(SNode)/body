{
  if (node == null)   return null;
  SNode containingRoot=node.getContainingRoot();
  if (containingRoot == null)   return null;
  if (myComputedTypesForCompletion != null && myComputedTypesForCompletion.containsKey(node)) {
    return myComputedTypesForCompletion.get(node);
  }
  TypeCheckingContext typeCheckingContext=NodeTypesComponentsRepository.getInstance().getTypeCheckingContext(node.getContainingRoot());
  typeCheckingContext=NodeTypesComponentsRepository.getInstance().createTypeCheckingContext(containingRoot);
  SNode resultType=typeCheckingContext.computeTypeForResolve(node);
  if (myComputedTypesForCompletion != null) {
    myComputedTypesForCompletion.put(node,resultType);
  }
  return resultType;
}
