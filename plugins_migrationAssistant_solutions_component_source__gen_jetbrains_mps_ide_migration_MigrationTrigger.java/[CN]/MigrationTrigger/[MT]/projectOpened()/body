{
  if (!(myState.migrationRequired)) {
    addListeners();
    ModelAccess.instance().runWriteAction(new Runnable(){
      public void run(){
        tryMigratingProject();
      }
    }
);
  }
 else {
    StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
      public void run(){
        if (!(myMigrationManager.isMigrationRequired())) {
          return;
        }
        ApplicationManager.getApplication().runWriteAction(new Runnable(){
          public void run(){
            VirtualFileUtils.refreshSynchronouslyRecursively(myProject.getBaseDir());
            VirtualFileManager.getInstance().asyncRefresh(new Runnable(){
              public void run(){
                SwingUtilities.invokeLater(new Runnable(){
                  public void run(){
                    ReloadManager.getInstance().flush();
                    ProjectManagerEx.getInstanceEx().unblockReloadingProjectOnExternalChanges();
                    executeWizard();
                  }
                }
);
              }
            }
);
          }
        }
);
      }
    }
);
  }
}
