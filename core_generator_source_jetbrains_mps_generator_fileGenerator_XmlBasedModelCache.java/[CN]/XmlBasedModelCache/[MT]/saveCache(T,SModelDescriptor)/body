{
  IFile cacheFile=getCacheFile(model);
  if (cacheFile == null)   return null;
  VirtualFile cacheVFile;
  try {
    cacheVFile=FileUtil.createVirtualFile(cacheFile.getParent().toFile(),cacheFile.getName());
  }
 catch (  IOException e) {
    LOG.error(e,"Could no.t write cache file");
    return null;
  }
  OutputStream os=null;
  try {
    os=cacheVFile.getOutputStream(XmlBasedModelCache.class);
    save(cache,os);
  }
 catch (  IOException e) {
    LOG.error(e);
  }
 finally {
    if (os != null) {
      try {
        os.close();
      }
 catch (      IOException e) {
        LOG.error(e);
      }
    }
  }
  return cacheVFile;
}
