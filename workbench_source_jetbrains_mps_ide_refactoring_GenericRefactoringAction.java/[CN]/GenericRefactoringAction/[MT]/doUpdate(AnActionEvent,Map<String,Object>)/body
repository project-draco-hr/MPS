{
  IRefactoringTarget refTarget=myRefactoring.getRefactoringTarget();
  boolean oneEntity=!refTarget.allowMultipleTargets();
  List entities;
switch (refTarget.getTarget()) {
case NODE:
    entities=getNodes(e,oneEntity);
  break;
case MODEL:
entities=getModels(e,oneEntity);
break;
case MODULE:
entities=getModules(e,oneEntity);
break;
default :
throw new IllegalArgumentException("Wrong refactoring type " + refTarget.getTarget().getClass().getName());
}
boolean disabled=entities.isEmpty() || RefactoringUtil.getApplicability(myRefactoring,entities).lessThan(getMinApplicabilityLevel());
setEnabledState(e.getPresentation(),!disabled);
}
