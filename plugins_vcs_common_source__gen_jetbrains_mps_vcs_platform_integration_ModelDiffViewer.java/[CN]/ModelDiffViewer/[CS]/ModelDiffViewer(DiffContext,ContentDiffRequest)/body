{
  myProject=context.getProject();
  List<DiffContent> contents=request.getContents();
  FileType type=(contents.get(0).getContentType() != null ? contents.get(0).getContentType() : contents.get(1).getContentType());
  if (MPSFileTypeFactory.MPS_ROOT_FILE_TYPE.equals(type) || MPSFileTypeFactory.MPS_HEADER_FILE_TYPE.equals(type)) {
    Tuples._2<SModel,SNodeId> oldModel=getModelAndRoot(contents.get(0),type);
    Tuples._2<SModel,SNodeId> newModel=getModelAndRoot(contents.get(1),type);
    SNodeId rootId=(newModel._1() != null ? newModel._1() : oldModel._1());
    myViewer=new ModelDifferenceViewer(myProject,oldModel._0(),newModel._0(),rootId,false);
  }
 else {
    SModel oldModel=ModelDiffViewer.getModel(contents.get(0),type);
    SModel newModel=ModelDiffViewer.getModel(contents.get(1),type);
    myViewer=new ModelDifferenceViewer(myProject,oldModel,newModel,null,true);
  }
  List<String> titles=request.getContentTitles();
  myViewer.setContentTitles(titles.get(0),titles.get(1));
}
