{
  TypeReference typRef=anno.type;
  if (typRef == null) {
    return null;
  }
  String name;
  if (typRef instanceof SingleTypeReference) {
    name=new String(((SingleTypeReference)typRef).token);
  }
 else   if (typRef instanceof QualifiedTypeReference) {
    StringBuffer sb=new StringBuffer();
    name=((QualifiedTypeReference)typRef).print(0,sb).toString();
  }
 else {
    LOG.error("Unexpected type in annotation: " + typRef.getClass().getName());
    name=null;
  }
  SNode node=buildAnnotationInstance(name);
  for (  MemberValuePair pair : anno.memberValuePairs()) {
    SNode val=SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x114a71b1af4L,"jetbrains.mps.baseLanguage.structure.AnnotationInstanceValue"));
    SReference ref=new DynamicReference("key",val,null,new String(pair.name));
    val.setReference(ref.getRole(),ref);
    SLinkOperations.setTarget(val,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x114a71b1af4L,0x114a71c0fc4L,"value"),convertExpression(pair.value));
    ListSequence.fromList(SLinkOperations.getChildren(node,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x114a6b4ccabL,0x114a71c697fL,"value"))).addElement(val);
  }
  return node;
}
