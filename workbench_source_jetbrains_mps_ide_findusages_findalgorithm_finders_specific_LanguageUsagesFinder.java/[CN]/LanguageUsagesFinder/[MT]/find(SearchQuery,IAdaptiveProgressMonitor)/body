{
  SearchResults searchResults=new SearchResults();
  IHolder objectHolder=query.getObjectHolder();
  if (!(objectHolder instanceof ModuleHolder)) {
    return searchResults;
  }
  ModuleHolder moduleHolder=(ModuleHolder)objectHolder;
  IModule searchedModule=moduleHolder.getObject();
  if (!(searchedModule instanceof Language)) {
    return searchResults;
  }
  Language language=(Language)searchedModule;
  for (  IModule module : MPSModuleRepository.getInstance().getAllModules()) {
    if (monitor.isCanceled()) {
      return searchResults;
    }
    if (module instanceof Solution) {
      collectUsagesInSolution(language,(Solution)module,searchResults);
    }
    if (module instanceof Language) {
      collectUsagesInLanguage(language,(Language)module,searchResults);
    }
    if (module instanceof DevKit) {
      collectUsagesInDevKit(language,(DevKit)module,searchResults);
    }
  }
  return searchResults;
}
