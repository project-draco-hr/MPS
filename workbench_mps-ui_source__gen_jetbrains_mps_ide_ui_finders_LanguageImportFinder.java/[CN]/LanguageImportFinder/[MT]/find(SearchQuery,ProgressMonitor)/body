{
  SearchResults searchResults=new SearchResults();
  for (  SLanguage lang : LanguageUsagesFinder.getLanguageToLookUp(query)) {
    Language language=(Language)lang.getSourceModule();
    searchResults.getSearchedNodes().add(lang);
    SearchScope scope=query.getScope();
    ModuleUsagesFinder moduleFinder=new ModuleUsagesFinder();
    for (    SModule module : scope.getModules()) {
      if (monitor.isCanceled()) {
        return searchResults;
      }
      if (module instanceof Solution) {
        moduleFinder.collectUsagesInSolution(language,(Solution)module,searchResults);
      }
      if (module instanceof Language) {
        moduleFinder.collectUsagesInLanguage(language,(Language)module,searchResults);
        for (        Generator g : ((Language)module).getGenerators()) {
          moduleFinder.collectUsagesInGenerator(language,g,searchResults);
        }
      }
      if (module instanceof DevKit) {
        moduleFinder.collectUsagesInDevKit(language,(DevKit)module,searchResults);
      }
    }
  }
  return searchResults;
}
