{
  if (wasMoved) {
    return false;
  }
  myEditorContext.getRepository().getModelAccess().executeCommand(new EditorCommand(myEditorContext){
    protected void doExecute(){
      myIsValid=isValid();
      if (!(myIsValid)) {
        return;
      }
      IntelligentNodeMover.PlaceToMove placeToMove=findPlaceToMove();
      if (placeToMove != null) {
        Iterable<SNode> intersection=ListSequence.fromList(SNodeOperations.getNodeAncestors(placeToMove.myParent,null,false)).intersect(CollectionSequence.fromCollection(myNodesToMove));
        if (Sequence.fromIterable(intersection).isNotEmpty()) {
          SNode first=Sequence.fromIterable(intersection).first();
          LOG.error("Possible creation of cyclic tree. Node [\"" + first + "\"; concept: "+ SNodeOperations.getConcept(first)+ "; id: "+ first.getNodeId()+ "] is supposed to be moved inside itself. Moving was cancelled");
          return;
        }
        doMove(placeToMove);
        wasMoved=true;
      }
      if (wasMoved) {
        myEditorContext.flushEvents();
        if (CollectionSequence.fromCollection(myNodesToMove).count() == 1) {
          myEditorContext.select(getBoundaryNode());
        }
 else {
          SelectionManager selectionManager=myEditorContext.getSelectionManager();
          selectionManager.setSelection(selectionManager.createRangeSelection(CollectionSequence.fromCollection(myNodesToMove).first(),CollectionSequence.fromCollection(myNodesToMove).last()));
        }
      }
    }
  }
);
  return wasMoved;
}
