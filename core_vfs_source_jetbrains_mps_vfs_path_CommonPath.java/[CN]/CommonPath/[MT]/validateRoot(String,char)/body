{
  if (separator == WIN_SEPARATOR_CHAR) {
    if (root != null && root.contains(String.valueOf(separator))) {
      throw new InvalidPathException(root,"The root is not allowed to contain separator " + separator);
    }
  }
 else   if (separator == UNIX_SEPARATOR_CHAR) {
    if (root != null && (!root.equals(DEFAULT_UNIX_ROOT) && !root.equals(UNIX_ROOT_SEP))) {
      throw new InvalidPathException(root,"The UNIX root is allowed to be `" + DEFAULT_UNIX_ROOT + "' or `"+ UNIX_ROOT_SEP+ "'.");
    }
    if (root != null && root.equals(UNIX_ROOT_SEP)) {
      root=DEFAULT_UNIX_ROOT;
    }
  }
  return root;
}
