{
  final Set<VirtualFile> files=new HashSet<VirtualFile>();
  for (  IModule m : MPSModuleRepository.getInstance().getAllModules()) {
    for (    final SModelRoot root : m.getSModelRoots()) {
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          VirtualFile file=VirtualFileUtils.getVirtualFile(root.getPath());
          if (file != null) {
            files.add(file);
          }
        }
      }
);
    }
  }
  return files;
}
