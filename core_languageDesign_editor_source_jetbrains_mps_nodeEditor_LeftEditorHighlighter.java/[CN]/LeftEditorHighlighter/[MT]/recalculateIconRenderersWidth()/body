{
  myLineToRenderersMap.clear();
  for (  EditorMessageIconRenderer renderer : myIconRenderers) {
    int yCoordinate=getIconCoordinate(renderer);
    if (yCoordinate < 0) {
      continue;
    }
    List<EditorMessageIconRenderer> renderersForLine=myLineToRenderersMap.get(yCoordinate);
    if (renderersForLine == null) {
      renderersForLine=new SortedList(new Comparator<EditorMessageIconRenderer>(){
        @Override public int compare(        EditorMessageIconRenderer message1,        EditorMessageIconRenderer message2){
          return message1.getType().getWeight() - message2.getType().getWeight();
        }
      }
);
      myLineToRenderersMap.put(yCoordinate,renderersForLine);
    }
    renderersForLine.add(renderer);
  }
  myIconRenderersWidth=0;
  new IconsBeltAllocator(myLineToRenderersMap){
    @Override public boolean allocateRow(    List<EditorMessageIconRenderer> row,    int y){
      boolean result=super.allocateRow(row,y);
      myIconRenderersWidth=Math.max(myIconRenderersWidth,getLastRowWidth());
      return result;
    }
  }
.run();
}
