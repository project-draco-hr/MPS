{
  IdeMain.setTestMode(TestMode.CORE_TEST);
  TestMain.configureMPS();
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    @Override public void run(){
      ModelAccess.instance().runWriteAction(new Runnable(){
        @Override public void run(){
          myTmpDir=IFileUtils.createTmpDir();
          myCreatedRuntimeSolution=createNewRuntimeSolution();
          createJavaFiles(myCreatedRuntimeSolution);
          myCreatedLanguage=createNewLanguage();
          createJavaFiles(myCreatedLanguage);
          myCreatedSolution=createNewSolution();
          createJavaFiles(myCreatedSolution);
          String generatorOutputPath=myCreatedSolution.getGeneratorOutputPath();
          IFile resourceDir=FileSystem.getInstance().getFileByPath(generatorOutputPath).getParent().getDescendant("resources");
          myCreatedSolution.getModuleDescriptor().getSourcePaths().add(resourceDir.getPath());
          createFile(resourceDir,"res.0.1/test.txt","test");
        }
      }
);
    }
  }
,ModalityState.NON_MODAL);
}
