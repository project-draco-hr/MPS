{
  String genuineReferenceRole=SModelUtil_new.getGenuineLinkRole(referenceLinkDeclaration);
  INodeReferentSearchScopeProvider scopeProvider=ModelConstraintsManager.getInstance().getNodeReferentSearchScopeProvider(referenceNodeConcept,genuineReferenceRole);
  if (scopeProvider != null) {
    try {
      if (scopeProvider.canCreateNodeReferentSearchScope(model,enclosingNode,referenceNode,scope)) {
        ISearchScope searchScope=scopeProvider.createNodeReferentSearchScope(model,enclosingNode,referenceNode,scope);
        return newOK(searchScope);
      }
    }
 catch (    Throwable t) {
      LOG.error(t);
    }
    return new Status.ERROR("can't create referent search scope: " + scopeProvider.getNodeReferentSearchScopeDescription());
  }
  AbstractConceptDeclaration referentConcept=referenceLinkDeclaration.getTarget();
  scopeProvider=ModelConstraintsManager.getInstance().getNodeDefaultSearchScopeProvider(referentConcept);
  if (scopeProvider != null) {
    if (scopeProvider.canCreateNodeReferentSearchScope(model,enclosingNode,referenceNode,scope)) {
      ISearchScope searchScope=scopeProvider.createNodeReferentSearchScope(model,enclosingNode,referenceNode,scope);
      return newOK(searchScope);
    }
    return new Status.ERROR("can't create default search scope: " + scopeProvider.getNodeReferentSearchScopeDescription());
  }
  ISearchScope searchScope=SModelSearchUtil_new.createModelAndImportedModelsScope(model,false,scope);
  return newOK(searchScope);
}
