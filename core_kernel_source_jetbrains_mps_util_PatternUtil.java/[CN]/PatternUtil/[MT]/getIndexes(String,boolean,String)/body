{
  List<Integer> indexList=new ArrayList<Integer>();
  int curIndex=0;
  if (addIndexes(matchingText,indexList,curIndex,pattern)) {
    return new ArrayList<Integer>(indexList);
  }
 else {
    indexList=new ArrayList<Integer>();
  }
  StringBuilder nextSubstring=new StringBuilder();
  for (int i=0; i < pattern.length(); i++) {
    char c=pattern.charAt(i);
    if (c == '*' || c == '?') {
      if (!addIndexes(matchingText,indexList,curIndex,nextSubstring.toString()))       return new ArrayList<Integer>();
      curIndex+=nextSubstring.length();
      nextSubstring=new StringBuilder();
    }
 else     if (useDots && c == '.' || c == '@' || Character.isUpperCase(c)) {
      if (!addIndexes(matchingText,indexList,curIndex,nextSubstring.toString()))       return new ArrayList<Integer>();
      nextSubstring=new StringBuilder();
      if (!addIndexes(matchingText,indexList,curIndex,new String(new char[]{c})))       return new ArrayList<Integer>();
    }
 else {
      nextSubstring.append(c);
    }
  }
  if (!addIndexes(matchingText,indexList,curIndex,nextSubstring.toString()))   return new ArrayList<Integer>();
  return new ArrayList<Integer>(indexList);
}
