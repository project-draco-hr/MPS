{
  BasicConfigurator.configure();
  Logger.getRootLogger().setLevel(Level.INFO);
  jetbrains.mps.logging.Logger.addLoggingHandler(new LoggingHandlerAdapter());
  IdeMain.setTestMode(TestMode.CORE_TEST);
  TestMain.configureMPS();
  for (  String[] macro : macros) {
    Testbench.setMacro(macro[0],macro[1]);
  }
  Testbench.initLibs();
  Testbench.makeAll();
  Testbench.reloadAll();
  com.intellij.openapi.project.Project ideaProject=ProjectManager.getInstance().getDefaultProject();
  File projectFile=FileUtil.createTmpFile();
  MPSProject project=new MPSProject(ideaProject);
  project.init(projectFile,new ProjectDescriptor());
  return new PrivToken(project);
}
