{
  ProgressIndicator indicator=progressContext.getProgressIndicator();
  long estimatedTime=progressContext.getEstimatedTime();
  if (indicator.isCanceled()) {
    return false;
  }
  long elapsedTime=System.currentTimeMillis() - progressContext.getStartTime();
  String estimatedTimeString=TimePresentationUtil.timeIntervalStringPresentation(estimatedTime);
  String elapsedTimeString=TimePresentationUtil.timeIntervalStringPresentation(elapsedTime);
  indicator.setText(text);
  indicator.setText2("Estimated time: " + estimatedTimeString + ", elapsed time: "+ elapsedTimeString);
  if (elapsedTime < estimatedTime) {
    indicator.setIndeterminate(false);
    indicator.setFraction(elapsedTime * 1.0 / estimatedTime);
  }
 else {
    indicator.setIndeterminate(true);
  }
  return true;
}
