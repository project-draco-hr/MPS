{
  Document compiler=JDOMUtil.loadDocument(compilerXmlFile);
  Element rootElement=Utils.getComponentWithName(compiler,COMPILER_CONFIGURATION);
  Element excludeXml=rootElement.getChild("excludeFromCompile");
  excludeXml.removeChildren(DIRECTORY);
  List<String> paths=new ArrayList<String>();
  for (  Entry<String,Collection<String>> module : Utils.collectMPSCompiledModulesInfo(sourceDirs).entrySet()) {
    for (    String sourcePath : module.getValue()) {
      paths.add(convertRelPathToProject(sourcePath));
    }
  }
  Collections.sort(paths);
  for (  File excludedDir : excludeDirs) {
    paths.add(convertRelPathToProject(excludedDir.getAbsolutePath()));
  }
  for (  String path : paths) {
    Element excludedDir=new Element(DIRECTORY);
    excludedDir.setAttribute(URL,path);
    excludedDir.setAttribute("includeSubdirectories","true");
    excludeXml.addContent(excludedDir);
  }
  JDOMUtil.writeDocument(compiler,compilerXmlFile);
}
