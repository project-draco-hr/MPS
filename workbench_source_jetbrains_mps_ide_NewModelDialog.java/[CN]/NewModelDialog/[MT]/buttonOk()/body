{
  SModelDescriptor model=ModelAccess.instance().runWriteActionInCommand(new Computable<SModelDescriptor>(){
    public SModelDescriptor compute(){
      if (myModelName.getText().length() == 0) {
        setErrorText("Empty model's name isn't allowed");
        return null;
      }
      SModelUID modelUID=new SModelUID(myModelName.getText(),myModelStereotype.getSelectedItem().toString());
      if (SModelRepository.getInstance().getModelDescriptor(modelUID) != null) {
        setErrorText("Model with an uid " + myModelName.getText() + " is already exists");
        return null;
      }
      ModelRootWrapper wrapper=(ModelRootWrapper)myModelRoots.getSelectedItem();
      if (!myModelName.getText().startsWith(wrapper.myModelRoot.getPrefix())) {
        setErrorText("Model name should have a prefix " + wrapper.myModelRoot.getPrefix());
        return null;
      }
      return myContext.getModule().createModel(modelUID,wrapper.myModelRoot);
    }
  }
);
  if (model == null) {
    return;
  }
  new ModelPropertiesDialog(model,myContext).showDialog();
  dispose();
}
