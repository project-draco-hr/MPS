{
  Project project=(Project)dataProvider.getData(MPSDataKeys.PROJECT.getName());
  if (project == null) {
    IdeFrame frame=(IdeFrame)dataProvider.getData(MPSDataKeys.FRAME.getName());
    if (frame != null)     project=frame.getProject();
  }
  if (project == null)   return null;
  List<SNode> nodes=(List<SNode>)dataProvider.getData(MPSDataKeys.NODES.getName());
  if (nodes != null && nodes.size() > 1)   return new MPSLocation(project,nodes);
  SNode node=(SNode)dataProvider.getData(MPSDataKeys.NODE.getName());
  if (node != null)   return new MPSLocation(project,node);
  SModel model=(SModel)dataProvider.getData(MPSDataKeys.MODEL.getName());
  if (model != null)   return new MPSLocation(project,model);
  SModule module=(SModule)dataProvider.getData(MPSDataKeys.MODULE.getName());
  if (module != null)   return new MPSLocation(project,module);
  jetbrains.mps.project.Project mpsProject=(jetbrains.mps.project.Project)dataProvider.getData(MPSDataKeys.MPS_PROJECT.getName());
  if (mpsProject != null)   return new MPSLocation(project,mpsProject);
  return null;
}
