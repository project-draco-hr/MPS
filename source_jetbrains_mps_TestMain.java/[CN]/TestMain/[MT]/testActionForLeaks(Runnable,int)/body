{
  action.run();
  gc();
  allowToCreateASnapshot();
  long memory=usedMemory();
  action.run();
  gc();
  allowToCreateASnapshot();
  long delta=usedMemory() - memory;
  System.out.println("delta = " + delta);
  if (delta > leakThreshold * 1000) {
    System.out.println(delta + " bytes leaked");
    return false;
  }
  return true;
}
