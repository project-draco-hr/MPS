{
  DataSource source=(model != null ? model.getSource() : null);
  IFile modelFile=(source instanceof FileDataSource ? ((FileDataSource)source).getFile() : null);
  if (modelFile != null) {
    String filePath=modelFile.getPath().replace('\\','/');
    if (filePath.startsWith(languagesUtilPath)) {
      return OTHER;
    }
  }
  SModule module=model.getModule();
  if (module instanceof Language) {
    LanguageAspect aspect=Language.getModelAspect(model);
    if (aspect != null) {
switch (aspect) {
case ACTIONS:
        return EDITOR;
case BEHAVIOR:
      return CORE;
case CONSTRAINTS:
    return CORE;
case DATA_FLOW:
  return CORE;
case EDITOR:
return EDITOR;
case FIND_USAGES:
return CORE;
case INTENTIONS:
return EDITOR;
case PLUGIN:
return WORKBENCH;
case REFACTORINGS:
return CORE;
case SCRIPTS:
return CORE;
case STRUCTURE:
return CORE;
case MIGRATION:
return CORE;
case TEST:
return EDITOR;
case TEXT_GEN:
return CORE;
case TYPESYSTEM:
return CORE;
default :
}
}
return CORE;
}
 else if (module instanceof Solution) {
String moduleFqName=module.getModuleName();
if (moduleFqName.equals("JDK")) {
return CORE;
}
if (moduleFqName.equals("MPS.Core")) {
return CORE;
}
if (moduleFqName.equals("MPS.Editor")) {
return EDITOR;
}
if (moduleFqName.equals("MPS.Workbench")) {
return WORKBENCH;
}
if (moduleFqName.equals("MPS.Classpath")) {
SNode refTargetRoot=reference.getTargetNode().getContainingRoot();
if (SNodeOperations.isInstanceOf(refTargetRoot,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,"jetbrains.mps.baseLanguage.structure.Classifier"))) {
String cName=SPropertyOperations.getString(SNodeOperations.cast(refTargetRoot,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0x101d9d3ca30L,"jetbrains.mps.baseLanguage.structure.Classifier")),MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name"));
String modelName=model.getModelName();
if (findInModule(coreModule,modelName,cName)) {
return CORE;
}
if (findInModule(editorModule,modelName,cName)) {
return EDITOR;
}
return WORKBENCH;
}
return OTHER;
}
Solution sol=(Solution)module;
switch (sol.getKind()) {
case NONE:
return OTHER;
case PLUGIN_CORE:
return CORE;
case PLUGIN_EDITOR:
return EDITOR;
case PLUGIN_OTHER:
return WORKBENCH;
default :
}
}
return OTHER;
}
