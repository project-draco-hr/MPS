{
  final CountDownLatch countDown=new CountDownLatch(1);
  final int[] exitCode=new int[]{1};
  OutputRedirector.redirect(process,new ProcessAdapter(){
    @Override public void processTerminated(    ProcessEvent event){
      exitCode[0]=event.getExitCode();
      countDown.countDown();
    }
  }
);
  process.startNotify();
  try {
    countDown.await();
  }
 catch (  InterruptedException e) {
  }
  return exitCode[0];
}
