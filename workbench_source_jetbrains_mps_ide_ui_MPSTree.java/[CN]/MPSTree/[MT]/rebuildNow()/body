{
  if (!ThreadUtils.isEventDispatchThread()) {
    throw new RuntimeException("Rebuild now can be only called from UI thread");
  }
  Runnable r=new Runnable(){
    public void run(){
      runRebuildAction(new Runnable(){
        public void run(){
          MPSTreeNode root=rebuild();
          setRootNode(root);
        }
      }
,true);
    }
  }
;
  Project project=MPSDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext());
  r.run();
  if (project == null)   return;
  DumbService.getInstance(project).smartInvokeLater(r);
}
