{
  TreePath path=getPathForLocation(x,y);
  if (path != null && path.getLastPathComponent() instanceof MPSTreeNode) {
    final MPSTreeNode node=(MPSTreeNode)path.getLastPathComponent();
    JPopupMenu menu=ModelAccess.instance().runReadAction(new Computable<JPopupMenu>(){
      public JPopupMenu compute(){
        ActionManager manager=ActionManager.getInstance();
        return manager.createActionPopupMenu(ActionPlaces.PROJECT_VIEW_POPUP,node.getActionGroup()).getComponent();
      }
    }
);
    if (menu == null)     return;
    if (!getSelectedPaths().contains(pathToString(path))) {
      setSelectionPath(path);
    }
    menu.show(this,x,y);
    return;
  }
  JPopupMenu defaultMenu=createDefaultPopupMenu();
  if (defaultMenu == null)   return;
  defaultMenu.show(this,x,y);
}
