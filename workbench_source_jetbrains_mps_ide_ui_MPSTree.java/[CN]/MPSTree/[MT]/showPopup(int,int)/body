{
  TreePath path=getPathForLocation(x,y);
  JPopupMenu menu=null;
  if (path != null && path.getLastPathComponent() instanceof MPSTreeNode) {
    final MPSTreeNode node=(MPSTreeNode)path.getLastPathComponent();
    menu=createPopupMenu(node);
    if (menu != null) {
      if (!getSelectedPaths().contains(pathToString(path))) {
        setSelectionPath(path);
      }
      menu.show(this,x,y);
      return;
    }
  }
  JPopupMenu defaultMenu=createDefaultPopupMenu();
  if (defaultMenu == null)   return;
  defaultMenu.show(this,x,y);
}
