{
  String models=PathUtil.getParentPath(copyFromUserDirToProject("tests/makeTestBroken/models/broken.mps","models/broken.mps"));
  String srcgen=PathUtil.getParentPath(createFile("src/empty.txt",""));
  JpsModule main=addModule("makeTestBroken",models,srcgen);
  MPSConfigurationBean configuration=createConfiguration(srcgen);
  DefaultModelRoot dmr=createModelRoot(models);
  configuration.setModelRoots(Arrays.<ModelRoot>asList(dmr));
  JpsMPSExtensionService.getInstance().setExtension(main,new JpsMPSModuleExtensionImpl(configuration));
  buildParams.put(MPSMakeConstants.MPS_LANGUAGES.toString(),getLanguageLocations());
  doBuild(CompileScopeTestBuilder.rebuild().all()).assertFailed();
}
