{
  String models=PathUtil.getParentPath(copyFromUserDirToProject("tests/blProject/models/main.mps","models/main.mps"));
  String srcgen=PathUtil.getParentPath(createFile("source_gen/empty.txt",""));
  JpsModule main=addModule("main",models,srcgen);
  MPSConfigurationBean configuration=createConfiguration(srcgen);
  DefaultModelRoot dmr=createModelRoot(models);
  configuration.setModelRoots(Arrays.<ModelRoot>asList(dmr));
  JpsMPSExtensionService.getInstance().setExtension(main,new JpsMPSModuleExtensionImpl(configuration));
  getBuilderParams().put(MPSMakeConstants.MPS_LANGUAGES.toString(),getLanguageLocations());
  rebuildAll();
  assertGenerated("mps-make/main/source_gen.caches/main/dependencies","mps-make/main/source_gen.caches/main/generated","source_gen/main/ConcoleUtil.java","source_gen/main/MainClass.java","source_gen/main/ProjectKind.java","source_gen/main/SimpleMarker.java","source_gen/main/trace.info");
}
