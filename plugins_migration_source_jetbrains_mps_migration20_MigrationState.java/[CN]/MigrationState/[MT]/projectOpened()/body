{
  if (myState != MState.INITIAL)   return;
  if (myVersion.getVersion().equals(MPSProjectVersion.CURRENT))   return;
  StartupManager.getInstance(myProject).registerPostStartupActivity(new Runnable(){
    public void run(){
      String message="MPS detected that this project contains old code that was not migrated to MPS 2.0.\n" + "If the code is not migrated, many references will be broken and code will not be generatable.\n" + "It is suggested to perform the migration right now or just after the project is opened by executing MainMenu -> Tools -> Start Migration to MPS 2.0";
      List<String> variants=new ArrayList<String>();
      variants.add("Start");
      variants.add("Later");
      if (InternalFlag.isInternalMode()) {
        variants.add("Already migrated");
      }
      int res=Messages.showDialog(myProject,message,"Migration to 2.0",variants.toArray(new String[variants.size()]),0,Messages.getQuestionIcon());
      if (res == 2) {
        setMigrationState(MState.DONE);
      }
      if (res != 0)       return;
      new MigrationHelper(myProject).migrate();
    }
  }
);
}
