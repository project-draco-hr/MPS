{
  MoveNodesActionBase.CopyMapObject copyMap=MoveNodesActionBase.CopyMapObject.getCopyMap(refactoringSession);
  copyMap.copy(nodeRoots);
  for (  SNode oldNode : ListSequence.fromList(nodeRoots)) {
    if (MapSequence.fromMap(ifKeepOldNodes).get(oldNode) == RefactoringParticipant.KeepOldNodes.REMOVE) {
      SNodeOperations.detachNode(oldNode);
    }
    myNodeLocation.insertNode(myProject.getRepository(),MapSequence.fromMap(copyMap.getCopyMap()).get(oldNode));
  }
}
