{
  if (directDependenciesOnly) {
    return ListSequence.fromList(SLinkOperations.getTargets(thisNode,"dependencies",true)).where(new IWhereFilter<SNode>(){
      public boolean accept(      SNode it){
        return SNodeOperations.isInstanceOf(it,"jetbrains.mps.build.structure.BuildProjectDependency") && SLinkOperations.getTarget(SNodeOperations.cast(it,"jetbrains.mps.build.structure.BuildProjectDependency"),"script",false) != thisNode;
      }
    }
).select(new ISelector<SNode,SNode>(){
      public SNode select(      SNode it){
        return SLinkOperations.getTarget(SNodeOperations.cast(it,"jetbrains.mps.build.structure.BuildProjectDependency"),"script",false);
      }
    }
);
  }
 else {
    LinkedHashSet<SNode> result=new LinkedHashSet<SNode>();
    BuildProject_Behavior.call_collectVisibleProjects_1224588814561808211(thisNode,result,thisNode);
    result.remove(thisNode);
    return result;
  }
}
