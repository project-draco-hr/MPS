{
  final MPSProject p=TestMain.loadProject(new File(System.getProperty("user.dir") + "/workbench/workbench.mpr"));
  SModelDescriptor descr=findModel(p,"jetbrains.mps.ide.actions");
  GeneratorManager gm=p.getProject().getComponent(GeneratorManager.class);
  File tmpFile=File.createTempFile("mps-generator-caches","tmp");
  tmpFile.deleteOnExit();
  GenerationOptions options=GenerationOptions.getDefaults().rebuildAll(true).strictMode(true).incremental(true,new FileBasedGenerationCacheContainer(tmpFile)).create();
  gm.generateModels(Collections.singletonList(descr),ModuleContext.create(descr,p.getProject()),new IncrementalTestGenerationHandler(),new EmptyProgressIndicator(),new TestMessageHandler(),options);
  ModelAccess.instance().flushEventQueue();
  ThreadUtils.runInUIThreadAndWait(new Runnable(){
    public void run(){
      p.dispose(false);
      IdeEventQueue.getInstance().flushQueue();
      System.gc();
    }
  }
);
}
