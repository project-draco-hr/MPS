{
  for (  final _FunctionTypes._void_P0_E0 t : tasks) {
    runCommandAndWait(new Runnable(){
      public void run(){
        t.invoke();
      }
    }
);
    waitAndCheck(diff);
  }
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    public void run(){
      for (int i=0; i < tasks.length; i++) {
        UndoManager.getInstance(myIdeaProject).undo(null);
      }
    }
  }
,ModalityState.NON_MODAL);
  waitAndCheck(diff);
}
