{
  FileSystemTreeImpl fileSystemTree=new FileSystemTreeImpl(null,new FileChooserDescriptor(true,true,true,true,true,false));
  AbstractTreeUi ui=fileSystemTree.getTreeBuilder().getUi();
  String path=myModelRoot.getPath() == null ? "" : myModelRoot.getPath();
  VirtualFile virtualFile=VirtualFileManager.getInstance().findFileByUrl(VirtualFileManager.constructUrl("file",path));
  if (myModelRoot.getModule() != null && (virtualFile == null || path.isEmpty())) {
    if (myModelRoot.getModule() instanceof AbstractModule) {
      virtualFile=VirtualFileManager.getInstance().findFileByUrl(VirtualFileManager.constructUrl("file",((AbstractModule)myModelRoot.getModule()).getModuleSourceDir().getPath()));
    }
  }
  if (virtualFile != null)   fileSystemTree.select(virtualFile,null);
  fileSystemTree.addListener(new Listener(){
    @Override public void selectionChanged(    List<VirtualFile> selection){
      if (selection.size() > 0) {
        myModelRoot.setPath(FileUtil.getCanonicalPath(selection.get(0).getPath()));
        myEventDispatcher.getMulticaster().fireDataChanged();
      }
    }
  }
,new Disposable(){
    @Override public void dispose(){
    }
  }
);
  myTreePanel.removeAll();
  myTreePanel.add(ui.getTree(),BorderLayout.CENTER);
  ui.scrollSelectionToVisible(null,true);
}
