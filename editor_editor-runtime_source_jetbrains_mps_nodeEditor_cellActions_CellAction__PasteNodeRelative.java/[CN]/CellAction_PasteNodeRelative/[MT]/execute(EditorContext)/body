{
  LOG.assertInCommand();
  EditorComponent editorComponent=context.getNodeEditorComponent();
  EditorCell selectedCell=editorComponent.getSelectedCell();
  SNode anchorNode=selectedCell.getSNode();
  PasteNodeData pasteNodeData=CopyPasteUtil.getPasteNodeDataFromClipboard(anchorNode.getModel());
  if (pasteNodeData == null || pasteNodeData.getNodes().isEmpty()) {
    pasteNodeData=CopyPasteUtil.getConvertedFromClipboard(anchorNode.getModel(),context.getOperationContext().getProject());
    if (pasteNodeData == null)     return;
  }
  List<SNode> pasteNodes=pasteNodeData.getNodes();
  Set<SReference> requireResolveReferences=pasteNodeData.getRequireResolveReferences();
  new NodePaster(pasteNodes).pasteRelative(anchorNode,myPastePlaceHint);
  ResolverComponent.getInstance().resolveScopesOnly(requireResolveReferences,context.getOperationContext());
  editorComponent.flushEvents();
  EditorCell nodeCell=editorComponent.findNodeCell(pasteNodes.get(0));
  if (nodeCell == null)   return;
  EditorCell_Label labelCell=nodeCell.findChild(CellFinders.byClass(EditorCell_Label.class,true));
  if (labelCell != null) {
    editorComponent.changeSelection(labelCell);
  }
  if (pasteNodes.size() == 1) {
    editorComponent.pushSelection(nodeCell);
  }
 else {
    SelectionManager selectionManager=editorComponent.getSelectionManager();
    selectionManager.pushSelection(selectionManager.createRangeSelection(pasteNodes.get(0),pasteNodes.get(pasteNodes.size() - 1)));
  }
}
