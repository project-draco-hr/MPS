{
  PQNode newQNode=new QNode();
  newQNode.setState(PQNode.State.PARTIAL);
  if (ListSequence.fromList(getChildren()).first().getState() == PQNode.State.FULL || (ListSequence.fromList(getChildren()).first().getState() == PQNode.State.PARTIAL && ListSequence.fromList(getChildren()).last().getState() == PQNode.State.EMPTY)) {
    reverse();
  }
  for (  PQNode child : ListSequence.fromList(getChildren())) {
    if (child.getState() == PQNode.State.PARTIAL) {
      for (      PQNode partialChild : ListSequence.fromList(child.getChildren())) {
        newQNode.addLastChild(partialChild);
      }
    }
 else {
      newQNode.addLastChild(child);
    }
  }
  return newQNode;
}
