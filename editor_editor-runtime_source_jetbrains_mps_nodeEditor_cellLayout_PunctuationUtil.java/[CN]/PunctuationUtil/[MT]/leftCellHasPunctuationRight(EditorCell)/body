{
  EditorCell_Collection parent=currentCell.getParent();
  if (parent == null || !hasPunctuableLayout(parent)) {
    return true;
  }
  if (parent.getCellLayout() instanceof CellLayout_Indent && CellLayout_Indent.isOnNewLine(parent,currentCell)) {
    return true;
  }
  if (parent.firstCell() == currentCell) {
    return leftCellHasPunctuationRight(parent);
  }
  EditorCell leftCell=CellTraversalUtil.getPrevLeaf(currentCell);
  if (parent.getCellLayout() instanceof CellLayout_Indent && CellLayout_Indent.isNewLineAfter(parent,leftCell)) {
    return true;
  }
  if (leftCell instanceof EditorCell_Collection) {
    return leftCellHasPunctuationRight(leftCell);
  }
  return hasPunctuationRight(leftCell);
}
