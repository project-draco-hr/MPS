{
  ModelAccess.assertLegalWrite();
  List<ModuleHandle> moduleHandles=ModulesMiner.getInstance().collectModules(file,refreshFiles);
  List<IModule> loaded=new ArrayList<IModule>();
  for (  ModuleHandle moduleHandle : moduleHandles) {
    IModule module=ModuleRepositoryFacade.createModule(moduleHandle,this);
    if (module != null) {
      loaded.add(module);
    }
  }
  for (  IModule module : loaded) {
    module.onModuleLoad();
  }
}
