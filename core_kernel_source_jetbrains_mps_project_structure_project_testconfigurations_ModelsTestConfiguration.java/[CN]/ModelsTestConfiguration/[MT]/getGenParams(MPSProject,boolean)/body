{
  Set<SModelDescriptor> modelDescriptors=new LinkedHashSet<SModelDescriptor>();
  for (  SModelReference m : getModels()) {
    modelDescriptors.add(mpsProject.getScope().getModelDescriptor(m));
  }
  if (modelDescriptors.isEmpty()) {
    throw new IllegalGeneratorConfigurationException("can't execute test configuration " + getName());
  }
  IModule module=null;
  for (  IModule m : MPSModuleRepository.getInstance().getAllModules()) {
    if (m.getOwnModelDescriptors().containsAll(modelDescriptors)) {
      module=m;
      break;
    }
  }
  if (module == null) {
    throw new IllegalGeneratorConfigurationException("there is no module that can be used to generate models " + modelDescriptors);
  }
  Project project=mpsProject.getComponent(Project.class);
  List<SModelDescriptor> models=new ArrayList<SModelDescriptor>();
  for (  SModelDescriptor sm : modelDescriptors) {
    if (!fullRegeneration && !ModelGenerationStatusManager.getInstance().generationRequired(sm,project)) {
      continue;
    }
    models.add(sm);
  }
  return new GenParameters(models,module);
}
