{
  SNode function=RuleUtil.getPropertyMacro_ValueFunction(propertyMacro);
  final String propertyName=AttributeOperations.getPropertyName(propertyMacro);
  if (function == null || propertyName == null) {
    return super.getPropertyValueQuery(propertyMacro);
  }
  String methodName=TemplateFunctionMethodName.propertyMacro_GetPropertyValue(function);
  SNode templateNode=propertyMacro.getParent();
  final Object templateValue=SNodeAccessUtil.getProperty(templateNode,propertyName);
  return new Macros(propertyMacro.getReference(),methodName,propertyName,templateValue);
}
