{
  Map<MPSVCSManager,Set<VirtualFile>> vcsManagerToFile=new HashMap<MPSVCSManager,Set<VirtualFile>>();
  for (  VirtualFile file : files) {
    Project projectForFile=getProjectForFile(file);
    if (projectForFile == null)     continue;
    MPSVCSManager mpsVcsManager=MPSVCSManager.getInstance(projectForFile);
    if (mpsVcsManager == null) {
      LOG.debug("Can not find " + MPSVCSManager.class.getName() + " instance for file "+ file+ ".");
      continue;
    }
    Set<VirtualFile> filesForManager=vcsManagerToFile.get(mpsVcsManager);
    if (filesForManager == null) {
      filesForManager=new HashSet<VirtualFile>();
      vcsManagerToFile.put(mpsVcsManager,filesForManager);
    }
    filesForManager.add(file);
  }
  for (  MPSVCSManager manager : vcsManagerToFile.keySet()) {
    manager.addVirtualFilesToVcs(vcsManagerToFile.get(manager),recursive,silently);
  }
}
