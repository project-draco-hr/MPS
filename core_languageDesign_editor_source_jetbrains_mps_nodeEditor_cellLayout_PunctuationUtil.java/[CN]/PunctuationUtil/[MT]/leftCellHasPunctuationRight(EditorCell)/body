{
  EditorCell_Collection parent=currentCell.getParent();
  if (parent != null && hasPunctuableLayout(parent)) {
    if (parent.getCellLayout() instanceof CellLayout_Indent && CellLayout_Indent.isOnNewLine(parent,currentCell)) {
      return true;
    }
    int index=parent.getCellNumber(currentCell);
    if (index > 0) {
      EditorCell leftCell=parent.getChildAt(index - 1).getLastLeaf();
      if (parent.getCellLayout() instanceof CellLayout_Indent && CellLayout_Indent.isNewLineAfter(parent,leftCell)) {
        return true;
      }
      if (leftCell.getLastLeaf() instanceof EditorCell_Collection) {
        return leftCellHasPunctuationRight(leftCell);
      }
 else {
        return hasPunctuationRight(leftCell);
      }
    }
 else {
      return leftCellHasPunctuationRight(parent);
    }
  }
  return true;
}
