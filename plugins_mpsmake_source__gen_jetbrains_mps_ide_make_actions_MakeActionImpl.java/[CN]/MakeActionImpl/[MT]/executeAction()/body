{
  if (ModelAccess.instance().isInsideCommand()) {
    throw new IllegalStateException();
  }
  final Iterable<? extends IResource> inputRes=myParams.collectInput();
  final Project project=myParams.getProject();
  project.getModelAccess().executeCommand(new Runnable(){
    public void run(){
      project.getRepository().saveAll();
    }
  }
);
  final List<SModel> models=ListSequence.fromListWithValues(new ArrayList<SModel>(),MakeActionImpl.this.selectModels(inputRes));
  MakeSession session=new MakeSession(project,new DefaultMakeMessageHandler(project),myParams.isCleanMake()){
    @Override public void doExecute(    Runnable scriptRunnable){
      if (GenerationCheckHelper.getInstance().checkModelsBeforeGenerationIfNeeded(project,new ProjectOperationContext(project),models)) {
        scriptRunnable.run();
      }
 else {
        IMakeService.INSTANCE.get().closeSession(this);
      }
    }
  }
;
  if (IMakeService.INSTANCE.get().openNewSession(session)) {
    IMakeService.INSTANCE.get().make(session,inputRes);
  }
}
