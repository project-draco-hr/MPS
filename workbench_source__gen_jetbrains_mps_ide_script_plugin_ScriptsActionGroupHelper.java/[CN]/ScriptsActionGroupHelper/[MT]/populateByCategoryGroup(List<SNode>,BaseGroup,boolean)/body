{
  Map<String,List<SNode>> byCategory=new HashMap<String,List<SNode>>();
  for (  SNode migrationScript : migrationScripts) {
    String cat=NameUtil.pluralize(NameUtil.capitalize(SPropertyOperations.getString_def(migrationScript,"type","enhancement")));
    if (cat == null) {
      cat="<uncategorized>";
    }
    if (!(byCategory.containsKey(cat))) {
      byCategory.put(cat,new ArrayList<SNode>());
    }
    ListSequence.<SNode>fromList(byCategory.get(cat)).addElement(migrationScript);
  }
  Set<String> sorted=new TreeSet<String>(new Comparator<String>(){
    public int compare(    String o1,    String o2){
      if ("<uncategorized>".equals(o1)) {
        return 1;
      }
      if ("<uncategorized>".equals(o2)) {
        return -1;
      }
      return o1.compareTo(o2);
    }
  }
);
  sorted.addAll(byCategory.keySet());
  for (  String cat : sorted) {
    BaseGroup categoryGroup=new BaseGroup(cat,"");
    for (    SNode script : byCategory.get(cat)) {
      categoryGroup.add(new RunMigrationScriptAction(script,ScriptsActionGroupHelper.makeScriptActionName(null,SPropertyOperations.getString(script,"title"),SPropertyOperations.getString(script,"toBuild")),applyToSelection));
    }
    categoryGroup.setPopup(true);
    ownerGroup.add(categoryGroup);
  }
}
