{
  SNode scopeReference=referenceNode.getLinkDeclaration(role);
  if (scopeReference == null) {
    throw new IllegalArgumentException("can't find link for role '" + role + "' in '"+ referenceNode.getConcept().getId()+ "'");
  }
  reference=null;
  sourceNodeConcept=referenceNode.getConceptDeclarationNode();
  refRole=SModelUtil.getGenuineLinkRole(scopeReference);
  this.role=role;
  enclosingNode=referenceNode.getParent();
  this.referenceNode=referenceNode;
  linkTarget=SModelUtil.getLinkDeclarationTarget(scopeReference);
  containingLinkDeclaration=referenceNode.getRoleLink();
  this.index=0;
  scopeProvider=getScopeProvider(sourceNodeConcept,refRole);
  contextNode=referenceNode != null ? referenceNode : enclosingNode;
  model=contextNode != null ? contextNode.getModel() : null;
  module=getModule(model);
  exists=reference != null;
}
