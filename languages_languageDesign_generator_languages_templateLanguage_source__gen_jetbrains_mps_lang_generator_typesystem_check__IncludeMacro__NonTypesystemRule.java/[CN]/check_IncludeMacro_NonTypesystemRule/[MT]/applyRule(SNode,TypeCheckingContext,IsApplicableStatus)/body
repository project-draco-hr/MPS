{
  SNode containingTemplate=SNodeOperations.getNodeAncestor(macro,MetaAdapterFactory.getConcept(0xb401a68083254110L,0x8fd384331ff25befL,0xfe43cb41d0L,"jetbrains.mps.lang.generator.structure.TemplateDeclaration"),false,false);
  SNode includedTemplate=SLinkOperations.getTarget(macro,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0x11621ab7715L,0x11621b434a7L,"includeTemplate"));
  if ((includedTemplate == null)) {
{
      MessageTarget errorTarget=new NodeMessageTarget();
      IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(macro,"No template","r:00000000-0000-4000-0000-011c895902e4(jetbrains.mps.lang.generator.typesystem)","7260186302264328988",null,errorTarget);
    }
  }
 else   if ((containingTemplate == null)) {
    if (!(ListSequence.fromList(SLinkOperations.getChildren(includedTemplate,MetaAdapterFactory.getContainmentLink(0xb401a68083254110L,0x8fd384331ff25befL,0xda3dc6e5137e9b1L,0xda3dc6e5137ea56L,"parameter"))).isEmpty())) {
{
        MessageTarget errorTarget=new NodeMessageTarget();
        IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(macro,"Cannot include template with arguments","r:00000000-0000-4000-0000-011c895902e4(jetbrains.mps.lang.generator.typesystem)","7260186302264329007",null,errorTarget);
      }
    }
  }
 else {
    Map<String,SNode> available=MapSequence.fromMap(new HashMap<String,SNode>());
    for (    SNode param : ListSequence.fromList(SLinkOperations.getChildren(containingTemplate,MetaAdapterFactory.getContainmentLink(0xb401a68083254110L,0x8fd384331ff25befL,0xda3dc6e5137e9b1L,0xda3dc6e5137ea56L,"parameter")))) {
      MapSequence.fromMap(available).put(SPropertyOperations.getString(param,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")),SLinkOperations.getTarget(param,MetaAdapterFactory.getContainmentLink(0xb401a68083254110L,0x8fd384331ff25befL,0x190d31fe6a0962e6L,0x190d31fe6a096acfL,"type")));
    }
    for (    SNode p : ListSequence.fromList(SLinkOperations.getChildren(includedTemplate,MetaAdapterFactory.getContainmentLink(0xb401a68083254110L,0x8fd384331ff25befL,0xda3dc6e5137e9b1L,0xda3dc6e5137ea56L,"parameter")))) {
      if (!(MapSequence.fromMap(available).containsKey(SPropertyOperations.getString(p,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name"))))) {
{
          MessageTarget errorTarget=new NodeMessageTarget();
          IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(macro,"no `" + SPropertyOperations.getString(p,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")) + "' parameter","r:00000000-0000-4000-0000-011c895902e4(jetbrains.mps.lang.generator.typesystem)","7260186302264329045",null,errorTarget);
        }
      }
 else       if (!(TypeChecker.getInstance().getSubtypingManager().isSubtype(MapSequence.fromMap(available).get(SPropertyOperations.getString(p,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name"))),SLinkOperations.getTarget(p,MetaAdapterFactory.getContainmentLink(0xb401a68083254110L,0x8fd384331ff25befL,0x190d31fe6a0962e6L,0x190d31fe6a096acfL,"type"))))) {
{
          MessageTarget errorTarget=new NodeMessageTarget();
          IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(macro,"bad type of `" + SPropertyOperations.getString(p,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")) + "' parameter","r:00000000-0000-4000-0000-011c895902e4(jetbrains.mps.lang.generator.typesystem)","7260186302264329073",null,errorTarget);
        }
      }
    }
  }
  if ((includedTemplate != null) && (SLinkOperations.getTarget(includedTemplate,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0xfe43cb41d0L,0x1100343ad9eL,"applicableConcept")) != null)) {
    SNode inputNodeConcept=BehaviorReflection.invokeVirtual((Class<SNode>)((Class)Object.class),macro,"virtual_getInputNodeTypeInsideOfMacro_1213877290799",new Object[]{});
    if ((inputNodeConcept != null)) {
      if (!(MetaAdapterByDeclaration.getConcept(inputNodeConcept).isSubConceptOf(MetaAdapterByDeclaration.getConcept(SLinkOperations.getTarget(includedTemplate,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0xfe43cb41d0L,0x1100343ad9eL,"applicableConcept")))))) {
        String msg=String.format("Input node (%s) is not an instance of template's expected concept (%s)",SPropertyOperations.getString(inputNodeConcept,MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")),SPropertyOperations.getString(SLinkOperations.getTarget(includedTemplate,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0xfe43cb41d0L,0x1100343ad9eL,"applicableConcept")),MetaAdapterFactory.getProperty(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x110396eaaa4L,0x110396ec041L,"name")));
{
          MessageTarget errorTarget=new NodeMessageTarget();
          IErrorReporter _reporter_2309309498=typeCheckingContext.reportTypeError(macro,msg,"r:00000000-0000-4000-0000-011c895902e4(jetbrains.mps.lang.generator.typesystem)","3850501259760070529",null,errorTarget);
        }
      }
    }
  }
}
