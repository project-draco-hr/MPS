{
  SNode type=null;
  while (node != null) {
    computeTypes(type,true,false);
    type=getType(node);
    if (type == null || type.getAdapter() instanceof RuntimeTypeVariable || !type.allChildrenByAdaptor(RuntimeTypeVariable.class).isEmpty()) {
      if (node.isRoot()) {
        continuation.run();
        return type;
      }
      node=node.getParent();
    }
 else {
      if (node.isRoot()) {
        continuation.run();
      }
      return type;
    }
  }
  return type;
}
