{
  myMappings=configurations;
  myTemplateSwitchGraph=plan.getTemplateSwitchGraph();
  if (myTemplateSwitchGraph == null)   throw new IllegalStateException("switch graph is not initialized");
  initialize(myMappings,logger);
  myRuleFinder=initRules(myMappings);
  myModelMap=new HashMap<SModelReference,TemplateModel>();
  for (  TemplateModel m : plan.getTemplateModels()) {
    myModelMap.put(m.getSModelReference(),m);
  }
}
