{
  if (myEditorActivated) {
    TextLine textLine=myEditorWindow.myTextLine;
    int caretPosition=textLine.getCaretPosition();
    String text=textLine.getText();
    return text.substring(0,caretPosition);
  }
  if (myCachedText == null) {
    return "";
  }
  int caretPos=Math.min(myCachedText.length(),Math.max(myCachedCaretPosition,0));
  return myCachedText.substring(0,caretPos);
}
