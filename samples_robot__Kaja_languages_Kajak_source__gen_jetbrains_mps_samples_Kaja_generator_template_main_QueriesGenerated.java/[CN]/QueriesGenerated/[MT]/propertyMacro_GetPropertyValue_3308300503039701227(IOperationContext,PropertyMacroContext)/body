{
  if (SNodeOperations.getAncestor(_context.getNode(),"jetbrains.mps.samples.Kaja.structure.Script",false,false) != null) {
    return SPropertyOperations.getString(_context.getNode(),"name").replaceAll(" ","_SPACE_") + "_routine";
  }
 else   if (SNodeOperations.getAncestor(_context.getNode(),"jetbrains.mps.samples.Kaja.structure.Library",false,false) != null) {
    return SPropertyOperations.getString(_context.getNode(),"name").replaceAll(" ","_SPACE_") + "_library_routine_from_" + SPropertyOperations.getString(SNodeOperations.getAncestor(_context.getNode(),"jetbrains.mps.samples.Kaja.structure.Library",false,false),"name");
  }
 else {
    throw new IllegalArgumentException("The routine " + SPropertyOperations.getString(_context.getNode(),"name") + " seems to have no parent script nor library");
  }
}
