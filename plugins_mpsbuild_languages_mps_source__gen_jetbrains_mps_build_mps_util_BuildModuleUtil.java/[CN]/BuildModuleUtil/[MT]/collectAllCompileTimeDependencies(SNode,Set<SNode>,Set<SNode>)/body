{
  dependencies.add(module);
  for (  SNode m : getDependencies(module)) {
    if (!(dependencies.contains(m))) {
      collectAllCompileTimeDependencies(m,dependencies,languagesWithRuntime);
    }
  }
  for (  SNode language : getUsedLanguages(module)) {
    boolean hasRuntime=false;
    for (    SNode rdep : SLinkOperations.getTargets(language,"runtime",true)) {
      if (!(SNodeOperations.isInstanceOf(rdep,"jetbrains.mps.build.mps.structure.BuildMps_ModuleSolutionRuntime"))) {
        hasRuntime=true;
        continue;
      }
      SNode runtimeSolution=SLinkOperations.getTarget(SNodeOperations.cast(rdep,"jetbrains.mps.build.mps.structure.BuildMps_ModuleSolutionRuntime"),"solution",false);
      if (!(dependencies.contains(runtimeSolution))) {
        collectAllCompileTimeDependencies(runtimeSolution,dependencies,languagesWithRuntime);
      }
    }
    if (hasRuntime) {
      languagesWithRuntime.add(language);
    }
  }
}
