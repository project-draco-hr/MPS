{
  super(project);
  myRootManager=rootManager;
  myProjectManager=projectManager;
  myIndex=index;
  final MPSUnindexedFilesUpdater updater=new MPSUnindexedFilesUpdater(myIndex,myRootManager,project);
  final StartupManagerEx startupManager=(StartupManagerEx)StartupManager.getInstance(myProject);
  if (startupManager == null)   return;
  startupManager.registerPreStartupActivity(new Runnable(){
    @Override public void run(){
      startupManager.registerCacheUpdater(updater);
      myIndex.registerIndexableSet(MPSFileBasedIndexProjectHandler.this,myProject);
      DumbServiceImpl.getInstance(myProject).queueCacheUpdate(Collections.<CacheUpdater>singletonList(updater));
    }
  }
);
}
