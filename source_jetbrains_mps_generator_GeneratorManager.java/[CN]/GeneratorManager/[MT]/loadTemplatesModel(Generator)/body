{
  if (generator.getTemplatesModelKey() == null) {
    return null;
  }
  if (generator.getModelRoots().size() == 0) {
    LOG.error("Couldn't find templates model \"" + generator.getTemplatesModelKey() + "\" model roots aren't specified");
    getMessageView().add(new Message(MessageKind.WARNING,"Couldn't find templates model \"" + generator.getTemplatesModelKey() + "\" model roots aren't specified"));
    return null;
  }
  Set<ModelRoot> roots=new HashSet<ModelRoot>();
  Iterator<ModelRoot> iterator=generator.getModelRoots().iterator();
  while (iterator.hasNext()) {
    ModelRoot modelRoot=iterator.next();
    roots.add(modelRoot);
  }
  Set<SModelDescriptor> models=new HashSet<SModelDescriptor>();
  SModelRepository.getInstance().readModelDescriptors(roots,models,this);
  String templatesModelFqName=generator.getTemplatesModelKey().myFQName;
  for (  SModelDescriptor model : models) {
    if (model.getFQName().equals(templatesModelFqName))     return model;
  }
  LOG.errorWithTrace("Couldn't find templates model \"" + templatesModelFqName + "\"");
  getMessageView().add(new Message(MessageKind.WARNING,"Couldn't find templates model \"" + templatesModelFqName + "\""));
  return null;
}
