{
  if (outputPath == null)   throw new RuntimeException("Unspecified output path. Please specify one.");
  File outputPathFile=new File(getOutputFolderPath(outputPath,sourceModel));
  if (!outputPathFile.exists()) {
    outputPathFile.mkdirs();
  }
  String packageName=JavaNameUtil.packageNameForModelUID(sourceModel.getUID());
  XmlFileGenerator xmlFileGenerator=new XmlFileGenerator(outputPathFile,packageName,false);
  JavaFileGenerator javaFileGenerator=new JavaFileGenerator(outputPathFile,packageName,false);
  Iterator<SNode> roots=targetModel.roots();
  while (roots.hasNext()) {
    SNode root=roots.next();
    String content=generateText(root);
    if (root instanceof Classifier) {
      javaFileGenerator.generateJavaFile((Classifier)root,content);
    }
 else     if (root instanceof Document) {
      xmlFileGenerator.generateXmlFile((Document)root,content);
    }
  }
}
