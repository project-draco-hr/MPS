{
  if (outputPath == null)   throw new RuntimeException("Unspecified output path. Please specify one.");
  LOG.debug("Generating to root : " + outputPath);
  String packageName=JavaNameUtil.packageNameForModelFqName(sourceModel.getFQName());
  File outputPathFile=new File(outputPath + File.separator + packageName.replace('.',File.separatorChar));
  LOG.debug("Generating to folder : " + outputPathFile.getAbsolutePath());
  if (!outputPathFile.exists()) {
    outputPathFile.mkdirs();
  }
  XmlFileGenerator xmlFileGenerator=new XmlFileGenerator(outputPathFile,packageName,false);
  JavaFileGenerator javaFileGenerator=new JavaFileGenerator(outputPathFile,packageName,false);
  Iterator<SemanticNode> roots=targetModel.roots();
  while (roots.hasNext()) {
    SemanticNode root=roots.next();
    String content=generateText(root);
    if (root instanceof Classifier) {
      javaFileGenerator.generateJavaFile((Classifier)root,content);
    }
 else     if (root instanceof Document) {
      xmlFileGenerator.generateXmlFile((Document)root,content);
    }
  }
}
