{
  SearchResults results=new SearchResults();
  Set<SNode> targets=new HashSet<SNode>();
  for (  SNode node : nodes) {
    for (    SReference ref : SNodeOperations.getReferences(((SNode)node))) {
      SNode target=jetbrains.mps.util.SNodeOperations.getTargetNodeSilently(ref);
      if (target == null) {
        continue;
      }
      if (scope.contains(target)) {
        continue;
      }
      if (targets.add(target)) {
        results.getSearchResults().add(new SearchResult(target,"target"));
      }
    }
    monitor.advance(1);
    if (monitor.isCanceled()) {
      return results;
    }
  }
  return results;
}
