{
  try {
    List<SNodeId> nodeIds=new ArrayList<SNodeId>();
    Stack<SNodeId> stack=new Stack<SNodeId>();
    for (; ; ) {
      String line=reader.readLine();
      if (line == null) {
        return nodeIds;
      }
      if (line.contains("<node")) {
        int idStart=line.indexOf("id=\"") + 4;
        String id=line.substring(idStart,line.indexOf("\"",idStart));
        stack.push(SNodeId.fromString(id));
      }
      if (stack.isEmpty()) {
        nodeIds.add(null);
      }
 else {
        nodeIds.add(stack.peek());
      }
      if (line.contains("</node>") || line.contains("<node") && line.contains("/>")) {
        stack.pop();
      }
    }
  }
 catch (  IOException e) {
    return null;
  }
}
