{
  Iterable<? extends ZipEntry> entries=CollectionUtil.asIterable(myZipFile.entries());
  for (  ZipEntry entry : entries) {
    if (entry.isDirectory()) {
      String name=entry.getName();
      if (name.endsWith("/")) {
        name=name.substring(0,name.length() - 1);
      }
      String pack=name.replace('/','.');
      buildPackageCaches(pack);
    }
 else {
      String name=entry.getName();
      int packEnd=name.lastIndexOf('/');
      String pack;
      if (packEnd == -1) {
        pack="";
      }
 else {
        pack=packEnd > 0 ? name.substring(0,packEnd).replace('/','.') : name;
      }
      buildPackageCaches(pack);
      if (name.endsWith(".class")) {
        String className;
        if (packEnd == -1) {
          className=name.substring(0,name.length() - ".class".length());
        }
 else {
          className=name.substring(packEnd + 1,name.length() - ".class".length());
        }
        getClassesSetFor(pack).add(className);
        if (pack.length() > 0) {
          myEntries.put(pack + "." + className,entry);
        }
 else {
          myEntries.put(className,entry);
        }
      }
 else {
        String resourceName;
        if (packEnd == -1) {
          resourceName=name.substring(0,name.length());
        }
 else {
          resourceName=name.substring(packEnd + 1,name.length());
        }
        getResourcesSetFor(pack).add(resourceName);
      }
    }
  }
}
