{
  for (  final Solution solution : ListSequence.fromList(myProject.getProjectModules(Solution.class))) {
    if (solution.getModuleFqName().endsWith(SOLUTION_NAME)) {
      List<SModelDescriptor> models=solution.getOwnModelDescriptors();
      SModel m=ListSequence.fromList(models).first().getSModel();
      ListSequence.fromList(SModelOperations.getNodes(m,"jetbrains.mps.lang.resources.structure.IconResource")).where(new IWhereFilter<SNode>(){
        public boolean accept(        SNode it){
          return (it != null) && (SPropertyOperations.getString(it,"path") != null && SPropertyOperations.getString(it,"path").length() > 0) && !(isValid(it));
        }
      }
).visitAll(new IVisitor<SNode>(){
        public void visit(        SNode it){
          String langName=NameUtil.namespaceFromLongName(solution.getModuleFqName());
          Language lang=ModuleRepositoryFacade.getInstance().getModule(langName,Language.class);
          if (lang == null) {
            return;
          }
          String iconPath=MacrosFactory.moduleDescriptor(lang).expandPath(SPropertyOperations.getString(it,"path"),lang.getDescriptorFile());
          String newIconMacro=SPropertyOperations.getString(it,"path").replace(MacrosFactory.LANGUAGE_DESCRIPTOR,MacrosFactory.SOLUTION_DESCRIPTOR);
          String newIconPath=MacrosFactory.moduleDescriptor(solution).expandPath(newIconMacro,solution.getDescriptorFile());
          IFile file=FileSystem.getInstance().getFile(iconPath);
          if (!(file.exists())) {
            return;
          }
          file.move(FileSystem.getInstance().getFile(newIconPath).getParent());
          SPropertyOperations.set(it,"path",newIconMacro);
        }
      }
);
    }
  }
}
