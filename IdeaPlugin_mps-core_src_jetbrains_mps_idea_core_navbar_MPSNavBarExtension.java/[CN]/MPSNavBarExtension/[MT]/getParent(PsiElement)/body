{
  if (psiElement instanceof MPSPsiModel) {
    VirtualFile virtualFile=((MPSPsiModel)psiElement).getSourceVirtualFile();
    if (!virtualFile.isValid())     return null;
    PsiFile file=psiElement.getManager().findFile(virtualFile);
    if (file == null)     return null;
    return file.getParent();
  }
  if (psiElement instanceof MPSPsiRootNode && ((MPSPsiRootNode)psiElement).getVirtualFile() != null && ((MPSPsiRootNode)psiElement).getVirtualFile().getFileType().equals(MPSFileTypeFactory.MPS_ROOT_FILE_TYPE)) {
    return psiElement.getParent().getParent();
  }
  if (psiElement instanceof MPSPsiNodeBase) {
    return psiElement.getParent();
  }
  return null;
}
