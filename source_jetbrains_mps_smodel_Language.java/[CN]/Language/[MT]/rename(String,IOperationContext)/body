{
  String oldNamespace=getNamespace();
  MPSModuleRepository.getInstance().renameUID(this,newNamespace);
  myLanguageDescriptor.setNamespace(newNamespace);
  String oldLanguageModelsRoot=new File(myDescriptorFile.getParentFile(),LANGUAGE_MODELS).getAbsolutePath();
  String oldLanguageAccesoriesRoot=new File(myDescriptorFile.getParentFile(),LANGUAGE_ACCESSORIES).getAbsolutePath();
  for (  ModelRoot modelRoot : myLanguageDescriptor.getModelRoots()) {
    if (modelRoot.getPath().equals(oldLanguageModelsRoot)) {
      modelRoot.delete();
    }
    if (modelRoot.getPath().equals(oldLanguageAccesoriesRoot)) {
      modelRoot.delete();
    }
  }
  IProjectHandler projectHandler=operationContext.getProject().getProjectHandler();
  if (projectHandler != null) {
    try {
      projectHandler.deleteFilesAndRemoveFromVCS(CollectionUtil.asList(myDescriptorFile));
    }
 catch (    RemoteException e) {
      LOG.error(e);
    }
  }
 else {
    myDescriptorFile.delete();
  }
  File descriptorFile=newDescriptorFileByNewName(newNamespace);
  SModel descriptorModel=myLanguageDescriptor.getModel();
  ModelRoot languageModelRoot=ModelRoot.newInstance(descriptorModel);
  languageModelRoot.setPath(new File(descriptorFile.getParentFile(),LANGUAGE_MODELS).getAbsolutePath());
  languageModelRoot.setPrefix(newNamespace);
  myLanguageDescriptor.addModelRoot(languageModelRoot);
  ModelRoot accessoryModelRoot=ModelRoot.newInstance(descriptorModel);
  accessoryModelRoot.setPath(new File(descriptorFile.getParentFile(),LANGUAGE_ACCESSORIES).getAbsolutePath());
  accessoryModelRoot.setPrefix(newNamespace);
  myLanguageDescriptor.addModelRoot(accessoryModelRoot);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getStructureModel(),languageModelRoot,operationContext);
  Model editorModel=null;
  for (  Editor editor : myLanguageDescriptor.getEditors()) {
    if (editor.getStereotype() == null || editor.getStereotype().equals(SModelStereotype.NONE)) {
      editorModel=editor.getEditorModel();
      break;
    }
  }
  renameLanguageModel(oldNamespace,newNamespace,editorModel,languageModelRoot,operationContext);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getActionsModel(),languageModelRoot,operationContext);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getConstraintsModel(),languageModelRoot,operationContext);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getHelginsTypesystemModel(),languageModelRoot,operationContext);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getTypeSystem(),languageModelRoot,operationContext);
  renameLanguageModel(oldNamespace,newNamespace,myLanguageDescriptor.getScriptsModel(),languageModelRoot,operationContext);
  for (  Model m : myLanguageDescriptor.getAccessoryModels()) {
    renameLanguageModel(oldNamespace,newNamespace,m,languageModelRoot,operationContext);
  }
  SModelRepository.getInstance().saveAll();
  myDescriptorFile=descriptorFile;
  setLanguageDescriptor(myLanguageDescriptor);
  save();
}
