{
  String fileName;
  if (pathStartsWith(absolutePath,PathManager.getHomePath())) {
    String relationalPath=shrink(absolutePath,PathManager.getHomePath());
    fileName=MPS_HOME + relationalPath;
  }
 else {
    Set<String> macroNames=PathMacros.getInstance().getAllMacroNames();
    for (    String macro : macroNames) {
      String path=PathMacros.getInstance().getValue(macro);
      if (path == null)       continue;
      path=FileUtil.getCanonicalPath(path).replace(SEPARATOR_CHAR,File.separatorChar);
      if (pathStartsWith(absolutePath,path)) {
        String relationalPath=shrink(absolutePath,path);
        fileName="${" + macro + "}"+ relationalPath;
        return fileName;
      }
    }
    fileName=absolutePath;
  }
  return fileName;
}
