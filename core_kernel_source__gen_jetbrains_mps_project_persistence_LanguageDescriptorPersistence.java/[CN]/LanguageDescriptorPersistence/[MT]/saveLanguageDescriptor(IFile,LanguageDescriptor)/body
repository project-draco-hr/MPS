{
  if (file.isReadOnly()) {
    if (log.isErrorEnabled()) {
      log.error("Cant't save " + file.getPath());
    }
    return;
  }
  final Macros macros=Macros.languageDescriptor();
  Element languageElement=new _FunctionTypes._return_P0_E0<Element>(){
    public Element invoke(){
      Element result_v3r4p8_a0a0d0c=new Element("language");
      String result_v3r4p8_a0a0a0d0c=descriptor.getNamespace();
      result_v3r4p8_a0a0d0c.setAttribute("namespace","" + result_v3r4p8_a0a0a0d0c);
      if (descriptor.getUUID() != null) {
        String result_v3r4p8_a0a1a0a0d0c=descriptor.getUUID();
        result_v3r4p8_a0a0d0c.setAttribute("uuid","" + result_v3r4p8_a0a1a0a0d0c);
      }
      if (descriptor.getGenPath() != null) {
        String result_v3r4p8_a0a2a0a0d0c=macros.shrinkPath(descriptor.getGenPath(),file);
        result_v3r4p8_a0a0d0c.setAttribute("generatorOutputPath","" + result_v3r4p8_a0a2a0a0d0c);
      }
      boolean result_v3r4p8_a3a0a0d0c=descriptor.getEnableJavaStubs();
      result_v3r4p8_a0a0d0c.setAttribute("java-stubs-enabled","" + result_v3r4p8_a3a0a0d0c);
      Element result_v3r4p8_a5a0a0d0c=new Element("models");
      ModuleDescriptorPersistence.saveModelRoots(result_v3r4p8_a5a0a0d0c,descriptor.getModelRoots(),file,macros);
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a5a0a0d0c);
      Element result_v3r4p8_a7a0a0d0c=new Element("accessoryModels");
      for (      SModelReference model : ListSequence.fromList(descriptor.getAccessoryModels())) {
        Element result_v3r4p8_a0a0a7a0a0d0c=new Element("model");
        String result_v3r4p8_a0a0a0a7a0a0d0c=model.toString();
        result_v3r4p8_a0a0a7a0a0d0c.setAttribute("modelUID","" + result_v3r4p8_a0a0a0a7a0a0d0c);
        result_v3r4p8_a7a0a0d0c.addContent(result_v3r4p8_a0a0a7a0a0d0c);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a7a0a0d0c);
      Element result_v3r4p8_a9a0a0d0c=new Element("generators");
      for (      GeneratorDescriptor generatorDescriptor : ListSequence.fromList(descriptor.getGenerators())) {
        GeneratorDescriptorPersistence.saveGeneratorDescriptor(result_v3r4p8_a9a0a0d0c,generatorDescriptor,file,macros);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a9a0a0d0c);
      Element result_v3r4p8_a11a0a0d0c=new Element("classPath");
      for (      ClassPathEntry entry : ListSequence.fromList(descriptor.getClassPaths())) {
        Element result_v3r4p8_a0a0a11a0a0d0c=new Element("entry");
        String result_v3r4p8_a0a0a0a11a0a0d0c=macros.shrinkPath(entry.getPath(),file);
        result_v3r4p8_a0a0a11a0a0d0c.setAttribute("path","" + result_v3r4p8_a0a0a0a11a0a0d0c);
        boolean result_v3r4p8_a1a0a0a11a0a0d0c=entry.isIncludedInVCS();
        result_v3r4p8_a0a0a11a0a0d0c.setAttribute("include","" + result_v3r4p8_a1a0a0a11a0a0d0c);
        result_v3r4p8_a11a0a0d0c.addContent(result_v3r4p8_a0a0a11a0a0d0c);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a11a0a0d0c);
      if (!(descriptor.getStubModelEntries().isEmpty())) {
        Element result_v3r4p8_a0a31a0a0d0c=new Element("stubModelEntries");
        ModuleDescriptorPersistence.saveStubModelEntries(result_v3r4p8_a0a31a0a0d0c,descriptor.getStubModelEntries(),file,macros);
        result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a0a31a0a0d0c);
      }
      Element result_v3r4p8_a51a0a0d0c=new Element("languageRuntimeClassPath");
      for (      ClassPathEntry entry : ListSequence.fromList(descriptor.getRuntimeClassPaths())) {
        Element result_v3r4p8_a0a0a51a0a0d0c=new Element("entry");
        String result_v3r4p8_a0a0a0a51a0a0d0c=macros.shrinkPath(entry.getPath(),file);
        result_v3r4p8_a0a0a51a0a0d0c.setAttribute("path","" + result_v3r4p8_a0a0a0a51a0a0d0c);
        result_v3r4p8_a51a0a0d0c.addContent(result_v3r4p8_a0a0a51a0a0d0c);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a51a0a0d0c);
      if (!(descriptor.getRuntimeStubModels().isEmpty())) {
        Element result_v3r4p8_a0a71a0a0d0c=new Element("runtimeStubModels");
        for (        StubModelsEntry entry : ListSequence.fromList(descriptor.getRuntimeStubModels())) {
          Element result_v3r4p8_a0a0a0a71a0a0d0c=new Element("stubModelEntry");
          String result_v3r4p8_a0a0a0a0a71a0a0d0c=macros.shrinkPath(entry.getPath(),file);
          result_v3r4p8_a0a0a0a71a0a0d0c.setAttribute("path","" + result_v3r4p8_a0a0a0a0a71a0a0d0c);
          boolean result_v3r4p8_a1a0a0a0a71a0a0d0c=entry.isIncludedInVCS();
          result_v3r4p8_a0a0a0a71a0a0d0c.setAttribute("include","" + result_v3r4p8_a1a0a0a0a71a0a0d0c);
          Element result_v3r4p8_a2a0a0a0a71a0a0d0c=new Element("manager");
          String result_v3r4p8_a0a2a0a0a0a71a0a0d0c=entry.getManager().getModuleId();
          result_v3r4p8_a2a0a0a0a71a0a0d0c.setAttribute("moduleId","" + result_v3r4p8_a0a2a0a0a0a71a0a0d0c);
          String result_v3r4p8_a1a2a0a0a0a71a0a0d0c=entry.getManager().getClassName();
          result_v3r4p8_a2a0a0a0a71a0a0d0c.setAttribute("className","" + result_v3r4p8_a1a2a0a0a0a71a0a0d0c);
          result_v3r4p8_a0a0a0a71a0a0d0c.addContent(result_v3r4p8_a2a0a0a0a71a0a0d0c);
          result_v3r4p8_a0a71a0a0d0c.addContent(result_v3r4p8_a0a0a0a71a0a0d0c);
        }
        result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a0a71a0a0d0c);
      }
      Element result_v3r4p8_a91a0a0d0c=new Element("sourcePath");
      for (      String p : ListSequence.fromList(descriptor.getSourcePaths())) {
        Element result_v3r4p8_a0a0a91a0a0d0c=new Element("source");
        String result_v3r4p8_a0a0a0a91a0a0d0c=macros.shrinkPath(p,file);
        result_v3r4p8_a0a0a91a0a0d0c.setAttribute("path","" + result_v3r4p8_a0a0a0a91a0a0d0c);
        result_v3r4p8_a91a0a0d0c.addContent(result_v3r4p8_a0a0a91a0a0d0c);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a91a0a0d0c);
      boolean result_v3r4p8_a12a0a0d0c=descriptor.getCompileInMPS();
      result_v3r4p8_a0a0d0c.setAttribute("compileInMPS","" + result_v3r4p8_a12a0a0d0c);
      boolean result_v3r4p8_a22a0a0d0c=descriptor.isDoNotGenerateAdapters();
      result_v3r4p8_a0a0d0c.setAttribute("doNotGenerateAdapters","" + result_v3r4p8_a22a0a0d0c);
      ModuleDescriptorPersistence.saveDependencies(result_v3r4p8_a0a0d0c,descriptor);
      Element result_v3r4p8_a62a0a0d0c=new Element("extendedLanguages");
      for (      ModuleReference ref : ListSequence.fromList(descriptor.getExtendedLanguages())) {
        Element result_v3r4p8_a0a0a62a0a0d0c=new Element("extendedLanguage");
        String result_v3r4p8_a0a0a0a62a0a0d0c=ref.toString();
        result_v3r4p8_a0a0a62a0a0d0c.setText(result_v3r4p8_a0a0a0a62a0a0d0c);
        result_v3r4p8_a62a0a0d0c.addContent(result_v3r4p8_a0a0a62a0a0d0c);
      }
      result_v3r4p8_a0a0d0c.addContent(result_v3r4p8_a62a0a0d0c);
      return result_v3r4p8_a0a0d0c;
    }
  }
.invoke();
  try {
    OutputStream os=file.openOutputStream();
    JDOMUtil.writeDocument(new Document(languageElement),os);
  }
 catch (  Exception e) {
    if (log.isErrorEnabled()) {
      log.error("",e);
    }
  }
  ModuleDescriptorPersistence.setTimestamp(descriptor,file,true);
}
