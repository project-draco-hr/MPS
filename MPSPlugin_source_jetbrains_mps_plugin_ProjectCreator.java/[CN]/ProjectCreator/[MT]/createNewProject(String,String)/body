{
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          LocalFileSystem lfs=LocalFileSystem.getInstance();
          Project project=myProjectManager.newProject(path + File.separator + name+ ".ipr",true,false);
          myProjectManager.openProject(project);
          ModuleManager moduleManager=project.getComponent(ModuleManager.class);
          Module module=moduleManager.newModule(path + File.separator + name+ ".iml",ModuleType.JAVA);
          ModuleRootManager rootManager=module.getComponent(ModuleRootManager.class);
          ModifiableRootModel rootModel=rootManager.getModifiableModel();
          VirtualFile contentRootFile=lfs.refreshAndFindFileByIoFile(new File(path));
          ContentEntry contentEntry=rootModel.addContentEntry(contentRootFile);
          rootModel.commit();
        }
      }
);
    }
  }
,ModalityState.NON_MMODAL);
  return "OK";
}
