{
  clearBracesSelection();
  if (newSelection == null) {
    return;
  }
  EditorCell cellToSelect=null;
  if (getMatchingLabelAndCell(newSelection) != null) {
    cellToSelect=newSelection;
  }
 else   if (newSelection instanceof EditorCell_Label) {
    EditorCell_Label editorCell=(EditorCell_Label)newSelection;
    if (editorCell.getCaretPosition() == 0) {
      EditorCell cell=editorCell.getPrevLeaf();
      if (cell instanceof EditorCell_Label) {
        EditorCell_Label label=(EditorCell_Label)cell;
        if (label.getBounds().getMaxX() == editorCell.getBounds().getMinX() && editorCell.getLeftInset() == 0) {
          cellToSelect=label;
        }
      }
    }
 else     if (editorCell.getCaretPosition() == editorCell.getText().length()) {
      EditorCell cell=editorCell.getNextLeaf();
      if (cell instanceof EditorCell_Label) {
        EditorCell_Label label=(EditorCell_Label)cell;
        if (label.getBounds().getMinX() == editorCell.getBounds().getMaxX() && editorCell.getRightInset() == 0) {
          cellToSelect=label;
        }
      }
    }
  }
  if (cellToSelect != null) {
    selectBraces(cellToSelect);
  }
}
