{
  newOut.flush();
  newErr.flush();
  System.setOut(oldOut);
  System.setErr(oldErr);
  Logger.getRootLogger().removeAppender(app);
  Logger.getRootLogger().setLevel(oldLevel);
  if (!testsToIgnore.containsKey(desc) && (newOut.isNotEmpty() || newErr.isNotEmpty() || app.isNotEmpty())) {
    Failure fail=new Failure(desc,new UncleanTestExecutionException(newOut,newErr,app));
    super.fireTestFailure(fail);
  }
}
