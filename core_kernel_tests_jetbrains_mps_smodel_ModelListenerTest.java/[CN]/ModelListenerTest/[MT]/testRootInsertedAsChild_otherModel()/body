{
  final TestModelFactory m1f=new TestModelFactory();
  SModel m1=m1f.createModel(2,2);
  myTestModelAccess.enableWrite();
  m1f.attachTo(myTestRepo);
  final SNode r1=m1f.getRoot(1);
  final SNode ffn=m1f.createNode();
  final SNodeId r1id=r1.getNodeId();
  Assert.assertEquals(2,IterableUtil.asCollection(m1.getRootNodes()).size());
  Assert.assertEquals(2,IterableUtil.asCollection(r1.getChildren()).size());
  Assert.assertSame(r1,m1.getNode(r1id));
  try {
    ffn.insertChildBefore(ourRole,r1,null);
    Assert.assertEquals(2,IterableUtil.asCollection(m1.getRootNodes()).size());
    Assert.assertTrue(IterableUtil.asCollection(ffn.getChildren()).contains(r1));
    Assert.assertSame(r1,m1.getNode(r1id));
    Assert.assertNull(m1.getNode(r1id).getModel());
    Assert.fail("Insert of a root not detached from a model shall fail");
  }
 catch (  IllegalModelAccessException ignored) {
  }
}
