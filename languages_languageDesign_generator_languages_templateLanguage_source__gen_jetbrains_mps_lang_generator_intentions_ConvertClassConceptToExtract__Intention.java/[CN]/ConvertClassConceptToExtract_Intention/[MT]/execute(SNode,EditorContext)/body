{
  SNode newNode=SNodeFactoryOperations.createNewNode("jetbrains.mps.baseLanguageInternal.structure.ExtractStaticInnerClassConcept",null);
  for (  SNode child : newNode.getChildren()) {
    newNode.removeChild(child);
  }
  HashMap<SNode,SNode> mapping=new HashMap<SNode,SNode>();
  mapping.put(node,newNode);
  List<SNode> children=node.getChildren();
  CopyUtil.copy(children,mapping);
  for (  SNode child : children) {
    newNode.addChild(child.getRole(),mapping.get(child));
  }
  for (  SReference reference : node.getReferences()) {
    newNode.setReferent(reference.getRole(),reference.getTargetNode());
  }
  for (  String propertyName : node.getPropertyNames()) {
    newNode.setProperty(propertyName,node.getProperty(propertyName));
  }
  SNodeOperations.replaceWithAnother(node,newNode);
}
