{
  CompositeTracer tracer=new CompositeTracer(myTracer,monitor);
  tracer.start(String.format(BUILDING_MODULES_MSG,modules.size()),10);
  try {
    tracer.push(COLLECTING_DEPENDENCIES_MSG);
    Set<SModule> candidates=new LinkedHashSet<>(new GlobalModuleDependenciesManager(modules).getModules(Deptype.COMPILE));
    tracer.pop(1);
    tracer.push(LOADING_DEPENDENCIES_MSG);
    Dependencies dependencies=new Dependencies(candidates);
    tracer.pop(1);
    tracer.push(CALCULATING_DEPENDENCIES_TO_COMPILE_MSG);
    Set<SModule> toCompile=buildDirtyModulesClosure(new ModulesContainer(candidates,dependencies),tracer.subTracer(1));
    tracer.pop();
    tracer.push(BUILDING_MODULE_CYCLES_MSG);
    List<Set<SModule>> schedule=new StronglyConnectedModules<>(toCompile).getStronglyConnectedComponents();
    tracer.pop(1);
    return compileCycles(compilerOptions,schedule,tracer.subTracer(6,SubProgressKind.REPLACING),dependencies);
  }
  finally {
    tracer.done();
    tracer.printReport();
  }
}
