{
  if ((getSelectedNode() != null) && (getSelectedNode().getUserObject() instanceof MPSPsiElementTreeNode)) {
    return ((MPSPsiElementTreeNode)(getSelectedNode().getUserObject())).getValue().getSNodeReference().resolve(MPSModuleRepository.getInstance());
  }
 else {
    Set<IFile> models=MPSDataKeys.MODEL_FILES.getData(this);
    if (models != null && models.size() == 1) {
      return SModelFileTracker.getInstance().findModel(models.iterator().next());
    }
  }
  return null;
}
