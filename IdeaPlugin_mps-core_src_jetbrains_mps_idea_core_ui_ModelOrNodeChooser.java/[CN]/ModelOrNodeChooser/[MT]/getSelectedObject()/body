{
  SRepository repository=ProjectHelper.getProjectRepository(myProject);
  if ((getSelectedNode() != null) && (getSelectedNode().getUserObject() instanceof MPSPsiElementTreeNode)) {
    return new NodeLocationChild(((MPSPsiElementTreeNode)(getSelectedNode().getUserObject())).getValue().getSNodeReference().resolve(repository));
  }
 else {
    Set<IFile> models=MPSDataKeys.MODEL_FILES.getData(this);
    if (models != null && models.size() == 1) {
      return new NodeLocationRoot(SModelFileTracker.getInstance(repository).findModel(models.iterator().next()));
    }
  }
  return null;
}
