{
  SModule module=ModuleRepositoryFacade.getInstance().getModule(moduleReference);
  if (module != null) {
    for (    ModelRoot root : module.getModelRoots()) {
      if (root instanceof DefaultModelRoot) {
        String rootPath=((DefaultModelRoot)root).getPath();
        List<CachedModelData> models=buildModels((DefaultModelRoot)root);
        modelsByKindAndPath.put(PersistenceRegistry.DEFAULT_MODEL_ROOT + ":" + rootPath,models);
      }
 else       if (root instanceof JavaClassStubsModelRoot) {
        String rootPath=((JavaClassStubsModelRoot)root).getPath();
        List<CachedModelData> models=buildModels((JavaClassStubsModelRoot)root);
        if (models != null) {
          modelsByKindAndPath.put(PersistenceRegistry.JAVA_CLASSES_ROOT + ":" + rootPath,models);
        }
      }
    }
    if (module instanceof Language) {
      for (      Generator generator : ((Language)module).getGenerators()) {
        buildModule(modelsByKindAndPath,generator.getModuleReference());
      }
    }
  }
}
