{
  List<CachedModuleData> modules=new ArrayList<CachedModuleData>();
  for (  ModuleHandle handle : handles) {
    Map<String,List<CachedModelData>> modelsByPath=new HashMap<String,List<CachedModelData>>();
    ModuleReference moduleReference=handle.getDescriptor().getModuleReference();
    SModule module=ModuleRepositoryFacade.getInstance().getModule(moduleReference);
    if (module != null) {
      for (      ModelRoot root : module.getModelRoots()) {
        if (root instanceof DefaultModelRoot) {
          String rootPath=((DefaultModelRoot)root).getPath();
          List<CachedModelData> models=buildModels((DefaultModelRoot)root);
          modelsByPath.put(rootPath,models);
        }
      }
    }
    modules.add(new CachedModuleData(handle,modelsByPath));
  }
  return new CachedRepositoryData(modules);
}
