{
  if (treeNode instanceof PsiDirectoryNode && !(treeNode instanceof MPSPsiModelTreeNode)) {
    return modifyDirectoryChildren(treeNode,children,settings);
  }
  if (!(treeNode instanceof MPSPsiModelTreeNode))   return children;
  MPSPsiModel psiModel=(MPSPsiModel)((MPSPsiModelTreeNode)treeNode).getValue();
  List<AbstractTreeNode> newChildren=new ArrayList<AbstractTreeNode>();
  for (  PsiElement psiElement : psiModel.getChildren()) {
    newChildren.add(new MPSPsiElementTreeNode(treeNode.getProject(),(MPSPsiRootNode)psiElement,settings));
  }
  return newChildren;
}
