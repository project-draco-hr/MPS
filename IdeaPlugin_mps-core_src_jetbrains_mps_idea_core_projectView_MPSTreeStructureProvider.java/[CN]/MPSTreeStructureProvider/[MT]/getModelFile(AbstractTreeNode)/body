{
  if (treeNode instanceof MPSProjectViewNode) {
    return getModelFile(treeNode.getParent());
  }
  if (treeNode instanceof PsiFileNode) {
    PsiFileNode fileNode=(PsiFileNode)treeNode;
    VirtualFile virtualFile=fileNode.getVirtualFile();
    if (virtualFile == null || virtualFile.getFileType() != MPSFileTypeFactory.MODEL_FILE_TYPE) {
      return null;
    }
    return FileSystem.getInstance().getFileByPath(virtualFile.getPath());
  }
  return null;
}
