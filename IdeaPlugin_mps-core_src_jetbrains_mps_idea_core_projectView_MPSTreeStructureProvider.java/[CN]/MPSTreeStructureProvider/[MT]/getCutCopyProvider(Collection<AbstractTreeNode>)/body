{
  if (selected.size() == 0) {
    return null;
  }
  List<SNodePointer> selectedNodePointers=new ArrayList<SNodePointer>();
  Project project=null;
  for (  AbstractTreeNode treeNode : selected) {
    if (treeNode instanceof MPSProjectViewNode) {
      selectedNodePointers.add(((MPSProjectViewNode)treeNode).getValue());
    }
 else {
      return null;
    }
    if (project == null) {
      project=treeNode.getProject();
    }
 else     if (project != treeNode.getProject()) {
      return null;
    }
  }
  jetbrains.mps.project.Project mpsProject=ProjectHelper.toMPSProject(project);
  if (mpsProject == null) {
    return null;
  }
  return new CutCopyProvider(selectedNodePointers,mpsProject);
}
