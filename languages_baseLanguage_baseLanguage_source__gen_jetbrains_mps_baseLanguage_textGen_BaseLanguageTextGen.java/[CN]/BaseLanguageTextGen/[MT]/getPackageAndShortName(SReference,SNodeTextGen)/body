{
  SReference reference=classifierRef;
  if (reference == null) {
    textGen.foundError("null reference");
    return null;
  }
  String shortName="";
  String packageName="";
  if (reference instanceof DynamicReference) {
    shortName=((jetbrains.mps.smodel.SReference)reference).getResolveInfo();
    if (shortName.startsWith("[")) {
      return MultiTuple.<String,String>from(shortName.substring(1,shortName.lastIndexOf("]")).trim(),shortName.substring(shortName.lastIndexOf("]") + 1).trim());
    }
 else {
      final SModelReference modelReference=reference.getTargetSModelReference();
      if (modelReference != null) {
        packageName=SModelStereotype.withoutStereotype(modelReference.getModelName());
        if (LOG.isEnabledFor(Level.WARN)) {
          LOG.warn("generating classifier reference with target model reference " + modelReference + " @ "+ classifierRef);
        }
      }
 else {
        int lastDot=shortName.lastIndexOf('.');
        if (lastDot >= 0) {
          packageName=shortName.substring(0,lastDot);
          shortName=shortName.substring(lastDot + 1).replace('$','.');
        }
 else {
          SModelReference sModelReference=classifierRef.getSourceNode().getModel().getReference();
          packageName=(sModelReference != null ? SModelStereotype.withoutStereotype(sModelReference.getModelName()) : "");
        }
      }
      return MultiTuple.<String,String>from(packageName,shortName);
    }
  }
 else {
    SNode targetNode=jetbrains.mps.util.SNodeOperations.getTargetNodeSilently(reference);
    if (targetNode == null) {
      textGen.foundError("Target node is null for reference to classifier with role " + SLinkOperations.getRole(classifierRef) + "; resolve info "+ SLinkOperations.getResolveInfo(classifierRef)+ "; "+ jetbrains.mps.util.SNodeOperations.getDebugText(classifierRef.getSourceNode()));
      return null;
    }
    return MultiTuple.<String,String>from(SModelStereotype.withoutStereotype(targetNode.getModel().getReference().getModelName()),(SNodeOperations.isInstanceOf(targetNode,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1107461130800l,"jetbrains.mps.baseLanguage.structure.Classifier")) ? SPropertyOperations.getString(SNodeOperations.cast(targetNode,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1107461130800l,"jetbrains.mps.baseLanguage.structure.Classifier")),MetaAdapterFactory.getProperty(new UUID(-935030926396207931l,-6610165693999523818l),1107461130800l,1211504562189l,"nestedName")) : jetbrains.mps.util.SNodeOperations.getResolveInfo(targetNode)));
  }
}
