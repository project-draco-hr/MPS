{
  final VirtualFile file=getVirtualFile();
  if (file == null) {
    final LocalHistoryAction action=startLocalHistoryAction(revision);
    if (getVirtualParent() != null) {
      getVirtualParent().refresh(true,true,new Runnable(){
        public void run(){
          myFilePath.refresh();
          action.finish();
        }
      }
);
    }
  }
 else {
    FileDocumentManager.getInstance().saveDocument(FileDocumentManager.getInstance().getDocument(file));
  }
}
