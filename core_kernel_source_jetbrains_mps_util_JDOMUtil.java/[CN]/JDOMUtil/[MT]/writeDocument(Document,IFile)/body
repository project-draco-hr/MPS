{
  if (!file.getParent().exists()) {
    file.getParent().mkdirs();
  }
  if (!file.exists()) {
    file.createNewFile();
  }
  OutputStream stream=new BufferedOutputStream(file.openOutputStream());
  try {
    writeDocument(document,stream);
  }
  finally {
    stream.close();
  }
}
