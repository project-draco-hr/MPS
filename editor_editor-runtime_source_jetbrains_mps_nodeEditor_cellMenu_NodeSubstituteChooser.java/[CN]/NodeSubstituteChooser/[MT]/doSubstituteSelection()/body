{
  final String pattern=getPatternEditor().getPattern();
  final SubstituteAction action=mySubstituteActions.get(getPopupWindow().getSelectionIndex());
  setVisible(false);
  myEditorComponent.getEditorContext().getRepository().getModelAccess().executeCommand(new Runnable(){
    @Override public void run(){
      action.substitute(myEditorComponent.getEditorContext(),pattern);
    }
  }
);
}
