{
  boolean directRef=SNodeOperations.getModel(((SNode)_context.getVariable("template"))) == SNodeOperations.getModel(_context.getNode());
  if (directRef && !(SNodeOperations.isInstanceOf(((SNode)_context.getVariable("template")),MetaAdapterFactory.getConcept(new UUID(-5475912601019530992l,-8082971551085732881l),1092059087312l,"jetbrains.mps.lang.generator.structure.TemplateDeclaration")))) {
    if (AttributeOperations.getAttribute(((SNode)_context.getVariable("template")),new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation")) == null) {
      _context.showErrorMessage(_context.getNode(),"cannot refer template root without template annotation");
      return false;
    }
  }
  return directRef;
}
