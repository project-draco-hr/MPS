{
  final Set<SNode> conceptUsages=SetSequence.fromSet(new HashSet<SNode>());
  final Set<SNode> accessUsages=SetSequence.fromSet(new HashSet<SNode>());
  final Set<SearchResult<SNode>> allUsages=SetSequence.fromSet(new HashSet<SearchResult<SNode>>());
  SNode aliasDecl=SLinkOperations.getTarget(SNodeOperations.cast(SLinkOperations.getTarget(new ConceptPropertiesHelper.QuotationClass_azpnkk_a0a0a0d0c().createNode(),"operation",true),"jetbrains.mps.lang.smodel.structure.SConceptPropertyAccess"),"conceptProperty",false);
  final Set<SNode> searchedNodes=SetSequence.fromSet(new HashSet<SNode>());
  SetSequence.fromSet(searchedNodes).addElement(aliasDecl);
  Set<SReference> usages=FindUsagesManager.getInstance().findUsages(searchedNodes,SearchType.USAGES,scope,new EmptyProgressMonitor());
  for (  SReference usage : SetSequence.fromSet(usages)) {
    SNode node=usage.getSourceNode();
    if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.structure.structure.StringConceptProperty")) {
      SetSequence.fromSet(conceptUsages).addElement(SNodeOperations.getAncestor(SNodeOperations.cast(node,"jetbrains.mps.lang.structure.structure.StringConceptProperty"),"jetbrains.mps.lang.structure.structure.ConceptDeclaration",false,false));
    }
 else     if (SNodeOperations.isInstanceOf(node,"jetbrains.mps.lang.smodel.structure.SConceptPropertyAccess")) {
      SetSequence.fromSet(accessUsages).addElement(SNodeOperations.cast(node,"jetbrains.mps.lang.smodel.structure.SConceptPropertyAccess"));
    }
    SetSequence.fromSet(allUsages).addElement(new SearchResult<SNode>(node,""));
  }
  final SearchResults searchResults=new SearchResults<SNode>(searchedNodes,SetSequence.fromSet(allUsages).toListSequence());
  RefactoringAccess.getInstance().showRefactoringView(ideaProject,new RefactoringViewAction(){
    public void performAction(    final RefactoringViewItem refactoringViewItem){
      ModelAccess.instance().runWriteActionInCommand(new Runnable(){
        public void run(){
          for (          SNode concept : SetSequence.fromSet(conceptUsages)) {
            SPropertyOperations.set(concept,"conceptAlias",SConceptPropertyOperations.getString(concept,"alias"));
          }
          for (          SNode node : SetSequence.fromSet(accessUsages)) {
            SNodeOperations.replaceWithAnother(node,SLinkOperations.getTarget(new ConceptPropertiesHelper.QuotationClass_azpnkk_a0a0a0a1a0a0a0a0a0a0b0a01a2().createNode(),"operation",true));
          }
          refactoringViewItem.close();
        }
      }
);
    }
  }
,searchResults,false,"remove alias");
  final Set<SModel> sourceModels=searchResults.getAffectedModels();
  if (sourceModels.isEmpty()) {
    return;
  }
  final List<org.jetbrains.mps.openapi.model.SModel> descriptors=new ArrayList<org.jetbrains.mps.openapi.model.SModel>();
  SModelRepository.getInstance().saveAll();
  for (  SModel model : sourceModels) {
    if (!(model.isDisposed())) {
      descriptors.add(model.getModelDescriptor());
    }
  }
  final IOperationContext operationContext=new ProjectOperationContext(project);
  new Thread(){
    public void run(){
      try {
        MakeSession sess=new MakeSession(operationContext);
        if (IMakeService.INSTANCE.get().openNewSession(sess)) {
          Future<IResult> result=IMakeService.INSTANCE.get().make(sess,new ModelsToResources(operationContext,descriptors).resources(false));
          result.get();
        }
      }
 catch (      InterruptedException e) {
      }
catch (      CancellationException ignore) {
      }
catch (      ExecutionException e) {
        e.printStackTrace();
      }
 finally {
      }
    }
  }
.start();
}
