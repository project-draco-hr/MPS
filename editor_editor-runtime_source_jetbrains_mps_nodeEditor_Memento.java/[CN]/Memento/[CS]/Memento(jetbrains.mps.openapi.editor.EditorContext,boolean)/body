{
  EditorComponent nodeEditor=(EditorComponent)context.getEditorComponent();
  SNode editedNode=nodeEditor.getEditedNode();
  if (editedNode == null || SNodeUtil.isAccessible(editedNode,MPSModuleRepository.getInstance())) {
    if (saveEditedNode && editedNode != null) {
      myEditedNodeReference=editedNode.getReference();
    }
    mySelectionStack=nodeEditor.getSelectionManager().getSelectionInfoStack();
    ArrayList<EditorCell> foldedCells=new ArrayList<EditorCell>(nodeEditor.getFoldedCells());
    Collections.sort(foldedCells,FOLDED_CELLS_COMPARATOR);
    for (    EditorCell foldedCell : foldedCells) {
      myFolded.add(foldedCell.getCellInfo());
    }
    for (    EditorCell bracesEnabledCell : nodeEditor.getBracesEnabledCells()) {
      myCollectionsWithEnabledBraces.add(bracesEnabledCell.getCellInfo());
    }
    collectErrors(nodeEditor);
  }
  myViewPosition=nodeEditor.getViewport().getViewPosition();
  myEnabledHints=nodeEditor.getUpdater().getInitialEditorHints();
}
