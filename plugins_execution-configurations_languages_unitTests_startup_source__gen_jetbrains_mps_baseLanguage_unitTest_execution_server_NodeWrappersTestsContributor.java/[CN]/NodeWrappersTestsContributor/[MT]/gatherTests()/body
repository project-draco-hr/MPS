{
  final Exception[] ex=new Exception[1];
  final List<Request> requestList=new ArrayList<Request>();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      try {
        for (        ITestNodeWrapper<?> testNode : myTestNodes) {
          String fqName=testNode.getFqName();
          final SModule module=getModuleByNode(testNode.getNode());
          if (testNode.isTestCase()) {
            final Class<?> aClass=myTestClassStorage.loadTestClass(fqName,module);
            TestNodeRequest request=new TestNodeRequest(Request.aClass(aClass),testNode);
            requestList.add(request);
          }
 else {
            int index=fqName.lastIndexOf('.');
            String testFqName=fqName.substring(0,index);
            final Class aClass=myTestClassStorage.loadTestClass(testFqName,module);
            String method=fqName.substring(index + 1);
            TestNodeRequest request=new TestNodeRequest(Request.method(aClass,method),testNode);
            requestList.add(request);
          }
        }
      }
 catch (      ClassNotFoundException e) {
        ex[0]=e;
      }
    }
  }
);
  if (ex[0] != null) {
    throw ex[0];
  }
  return requestList;
}
