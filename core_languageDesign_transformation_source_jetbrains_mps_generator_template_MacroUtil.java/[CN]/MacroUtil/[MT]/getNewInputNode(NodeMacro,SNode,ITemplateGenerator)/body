{
  try {
    if (nodeMacro instanceof SwitchMacro) {
      return getNewInputNodeForSwitchMacro(currentInputNode,(SwitchMacro)nodeMacro,generator);
    }
 else     if (nodeMacro instanceof IncludeMacro) {
      return getNewInputNode(currentInputNode,(SourceSubstituteMacro)nodeMacro,((IncludeMacro)nodeMacro).getSourceNodeQuery(),true,generator);
    }
  }
 catch (  GenerationFailedException gfe) {
    throw gfe;
  }
catch (  Throwable t) {
    throw new GenerationFailedException(new GenerationFailueInfo(t.toString(),currentInputNode,nodeMacro.getNode(),null,generator.getGeneratorSessionContext()),t);
  }
  throw new GenerationFailedException(new GenerationFailueInfo("couldn't get new input node",currentInputNode,nodeMacro.getNode(),null,generator.getGeneratorSessionContext()));
}
