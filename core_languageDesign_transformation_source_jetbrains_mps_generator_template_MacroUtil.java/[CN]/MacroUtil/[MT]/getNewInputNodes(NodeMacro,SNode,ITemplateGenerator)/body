{
  try {
    if (nodeMacro instanceof LoopMacro) {
      return getNewInputNodes(currentInputNode,(SourceSubstituteMacro)nodeMacro,((LoopMacro)nodeMacro).getSourceNodesQuery(),generator);
    }
 else     if (nodeMacro instanceof CopySrcListMacro) {
      return getNewInputNodes(currentInputNode,(SourceSubstituteMacro)nodeMacro,((CopySrcListMacro)nodeMacro).getSourceNodesQuery(),generator);
    }
 else     if (nodeMacro instanceof MapSrcListMacro) {
      return getNewInputNodes(currentInputNode,(SourceSubstituteMacro)nodeMacro,((MapSrcListMacro)nodeMacro).getSourceNodesQuery(),generator);
    }
    if (nodeMacro instanceof CopySrcNodeMacro) {
      List<SNode> result=new ArrayList<SNode>(1);
      SNode newInputNode=getNewInputNode(currentInputNode,(SourceSubstituteMacro)nodeMacro,((CopySrcNodeMacro)nodeMacro).getSourceNodeQuery(),false,generator);
      if (newInputNode != null) {
        result.add(newInputNode);
      }
      return result;
    }
 else     if (nodeMacro instanceof MapSrcNodeMacro) {
      List<SNode> result=new ArrayList<SNode>(1);
      SNode newInputNode=getNewInputNode(currentInputNode,(SourceSubstituteMacro)nodeMacro,((MapSrcNodeMacro)nodeMacro).getSourceNodeQuery(),true,generator);
      if (newInputNode != null) {
        result.add(newInputNode);
      }
      return result;
    }
    if (nodeMacro instanceof SwitchMacro) {
      throw new GenerationFailedException(new GenerationFailueInfo("The SwitchMacro is not supported by getNewInputNodes",currentInputNode,nodeMacro.getNode(),null,generator.getGeneratorSessionContext()));
    }
 else     if (nodeMacro instanceof IncludeMacro) {
      throw new GenerationFailedException(new GenerationFailueInfo("The IncludeMacro is not supported by getNewInputNodes",currentInputNode,nodeMacro.getNode(),null,generator.getGeneratorSessionContext()));
    }
    String sourceQueryAspectMethodName=nodeMacro.getSourceQueryAspectMethodName();
    if (sourceQueryAspectMethodName != null) {
      String methodName="templateSourceQuery_" + sourceQueryAspectMethodName;
      Object[] args=new Object[]{currentInputNode,generator};
      return (List<SNode>)QueryMethod.invoke(methodName,args,nodeMacro.getModel());
    }
    List<SNode> list=new ArrayList<SNode>(1);
    list.add(currentInputNode);
    return list;
  }
 catch (  GenerationFailedException gfe) {
    throw gfe;
  }
catch (  Throwable t) {
    throw new GenerationFailedException(new GenerationFailueInfo("couldn't get input nodes",currentInputNode,nodeMacro.getNode(),null,generator.getGeneratorSessionContext()),t);
  }
}
