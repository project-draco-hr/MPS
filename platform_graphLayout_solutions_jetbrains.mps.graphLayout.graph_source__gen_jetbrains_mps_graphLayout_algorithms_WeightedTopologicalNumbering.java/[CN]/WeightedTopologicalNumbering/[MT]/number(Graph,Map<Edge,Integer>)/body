{
  List<Node> sorting=TopologicalSorting.sort(graph);
  Map<Node,Integer> numbering=new NodeMap<Integer>(graph);
  for (  Node node : ListSequence.fromList(graph.getNodes())) {
    MapSequence.fromMap(numbering).put(node,0);
  }
  for (  Node node : ListSequence.fromList(sorting)) {
    for (    Edge edge : ListSequence.fromList(node.getOutEdges())) {
      Node target=edge.getTarget();
      MapSequence.fromMap(numbering).put(target,Math.max(MapSequence.fromMap(numbering).get(target),MapSequence.fromMap(numbering).get(node) + MapSequence.fromMap(weights).get(edge)));
    }
  }
  return numbering;
}
