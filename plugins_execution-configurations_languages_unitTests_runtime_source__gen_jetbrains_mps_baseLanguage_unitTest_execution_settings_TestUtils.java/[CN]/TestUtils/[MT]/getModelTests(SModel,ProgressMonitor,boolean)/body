{
  Iterable<ITestNodeWrapper> result=Sequence.fromIterable(Collections.<ITestNodeWrapper>emptyList());
  Iterable<SNode> roots=(Iterable<SNode>)model.getRootNodes();
  monitor.start("model " + model.getModelName(),IterableUtil.asCollection(roots).size());
  try {
    for (    SNode root : Sequence.fromIterable(roots)) {
      if (monitor.isCanceled()) {
        return null;
      }
      ITestNodeWrapper wrappedNode=TestNodeWrapperFactory.tryToWrap(root);
      if (wrappedNode != null) {
        result=Sequence.fromIterable(result).concat(Sequence.singleton(wrappedNode));
        if (breakOnFirstFound) {
          return result;
        }
      }
      monitor.advance(1);
    }
  }
  finally {
    monitor.done();
  }
  return result;
}
