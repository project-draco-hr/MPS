{
  List<SReference> unresolvedReferences=Sequence.fromIterable(references).sort(REFERENCE_COMPARATOR,true).toListSequence();
  boolean performResolve=true;
  while (performResolve) {
    performResolve=false;
    for (Iterator<SReference> iterator=ListSequence.fromList(unresolvedReferences).iterator(); iterator.hasNext(); ) {
      SReference reference=iterator.next();
      SNode sourceNode=reference.getSourceNode();
      if (sourceNode == null) {
        continue;
      }
      ResolveResult resolveResult=myScopeResolver.resolve(reference,sourceNode,operationContext);
      if (resolveResult != null) {
        resolveResult.setTarget();
        iterator.remove();
        performResolve=true;
      }
    }
  }
}
