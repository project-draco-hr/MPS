{
  if (dataSource instanceof FileDataSource) {
    save(((FileDataSource)dataSource).getFile(),log);
  }
 else   if (dataSource instanceof MultiStreamDataSource) {
    save((MultiStreamDataSource)dataSource,log);
  }
 else {
    throw new UnsupportedOperationException("cannot save structure modification log for " + dataSource.getClass().getName());
  }
}
