{
  final List<SReference> result=ListSequence.fromList(new ArrayList<SReference>());
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      for (      jetbrains.mps.smodel.SNode node : SNodeOperations.getDescendants(((jetbrains.mps.smodel.SNode)root),null,true,new String[]{})) {
        for (        SReference ref : SNodeOperations.getReferences(node)) {
          jetbrains.mps.smodel.SNode targetNode=ref.getTargetNode();
          boolean contains=scope.contains(targetNode);
          if (!(contains)) {
            ListSequence.fromList(result).addElement(ref);
          }
        }
      }
    }
  }
);
  return result;
}
