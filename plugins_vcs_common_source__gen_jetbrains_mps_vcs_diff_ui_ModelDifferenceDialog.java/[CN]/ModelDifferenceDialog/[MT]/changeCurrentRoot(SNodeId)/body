{
  if (myRootDifferencePane != null && myRootId == rootId) {
    return;
  }
  syncMetadataChanges();
  myRootId=rootId;
  final ModelChangeSet changeSet=(rootId == null ? myMetadataChangeSet : myChangeSet);
  final SNodeId nodeId=(rootId == null ? ListSequence.fromList(SModelOperations.getRoots(((org.jetbrains.mps.openapi.model.SModel)myMetadataChangeSet.getOldModel().getModelDescriptor()),null)).first().getNodeId() : rootId);
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      if (myRootDifferencePane == null) {
        myRootDifferencePane=new RootDifferencePane(myProject,changeSet,nodeId,myTree.getNameForRoot(rootId),myContentTitles,myEditable,myStatusBar);
        DefaultActionGroup actionGroup=new DefaultActionGroup();
        actionGroup.addAll(myRootDifferencePane.getActions());
        ActionToolbar toolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,actionGroup,true);
        myRootDifferencePane.registerShortcuts(myComponent);
        JPanel panel=new JPanel(new BorderLayout());
        panel.add(toolbar.getComponent(),BorderLayout.NORTH);
        panel.add(myRootDifferencePane.getPanel(),BorderLayout.CENTER);
        myPanel.setSecondComponent(panel);
        myRootDifferencePane.navigateInitial(null);
      }
 else {
        myRootDifferencePane.setRootId(nodeId,changeSet);
      }
    }
  }
);
}
