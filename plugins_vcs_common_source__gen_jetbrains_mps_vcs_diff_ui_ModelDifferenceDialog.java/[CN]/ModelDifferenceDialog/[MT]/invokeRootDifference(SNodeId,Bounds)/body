{
  if (rootId == null) {
    MetadataUtil.showMetadataDifference(myChangeSet.getOldModel(),myChangeSet.getNewModel(),myProject,myContentTitles[0],myContentTitles[1],scrollTo);
    return;
  }
  if (myRootDifferenceDialog != null) {
    return;
  }
  myGoingToNeighbour=false;
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      myRootDifferenceDialog=new RootDifferenceDialog(myProject,myChangeSet,rootId,myTree.getNameForRoot(rootId),myContentTitles,(isVisible() ? getWindow() : WindowManager.getInstance().getFrame(myProject)),myEditable,new ModelDifferenceDialog.MyGoToNeighbourRootActions().getActions(),scrollTo);
    }
  }
);
  myRootDifferenceDialog.show();
  myRootDifferenceDialog=null;
  if (!(myGoingToNeighbour) && !(isVisible())) {
    close(NEXT_USER_EXIT_CODE);
    return;
  }
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      rebuildChangeSet();
    }
  }
);
}
