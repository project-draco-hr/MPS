{
  List<SReference> oldReferences=(List<SReference>)oldNode.getReferences();
  List<SReference> newReferences=(List<SReference>)newNode.getReferences();
  for (  String role : ListSequence.fromList(oldReferences).concat(ListSequence.fromList(newReferences)).select(new ISelector<SReference,String>(){
    public String select(    SReference r){
      return r.getRole();
    }
  }
).distinct()) {
    buildForReference(oldNode,newNode,role);
  }
}
