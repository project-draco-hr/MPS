{
  SNode suitableMacro=ListSequence.<SNode>fromList(macro).findFirst(new IWhereFilter<SNode>(){
    public boolean accept(    SNode it){
      return SPropertyOperations.getString(thisNode,"fullPath").startsWith(SPropertyOperations.getString(it,"path") + Util.SEPARATOR);
    }
  }
);
  if (suitableMacro == null) {
    return;
  }
  SLinkOperations.setTarget(thisNode,"macro",suitableMacro,false);
  SPropertyOperations.set(thisNode,"fullPath",ModuleUtil.getRelativePath(SPropertyOperations.getString(thisNode,"fullPath"),SPropertyOperations.getString(suitableMacro,"path")));
}
