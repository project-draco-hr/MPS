{
  Set<IModule> reqModules=SetSequence.fromSet(new HashSet<IModule>());
  Set<IModule> rtModules=SetSequence.fromSet(new HashSet<IModule>());
  Set<Language> usedLanguages=SetSequence.fromSet(new HashSet<Language>());
  DependencyTree tree=(DependencyTree)getTree();
  for (  IModule module : ListSequence.fromList(myModules)) {
    DependenciesManager depManager=module.getDependenciesManager();
    SetSequence.fromSet(reqModules).addSequence(SetSequence.fromSet(depManager.getAllVisibleModules()));
    SetSequence.fromSet(rtModules).addSequence(SetSequence.fromSet(depManager.getAllRequiredModules()));
    SetSequence.fromSet(usedLanguages).addSequence(SetSequence.fromSet(depManager.getAllUsedLanguages()));
  }
  Set<IModule> allModules=(tree.isShowRuntime() ? rtModules : reqModules);
  Set<IModule> depLoops=tree.getLoops();
  SetSequence.fromSet(allModules).addSequence(SetSequence.fromSet(depLoops).intersect(ListSequence.fromList(myModules)));
  for (  IModule m : SetSequence.fromSet(allModules).sort(new ISelector<IModule,Comparable<?>>(){
    public Comparable<?> select(    IModule it){
      return it.getModuleFqName();
    }
  }
,true)) {
    add(new ModuleDependencyNode.DepDependencyNode(m,!(SetSequence.fromSet(reqModules).contains(m)),SetSequence.fromSet(depLoops).contains(m),getOperationContext()));
  }
  if (tree.isShowUsedLanguage()) {
    MPSTreeNode usedlanguages=new TextMPSTreeNode("Used languages",getOperationContext());
    for (    Language l : SetSequence.fromSet(usedLanguages).sort(new ISelector<Language,Comparable<?>>(){
      public Comparable<?> select(      Language it){
        return it.getModuleFqName();
      }
    }
,true)) {
      usedlanguages.add(new ModuleDependencyNode.ULangDependencyNode(l,getOperationContext()));
    }
    add(usedlanguages);
  }
  myInitialized=true;
}
