{
  for (  SNode node : nodes) {
    for (    SReference ref : node.getReferences()) {
      if (mapping.containsKey(ref.getTargetNode())) {
        node.replace(ref.getTargetNode(),mapping.get(ref.getTargetNode()));
      }
 else {
        node.getModel().addImportedModel(ref.getSourceNode().getModel().getUID());
      }
    }
    for (    SNode child : node.getChildren()) {
      List<SNode> childList=new ArrayList<SNode>();
      childList.add(child);
      fixReferences(childList,mapping);
    }
  }
}
