{
  myNodesOrder.clear();
  Deque<MPSPsiNodeBase> stack=new ArrayDeque<MPSPsiNodeBase>();
  stack.add(this);
  int k=0;
  while (!stack.isEmpty()) {
    MPSPsiNodeBase curr=stack.pop();
    myNodesOrder.put(curr,k++);
    PsiElement[] children=curr.getChildren();
    for (int i=children.length - 1; i >= 0; i--) {
      PsiElement c=children[i];
      if (c instanceof MPSPsiNodeBase) {
        stack.push((MPSPsiNodeBase)c);
      }
    }
  }
}
