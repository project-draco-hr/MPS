{
  MPSPsiNode last=null;
  for (  SNode root : model.getRootNodes()) {
    MPSPsiNode psiRoot=convert(root);
    addChild(last,psiRoot);
    last=psiRoot;
  }
  DataSource source=model.getSource();
  if (source instanceof FileDataSource) {
    File file=new File(((FileDataSource)source).getFile().getPath());
    VirtualFile vfile=LocalFileSystem.getInstance().findFileByIoFile(file);
    this.mySourceVirtualFile=vfile;
    vfile.putUserData(MPSKeys.MODEL_REFERENCE,reference);
  }
}
