{
  String textTrimmed=text.trim();
  if (text.startsWith(UnitTestRunner.START_TEST_PREFIX)) {
    saveLastTestIfNecessary();
    myCurrentlyRunningTest=removeTag(text,UnitTestRunner.START_TEST_PREFIX);
    myUnitTestListener.testStarted(myCurrentlyRunningTest);
  }
 else   if (text.startsWith(UnitTestRunner.END_TEST_PREFIX)) {
    myCurrentlyRunningTest=null;
    myUnitTestListener.testFinished(removeTag(text,UnitTestRunner.END_TEST_PREFIX));
  }
 else   if (text.startsWith(UnitTestRunner.FAILURE_TEST_PREFIX)) {
    myLastMessage=removeTag(text,UnitTestRunner.FAILURE_TEST_PREFIX);
    myInsideTestError=true;
  }
 else   if (text.startsWith(UnitTestRunner.FAILURE_TEST_SUFFIX)) {
    myUnitTestListener.testFailed(removeTag(text,UnitTestRunner.FAILURE_TEST_SUFFIX),myLastMessage,myLastError.toString());
    myLastError=new StringBuffer();
    myInsideTestError=false;
  }
 else   if (error) {
    if (myInsideTestError) {
      myLastError.append(textTrimmed);
      myLastError.append("\n");
    }
 else {
      myUnitTestListener.logError(text);
    }
  }
 else {
    myUnitTestListener.logMessage(text);
  }
}
