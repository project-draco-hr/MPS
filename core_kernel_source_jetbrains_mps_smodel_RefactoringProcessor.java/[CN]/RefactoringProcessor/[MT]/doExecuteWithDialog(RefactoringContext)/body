{
  final boolean[] cancelled=new boolean[]{true};
  ThreadUtils.runInUIThreadAndWait(new Runnable(){
    public void run(){
      IRefactoring refactoring=refactoringContext.getRefactoring();
      Frame mainFrame=refactoringContext.getCurrentOperationContext().getMainFrame();
      List<SModel> modelsToGenerate=getModelsToGenerate(refactoring,refactoringContext);
      RefactoringOptionsDialog dialog=new RefactoringOptionsDialog(mainFrame,refactoringContext,refactoring,!modelsToGenerate.isEmpty());
      if (dialog.needToBeShown()) {
        dialog.showDialog();
        cancelled[0]=dialog.isCancelled();
      }
 else {
        cancelled[0]=false;
      }
    }
  }
);
  if (cancelled[0])   return;
  doExecute(refactoringContext);
}
