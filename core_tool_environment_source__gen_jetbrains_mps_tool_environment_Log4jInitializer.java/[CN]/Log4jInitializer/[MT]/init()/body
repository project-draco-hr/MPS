{
  System.setProperty("log4j.defaultInitOverride","true");
  File logXmlFile=new File(PathManager.getHomePath() + "/bin/log.xml");
  if (logXmlFile == null) {
    throw new RuntimeException("log.xml file does not exist! Path: [ $home/bin/log.xml]");
  }
  String text=FileUtil.read(logXmlFile);
  text=StringUtil.replace(text,SYSTEM_MACRO,StringUtil.replace(PathManager.getSystemPath(),"\\","\\\\"));
  text=StringUtil.replace(text,APPLICATION_MACRO,StringUtil.replace(PathManager.getHomePath(),"\\","\\\\"));
  text=StringUtil.replace(text,LOG_DIR_MACRO,StringUtil.replace(PathManager.getLogPath(),"\\","\\\\"));
  File file=new File(PathManager.getLogPath());
  if (!(file.mkdirs()) && !(file.exists())) {
    System.err.println("Cannot create log directory: " + file);
  }
  new DOMConfigurator().doConfigure(new StringReader(text),LogManager.getLoggerRepository());
  LogManager.getLogger("").info("Log4j has been initialized successfully");
}
