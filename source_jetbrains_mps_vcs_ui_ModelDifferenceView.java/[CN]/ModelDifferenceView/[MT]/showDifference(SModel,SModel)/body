{
  myNewModel=newModel;
  DiffBuilder builder=new DiffBuilder(oldModel,newModel);
  List<Change> changes=builder.getChanges();
  myChanges=changes;
  for (  AddRootChange ar : CollectionUtil.filter(AddRootChange.class,changes)) {
    myAddedNodes.add(ar.getNodeId());
  }
  for (  AddNodeChange an : CollectionUtil.filter(AddNodeChange.class,changes)) {
    myAddedNodes.add(an.getNodeId());
  }
  for (  SetNodeChange c : CollectionUtil.filter(SetNodeChange.class,changes)) {
    myAddedNodes.add(c.getNodeId());
  }
  for (  SetPropertyChange p : CollectionUtil.filter(SetPropertyChange.class,changes)) {
    myChangedNodes.add(p.getNodeId());
  }
  for (  SetReferenceChange r : CollectionUtil.filter(SetReferenceChange.class,changes)) {
    myChangedNodes.add(r.getNodeId());
  }
  for (  AddReferenceChange r : CollectionUtil.filter(AddReferenceChange.class,changes)) {
    myChangedNodes.add(r.getNodeId());
  }
  updateView();
  for (  Change c : changes) {
    expandNode(c.getAffectedNodeId());
  }
  return this;
}
