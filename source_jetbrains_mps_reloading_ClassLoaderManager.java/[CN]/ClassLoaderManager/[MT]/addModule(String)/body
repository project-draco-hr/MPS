{
  IModule module=MPSModuleRepository.getInstance().getModuleByUID(moduleUID);
  if (!myUseOSGI) {
    if (myRuntimeEnvironment.get(moduleUID) != null) {
      return;
    }
    RBundle b=new RBundle(module.getModuleUID(),module.getByteCodeLocator());
    for (    String dep : module.getExplicitlyDependOnModuleUIDs()) {
      b.addDependency(dep);
    }
    myRuntimeEnvironment.add(b);
  }
 else {
    module.createManifest();
    try {
      File file=module.getDescriptorFile();
      if (file == null) {
        return;
      }
      String bundleHome="reference:file:/" + file.getParentFile().getAbsolutePath();
      System.out.println("install to " + bundleHome);
      Bundle bundle=MPSActivator.ourBundleContext.installBundle(bundleHome);
      myOSGIBundles.put(moduleUID,bundle);
      bundle.update();
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}
