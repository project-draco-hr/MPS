{
  LOG.debug("Updating class path");
  if (changeModule == null) {
    if (!myUseOSGI) {
      myRuntimeEnvironment.reloadAll();
    }
 else {
      refreshBundles(myOSGIBundles.values().toArray(new Bundle[0]));
    }
  }
 else {
    if (!myUseOSGI) {
      myRuntimeEnvironment.replace(new RBundle(changeModule.getModuleUID(),changeModule.getByteCodeLocator()));
    }
 else {
      refreshBundles(new Bundle[]{myOSGIBundles.get(changeModule.getModuleUID())});
    }
  }
  if (changeModule == null) {
    for (    IModule m : myModuleRepository.getAllModules()) {
      m.reloadStubs();
      ((AbstractModule)m).updateRuntimeClassPath();
    }
  }
 else {
    changeModule.reloadStubs();
    ((AbstractModule)changeModule).updateRuntimeClassPath();
  }
  LOG.debug("Done");
}
