{
  Tuples._2<SNode,SNode> key=MultiTuple.<SNode,SNode>from(classifier,kind);
  if (!(MapSequence.fromMap(CACHE).containsKey(key))) {
    Scope scope=scopeCreator.invoke();
    if (doFlat) {
      scope=new SimpleScope(scope.getAvailableElements(null));
    }
    MapSequence.fromMap(CACHE).put(key,scope);
  }
  return MapSequence.fromMap(CACHE).get(key);
}
