{
  IScript scr=new ScriptBuilder().withFacetNames(new IFacet.Name("jetbrains.mps.lang.core.Generate"),new IFacet.Name("jetbrains.mps.lang.core.TextGen"),new IFacet.Name("jetbrains.mps.make.facets.Make")).withFinalTarget(new ITarget.Name("jetbrains.mps.lang.core.TextGen.textGenToMemory")).toScript();
  IScriptController ctl=new IScriptController.Stub(new IConfigMonitor.Stub(){
    @Override public <T extends IOption>T relayQuery(    IQuery<T> query){
      return query.defaultOption();
    }
  }
,new IJobMonitor.Stub());
  final Future<IResult> future=IMakeService.INSTANCE.get().make(session,new ModelsToResources(context,Sequence.<SModel>singleton(md)).resources(false),scr,ctl);
  final SNodeReference contextRootNode=ModelAccess.instance().runWriteAction(new Computable<SNodeReference>(){
    public SNodeReference compute(){
      return check_yiwzzi_a0a0a0a6a1(check_yiwzzi_a0a0a0a0g0b(contextNode));
    }
  }
);
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      try {
        IResult result=future.get();
        if (result.isSucessful()) {
          FResource fres=(FResource)Sequence.fromIterable(result.output()).first();
          String fileToOpen=(contextNode != null ? MapSequence.fromMap(fres.rootNodeNames()).get(contextRootNode) : null);
          final TextPreviewFile[] previewFiles=new TextPreviewFile[(fileToOpen != null ? 1 : MapSequence.fromMap(fres.contents()).count())];
          if (fileToOpen != null) {
            previewFiles[0]=new TextPreviewFile(fileToOpen,MapSequence.fromMap(fres.contents()).get(fileToOpen),NameUtil.compactNamespace(md.getModelName()));
          }
 else {
            int counter=0;
{
              Iterator<String> key_it=SetSequence.fromSet(MapSequence.fromMap(fres.contents()).keySet()).iterator();
              String key_var;
              while (key_it.hasNext()) {
                key_var=key_it.next();
                previewFiles[counter++]=new TextPreviewFile(key_var,MapSequence.fromMap(fres.contents()).get(key_var),NameUtil.compactNamespace(md.getModelName()));
              }
            }
          }
          SwingUtilities.invokeLater(new Runnable(){
            public void run(){
              Project p=ProjectHelper.toIdeaProject(context.getProject());
              for (              TextPreviewFile previewFile : previewFiles) {
                FileEditorManager.getInstance(p).openTextEditor(new OpenFileDescriptor(p,previewFile),true);
              }
            }
          }
);
          ProjectPane.getInstance(context.getProject()).rebuild();
        }
      }
 catch (      InterruptedException ignored) {
      }
catch (      ExecutionException ignored) {
      }
catch (      CancellationException ignored) {
      }
    }
  }
);
}
