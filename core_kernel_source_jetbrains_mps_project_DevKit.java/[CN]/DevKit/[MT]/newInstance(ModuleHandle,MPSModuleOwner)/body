{
  DevKit result=new DevKit();
  DevkitDescriptor devKitDescriptor;
  if (handle.getDescriptor() != null) {
    devKitDescriptor=(DevkitDescriptor)handle.getDescriptor();
    if (devKitDescriptor.getId() == null) {
      devKitDescriptor.setId(ModuleId.regular());
      DevkitDescriptorPersistence.saveDevKitDescriptor(devKitDescriptor,handle.getFile());
    }
  }
 else {
    devKitDescriptor=new DevkitDescriptor();
    devKitDescriptor.setId(ModuleId.regular());
  }
  result.myDescriptorFile=handle.getFile();
  MPSModuleRepository repository=MPSModuleRepository.getInstance();
  if (repository.getModule(devKitDescriptor.getModuleReference()) != null) {
    LOG.error("Loading module " + devKitDescriptor.getNamespace() + " for the second time");
    return ModuleRepositoryFacade.getInstance().getModule(devKitDescriptor.getModuleReference(),DevKit.class);
  }
  result.setDevKitDescriptor(devKitDescriptor,false);
  repository.addModule(result,moduleOwner);
  return result;
}
