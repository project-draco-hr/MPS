{
  if (!(SNodeOperations.isInstanceOf(SNodeOperations.getParent(expr),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation")))) {
    return;
  }
  SNode binOp=ParenthesisUtil.getBinOp(expr,toRight);
  if (binOp == null) {
    return;
  }
  SNode sidemost=findRightmostOrLeftmostLeafExpression(SLinkOperations.getTarget(expr,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfb4ed32b7fL,0xfb4ed32b80L,"expression")),toRight);
  SNode leaf=findRightmostOrLeftmostLeafExpression((toRight ? SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression")) : SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression"))),!(toRight));
  SNode backsideSubtree=(toRight ? SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression")) : SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression")));
  SNodeOperations.detachNode(backsideSubtree);
  SNodeOperations.replaceWithAnother(binOp,backsideSubtree);
  SNodeOperations.replaceWithAnother(sidemost,binOp);
  if (toRight) {
    SLinkOperations.setTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression"),sidemost);
  }
 else {
    SLinkOperations.setTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression"),sidemost);
  }
  SNode sideSubtree=(toRight ? SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression")) : SLinkOperations.getTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression")));
  SNodeOperations.detachNode(leaf);
  if (toRight) {
    SLinkOperations.setTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression"),leaf);
  }
 else {
    SLinkOperations.setTarget(binOp,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression"),leaf);
  }
  if (sideSubtree != leaf) {
    SNode leafParentOperation=SNodeOperations.cast(sideSubtree,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation"));
    SNode exprParent=SNodeOperations.getParent(expr);
    SNodeOperations.replaceWithAnother(expr,sideSubtree);
    if (toRight) {
      SLinkOperations.setTarget(leafParentOperation,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11cL,"leftExpression"),expr);
    }
 else {
      SLinkOperations.setTarget(leafParentOperation,MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,0xfbdeb7a11bL,"rightExpression"),expr);
    }
    if (SNodeOperations.isInstanceOf(exprParent,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation"))) {
      ParenthesisUtil.checkOperationWRTPriority(SNodeOperations.cast(exprParent,MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation")));
    }
  }
  SNode binOpCheck=(SNodeOperations.isInstanceOf(SNodeOperations.getParent(binOp),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation")) ? SNodeOperations.cast(SNodeOperations.getParent(binOp),MetaAdapterFactory.getConcept(0xf3061a5392264cc5L,0xa443f952ceaf5816L,0xfbdeb6fecfL,"jetbrains.mps.baseLanguage.structure.BinaryOperation")) : binOp);
  ParenthesisUtil.checkOperationWRTPriority(binOpCheck);
  selectNode(context,expr,toRight);
}
