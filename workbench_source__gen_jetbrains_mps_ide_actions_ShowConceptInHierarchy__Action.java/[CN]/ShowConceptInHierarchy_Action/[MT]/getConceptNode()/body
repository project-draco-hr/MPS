{
  SNode refNode=ShowConceptInHierarchy_Action.this.editorCell.getSNodeWRTReference();
  if (SNodeOperations.isInstanceOf(refNode,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration")) {
    return SNodeOperations.cast(refNode,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration");
  }
  if (SNodeOperations.isInstanceOf(refNode,"jetbrains.mps.lang.behavior.structure.ConceptConstructorDeclaration")) {
    SNode concept=SNodeOperations.getAncestor(refNode,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration",false,false);
    if (concept != null) {
      return concept;
    }
  }
  SNode outerConcept=SNodeOperations.getAncestor(ShowConceptInHierarchy_Action.this.node,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration",true,false);
  if (outerConcept != null) {
    return outerConcept;
  }
  if (!(ShowConceptInHierarchy_Action.this.editor instanceof TabbedEditor)) {
    return null;
  }
  TabbedEditor tabbedEditor=(TabbedEditor)ShowConceptInHierarchy_Action.this.editor;
  SNode editedNode=(tabbedEditor).getEditedNode();
  if (!(SNodeOperations.isInstanceOf(editedNode,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration"))) {
    return null;
  }
  return SNodeOperations.cast(editedNode,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration");
}
