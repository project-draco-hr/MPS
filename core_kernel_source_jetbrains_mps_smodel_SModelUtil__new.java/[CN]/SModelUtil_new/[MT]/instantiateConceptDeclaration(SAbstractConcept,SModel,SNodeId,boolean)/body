{
  boolean isNotProjectModel=model == null || !TemporaryModels.isTemporary(model);
  if (isNotProjectModel) {
    SConcept concreteConcept=ModelConstraints.getDefaultConcreteConcept(concept);
    if (concreteConcept != null) {
      concept=concreteConcept;
    }
  }
  SConcept concreteConcept=MetaAdapterByDeclaration.asInstanceConcept(concept);
  jetbrains.mps.smodel.SNode newNode=nodeId == null ? new jetbrains.mps.smodel.SNode(concreteConcept) : new jetbrains.mps.smodel.SNode(concreteConcept,nodeId);
  if (fullNodeStructure && isNotProjectModel) {
    createNodeStructure(concreteConcept,newNode,model);
  }
  return newNode;
}
