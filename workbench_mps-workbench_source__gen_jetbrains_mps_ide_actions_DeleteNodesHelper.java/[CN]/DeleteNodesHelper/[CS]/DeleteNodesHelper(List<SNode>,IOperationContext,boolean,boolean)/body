{
  myContext=context;
  mySafe=safe;
  if (aspects) {
    myNodesToDelete=ListSequence.fromList(nodes).translate(new ITranslator2<SNode,SNode>(){
      public Iterable<SNode> translate(      final SNode node){
        List<RelationDescriptor> tabs=ProjectPluginManager.getApplicableTabs(ProjectHelper.toIdeaProject(context.getProject()),node);
        return ListSequence.fromList(tabs).translate(new ITranslator2<RelationDescriptor,SNode>(){
          public Iterable<SNode> translate(          RelationDescriptor tab){
            return (tab.isApplicable(node) ? tab.getNodes(node) : Collections.<SNode>emptyList());
          }
        }
);
      }
    }
).toListSequence();
  }
 else {
    myNodesToDelete=nodes;
  }
}
