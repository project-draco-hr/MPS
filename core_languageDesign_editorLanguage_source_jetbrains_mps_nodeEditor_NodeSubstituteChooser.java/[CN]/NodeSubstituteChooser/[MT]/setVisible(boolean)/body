{
  if (myChooserActivated != b) {
    if (b) {
      myEditorComponent.pushKeyboardHandler(this);
      getPatternEditor().activate(getEditorWindow(),myPatternEditorLocation,myPatternEditorSize);
      myNodeSubstituteInfo.invalidateActions();
      rebuildMenuEntries();
      getPopupWindow().relayout();
      getPopupWindow().setSelectionIndex(0);
      getPopupWindow().setVisible(true);
      myPopupActivated=true;
    }
 else {
      getPopupWindow().setVisible(false);
      getPatternEditor().done();
      myPopupActivated=false;
      myEditorComponent.popKeyboardHandler();
    }
  }
  myChooserActivated=b;
}
