{
  SNode baseNode=null;
  if (jetbrains.mps.util.SNodeOperations.isRoot(node) && SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x10802efe25aL,"jetbrains.mps.lang.core.structure.BaseConcept"))) {
    SNode bc=SNodeOperations.cast(node,MetaAdapterFactory.getConcept(0xceab519525ea4f22L,0x9b92103b95ca8c0cL,0x10802efe25aL,"jetbrains.mps.lang.core.structure.BaseConcept"));
    SNode annotation=AttributeOperations.getAttribute(bc,new IAttributeDescriptor.NodeAttribute("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation"));
    if ((annotation != null) && (SLinkOperations.getTarget(annotation,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0x11017244494L,0x11017255ccfL,"applicableConcept")) != null)) {
      baseNode=SLinkOperations.getTarget(annotation,MetaAdapterFactory.getReferenceLink(0xb401a68083254110L,0x8fd384331ff25befL,0x11017244494L,0x11017255ccfL,"applicableConcept"));
    }
  }
  if ((baseNode == null)) {
    return null;
  }
  SModule baseNodeModule=SNodeOperations.getModel(baseNode).getModule();
  SModule nodeModule=SNodeOperations.getModel(node).getModule();
  if (nodeModule instanceof Generator) {
    nodeModule=((Generator)nodeModule).getSourceLanguage();
  }
  if (baseNodeModule != nodeModule) {
    return null;
  }
  return baseNode;
}
