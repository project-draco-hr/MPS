{
  myReference=null;
  myRefConcept=smartConcept;
  final SNode smartReference=ReferenceConceptUtil.getCharacteristicReference(smartConcept);
  if (smartReference == null) {
    throw new IllegalArgumentException("smartConcept has no characteristic reference: " + smartConcept.getName());
  }
  myRefRole=SModelUtil.getGenuineLinkRole(smartReference);
  SNode linkDeclaration=role != null ? enclosingNode.getLinkDeclaration(role) : null;
  if (linkDeclaration != null && SNodeUtil.getLinkDeclaration_IsReference(linkDeclaration)) {
    throw new IllegalArgumentException("for reference role smartConcept should be null");
  }
  myReferentConstraintContext=createReferentConstraintContext(false,enclosingNode,null,role,index,SModelUtil.getLinkDeclarationTarget(smartReference),linkDeclaration);
  myScopeProvider=ModelConstraintsManager.getNodeReferentSearchScopeProvider(smartConcept,myRefRole);
}
