{
  ModelAccess.assertLegalRead();
  SNode node=reference.getSourceNode();
  String role=reference.getRole();
  SNode concept=node.getConceptDeclarationNode();
  SearchScopeStatus status=getSearchScope(node.getParent(),node,concept,role,null,node.getRoleLink(),context);
  if (status.isOk()) {
    if (status.isDefault()) {
      SNode linkDeclaration=SModelSearchUtil.findLinkDeclaration(concept,reference.getRole());
      SNode linkTarget=SModelUtil.getLinkDeclarationTarget(linkDeclaration);
      return createDefaultScope(reference.getSourceNode().getModel(),context,NameUtil.nodeFQName(linkTarget));
    }
    return new RefAdapter(status.getSearchScope(),reference);
  }
  return new ErrorScope(status.getMessage());
}
