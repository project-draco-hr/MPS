{
  if (scopeProvider == null)   return new OK(createDefaultScope(model,context),null,true,null);
  final ReferentConstraintContext referentConstraintContext=new ReferentConstraintContext(model,enclosingNode,referenceNode,linkTarget,containingLinkDeclaration);
  try {
    ISearchScope searchScope=TypeContextManager.getInstance().runResolveAction(new Computable<ISearchScope>(){
      @Override public ISearchScope compute(){
        return scopeProvider.createSearchScope(context,referentConstraintContext);
      }
    }
);
    if (searchScope instanceof UndefinedSearchScope) {
      return new OK(createDefaultScope(model,context),null,true,null);
    }
 else {
      return new OK(searchScope,null,false,scopeProvider.getSearchScopeValidatorNode());
    }
  }
 catch (  Throwable t) {
    return new ERROR(t.getMessage());
  }
}
