{
  FileSystem.getInstance().removeListener(this);
  super.dispose();
  ModelAccess.instance().runWriteAction(new Runnable(){
    @Override public void run(){
      final ClassLoaderManager manager=ClassLoaderManager.getInstance();
      manager.stopListening();
      Collection<SModule> projectModules=ModuleRepositoryFacade.getInstance().getModules(StandaloneMPSProject.this,SModule.class);
      manager.unloadClasses(projectModules,new EmptyProgressMonitor());
      ModuleRepositoryFacade.getInstance().unregisterModules(StandaloneMPSProject.this);
      manager.startListening();
      CleanupManager.getInstance().cleanup();
      if (ProjectManager.getInstance().getOpenProjects().length > 0) {
        manager.reloadAll(new EmptyProgressMonitor());
      }
    }
  }
);
  if (myProject != null) {
    if (RuntimeFlags.isTestMode() && !(myProject.isDisposed())) {
      ProjectUtil.closeAndDispose(myProject);
    }
  }
  stopWatching();
}
