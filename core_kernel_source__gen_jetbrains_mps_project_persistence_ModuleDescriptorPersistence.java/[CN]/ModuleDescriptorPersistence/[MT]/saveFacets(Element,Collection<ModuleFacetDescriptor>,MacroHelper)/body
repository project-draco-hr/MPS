{
  for (  ModuleFacetDescriptor facet : CollectionSequence.fromCollection(facets)) {
    Memento memento=facet.getMemento();
    Element facetElement=new Element("facet");
    writeMemento(memento,facetElement,macroHelper);
    String type=facet.getType();
    facetElement.setAttribute("type",type);
    result.addContent(facetElement);
  }
}
