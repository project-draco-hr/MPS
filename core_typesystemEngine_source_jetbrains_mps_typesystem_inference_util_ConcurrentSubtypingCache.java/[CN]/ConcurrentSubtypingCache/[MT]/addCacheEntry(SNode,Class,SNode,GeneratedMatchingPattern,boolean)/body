{
  ConcurrentHashMap<CacheNodeHandler,ConcurrentHashMap<Class,Pair<SNode,GeneratedMatchingPattern>>> cache=isWeak ? myCoerceToPatternsCacheWeak : myCoerceToPatternsCache;
  CacheNodeHandler subtypeHandler=new CacheNodeHandler(subtype);
  ConcurrentHashMap<Class,Pair<SNode,GeneratedMatchingPattern>> map=cache.get(subtypeHandler);
  if (map == null) {
    map=new ConcurrentHashMap<Class,Pair<SNode,GeneratedMatchingPattern>>();
    if (cache.putIfAbsent(subtypeHandler,map) != null) {
      map=cache.get(subtypeHandler);
    }
  }
  if (map != null) {
    map.put(c,new Pair<SNode,GeneratedMatchingPattern>(result,pattern));
  }
}
