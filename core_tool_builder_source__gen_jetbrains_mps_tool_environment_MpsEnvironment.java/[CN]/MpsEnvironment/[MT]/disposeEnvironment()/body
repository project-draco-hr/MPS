{
  for (  Project project : SetSequence.fromSetWithValues(new HashSet<Project>(),openedProjects)) {
    disposeProject(project);
  }
  PathMacros.getInstance().removeMacrosProvider(macroProvider);
  LibraryInitializer.getInstance().removeContributor(libContributor);
  MpsPlatform.dispose();
  ActiveEnvironment.deactivateEnvironment(this);
}
