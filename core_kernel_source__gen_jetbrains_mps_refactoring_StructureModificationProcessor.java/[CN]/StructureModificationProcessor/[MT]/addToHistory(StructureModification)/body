{
  for (  StructureModification.Entry d : ListSequence.fromList(data.getData())) {
    Sequence.fromIterable(d.getDependentModels()).visitAll(new IVisitor<SModelReference>(){
      public void visit(      SModelReference it){
        data.addDependencyModel(it);
      }
    }
);
  }
  for (  IMapping<SModelReference,Integer> d : MapSequence.fromMap(data.getDependencies())) {
    EditableSModelDescriptor model=(EditableSModelDescriptor)SModelRepository.getInstance().getModelDescriptor(d.key());
    StructureModificationLog history=model.getStructureModificationLog();
    history.addStructureModification(data);
    model.setVersion(d.value() + 1);
    model.saveStructureModificationLog(history);
    SModelRepository.getInstance().markChanged(model,true);
  }
}
