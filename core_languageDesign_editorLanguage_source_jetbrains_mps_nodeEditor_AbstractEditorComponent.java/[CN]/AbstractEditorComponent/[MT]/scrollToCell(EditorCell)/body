{
  if (getVisibleRect().isEmpty()) {
    return;
  }
  EditorCell largestVerticalBigCell=cell;
  int viewportWidth=myScrollPane.getViewport().getWidth();
  int x0;
  int width;
  if (cell instanceof EditorCell_Label && cell.getWidth() > viewportWidth) {
    EditorCell_Label cellLabel=(EditorCell_Label)cell;
    int caretX=cellLabel.getCaretX();
    int charWidth=cellLabel.getCharWidth();
    x0=caretX - 2 * charWidth;
    width=4 * charWidth;
  }
 else {
    x0=cell.getX();
    width=cell.getWidth();
  }
  Rectangle visibleRect=getVisibleRect();
  boolean adjustHorizontally=!visibleRect.contains(new Rectangle(x0,visibleRect.y,width,visibleRect.height));
  if (adjustHorizontally) {
    int x1=Math.max(0,x0 + width - viewportWidth);
    scrollRectToVisible(expandRectangleOneLine(new Rectangle(x1,largestVerticalBigCell.getY(),x0 - x1 + width,largestVerticalBigCell.getHeight())));
  }
 else {
    scrollRectToVisible(expandRectangleOneLine(new Rectangle(x0,largestVerticalBigCell.getY(),width,largestVerticalBigCell.getHeight())));
  }
}
