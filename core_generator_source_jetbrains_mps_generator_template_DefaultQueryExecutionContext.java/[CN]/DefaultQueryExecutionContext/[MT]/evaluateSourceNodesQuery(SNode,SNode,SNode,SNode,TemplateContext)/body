{
  Collection<SNode> result=getSourceNodes(ruleNode == null ? macroNode : ruleNode,query,context.subContext(inputNode));
  @SuppressWarnings("unchecked") List<SNode> resultList=(result instanceof List) ? (List<SNode>)result : new ArrayList<SNode>(result);
  return resultList;
}
