{
  String propertyName=AttributeOperations.getPropertyName(propertyMacro);
  SNode function=RuleUtil.getPropertyMacro_ValueFunction(propertyMacro);
  if (propertyName == null || function == null) {
    getLog().error(propertyMacro.getReference(),"cannot evaluate property macro",GeneratorUtil.describeInput(context));
    throw new GenerationFailureException("cannot evaluate property macro");
  }
  String templateValue=SNodeAccessUtil.getProperty(templateNode,propertyName);
  String methodName=TemplateFunctionMethodName.propertyMacro_GetPropertyValue(function);
  try {
    Object macroValue=QueryMethodGenerated.invoke(methodName,myGenerator.getGeneratorSessionContext(),new PropertyMacroContext(context,templateValue,propertyMacro.getReference(),myGenerator),propertyMacro.getModel());
    String propertyValue=macroValue == null ? null : String.valueOf(macroValue);
    SNodeAccessUtil.setProperty(outputNode,propertyName,propertyValue);
  }
 catch (  Throwable t) {
    getLog().handleException(t);
    getLog().error(propertyMacro.getReference(),"cannot evaluate property macro, exception was thrown",GeneratorUtil.describeInput(context));
    throw new GenerationFailureException(t);
  }
}
