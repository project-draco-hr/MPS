{
  try {
    final SNodeReference qr=query.getReference();
    SourceNodeQuery q=myQuerySource.getQueryProvider(qr).getSourceNodeQuery(query);
    return q.evaluate(new SourceSubstituteMacroNodeContext(context.subContext(inputNode),macroNode.getReference()));
  }
 catch (  GenerationFailureException ex) {
    throw ex;
  }
catch (  Throwable th) {
    getLog().handleException(th);
    getLog().error(query.getReference(),"cannot evaluate query, exception was thrown",GeneratorUtil.describeInput(context));
    return null;
  }
}
