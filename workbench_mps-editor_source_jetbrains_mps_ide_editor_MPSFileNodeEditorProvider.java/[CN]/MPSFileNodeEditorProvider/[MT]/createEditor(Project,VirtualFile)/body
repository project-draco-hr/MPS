{
  MPSNodeVirtualFile mpsNodeVirtualFile=file instanceof MPSNodeVirtualFile ? (MPSNodeVirtualFile)file : ModelAccess.instance().runReadAction(new Computable<MPSNodeVirtualFile>(){
    @Override public MPSNodeVirtualFile compute(){
      SModel descr=SModelFileTracker.getInstance().findModel(VirtualFileUtils.toIFile(file.getParent()));
      if (descr != null) {
        for (        SNode node : descr.getRootNodes()) {
          if (node.getName().equals(file.getNameWithoutExtension())) {
            return MPSNodesVirtualFileSystem.getInstance().getFileFor(node);
          }
        }
      }
      return null;
    }
  }
);
  return mpsNodeVirtualFile != null ? new MPSFileNodeEditor(project,mpsNodeVirtualFile) : new MPSFileNodeEditor(project,file);
}
