{
  environment.getTracer().pushRule(getRuleNode());
  try {
    final TemplateExecutionEnvironment env=environment.getEnvironment(context.getInput(),this);
    return doApply(context.subContext(env),env);
  }
  finally {
    environment.getTracer().closeRule(getRuleNode());
  }
}
