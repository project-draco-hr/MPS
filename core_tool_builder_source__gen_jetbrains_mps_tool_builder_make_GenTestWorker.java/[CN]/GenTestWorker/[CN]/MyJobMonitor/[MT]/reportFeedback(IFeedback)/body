{
  if (fdbk.getSeverity() == IFeedback.Severity.ERROR) {
    String test=myReporter.getCurrentTestName();
    if (test == null) {
      test="unknown";
    }
    Throwable thr=fdbk.getException();
    String msg=fdbk.getMessage();
    String details=(thr == null ? "(no details)" : String.valueOf(MpsWorker.extractStackTrace(thr)));
    int eol=msg.indexOf("\n");
    if (eol >= 0) {
      details=msg.substring(eol + 1) + "\n" + details;
      msg=msg.substring(0,eol);
    }
    myReporter.testFailed(test,msg,details);
  }
}
