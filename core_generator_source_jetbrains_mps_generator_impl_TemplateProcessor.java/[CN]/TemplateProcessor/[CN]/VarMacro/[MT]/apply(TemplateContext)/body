{
  String varName=RuleUtil.getVarMacro_Name(macro);
  Object varValue=myTemplateProcessor.getQueryExecutor().evaluateVariableQuery(templateContext.getInput(),RuleUtil.getVarMacro_Query(macro),templateContext);
  TemplateContext newContext=templateContext.subContext(Collections.singletonMap(varName,varValue));
  return myTemplateProcessor.applyTemplate(templateNode,newContext.subContext(templateContext.getInputName()),this);
}
