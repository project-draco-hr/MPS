{
  String varName=RuleUtil.getVarMacro_Name(macro);
  Object varValue=templateContext.getEnvironment().getQueryExecutor().evaluate(myValueQuery,new TemplateVarContext(templateContext,getMacroNodeRef()));
  TemplateContext newContext=templateContext.subContext(Collections.singletonMap(varName,varValue));
  return nextMacro(newContext.subContext(templateContext.getInputName()));
}
