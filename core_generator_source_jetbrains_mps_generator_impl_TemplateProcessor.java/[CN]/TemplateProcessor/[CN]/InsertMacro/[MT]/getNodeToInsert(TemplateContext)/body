{
  SNode query=RuleUtil.getInsertMacro_Query(macro);
  if (query != null) {
    return context.getEnvironment().getQueryExecutor().evaluateInsertQuery(context.getInput(),macro,query,context);
  }
  getLogger().error(getMacroNodeRef(),"couldn't get nodes to insert",GeneratorUtil.describeInput(context));
  throw new GenerationFailureException("couldn't get nodes to insert");
}
