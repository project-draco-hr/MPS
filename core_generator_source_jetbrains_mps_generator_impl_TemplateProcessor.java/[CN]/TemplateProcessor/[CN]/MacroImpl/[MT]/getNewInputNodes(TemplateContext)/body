{
  SNode nodesQuery=RuleUtil.getSourceNodesQuery(macro);
  if (nodesQuery != null) {
    return myTemplateProcessor.getQueryExecutor().getSourceNodes(macro,nodesQuery,context);
  }
  if (InputQueryUtil.doesMacroRequireInput(macro)) {
    getLogger().error(macro.getReference(),"couldn't get input nodes",GeneratorUtil.describeInput(context));
    throw new GenerationFailureException("couldn't get input nodes");
  }
  return InputQueryUtil.wrapAsList(context.getInput());
}
