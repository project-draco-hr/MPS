{
  final HashMap<String,Collection<E>> map=new HashMap<String,Collection<E>>();
  ModelAccess.instance().runIndexing(new Runnable(){
    @Override public void run(){
      try {
        SModel model=RootNodeNameIndex.doModelParsing(inputData);
        SModelReference modelRef=model.getReference();
        for (        S object : getObjectsToIndex(model)) {
          String[] keys=getKeys(model,object);
          for (          String key : keys) {
            Collection<E> collection=map.get(key);
            if (collection == null) {
              collection=new ArrayList<E>();
              map.put(key,collection);
            }
            updateCollection(modelRef,object,collection);
          }
        }
      }
 catch (      Exception e) {
        LOG.error("Error indexing model file " + inputData.getFileName() + "; "+ e.getMessage());
      }
    }
  }
);
  return map;
}
