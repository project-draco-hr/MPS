{
  myEditor=editor;
  myLightBulb=new LightBulbMenu(){
    public void activate(){
      checkAndShowMenu();
    }
  }
;
  myEditor.getViewport().addChangeListener(new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      adjustLightBulbLocation();
    }
  }
);
  myShowIntentionsAction=new AbstractAction(){
    public void actionPerformed(    ActionEvent e){
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          checkAndShowMenu();
        }
      }
);
    }
  }
;
  myEditor.registerKeyboardAction(myShowIntentionsAction,KeyStroke.getKeyStroke("alt ENTER"),JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
  myEditor.addFocusListener(new FocusAdapter(){
    public void focusGained(    FocusEvent e){
      updateIntentionsStatus();
    }
    public void focusLost(    FocusEvent e){
      hideLightBulb();
    }
  }
);
  myEditor.addCellSelectionListener(new CellSelectionListener(){
    public void selectionChanged(    EditorComponent editor,    EditorCell oldSelection,    EditorCell newSelection){
      if (!editor.isFocusOwner())       return;
      updateIntentionsStatus();
    }
  }
);
}
