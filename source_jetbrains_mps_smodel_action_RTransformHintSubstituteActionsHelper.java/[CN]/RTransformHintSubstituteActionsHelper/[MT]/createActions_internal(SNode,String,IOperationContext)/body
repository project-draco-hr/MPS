{
  List<INodeSubstituteAction> resultActions=new LinkedList<INodeSubstituteAction>();
  List<RTransformHintSubstituteActionsBuilder> actionsBuilders=getActionBuilders(sourceNode,transformTag,context);
  List<RemoveRTByConditionPart> removesByCondition=new ArrayList<RemoveRTByConditionPart>();
  Set<SNode> conceptsToRemove=new HashSet<SNode>();
  for (  RTransformHintSubstituteActionsBuilder builder : actionsBuilders) {
    for (    RemovePart rp : builder.getSubnodes(RemovePart.class)) {
      conceptsToRemove.add(rp.getConceptToRemove().getNode());
    }
    for (    RemoveRTByConditionPart rp : builder.getSubnodes(RemoveRTByConditionPart.class)) {
      removesByCondition.add(rp);
    }
    List<INodeSubstituteAction> addActions=invokeActionFactory(builder,sourceNode,context);
    resultActions.addAll(addActions);
  }
  for (  RemoveRTByConditionPart rbc : removesByCondition) {
    invokeRemoveByCondition(rbc,resultActions.iterator(),sourceNode,context);
  }
  for (Iterator<INodeSubstituteAction> it=resultActions.iterator(); it.hasNext(); ) {
    INodeSubstituteAction action=it.next();
    Object parameterObject=action.getParameterObject();
    if (parameterObject instanceof SNode && ((SNode)parameterObject).getAdapter() instanceof AbstractConceptDeclaration) {
      if (conceptsToRemove.contains(((SNode)parameterObject))) {
        it.remove();
      }
    }
 else     if (parameterObject instanceof AbstractConceptDeclaration) {
      if (conceptsToRemove.contains(((AbstractConceptDeclaration)parameterObject).getNode())) {
        it.remove();
      }
    }
  }
  return resultActions;
}
