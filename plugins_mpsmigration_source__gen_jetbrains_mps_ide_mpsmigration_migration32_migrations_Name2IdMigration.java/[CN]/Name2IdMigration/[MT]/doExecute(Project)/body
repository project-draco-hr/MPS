{
  Iterable<? extends SModule> modules=p.getModulesWithGenerators();
  final ModelFactory defaultModelFactory=PersistenceFacade.getInstance().getDefaultModelFactory();
  final ModelFactory perRootModelFactory=PersistenceRegistry.getInstance().getFolderModelFactory(FilePerRootModelPersistence.FACTORY_ID);
  Iterable<PersistenceVersionAware> models=Sequence.fromIterable(modules).translate(new ITranslator2<SModule,SModel>(){
    public Iterable<SModel> translate(    SModule it){
      return it.getModels();
    }
  }
).ofType(EditableSModel.class).where(new IWhereFilter<EditableSModel>(){
    public boolean accept(    EditableSModel it){
      return !(it.isReadOnly());
    }
  }
).ofType(PersistenceVersionAware.class).where(new IWhereFilter<PersistenceVersionAware>(){
    public boolean accept(    PersistenceVersionAware it){
      return it.getPersistenceVersion() < 9;
    }
  }
).where(new IWhereFilter<PersistenceVersionAware>(){
    public boolean accept(    PersistenceVersionAware it){
      return it.getModelFactory() == defaultModelFactory || it.getModelFactory() == perRootModelFactory;
    }
  }
);
  Sequence.fromIterable(models).visitAll(new IVisitor<PersistenceVersionAware>(){
    public void visit(    PersistenceVersionAware it){
      it.load();
    }
  }
);
  Sequence.fromIterable(models).visitAll(new IVisitor<PersistenceVersionAware>(){
    public void visit(    PersistenceVersionAware model){
      model.setPersistenceVersion(9);
      ((EditableSModel)model).setChanged(true);
      ((EditableSModel)model).save();
    }
  }
);
  return true;
}
