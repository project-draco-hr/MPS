{
  super.doOKAction();
  if (myCurrentProject != null) {
    int exitCode=Messages.showDialog(IdeBundle.message("prompt.open.project.in.new.frame"),IdeBundle.message("title.open.project"),new String[]{IdeBundle.message("button.newframe"),IdeBundle.message("button.existingframe")},1,Messages.getQuestionIcon());
    if (exitCode == 1) {
      ProjectUtil.closeProject(myCurrentProject);
    }
  }
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      try {
        ProjectFactory factory=new ProjectFactory(myCurrentProject,myOptions);
        factory.createProject();
        factory.activate();
      }
 catch (      ProjectNotCreatedException e) {
        Messages.showErrorDialog(getContentPane(),e.getMessage());
      }
    }
  }
);
}
