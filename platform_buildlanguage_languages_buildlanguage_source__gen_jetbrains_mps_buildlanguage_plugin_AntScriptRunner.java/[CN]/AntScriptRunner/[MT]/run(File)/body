{
  List<String> parameters=ListSequence.fromList(new ArrayList<String>());
  this.addBasicParameters(parameters,file);
  AntScriptRunner.addMacroValues(parameters);
  this.addProgramParameters(parameters);
  this.myBuilder=new ProcessBuilder(ListSequence.fromListWithValues(new ArrayList<String>(),parameters));
  File workingDirFile;
  if (this.myRunParameters.getWorkingDirectory() != null && StringUtils.isNotEmpty(this.myRunParameters.getWorkingDirectory())) {
    workingDirFile=new File(this.myRunParameters.getWorkingDirectory());
  }
 else {
    workingDirFile=file.getParentFile();
  }
  this.myBuilder.directory(workingDirFile);
  try {
    return this.myBuilder.start();
  }
 catch (  IOException e) {
    LOG.error("Can't run script " + file + ": "+ e.getMessage(),e);
    throw new ProcessNotCreatedException(e.getMessage(),e,this.getCommandLine(workingDirFile.getAbsolutePath()));
  }
}
