{
  SNode lastCmd=ListSequence.fromList(SLinkOperations.getTargets(myHistRoot,"item",true)).last();
  if ((lastCmd == null)) {
    return;
  }
  if ((myCursor == null)) {
    return;
  }
  SNode newCursor=getNextCmd(SNodeOperations.cast(myCursor,"jetbrains.mps.console.base.structure.Command"));
  if (!((newCursor == null))) {
    myCursor=newCursor;
    SNodeOperations.replaceWithAnother(lastCmd,SNodeOperations.copyNode(myCursor));
  }
 else {
    myCursor=null;
    SNodeOperations.replaceWithAnother(lastCmd,SNodeOperations.copyNode(myNewCommand));
  }
}
