{
  SNode lastCmd=lastCmd();
  if ((lastCmd == null)) {
    return;
  }
  SNode newCursor;
  if (myCursor == null) {
    newCursor=lastCmd;
    myNewCommand=SNodeOperations.copyNode(myCommandRoot);
  }
 else {
    newCursor=getPrevCmd(myCursor);
    if ((newCursor == null)) {
      return;
    }
    SNode myCursorCommand=SLinkOperations.getTarget(myCursor,"command",true);
    SNode myCursorNew=SConceptOperations.createNewNode("jetbrains.mps.console.base.structure.ModifiedCommandHistoryItem",null);
    SLinkOperations.setTarget(myCursorNew,"command",myCursorCommand,true);
    SLinkOperations.setTarget(myCursorNew,"modifiedCommand",SLinkOperations.getTarget(myCommandRoot,"command",true),true);
    SNodeOperations.replaceWithAnother(myCursor,myCursorNew);
  }
  if ((newCursor == null)) {
    return;
  }
  myCursor=newCursor;
  SLinkOperations.setTarget(myCommandRoot,"command",SNodeOperations.copyNode(BehaviorReflection.invokeVirtual((Class<SNode>)((Class)Object.class),myCursor,"virtual_getCommandToEdit_691634242167796942",new Object[]{})),true);
}
