{
  SNode newChild=mySubstituteItem.createNode(pattern);
  if (newChild != null) {
    if (!newChild.getConcept().isSubConceptOf(myContainmentLink.getTargetConcept())) {
      LOG.error("couldn't set instance of " + newChild.getConcept().getName() + " as child '"+ myContainmentLink.getName()+ "' to parent"+ myParentNode.getPresentation()+ " Parent id: "+ myParentNode.getNodeId());
    }
    if (myCurrentChild == null) {
      myParentNode.addChild(myContainmentLink,newChild);
    }
 else {
      SNodeUtil.replaceWithAnother(myCurrentChild,newChild);
      myCurrentChild.delete();
    }
  }
  boolean wasSelected=mySubstituteItem.select(newChild,pattern);
  if (!wasSelected) {
    myEditorContext.flushEvents();
    EditorComponent editorComponent=((EditorComponent)myEditorContext.getEditorComponent());
    EditorCell cell=editorComponent.findNodeCell(newChild);
    if (cell != null) {
      EditorCell errorCell=CellFinderUtil.findFirstError(cell,true);
      if (errorCell != null) {
        editorComponent.changeSelectionWRTFocusPolicy(errorCell);
      }
 else {
        editorComponent.changeSelectionWRTFocusPolicy(cell);
      }
    }
  }
}
