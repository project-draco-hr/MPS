{
  final RepositoryVirtualFiles rvf=findRepoFiles(md);
  if (rvf == null) {
    return;
  }
  final Collection<MPSNodeVirtualFile> filesInModel=rvf.getKnownVirtualFilesIn(md.getReference());
  updateModificationStamp(filesInModel);
  Collection<MPSNodeVirtualFile> deletedFiles=new ArrayList<MPSNodeVirtualFile>();
  Collection<Pair<MPSNodeVirtualFile,String>> renamedFiles=new ArrayList<Pair<MPSNodeVirtualFile,String>>();
  for (  MPSNodeVirtualFile vf : filesInModel) {
    if (vf.getNode() == null) {
      deletedFiles.add(vf);
    }
 else {
      String oldName=vf.getName();
      vf.updateFields();
      String newName=vf.getName();
      if (!oldName.equals(newName)) {
        renamedFiles.add(new Pair<MPSNodeVirtualFile,String>(vf,oldName));
      }
    }
  }
  VFSNotifier vfsNotifier=new VFSNotifier(rvf);
  vfsNotifier.deleted(deletedFiles);
  vfsNotifier.renamed(renamedFiles);
  vfsNotifier.execute();
}
