{
  try {
    Class<Selection> selectionClass;
    if (myModuleID != null) {
      SModule module=MPSModuleRepository.getInstance().getModuleByFqName(myModuleID);
      if (module == null) {
        LOG.error("Specified selection class module was not found by ID: " + myModuleID);
        return null;
      }
      if (!(module instanceof ReloadableModule)) {
        LOG.error("Specified selection class module was not Language: " + myModuleID);
        return null;
      }
      selectionClass=(Class<Selection>)((ReloadableModule)module).getClass(mySelectionClassName);
    }
 else {
      selectionClass=(Class<Selection>)getClass().getClassLoader().loadClass(mySelectionClassName);
    }
    if (!Selection.class.isAssignableFrom(selectionClass)) {
      LOG.error("Serialized selection class: " + mySelectionClassName + " is not a subclass of "+ Selection.class.getName());
      return null;
    }
    Constructor<Selection> constructor=selectionClass.getConstructor(EditorComponent.class,Map.class,CellInfo.class);
    return constructor.newInstance(editorComponent,myProperties,myCellInfo);
  }
 catch (  ClassNotFoundException e) {
    LOG.error(null,e);
    return null;
  }
catch (  NoSuchMethodException e) {
    LOG.error(null,e);
    return null;
  }
catch (  InvocationTargetException e) {
    if (e.getTargetException() instanceof SelectionRestoreException) {
      return null;
    }
    LOG.error(null,e);
    return null;
  }
catch (  InstantiationException e) {
    LOG.error(null,e);
    return null;
  }
catch (  IllegalAccessException e) {
    LOG.error(null,e);
    return null;
  }
}
