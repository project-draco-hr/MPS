{
  final Application application=ApplicationManager.getApplication();
  if (application != null) {
    ThreadUtils.runInUIThreadAndWait(new Runnable(){
      public void run(){
        application.runWriteAction(new Runnable(){
          public void run(){
            Disposer.dispose(application);
          }
        }
);
      }
    }
);
  }
  DefaultRunListener listener=((DefaultRunListener)this.getListener());
  if (listener == null) {
    System.exit(EXIT_CODE_FOR_EXCEPTION);
  }
 else {
    System.exit(listener.getFailureCount());
  }
}
