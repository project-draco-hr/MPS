{
  myProgress.start("generating",estimateGenerationTime());
  MPSModuleRepository.getInstance().removeTransientModules();
  showMessageView();
  getProject().saveModels();
  clearMessageVew();
  myMesssages.handle(new Message(MessageKind.INFORMATION,myGenerationType.getStartText()));
  try {
    boolean generationOK=true;
    for (    Pair<IModule,List<SModelDescriptor>> moduleAndDescriptors : myModuleSequence) {
      generationOK=generationOK && generateModelsInModule(moduleAndDescriptors.o1,moduleAndDescriptors.o2);
    }
    if (generationOK) {
      boolean compiledSuccessfully=true;
      boolean needToReload=false;
      for (      Pair<IModule,List<SModelDescriptor>> moduleListPair : myModuleSequence) {
        IModule module=moduleListPair.o1;
        if (module != null && module.reloadClassesAfterGeneration()) {
          needToReload=true;
        }
        compiledSuccessfully=compiledSuccessfully && compileModule(module);
      }
      for (      SModelDescriptor sm : myModelsToContexts.keySet()) {
        ModelGenerationStatusManager.getInstance().invalidateData(sm);
      }
      if (compiledSuccessfully && needToReload) {
        reloadClasses();
      }
      if (generationOK) {
        myProgress.addText("generation completed successfully");
        myMesssages.handle(new Message(MessageKind.INFORMATION,"generation completed successfully"));
      }
 else {
        myProgress.addText("generation completed with errors");
        myMesssages.handle(new Message(MessageKind.INFORMATION,"generation completed with errors"));
      }
    }
 else     if (!generationOK) {
      myProgress.addText("generation finished with errors");
      myMesssages.handle(new Message(MessageKind.WARNING,"generation finished with errors"));
    }
    if (myGenerationType instanceof GenerateFilesGenerationType && isIDEAPresent() && !myGenerationType.requiresCompilationInIDEAfterGeneration()) {
      getProjectHandler().refreshFS();
    }
  }
 catch (  GenerationCanceledException gce) {
    myProgress.addText("generation canceled");
    myMesssages.handle(new Message(MessageKind.WARNING,"generation canceled"));
    myProgress.finishAnyway();
    showMessageView();
    return false;
  }
catch (  Throwable t) {
    LOG.error(t);
    final String text=t.toString();
    myProgress.addText(text);
    myMesssages.handle(new Message(MessageKind.ERROR,text));
  }
 finally {
    myProgress.finishAnyway();
  }
  return true;
}
