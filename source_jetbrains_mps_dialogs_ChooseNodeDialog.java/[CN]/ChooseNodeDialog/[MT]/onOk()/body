{
  if (myTree.getSelectionPath() == null)   return;
  dispose();
  MPSTreeNode node=(MPSTreeNode)myTree.getSelectionPath().getLastPathComponent();
  if (node instanceof SNodeTreeNode) {
    SNode sNode=((SNodeTreeNode)node).getSNode();
    if (mySourceNodes != null && !mySourceNodes.isEmpty()) {
      if (mySourceNodes.contains(sNode)) {
        JOptionPane.showMessageDialog(myContext.getMainFrame(),"Can't refactor node onto itself");
        return;
      }
      String role=MoveNodeRefactoring.getRoleInTarget(mySourceNodes.get(0),sNode,myContext.getProject().getScope());
      if (role == null) {
        JOptionPane.showMessageDialog(myContext.getMainFrame(),"Can't find suitable role");
        return;
      }
    }
    myResult=sNode;
  }
  if (node instanceof SModelTreeNode) {
    myResult=((SModelTreeNode)node).getSModelDescriptor();
  }
}
