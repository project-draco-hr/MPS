{
  List<INodeSubstituteAction> result=new ArrayList<INodeSubstituteAction>();
{
    AbstractConceptDeclaration concept=SModelUtil_new.findConceptDeclaration("null",operationContext.getScope());
    Calculable calc=new Calculable(){
      public Object calculate(){
        List<SNode> res=ListSequence.<SNode>fromArray(SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFReplaceFunWrapper"),SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFRemoveFunWrapper"),SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFInsertFunWrapper"));
        if (SNodeOperations.isInstanceOf(_context.getParentNode(),"jetbrains.mps.ypath.structure.GenericFeatureFunHolder")) {
          for (          SNode foo : SLinkOperations.getTargets(_context.getParentNode(),"functions",true)) {
            if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureReplaceFun")) {
              ListSequence.fromList(res).removeElement(SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFReplaceFunWrapper"));
            }
 else             if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureRemoveFun")) {
              ListSequence.fromList(res).removeElement(SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFRemoveFunWrapper"));
            }
 else             if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureInsertFun")) {
              ListSequence.fromList(res).removeElement(SConceptOperations.findConceptDeclaration("jetbrains.mps.ypath.structure.GFInsertFunWrapper"));
            }
          }
        }
        return res;
      }
    }
;
    Iterable queryResult=(Iterable)calc.calculate();
    if (queryResult != null) {
      for (      Object item : queryResult) {
        List<INodeSubstituteAction> defaultActions=ChildSubstituteActionsHelper.createDefaultActions((ConceptDeclaration)BaseAdapter.fromNode((SNode)item),_context.getParentNode(),_context.getCurrentTargetNode(),_context.getChildSetter(),operationContext);
        result.addAll(defaultActions);
      }
    }
  }
{
    AbstractConceptDeclaration outputConcept=SModelUtil_new.findConceptDeclaration("jetbrains.mps.ypath.structure.IGenericFeatureFunFragment",operationContext.getScope());
    SNode childConcept=(SNode)_context.getChildConcept();
    if (SConceptOperations.isSuperConceptOf(childConcept,NameUtil.nodeFQName((SNode)BaseAdapter.fromAdapter(outputConcept)))) {
      Calculable calc=new Calculable(){
        public Object calculate(){
          List<FragmentTypeEnum> types=ListSequence.<FragmentTypeEnum>fromArray(FragmentTypeEnum.replace_single,FragmentTypeEnum.replace_selection,FragmentTypeEnum.replace_all,FragmentTypeEnum.remove_single,FragmentTypeEnum.remove_selection,FragmentTypeEnum.remove_all,FragmentTypeEnum.insert_at_start,FragmentTypeEnum.insert_at_end,FragmentTypeEnum.insert_before,FragmentTypeEnum.insert_after);
          if (SNodeOperations.isInstanceOf(_context.getParentNode(),"jetbrains.mps.ypath.structure.GenericFeatureFunHolder")) {
            for (            SNode foo : SLinkOperations.getTargets(_context.getParentNode(),"functions",true)) {
              if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureFunFragment")) {
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.parseValue(SPropertyOperations.getString_def(foo,"fragmentType","REPLACE_SINGLE")));
              }
 else               if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureReplaceFun")) {
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.replace_single);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.replace_selection);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.replace_all);
              }
 else               if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureRemoveFun")) {
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.remove_single);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.remove_selection);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.remove_all);
              }
 else               if (SNodeOperations.isInstanceOf(foo,"jetbrains.mps.ypath.structure.IGenericFeatureInsertFun")) {
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.insert_at_start);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.insert_at_end);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.insert_before);
                ListSequence.fromList(types).removeElement(FragmentTypeEnum.insert_after);
              }
            }
          }
          return types;
        }
      }
;
      Iterable<FragmentTypeEnum> queryResult=(Iterable)calc.calculate();
      if (queryResult != null) {
        for (        final FragmentTypeEnum item : queryResult) {
          result.add(new DefaultChildNodeSubstituteAction(outputConcept,item,_context.getParentNode(),_context.getCurrentTargetNode(),_context.getChildSetter(),operationContext.getScope()){
            public SNode createChildNode(            Object parameterObject,            SModel model,            String pattern){
              FragmentTypeEnum type=(item);
              SNode fragment=null;
              if (type == FragmentTypeEnum.replace_single || type == FragmentTypeEnum.replace_selection || type == FragmentTypeEnum.replace_all) {
                fragment=SConceptOperations.createNewNode("jetbrains.mps.ypath.structure.GFReplaceFunFragment",null);
                SPropertyOperations.set(fragment,"fragmentType",type.getValue());
                if ((SNodeOperations.getAncestor(_context.getParentNode(),"jetbrains.mps.ypath.structure.GenericParamFeature",false,false) != null)) {
                  SLinkOperations.setNewChild(fragment,"fragmentFun","jetbrains.mps.ypath.structure.GFReplacerParamFun");
                }
              }
 else               if (type == FragmentTypeEnum.remove_single || type == FragmentTypeEnum.remove_selection || type == FragmentTypeEnum.remove_all) {
                fragment=SConceptOperations.createNewNode("jetbrains.mps.ypath.structure.GFRemoveFunFragment",null);
                SPropertyOperations.set(fragment,"fragmentType",type.getValue());
                if ((SNodeOperations.getAncestor(_context.getParentNode(),"jetbrains.mps.ypath.structure.GenericParamFeature",false,false) != null)) {
                  SLinkOperations.setNewChild(fragment,"fragmentFun","jetbrains.mps.ypath.structure.GFRemoverParamFun");
                }
              }
 else               if (type == FragmentTypeEnum.insert_at_start || type == FragmentTypeEnum.insert_at_end || type == FragmentTypeEnum.insert_before || type == FragmentTypeEnum.insert_after) {
                fragment=SConceptOperations.createNewNode("jetbrains.mps.ypath.structure.GFInsertFunFragment",null);
                SPropertyOperations.set(fragment,"fragmentType",type.getValue());
                if ((SNodeOperations.getAncestor(_context.getParentNode(),"jetbrains.mps.ypath.structure.GenericParamFeature",false,false) != null)) {
                  SLinkOperations.setNewChild(fragment,"fragmentFun","jetbrains.mps.ypath.structure.GFInserterParamFun");
                }
              }
              return fragment;
            }
            public String getMatchingText(            String pattern){
              return (item).getName();
            }
            public String getVisibleMatchingText(            String pattern){
              return this.getMatchingText(pattern);
            }
          }
);
        }
      }
    }
  }
  return result;
}
