{
  threadWatcher.waitUntilSettled(15000);
  disposeCaches();
  app.sealEvents();
  org.apache.log4j.Logger.getRootLogger().removeAppender(app);
  org.apache.log4j.Logger.getRootLogger().setLevel(oldLevel);
  Failure fail=null;
  if (!(testsToIgnore.containsKey(desc)) && (cacheOut.isNotEmpty() || cacheErr.isNotEmpty() || app.isNotEmpty()|| threadWatcher.isNotEmpty())) {
    fail=new Failure(desc,new UncleanTestExecutionException(cacheOut,cacheErr,app,threadWatcher));
  }
  cacheOut.clear();
  cacheErr.clear();
  if (fail != null) {
    super.fireTestFailure(fail);
  }
}
