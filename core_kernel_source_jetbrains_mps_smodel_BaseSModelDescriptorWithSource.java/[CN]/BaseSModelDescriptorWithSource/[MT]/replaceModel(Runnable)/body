{
  ModelAccess.assertLegalWrite();
  final SModel oldSModel=getCurrentModelInternal();
  if (oldSModel != null) {
    oldSModel.setModelDescriptor(null);
  }
  replacer.run();
  SModel newModel=getCurrentModelInternal();
  if (newModel != null) {
    newModel.setModelDescriptor(this);
  }
  notifyModelReplaced(oldSModel);
  MPSModuleRepository.getInstance().invalidateCaches();
}
