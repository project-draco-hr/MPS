{
  SNode parent=SNodeOperations.getAncestor(anchor,NameUtil.nodeFQName(parentConcept),true,false);
  if ((parent == null)) {
    return false;
  }
  anchor=SNodeOperations.getAncestor(anchor,NameUtil.nodeFQName(SLinkOperations.getTarget(role,"target",false)),true,false);
  if ((anchor == null) || SNodeOperations.getParent(anchor) != parent) {
    parent.addChild(SPropertyOperations.getString(role,"role"),node);
  }
 else {
    jetbrains.mps.util.SNodeOperations.insertChild(parent,SPropertyOperations.getString(role,"role"),node,anchor,true);
  }
  return true;
}
