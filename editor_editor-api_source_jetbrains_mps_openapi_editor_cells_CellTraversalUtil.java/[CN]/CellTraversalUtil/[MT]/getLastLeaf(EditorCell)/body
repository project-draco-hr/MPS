{
  if (cell instanceof EditorCell_Collection) {
    return ((EditorCell_Collection)cell).isEmpty() ? cell : getLastLeaf(((EditorCell_Collection)cell).lastCell());
  }
 else {
    return cell;
  }
}
