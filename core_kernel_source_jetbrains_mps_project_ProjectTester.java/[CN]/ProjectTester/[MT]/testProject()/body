{
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      myProject.getPluginManager().reloadPlugins();
    }
  }
);
  final List<String> errors=new ArrayList<String>();
  final List<String> warnings=new ArrayList<String>();
  final IMessageHandler handler=new IMessageHandler(){
    public void handle(    Message msg){
      final String message=msg.getText();
switch (msg.getKind()) {
case ERROR:
        errors.add(msg.getText());
      LOG.error(message);
    break;
case WARNING:
  warnings.add(msg.getText());
LOG.warning(message);
break;
case INFORMATION:
LOG.info(message);
break;
}
}
}
;
final GenerateFilesAndClassesGenerationType generationType=new GenerateFilesAndClassesGenerationType(false){
public boolean requiresCompilationInIDEABeforeGeneration(){
return false;
}
public boolean requiresCompilationInIDEAfterGeneration(){
return false;
}
protected boolean isPutClassesOnTheDisk(){
return false;
}
}
;
final List<String> compilationResults=new ArrayList<String>();
CommandProcessor.instance().executeCommand(new Runnable(){
public void run(){
List<BaseGeneratorConfiguration> configurations=new ArrayList<BaseGeneratorConfiguration>(myProject.getProjectDescriptor().getRunConfigurations());
if (myProject.getProjectDescriptor().getTestAllLanguages()) {
for (Language l : myProject.getProjectLanguages()) {
LanguageGeneratorConfiguration conf=LanguageGeneratorConfiguration.newInstance(myProject.getProjectDescriptor().getModel());
conf.setLanguageNamespace(l.getNamespace());
configurations.add(conf);
}
}
for (BaseGeneratorConfiguration t : configurations) {
System.out.println("completed : " + configurations.indexOf(t) + " / "+ configurations.size());
GenParameters parms;
try {
parms=GeneratorConfigUtil.calculate(myProject,t);
}
 catch (GeneratorConfigUtil.GeneratorConfigurationException e) {
errors.add("Can't create a generator configuration : " + e.getMessage());
return;
}
GeneratorManager gm=myProject.getComponentSafe(GeneratorManager.class);
gm.generateModels(parms.getModels(),new ModuleContext(parms.getModule(),myProject),generationType,new EmptyProgressIndicator(),handler);
compilationResults.addAll(createCompilationProblemsList(generationType.compile(IAdaptiveProgressMonitor.NULL_PROGRESS_MONITOR)));
System.out.println("");
System.out.println("");
System.out.println("");
}
}
}
);
return new TestResult(errors,warnings,compilationResults);
}
