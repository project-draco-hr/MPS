{
  final VirtualFile file=VirtualFileUtils.getVirtualFile(modelFile);
  if (file == null) {
    if (log.isErrorEnabled()) {
      log.error("",new AssertionError());
    }
  }
  final OldMergeModelsDialog dialog=ModelAccess.instance().runReadAction(new Computable<OldMergeModelsDialog>(){
    public OldMergeModelsDialog compute(){
      IOperationContext context=new ModuleContext(base.getModelDescriptor().getModule(),ProjectHelper.toMPSProject(project));
      return new OldMergeModelsDialog(context,base,mine,repo);
    }
  }
);
  dialog.showDialog();
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      dialog.toFront();
    }
  }
);
  if (dialog.getResultModel() != null) {
    SModel result=dialog.getResultModel();
    byte[] bytes=ModelUtils.modelToBytes(result);
    ModelUtils.replaceModelWithBytes(file,bytes);
    return false;
  }
  return true;
}
