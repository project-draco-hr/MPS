{
  final VirtualFile file=VirtualFileUtils.getVirtualFile(modelFile);
  LOG.assertLog(file != null);
  final OldModelDifferenceDialog dialog=ModelAccess.instance().runReadAction(new Computable<OldModelDifferenceDialog>(){
    public OldModelDifferenceDialog compute(){
      SModelDescriptor modelDescriptor=diskModel.getModelDescriptor();
      if (modelDescriptor == null) {
        modelDescriptor=memoryModel.getModelDescriptor();
        if (modelDescriptor == null) {
          modelDescriptor=SModelRepository.getInstance().getModelDescriptor(diskModel.getSModelFqName());
        }
      }
      IOperationContext context;
      if (modelDescriptor == null) {
        context=new GlobalOperationContext();
      }
 else {
        context=new ModuleContext(modelDescriptor.getModule(),project);
      }
      JFrame frame=WindowManager.getInstance().getFrame(project);
      return new OldModelDifferenceDialog(context,frame,diskModel,memoryModel,"Disk Memory Diff",true,new String[]{"Filesystem version (read-only)","Memory version"});
    }
  }
);
  dialog.showDialog();
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      dialog.toFront();
    }
  }
);
  return true;
}
