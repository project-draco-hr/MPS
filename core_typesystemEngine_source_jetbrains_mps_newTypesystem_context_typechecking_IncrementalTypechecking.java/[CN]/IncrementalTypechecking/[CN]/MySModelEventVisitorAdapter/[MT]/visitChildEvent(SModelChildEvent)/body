{
  final SNode child=event.getChild();
  final SNode parent=event.getParent();
  markInvalid(child);
  markInvalid(parent);
  final List<SNode> descendants=jetbrains.mps.util.SNodeOperations.getDescendants(child,null);
  for (  SNode descendant : descendants) {
    if (event.isRemoved()) {
      markDependentNodesForInvalidation(descendant,myNonTypeSystemComponent);
      markDependentNodesForInvalidation(descendant,getTypecheckingComponent());
    }
  }
  markReferenceTargetsInvalid(collectReferences(child,descendants));
}
