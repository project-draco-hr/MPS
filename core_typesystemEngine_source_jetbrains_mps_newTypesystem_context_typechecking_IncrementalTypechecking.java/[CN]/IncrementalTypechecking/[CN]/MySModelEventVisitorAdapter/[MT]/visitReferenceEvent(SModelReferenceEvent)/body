{
  SReference ref=event.getReference();
  markInvalid(ref.getSourceNode());
  if (ref.getSourceNode().getParent() != null) {
    markInvalid(ref.getSourceNode().getParent());
  }
  if (!event.isAdded())   return;
  if (ref instanceof DynamicReference && ref.getSourceNode().getModel() == null) {
    return;
  }
  SNode node=jetbrains.mps.util.SNodeOperations.getTargetNodeSilently(event.getReference());
  if (node == null)   return;
  markDependentNodesForInvalidation(node,myNonTypeSystemComponent);
}
