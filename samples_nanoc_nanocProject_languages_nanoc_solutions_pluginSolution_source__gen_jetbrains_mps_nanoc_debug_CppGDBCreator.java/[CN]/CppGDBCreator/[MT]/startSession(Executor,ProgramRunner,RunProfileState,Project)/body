{
  IDebuggerSettings settings=createLocalConnectionSettings(state);
  if (!(settings instanceof GdbDebuggerSettings)) {
    throw new ExecutionException("Unknown debugger settings: " + settings);
  }
  ExecutionResult result=super.startSession(executor,runner,state,project);
  myDebugSession=new CppDebugSession(project,((GdbDebuggerSettings)settings).getSourceDir());
  myDebugSession.setProcessHandler(result.getProcessHandler());
  myDebugSession.getGDBEventsHandler().addEventListener(new GDBEventsAdapter(){
    public void processTerminated(    ProcessHandler gdbProcess){
      try {
        OutputStreamWriter outputStreamWriter=new OutputStreamWriter(gdbProcess.getProcessInput());
        outputStreamWriter.write("-gdb-exit\n");
        outputStreamWriter.flush();
      }
 catch (      Throwable t) {
        if (log.isErrorEnabled()) {
          log.error("",t);
        }
      }
    }
  }
);
  return result;
}
