{
  final SNode[] created=new SNode[1];
  final Runnable r1=new Runnable(){
    @Override public void run(){
      SNode node=ModelAccess.instance().runReadAction(new Computable<SNode>(){
        @Override public SNode compute(){
          return myBaseNode.resolve(MPSModuleRepository.getInstance());
        }
      }
);
      created[0]=myDescriptor.createNode(node,myConcept);
    }
  }
;
  final Runnable r2=new Runnable(){
    @Override public void run(){
      String mainPack=SNodeAccessUtil.getProperty(myBaseNode.resolve(MPSModuleRepository.getInstance()),SNodeUtil.propertyName_BaseConcept_virtualPackage);
      SNodeAccessUtil.setProperty(created[0],SNodeUtil.propertyName_BaseConcept_virtualPackage,mainPack);
      myCallback.changeNode(created[0]);
    }
  }
;
  if (myDescriptor.commandOnCreate()) {
    ModelAccess.instance().runWriteActionInCommand(new Runnable(){
      @Override public void run(){
        r1.run();
      }
    }
);
  }
 else {
    r1.run();
  }
  if (created[0] == null)   return;
  ModelAccess.instance().runWriteActionInCommand(r2);
}
