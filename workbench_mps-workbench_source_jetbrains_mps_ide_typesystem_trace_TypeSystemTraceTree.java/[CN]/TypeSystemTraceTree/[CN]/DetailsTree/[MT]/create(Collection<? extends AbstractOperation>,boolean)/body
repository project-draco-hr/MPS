{
  if (operations == null || operations.size() == 0 || operations.iterator().next() == null) {
    return null;
  }
  List<MPSTreeNode> result=new ArrayList<MPSTreeNode>();
  for (  AbstractOperation operation : operations) {
    final boolean showNode=showNode(operation);
    List<MPSTreeNode> children=new ArrayList<MPSTreeNode>();
    for (    AbstractOperation consequence : operation.getConsequences()) {
      Collection<MPSTreeNode> nodes=create(Collections.singletonList(consequence),true);
      if (nodes != null) {
        children.addAll(nodes);
      }
    }
    if (!(filterNodeType(operation))) {
      continue;
    }
    if (showParent) {
      TypeSystemTraceTreeNode treeNode=new TypeSystemTraceTreeNode(operation,myOperationContext,myContextTracker.getCurrentState(),myEditorComponent){
        @Override public void doUpdatePresentation(){
          super.doUpdatePresentation();
          if (!(showNode)) {
            setColor(JBColor.BLACK);
          }
        }
      }
;
      for (      MPSTreeNode node : children) {
        treeNode.add(node);
      }
      result.add(treeNode);
    }
 else {
      result.addAll(children);
    }
  }
  return result;
}
