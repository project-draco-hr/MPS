{
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      AbstractOperation rootDiff=myCurrentContext.getOperation();
      Object fromDiff=fromNode.getUserObject();
      Object toDiff=toNode.getUserObject();
      if (myOldOperation == null) {
        myCurrentState.clear(false);
        myCurrentState.executeOperationsBeforeAnchor(rootDiff,fromDiff);
      }
 else {
        myCurrentState.updateState(myOldOperation,(AbstractOperation)fromDiff);
      }
      myParent.resetState(myCurrentState);
      myCurrentState.updateState((AbstractOperation)fromDiff,(AbstractOperation)toDiff);
      myParent.updateState(myCurrentState);
      myOldOperation=(AbstractOperation)toDiff;
    }
  }
);
}
