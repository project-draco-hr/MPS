{
  final QueryExecutor queryExecutor=context.getEnvironment().getQueryExecutor();
  for (  CaseRuntime switchCase : getCases(context.getEnvironment())) {
    if (queryExecutor.evaluate(switchCase.condition,new InlineSwitchCaseContext(context,switchCase.nodeReference))) {
      return switchCase.consequence.processRuleConsequence(context);
    }
  }
  SNode defaultConsequence=RuleUtil.getInlineSwitch_defaultConsequence(mySwitchNode);
  if (defaultConsequence == null) {
    GenerationFailureException ex=new GenerationFailureException("no default consequence in switch");
    ex.setTemplateContext(context);
    ex.setTemplateModelLocation(mySwitchNode.getReference());
    throw ex;
  }
 else {
    RuleConsequenceProcessor rcp=RuleConsequenceProcessor.prepare(defaultConsequence);
    return rcp.processRuleConsequence(context);
  }
}
