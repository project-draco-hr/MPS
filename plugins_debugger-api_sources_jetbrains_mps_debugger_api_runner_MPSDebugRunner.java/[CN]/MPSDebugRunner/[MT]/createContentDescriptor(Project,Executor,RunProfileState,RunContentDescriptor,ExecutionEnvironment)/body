{
  IDebugger debugger;
  if (state instanceof DebuggerRunProfileState) {
    debugger=((DebuggerRunProfileState)state).getDebuggerConfiguration().getDebugger();
  }
 else {
    throw new ExecutionException("Unknown Run Profile State");
  }
  if (debugger == null) {
    throw new ExecutionException("Can't Start Debugger");
  }
  AbstractDebugSessionCreator debugSessionCreator=debugger.createDebugSessionCreator(project);
  ExecutionResult executionResult=debugSessionCreator.startSession(executor,this,state,project);
  AbstractDebugSession debugSession=debugSessionCreator.getDebugSession();
  DebugSessionManagerComponent.getInstance(project).addDebugSession(debugSession);
  DebuggerToolContentBuilder contentBuilder=new DebuggerToolContentBuilder(project,this,executor,executionResult,env);
  return contentBuilder.showRunContent(contentToReuse);
}
