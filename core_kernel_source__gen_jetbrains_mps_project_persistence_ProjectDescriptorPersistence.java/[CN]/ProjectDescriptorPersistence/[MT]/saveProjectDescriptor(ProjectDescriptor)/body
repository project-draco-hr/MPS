{
  Element project=new Element("project");
  Element projectModules=new Element(PROJECT_MODULES_TAG);
  if (descriptor.getModulePaths().isEmpty()) {
    return null;
  }
  for (  ModulePath path : Sequence.fromIterable(((Iterable<ModulePath>)descriptor.getModulePaths())).sort(new ISelector<ModulePath,String>(){
    public String select(    ModulePath p){
      return myMacroHelper.shrinkPath(p.getPath());
    }
  }
,true)) {
    String shrinkedPath=myMacroHelper.shrinkPath(path.getPath());
    XmlUtil.tagWithAttributes(projectModules,MODULE_PATH_TAG,PATH_TAG,shrinkedPath.replace(MacrosFactory.PROJECT,PROJECT_DIR_MACRO),FOLDER_TAG,(path.getVirtualFolder() != null ? path.getVirtualFolder() : ""));
  }
  project.addContent(projectModules);
  return project;
}
