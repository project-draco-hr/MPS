{
  try {
    if (!isIncrementalMode() || refreshTypes) {
      clear();
    }
 else {
      myState.clearStateObjects();
      doInvalidate();
      myPartlyCheckedNodes.addAll(myFullyCheckedNodes);
      myFullyCheckedNodes.clear();
    }
    computeTypesForNode(nodeToCheck,forceChildrenCheck,additionalNodes,initialNode);
    if (typeCalculated(initialNode) != null)     return;
    solveInequalitiesAndExpandTypes(finalExpansion);
    if (myNodeTypesComponent.getTypeCheckingContext().isSingleTypeComputation()) {
      performActionsAfterChecking();
    }
    myState.performActionsAfterChecking();
  }
  finally {
    myInvalidationWasPerformed=false;
  }
}
