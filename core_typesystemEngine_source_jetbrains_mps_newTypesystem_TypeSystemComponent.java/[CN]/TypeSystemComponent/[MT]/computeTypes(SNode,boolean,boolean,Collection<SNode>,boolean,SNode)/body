{
  try {
    if (refreshTypes) {
      clear();
      setTargetNode(initialNode);
    }
 else {
      myState.clearStateObjects();
      doInvalidate();
      myPartlyCheckedNodes.addAll(myFullyCheckedNodes);
      myFullyCheckedNodes.clear();
    }
    computeTypesSpecial(nodeToCheck,forceChildrenCheck,additionalNodes,finalExpansion,initialNode);
    performActionsAfterChecking();
    myState.performActionsAfterChecking();
  }
  finally {
    setInvalidationWasPerformed(false);
  }
}
