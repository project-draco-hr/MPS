{
  ThreadUtils.assertEDT();
  if (!myExtensions.add(extension)) {
    throw new IllegalArgumentException("Extension already registered: " + extension);
  }
  for (  Entry<EditorComponent,Collection<EditorExtension>> entry : myEditorExtensions.entrySet()) {
    EditorComponent editorComponent=entry.getKey();
    if (!entry.getValue().add(extension)) {
      throw new IllegalArgumentException("Extension already installed on editor component: " + extension + ", "+ editorComponent);
    }
    extension.install(editorComponent);
  }
}
