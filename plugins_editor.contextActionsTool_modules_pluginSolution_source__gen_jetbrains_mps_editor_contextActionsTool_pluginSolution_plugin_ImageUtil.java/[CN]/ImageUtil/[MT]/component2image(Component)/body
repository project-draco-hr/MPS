{
  int w=comp.getWidth();
  int h=comp.getHeight();
  GraphicsEnvironment ge=GraphicsEnvironment.getLocalGraphicsEnvironment();
  GraphicsDevice gd=ge.getDefaultScreenDevice();
  GraphicsConfiguration gc=gd.getDefaultConfiguration();
  BufferedImage image=gc.createCompatibleImage(w,h);
  Graphics2D g=image.createGraphics();
  comp.paintAll(g);
  g.dispose();
  return image;
}
