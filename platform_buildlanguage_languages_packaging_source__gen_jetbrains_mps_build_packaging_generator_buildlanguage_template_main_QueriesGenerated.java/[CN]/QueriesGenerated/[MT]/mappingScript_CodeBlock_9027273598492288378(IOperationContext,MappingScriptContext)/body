{
  for (  SNode root : ListSequence.fromList(SModelOperations.getRoots(_context.getModel(),"jetbrains.mps.build.packaging.structure.MPSLayout"))) {
    while (true) {
      List<SNode> blocks=SNodeOperations.getDescendants(root,"jetbrains.mps.build.packaging.structure.BlockReference",false,new String[]{});
      if (ListSequence.fromList(blocks).isEmpty()) {
        break;
      }
      for (      SNode blockRef : ListSequence.fromList(blocks)) {
        SNode blockParent=SNodeOperations.cast(SNodeOperations.getParent(blockRef),"jetbrains.mps.build.packaging.structure.AbstractProjectComponent");
        SNode block=SLinkOperations.getTarget(blockRef,"block",false);
        SNode place=blockRef;
        for (        SNode entry : ListSequence.fromList(SLinkOperations.getTargets(block,"entry",true))) {
          SNode entryCopy=CopyUtil.copy(entry);
          SNodeOperations.insertNextSiblingChild(place,entryCopy);
          place=entryCopy;
        }
        SNodeOperations.deleteNode(blockRef);
      }
    }
  }
}
