{
  SNode holder=SNodeOperations.getAncestor(_context.getNode(),"jetbrains.mps.build.packaging.structure.IMacroHolder",false,false);
  if (holder == null) {
    List<SNode> descendants=SNodeOperations.getDescendants(SNodeOperations.getAncestor(_context.getNode(),null,false,true),"jetbrains.mps.build.packaging.structure.Macro",false);
    SNode macro=ListSequence.fromList(descendants).findFirst(new IWhereFilter<SNode>(){
      public boolean accept(      SNode it){
        return SPropertyOperations.getString(it,"name").equals(SPropertyOperations.getString(SLinkOperations.getTarget(_context.getNode(),"macro",false),"name"));
      }
    }
);
    if (macro != null) {
      return ListSequence.fromList(_context.getAllOutputNodesByInputNodeAndMappingLabel(macro,"MacroToPropertyDeclaration")).first();
    }
    return ListSequence.fromList(PropertyReference_Behavior.getAllVisibleDeclarations_1239123615225(_context.getOutputNode())).findFirst(new IWhereFilter<SNode>(){
      public boolean accept(      SNode it){
        return SPropertyOperations.getString(it,"name").equals(SPropertyOperations.getString(SLinkOperations.getTarget(_context.getNode(),"macro",false),"name"));
      }
    }
);
  }
  SNode macro=IMacroHolder_Behavior.call_findMacroForReference_1234972707641(holder,SLinkOperations.getTarget(_context.getNode(),"macro",false));
  return ListSequence.fromList(_context.getAllOutputNodesByInputNodeAndMappingLabel(macro,"MacroToPropertyDeclaration")).first();
}
