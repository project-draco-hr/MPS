{
  if (getNodes().size() != 0) {
    AbstractEditorComponent editor=editorContext.getNodeEditorComponent();
    SNode node=getNodes().get(0);
    EditorCell cell=editor.findNodeCell(node);
    Pair<EditorCell,List<EditorCellKeyMapAction>> actionsInfo=EditorUtil.getKeyMapActionsForEvent(cell,keyEvent,editorContext);
    if (actionsInfo != null) {
      EditorCell contextCell=actionsInfo.o1;
      List<EditorCellKeyMapAction> actions=actionsInfo.o2;
      if (actions.size() == 1) {
        EditorUtil.executeKeyMapAction(actions.get(0),keyEvent,contextCell,editorContext);
        return true;
      }
 else {
        EditorUtil.showActionsMenu(actions,keyEvent,contextCell,editorContext,cell);
        return true;
      }
    }
  }
  String actionType=myEditorComponent.getActionType(keyEvent,editorContext);
  if (actionType == null) {
    if (keyEvent.getKeyCode() == KeyEvent.VK_DELETE || keyEvent.getKeyCode() == KeyEvent.VK_BACK_SPACE) {
      actionType=EditorCellAction.DELETE;
    }
  }
  if (actionType != null) {
    if (actionType == EditorCellAction.DELETE) {
      doDeleteNodes(editorContext);
      return true;
    }
    if (actionType == EditorCellAction.COPY) {
      myEditorComponent.executeComponentAction(EditorCellAction.COPY);
      return true;
    }
    if (actionType == EditorCellAction.CUT) {
      myEditorComponent.executeComponentAction(EditorCellAction.CUT);
      return true;
    }
    if (actionType == EditorCellAction.RENDER_TEXT) {
      myEditorComponent.executeComponentAction(EditorCellAction.RENDER_TEXT);
      return true;
    }
  }
  if (keyEvent.getKeyCode() == KeyEvent.VK_ESCAPE) {
    deactivate();
    return true;
  }
  if (!isSelectionKeystroke(keyEvent)) {
    if (keyEvent.getKeyCode() == KeyEvent.VK_UP || keyEvent.getKeyCode() == KeyEvent.VK_DOWN || keyEvent.getKeyCode() == KeyEvent.VK_LEFT || keyEvent.getKeyCode() == KeyEvent.VK_RIGHT) {
      deactivate();
    }
    return true;
  }
  boolean next=(keyEvent.getKeyCode() == KeyEvent.VK_RIGHT || keyEvent.getKeyCode() == KeyEvent.VK_DOWN);
  SNode newLastNode=null;
  Iterator<SNode> iterator=myParentNode.children(myRole);
  while (iterator.hasNext()) {
    SNode semanticNode=iterator.next();
    if (semanticNode == myLastNode) {
      if (next) {
        if (iterator.hasNext()) {
          newLastNode=iterator.next();
        }
 else {
          newLastNode=null;
        }
      }
      break;
    }
    newLastNode=semanticNode;
  }
  if (newLastNode != null) {
    myLastNode=newLastNode;
    myEditorComponent.repaint();
  }
  return true;
}
