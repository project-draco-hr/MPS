{
  List<SModelTreeNode> result=new ArrayList<SModelTreeNode>();
  Map<SModelDescriptor,SModelTreeNode> map=new LinkedHashMap<SModelDescriptor,SModelTreeNode>();
  for (  SModelDescriptor md : SortUtil.sortModels(models)) {
    SModelTreeNode treeNode=new SModelTreeNode(md,null,context,false);
    map.put(md,treeNode);
    result.add(treeNode);
  }
  for (  SModelTreeNode treeNode : map.values()) {
    List<SModelDescriptor> subfolderModels=treeNode.getSubfolderModels(map.keySet());
    for (    SModelDescriptor subfolderModel : subfolderModels) {
      result.remove(map.get(subfolderModel));
      treeNode.addChildModel(subfolderModel);
    }
  }
  return result;
}
