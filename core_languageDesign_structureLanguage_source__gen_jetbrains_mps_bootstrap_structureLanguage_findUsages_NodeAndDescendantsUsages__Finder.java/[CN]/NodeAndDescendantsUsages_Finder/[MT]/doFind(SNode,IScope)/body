{
  List<SNode> _results=new ArrayList<SNode>();
{
    Set<SNode> nodes=new HashSet<SNode>();
    nodes.add(node);
    for (    SNode child : ((SNode)node).allChildren()) {
      ListOperations.addElement(_results,child);
      nodes.add(child);
    }
    Set<SReference> resRefs=FindUsagesManager.getInstance().findUsages(nodes,scope,null);
    for (    SReference reference : resRefs) {
      if (!(nodes.contains(reference.getSourceNode()))) {
        ListOperations.addElement(_results,reference.getSourceNode());
      }
    }
  }
  return _results;
}
