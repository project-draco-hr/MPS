{
  getModelAccess().checkWriteAccess();
  LOG.info("Loading modules");
  int addedModules=0;
  int removedModules=0;
  clearErrorsBuffer();
  Set<SModule> existingModules=new HashSet<SModule>(getProjectModules());
  for (  ModulePath modulePath : myProjectDescriptor.getModulePaths()) {
    String path=modulePath.getPath();
    IFile descriptorFile=FS.getFileByPath(path);
    if (descriptorFile.exists()) {
      final ModulesMiner modulesMiner=new ModulesMiner();
      ModuleHandle handle=modulesMiner.loadModuleHandle(descriptorFile);
      if (handle.getDescriptor() != null) {
        SModule module=ModuleRepositoryFacade.createModule(handle,this);
        if (!existingModules.remove(module)) {
          myModuleToPathMap.put(module,modulePath);
          ++addedModules;
        }
      }
 else {
        error(String.format("Can't load module from %s. Unknown file type.",descriptorFile.getPath()));
      }
    }
 else {
      error(String.format("Can't load module from %s. File doesn't exist.",descriptorFile.getPath()));
    }
  }
  removeAbsentModules(existingModules);
  LOG.info(String.format("Modules are loaded: %d new; %d removed",addedModules,removedModules));
}
