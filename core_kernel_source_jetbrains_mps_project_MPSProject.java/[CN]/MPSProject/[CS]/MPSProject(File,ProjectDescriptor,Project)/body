{
  myIDEAProject=ideaProject;
  if (ideaProject.isDefault())   return;
  ModelAccess.instance().runWriteAction(new Runnable(){
    public void run(){
      myProjectFile=projectFile;
      SModel model=ProjectModels.createDescriptorFor(MPSProject.this).getSModel();
      model.setLoading(true);
      myProjectDescriptor=projectDescriptor;
      model.addRoot(myProjectDescriptor);
      MPSProjects projects=MPSProjects.instance();
      projects.addProject(MPSProject.this);
      LOG.assertLog(myProjectDescriptor.isRoot(),"Project descriptor has to be root");
      readModules();
      for (      IModule m : getModules()) {
        m.onModuleLoad();
      }
      for (      IModule m : getModules()) {
        ((AbstractModule)m).convertRenamedDependencies();
      }
      ClassLoaderManager.getInstance().reloadAll(new EmptyProgressIndicator());
      model.setLoading(false);
    }
  }
);
}
