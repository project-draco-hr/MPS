{
  myIDEAProject=ideaProject;
  CommandProcessor.instance().executeCommand(new Runnable(){
    public void run(){
      myProjectFile=projectFile;
      SModel model=ProjectModels.createDescriptorFor(MPSProject.this).getSModel();
      model.setLoading(true);
      if (myProjectFile == null) {
        myProjectDescriptor=DescriptorsPersistence.loadProjectDescriptor(null,model);
      }
 else {
        myProjectDescriptor=DescriptorsPersistence.loadProjectDescriptor(new File(FileUtil.getCanonicalPath(projectFile)),model);
      }
      MPSProjects projects=MPSProjects.instance();
      projects.addProject(MPSProject.this);
      LOG.assertLog(myProjectDescriptor.isRoot(),"Project descriptor has to be root");
      readModules();
      for (      IModule m : getModules()) {
        m.onModuleLoad();
      }
      ClassLoaderManager.getInstance().reloadAll(new EmptyProgressIndicator());
      model.setLoading(false);
    }
  }
);
}
