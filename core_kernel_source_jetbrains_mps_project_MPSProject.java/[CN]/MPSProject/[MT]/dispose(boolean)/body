{
  ModelAccess.instance().runWriteAction(new Runnable(){
    public void run(){
      MPSProjects projects=MPSProjects.instance();
      projects.removeProject(MPSProject.this);
      getComponentSafe(Highlighter.class).stopUpdater();
      MPSModuleRepository.getInstance().unRegisterModules(MPSProject.this);
      SModelRepository.getInstance().unRegisterModelDescriptors(MPSProject.this);
      TypeChecker.getInstance().clearForReload();
      UndoManager.instance().clear();
      ActionManager.instance().clearAll();
      MPSModuleRepository.getInstance().removeUnusedModules();
      SModelRepository.getInstance().removeUnusedDescriptors();
      if (reloadAll) {
        ClassLoaderManager.getInstance().reloadAll(new EmptyProgressIndicator());
      }
      if (getComponent(Project.class) != null) {
        Project project=getComponentSafe(Project.class);
        if (IdeMain.isTestMode()) {
          for (int i=0; i < 3; i++) {
            try {
            }
 catch (            Exception e) {
              LOG.error(e);
            }
          }
          ProjectUtil.closeProject(project);
        }
      }
      CleanupManager.getInstance().cleanup();
      myDisposed=true;
    }
  }
);
}
