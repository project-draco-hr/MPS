{
  markDependentNodesForInvalidation(event.getChild(),false);
  markDependentNodesForInvalidation(event.getParent(),false);
  markDependentNodesForInvalidation(event.getChild(),true);
  markDependentNodesForInvalidation(event.getParent(),true);
  List<SReference> references=new ArrayList<SReference>();
  SNode child=event.getChild();
  references.addAll(child.getReferences());
  for (  SNode descendant : child.getDescendants()) {
    references.addAll(descendant.getReferences());
    if (event.isRemoved()) {
      markDependentNodesForInvalidation(descendant,true);
      markDependentNodesForInvalidation(descendant,false);
    }
  }
  for (  SReference reference : references) {
    SNode targetNode=reference.getTargetNodeSilently();
    if (targetNode != null) {
      markDependentNodesForInvalidation(targetNode,true);
    }
  }
}
