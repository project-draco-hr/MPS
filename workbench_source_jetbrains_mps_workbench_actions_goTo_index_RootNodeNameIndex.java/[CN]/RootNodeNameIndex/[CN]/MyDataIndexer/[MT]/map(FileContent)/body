{
  final Map<SNodeDescriptor,Void> result=new HashMap<SNodeDescriptor,Void>();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      try {
        SModel model=ModelPersistence.readModel(inputData.getContent());
        if (model == null)         return;
        DependencyRecorder<SNode> recorder=new DependencyRecorder<SNode>();
        List<SNode> roots=model.getRoots();
        for (        final SNode root : roots) {
          recorder.rebuild(root,new Runnable(){
            public void run(){
              root.getName();
            }
          }
);
          String nodeName=(root.getName() == null) ? "null" : root.getName();
          String conceptFqName=root.getConceptFqName();
          SModelReference modelRef=model.getSModelReference();
          boolean dependOnOtherModel=false;
          for (          SNode node : recorder.getDependencies(root)) {
            if (node.getModel() != model) {
              dependOnOtherModel=true;
              break;
            }
          }
          int number=roots.indexOf(root);
          SNodeDescriptor key=SNodeDescriptor.fromModelReference(nodeName,conceptFqName,modelRef,dependOnOtherModel,number);
          result.put(key,null);
        }
      }
 catch (      JDOMException e) {
        LOG.error(e);
      }
catch (      IOException e) {
        LOG.error(e);
      }
    }
  }
);
  return result;
}
