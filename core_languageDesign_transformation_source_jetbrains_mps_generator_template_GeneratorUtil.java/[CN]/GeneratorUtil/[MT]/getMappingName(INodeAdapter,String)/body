{
  String mappingName=null;
  if (node instanceof CreateRootRule) {
    ConditionalRootLabelDeclaration mappingLabel=((CreateRootRule)node).getLabel();
    if (mappingLabel != null) {
      mappingName=mappingLabel.getName();
    }
 else {
      mappingName=node.getName();
    }
  }
 else   if (node instanceof BaseMappingRule) {
    MappingLabelDeclaration mappingLabel=((BaseMappingRule)node).getLabelDeclaration();
    if (mappingLabel != null) {
      mappingName=mappingLabel.getName();
    }
 else {
      mappingName=node.getName();
    }
  }
 else   if (node instanceof TemplateFragment) {
    MappingLabelDeclaration mappingLabel=((TemplateFragment)node).getLabelDeclaration();
    if (mappingLabel != null) {
      mappingName=mappingLabel.getName();
    }
 else {
      mappingName=node.getName();
    }
  }
 else   if (node instanceof NodeMacro) {
    MappingLabelDeclaration mappingLabel=((NodeMacro)node).getMappingLabel();
    if (mappingLabel != null) {
      mappingName=mappingLabel.getName();
    }
 else {
      mappingName=((NodeMacro)node).getMappingId();
    }
  }
 else {
    LOG.errorWithTrace("unexpected input " + node.getDebugText());
  }
  if (mappingName == null) {
    return defaultValue;
  }
  return mappingName;
}
