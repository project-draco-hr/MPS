{
  String relationKind=child ? "child" : "referent";
  AbstractConceptDeclaration concept=sourceNode.getConceptDeclarationAdapter();
  if (concept == null) {
    return false;
  }
  LinkDeclaration link=SModelSearchUtil.findMostSpecificLinkDeclaration(concept,role);
  if (link == null) {
    reportProblem("concept '" + concept.getName() + "' can't have "+ relationKind+ " with role '"+ role+ "'",sourceNode,riseError);
    reportProblem(" -- was " + relationKind + (child ? ": " : " (hidden in editor): ")+ targetNode.getDebugText(),targetNode,riseError);
    return false;
  }
  if (!SModelUtil_new.isAcceptableTarget(link,targetNode)) {
    String expected=link.getTarget().getName();
    String was=targetNode.getConceptDeclarationAdapter().getName();
    reportProblem(relationKind + " '" + expected+ "' is expected for role '"+ role+ "' but was '"+ was+ "'",sourceNode,riseError);
    reportProblem(" -- was " + relationKind + ": "+ targetNode.getDebugText(),targetNode,riseError);
    return false;
  }
  return true;
}
