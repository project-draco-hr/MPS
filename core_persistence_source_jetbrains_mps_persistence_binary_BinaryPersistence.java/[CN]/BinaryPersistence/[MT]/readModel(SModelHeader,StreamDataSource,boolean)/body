{
  ModelInputStream mis=null;
  final SModelReference desiredModelRef=header.getModelReference();
  try {
    mis=new ModelInputStream(source.openInputStream());
    ModelLoadResult rv=loadModel(mis,interfaceOnly);
    SModelReference actualModelRef=rv.getModel().getReference();
    if (!actualModelRef.equals(desiredModelRef)) {
      throw new ModelReadException(String.format("Intended to read model %s, actually read %s",desiredModelRef,actualModelRef),null,actualModelRef);
    }
    return rv;
  }
 catch (  IOException e) {
    throw new ModelReadException("Couldn't read model: " + e.getMessage(),e,desiredModelRef);
  }
 finally {
    FileUtil.closeFileSafe(mis);
  }
}
