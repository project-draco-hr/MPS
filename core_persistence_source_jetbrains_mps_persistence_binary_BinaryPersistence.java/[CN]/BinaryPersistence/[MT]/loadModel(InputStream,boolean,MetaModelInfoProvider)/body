{
  ModelInputStream mis=null;
  try {
    mis=new ModelInputStream(ensureMarkSupported(is));
    SModelHeader modelHeader=loadHeader(mis);
    DefaultSModel model=new DefaultSModel(modelHeader.getModelReference(),modelHeader);
    BinaryPersistence bp=new BinaryPersistence(mmiProvider == null ? new RegularMetaModelInfo() : mmiProvider,model);
    ReadHelper rh=bp.loadModelProperties(mis);
    rh.requestInterfaceOnly(interfaceOnly);
    NodesReader reader=new NodesReader(modelHeader.getModelReference(),mis,rh);
    reader.readNodesInto(model);
    return new ModelLoadResult((SModel)model,reader.hasSkippedNodes() ? ModelLoadingState.INTERFACE_LOADED : ModelLoadingState.FULLY_LOADED);
  }
  finally {
    FileUtil.closeFileSafe(mis);
  }
}
