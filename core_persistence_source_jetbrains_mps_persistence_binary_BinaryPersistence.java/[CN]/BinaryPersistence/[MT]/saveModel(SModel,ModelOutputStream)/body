{
  model.validateImplicitlyUsedLanguages();
  saveModelProperties(model,os);
  ArrayList<SNode> roots=new ArrayList<SNode>(IterableUtil.asCollection(model.getRootNodes()).size());
  for (  SNode root : model.getRootNodes()) {
    roots.add(root);
  }
  new NodesWriter(model.getReference(),PersistenceRegistry.getInstance().getModelEnvironmentInfo()).writeNodes(roots,os);
}
