{
  os.writeInt(HEADER);
  os.writeInt(STREAM_ID);
  os.writeModelReference(model.getSModelReference());
  os.writeInt(model.getVersion());
  os.writeBoolean(model instanceof BinarySModel && ((BinarySModel)model).getHeader().isDoNotGenerate());
  os.writeInt(0xabab);
  saveModuleRefList(model.importedLanguages(),os);
  saveModuleRefList(model.engagedOnGenerationLanguages(),os);
  saveModuleRefList(model.importedDevkits(),os);
  saveImports(model.importedModels(),os);
  saveImports(model.getAdditionalModelVersions(),os);
  os.writeInt(0xbaba);
  ArrayList<SNode> roots=new ArrayList<SNode>(model.rootsCount());
  for (  SNode root : model.roots()) {
    roots.add(root);
  }
  new NodesWriter(model.getSModelReference()).writeNodes(roots,os);
}
