{
  SNode outputNode=ModelPersistence.createNodeInstance(templateNode.getClass().getName(),outputModel);
  if (outputNode == null) {
    generator.showErrorMessage(null,templateNode,"'createNodeFromTemplate' cannot create root node");
    return null;
  }
  outputModel.addLanguage(templateNode.getLanguage(generator.getScope()));
  for (  String property : templateNode.getProperties().keySet()) {
    outputNode.setProperty(property,templateNode.getProperty(property),false);
  }
  for (  SNode templateChildNode : templateNode.getChildren()) {
    SNode childNode=createNodeFromTemplate(generator,outputModel,templateChildNode);
    if (childNode != null) {
      outputNode.addChild(templateNode.getRoleOf(templateChildNode),childNode);
    }
  }
  return outputNode;
}
