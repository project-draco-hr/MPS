{
  if (myMergeRootsPane != null && myRootId == rootId) {
    return;
  }
  applyMetadataChanges();
  myRootId=rootId;
  final MergeSession session=(rootId == null ? myMetadataMergeSession : myMergeSession);
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      SNodeId nodeId=(rootId == null ? Sequence.fromIterable(myMetadataMergeSession.getAffectedRoots()).first() : rootId);
      if (myMergeRootsPane == null) {
        myMergeRootsPane=new MergeRootsPane(myProject,session,nodeId,myMergeTree.getNameForRoot(rootId),myContentTitles,myStatusBar);
        DefaultActionGroup actionGroup=new DefaultActionGroup();
        actionGroup.addAll(myMergeRootsPane.getActions());
        ActionToolbar toolbar=ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN,actionGroup,true);
        myMergeRootsPane.registerShortcuts(MergeModelsPanel.this);
        JPanel panel=new JPanel(new BorderLayout());
        panel.add(toolbar.getComponent(),BorderLayout.NORTH);
        panel.add(myMergeRootsPane.getPanel(),BorderLayout.CENTER);
        myPanel.setSecondComponent(panel);
      }
 else {
        myMergeRootsPane.setRoodId(nodeId,session);
      }
    }
  }
);
}
