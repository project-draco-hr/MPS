{
  List<Point> refined=ListSequence.fromList(new LinkedList<Point>());
  Point prev=ListSequence.fromList(polyline).first();
  boolean prevVer=false;
  boolean firstSeg=true;
  ListSequence.fromList(refined).addElement(prev);
  for (  Point next : ListSequence.fromList(polyline)) {
    if (next.equals(prev)) {
      continue;
    }
    boolean nextVer=prev.x == next.x;
    if (!(firstSeg)) {
      if (nextVer != prevVer) {
        ListSequence.fromList(refined).addElement(prev);
      }
    }
    firstSeg=false;
    prevVer=nextVer;
    prev=next;
  }
  ListSequence.fromList(refined).addElement(prev);
  return refined;
}
