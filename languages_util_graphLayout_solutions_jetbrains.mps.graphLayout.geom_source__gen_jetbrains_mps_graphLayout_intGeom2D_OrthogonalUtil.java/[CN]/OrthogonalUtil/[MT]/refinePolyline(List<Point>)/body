{
  List<Point> refined=ListSequence.<Point>fromList(new LinkedList<Point>());
  Point prev=ListSequence.<Point>fromList(polyline).first();
  boolean prevVer=false;
  boolean firstSeg=true;
  ListSequence.<Point>fromList(refined).addElement(prev);
  for (  Point next : ListSequence.<Point>fromList(polyline)) {
    if (next.equals(prev)) {
      continue;
    }
    boolean nextVer=prev.x == next.x;
    if (!(firstSeg)) {
      if (nextVer != prevVer) {
        ListSequence.<Point>fromList(refined).addElement(prev);
      }
    }
    firstSeg=false;
    prevVer=nextVer;
    prev=next;
  }
  ListSequence.<Point>fromList(refined).addElement(prev);
  return refined;
}
