{
  MPSModulesClosure closure=new MPSModulesClosure(genContext,module).skipExternalModules().generationDependenciesClosure();
  for (  SNode q : Sequence.fromIterable(closure.getModulesIncludingLanguagesWithRuntime())) {
    MPSModulesPartitioner.Node node=map.get(q);
    if (node != null) {
      SetSequence.fromSet(metaDependencies).addElement(node);
    }
  }
  closure.closure();
  for (  SNode q : Sequence.fromIterable(closure.getModulesIncludingLanguagesWithRuntime())) {
    MPSModulesPartitioner.Node node=map.get(q);
    if (node != null) {
      SetSequence.fromSet(dependencyNodes).addElement(node);
    }
  }
}
