{
  Set<String> usedLanguages=new HashSet<String>(getLanguageNamespaces(GlobalScope.getInstance()));
  Set<SModelReference> importedModels=new HashSet<SModelReference>();
  for (  SModelDescriptor sm : allImportedModels(GlobalScope.getInstance())) {
    importedModels.add(sm.getSModelReference());
  }
  List<SNode> nodes=allNodes();
  for (  SNode node : nodes) {
    String languageNamespace=node.getLanguageNamespace();
    if (!usedLanguages.contains(languageNamespace)) {
      usedLanguages.add(languageNamespace);
      addLanguage(languageNamespace);
    }
    List<SReference> references=node.getReferences();
    for (    SReference reference : references) {
      if (reference.isExternal()) {
        SModelReference targetModelReference=reference.getTargetSModelReference();
        if (targetModelReference != null && !importedModels.contains(targetModelReference)) {
          addImportedModel(targetModelReference);
          importedModels.add(targetModelReference);
        }
      }
    }
  }
  importedModels.clear();
}
