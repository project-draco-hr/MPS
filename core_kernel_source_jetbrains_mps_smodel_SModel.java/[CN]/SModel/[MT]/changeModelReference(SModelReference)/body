{
  enforceFullLoad();
  SModelReference oldReference=myReference;
  myReference=newModelReference;
  for (  org.jetbrains.mps.openapi.model.SNode n : myIdToNodeMap.values()) {
    if (!(n instanceof SNode))     continue;
    SNode node=(SNode)n;
    for (    SReference reference : node.getReferences()) {
      if (oldReference.equals(reference.getTargetSModelReference())) {
        reference.setTargetSModelReference(newModelReference);
      }
    }
  }
}
