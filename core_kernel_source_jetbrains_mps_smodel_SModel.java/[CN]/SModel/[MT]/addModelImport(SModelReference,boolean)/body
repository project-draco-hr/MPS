{
  assertLegalChange();
  ImportElement importElement=SModelOperations.getImportElement(this,modelReference);
  if (importElement != null) {
    return;
  }
  if (myLegacyImplicitImports != null) {
    importElement=myLegacyImplicitImports.find(modelReference);
  }
  if (importElement == null) {
    org.jetbrains.mps.openapi.model.SModel modelDescriptor=RuntimeFlags.isMergeDriverMode() ? null : SModelRepository.getInstance().getModelDescriptor(modelReference);
    int usedVersion=-1;
    if (modelDescriptor instanceof RefactorableSModelDescriptor) {
      usedVersion=((RefactorableSModelDescriptor)modelDescriptor).getVersion();
    }
    importElement=new ImportElement(modelReference,-1,firstVersion ? -1 : usedVersion);
  }
  addModelImport(importElement);
}
