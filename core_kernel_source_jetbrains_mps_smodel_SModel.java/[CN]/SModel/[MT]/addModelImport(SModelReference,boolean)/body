{
  ModelChange.assertLegalChange(this);
  ImportElement importElement=SModelOperations.getImportElement(this,modelReference);
  if (importElement != null)   return;
  importElement=SModelOperations.getAdditionalModelElement(this,modelReference);
  if (importElement == null) {
    SModelDescriptor modelDescriptor=MPSCore.getInstance().isMergeDriverMode() ? null : SModelRepository.getInstance().getModelDescriptor(modelReference);
    int usedVersion=-1;
    if (modelDescriptor instanceof RefactorableSModelDescriptor) {
      usedVersion=((RefactorableSModelDescriptor)modelDescriptor).getVersion();
    }
    importElement=new ImportElement(modelReference,++myMaxImportIndex,firstVersion ? -1 : usedVersion);
  }
  if (importElement.getReferenceID() < 0) {
    importElement.setReferenceID(++myMaxImportIndex);
  }
  myImports.add(importElement);
  fireImportAddedEvent(importElement.getModelReference());
}
