{
  Set<SModelReference> usedModels=collectUsedModels(this,new HashSet<SModelReference>());
  for (  ImportElement elem : myImports) {
    usedModels.remove(elem.getModelReference());
  }
  List<ImportElement> implicitImport=new ArrayList<ImportElement>(usedModels.size());
  for (  ImportElement elem : myAdditionalModelsVersions) {
    if (usedModels.remove(elem.getModelReference())) {
      if (elem.myReferenceID < 0) {
        elem.myReferenceID=++myMaxImportIndex;
      }
      implicitImport.add(elem);
    }
  }
  for (  SModelReference ref : usedModels) {
    SModelDescriptor modelDescriptor=SModelRepository.getInstance().getModelDescriptor(ref);
    int version=modelDescriptor instanceof EditableSModelDescriptor ? ((EditableSModelDescriptor)modelDescriptor).getVersion() : -1;
    implicitImport.add(new ImportElement(ref,++myMaxImportIndex,version));
  }
  myAdditionalModelsVersions=implicitImport;
}
