{
  if (resetLastCaretX) {
    resetLastCaretX();
  }
  if (newSelectedCell != mySelectedCell) {
    myNodeSubstituteChooser.setVisible(false);
    myNodeRangeSelection.deactivate();
    final EditorCell oldSelection=mySelectedCell;
    if (mySelectedCell != null) {
      mySelectedCell.setSelected(false);
    }
    mySelectedCell=newSelectedCell;
    if (mySelectedCell != null) {
      mySelectedCell.setSelected(true);
    }
    fireCellSelectionChanged(oldSelection,newSelectedCell);
  }
  if (mySelectedCell != null) {
    if (scrollToCell) {
      scrollToCell(newSelectedCell);
    }
  }
  repaint();
}
