{
  if (!TextGenRegistry.getInstance().hasTextGen(myStartNode)) {
    myState=Status.Empty;
    return;
  }
  myTraceCollector=new TraceInfoCollector();
  TextBuffer trueBuffer=new TextBufferImpl();
  myLayoutBuilder.prepareBuffer(trueBuffer);
  myLegacyBuffer=new TextGenBuffer();
  if (myContextObjects != null) {
    for (    Pair<String,Object> p : myContextObjects) {
      myLegacyBuffer.putUserObject(p.o1,p.o2);
    }
  }
  myState=Status.Failed;
  doGenerate(myLegacyBuffer,trueBuffer);
  final BufferSnapshot textSnapshot=myLayoutBuilder.prepareSnapshot(trueBuffer);
  myTraceCollector.populatePositions(textSnapshot);
  myOutcome=textSnapshot.getText().toString();
  if (myLegacyBuffer.hasErrors()) {
    myState=Status.Failed;
  }
 else {
    myState=Status.Generated;
  }
}
