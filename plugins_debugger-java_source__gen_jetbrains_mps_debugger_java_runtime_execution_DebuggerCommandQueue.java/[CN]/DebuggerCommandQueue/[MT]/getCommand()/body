{
  myLock.lock();
  try {
    while (true) {
      if (myIsClosed) {
        throw new DebuggerCommandQueueClosedException();
      }
      for (int i=0; i < myCommands.length; i++) {
        final IDebuggerCommand debuggerCommand=getCommandsList(i).poll();
        if (debuggerCommand != null) {
          return debuggerCommand;
        }
      }
      myCommandsAvailable.awaitUninterruptibly();
    }
  }
  finally {
    myLock.unlock();
  }
}
