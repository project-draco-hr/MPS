{
  if (!mature()) {
    return myImmatureTargetNode;
  }
  if (getResolveInfo() == null) {
    error("no resolve info");
    return null;
  }
  SNode referenceNode=getSourceNode();
  AbstractConceptDeclaration referenceNodeConcept=referenceNode.getConceptDeclarationAdapter();
  SNode enclosingNode=getSourceNode().getParent();
  SearchScopeStatus status=ModelConstraintsUtil.getSearchScope(enclosingNode,referenceNode,referenceNodeConcept,getRole(),new GlobalOperationContext());
  if (status.isError()) {
    error("can't obtain search scope: " + status.getMessage());
    return null;
  }
  LinkDeclaration mostSpecificForRole=new ConceptAndSuperConceptsScope(referenceNodeConcept).getMostSpecificLinkDeclarationByRole(getRole());
  if (mostSpecificForRole == null) {
    error("couldn't find link declaration '" + getRole() + "' in concept '"+ referenceNode.getConceptFqName()+ "'");
    return null;
  }
  ISearchScope searchScope=status.getSearchScope();
  IReferenceInfoResolver infoResolver=searchScope.getReferenceInfoResolver(referenceNode,mostSpecificForRole.getTarget());
  if (infoResolver == null) {
    error("can't obtain resolve info resolver: '" + getRole() + "'");
    return null;
  }
  SNode targetNode=infoResolver.resolve(getResolveInfo(),getTargetSModelReference());
  if (targetNode == null) {
    error("can't find target by resolve info: '" + getResolveInfo() + "'");
  }
  return targetNode;
}
