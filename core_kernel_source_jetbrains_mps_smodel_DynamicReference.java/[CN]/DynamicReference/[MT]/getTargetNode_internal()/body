{
  if (!mature()) {
    return myTargetNode;
  }
  if (getResolveInfo() == null) {
    error("no resolve info");
    return null;
  }
  SNode referencingNode=getSourceNode();
  AbstractConceptDeclaration referencingNodeConcept=referencingNode.getConceptDeclarationAdapter();
  SNode enclosingNode=getSourceNode().getParent();
  SearchScopeStatus status=ModelConstraintsUtil.getSearchScope(enclosingNode,referencingNode,referencingNodeConcept,getRole(),new GlobalOperationContext());
  if (status.isError()) {
    error("can't obtain search scope: " + status.getMessage());
    return null;
  }
  LinkDeclaration mostSpecificForRole=new ConceptAndSuperConceptsScope(referencingNodeConcept).getMostSpecificLinkDeclarationByRole(getRole());
  if (mostSpecificForRole == null) {
    error("couldn't find link declaration '" + getRole() + "' in concept '"+ getSourceNode().getConceptFqName()+ "'");
    return null;
  }
  ISearchScope searchScope=status.getSearchScope();
  IReferenceInfoResolver infoResolver=searchScope.getReferenceInfoResolver(mostSpecificForRole.getTarget());
  if (infoResolver == null) {
    error("can't obtain resolve info resolver: '" + getRole() + "'");
    return null;
  }
  SNode targetNode=infoResolver.resolve(getResolveInfo());
  if (targetNode == null) {
    error("can't find target by resolve info: '" + getResolveInfo() + "'");
  }
  return targetNode;
}
