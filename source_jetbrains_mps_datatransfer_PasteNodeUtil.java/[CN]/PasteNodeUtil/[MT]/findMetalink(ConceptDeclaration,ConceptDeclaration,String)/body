{
  Iterator<LinkDeclaration> metalinks=sourceMetatype.linkDeclarations();
  while (metalinks.hasNext()) {
    LinkDeclaration metalink=metalinks.next();
    if (SModelUtil_new.isAssignableConcept(targetMetatype,metalink.getTarget()) && (role == null || metalink.getRole().equals(role))) {
      return metalink;
    }
  }
  ConceptDeclaration anExtends=sourceMetatype.getExtends();
  if (anExtends != null) {
    return findMetalink(anExtends,targetMetatype,role);
  }
  return null;
}
