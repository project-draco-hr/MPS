{
  final boolean[] res=new boolean[]{false};
  if (!getWriteLock().tryLock()) {
    return false;
  }
  getWriteLock().unlock();
  executeCommand(new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          if (getWriteLock().tryLock()) {
            try {
              r.run();
            }
  finally {
              getWriteLock().unlock();
            }
            res[0]=true;
          }
        }
      }
);
    }
  }
);
  return res[0];
}
