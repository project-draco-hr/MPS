{
  int currentY=myLastEditor.getViewport().getViewPosition().y;
  EditorCell selectedCell=myLastEditor.getSelectedCell();
  if (selectedCell != null) {
    currentY=selectedCell.getY();
  }
  int asLeft=findNeighbourGroupAsLeftOrRight(currentY,previous,true);
  int asRight=findNeighbourGroupAsLeftOrRight(currentY,previous,false);
  if (asLeft != -1 && asRight != -1) {
    return (previous ? Math.max(asLeft,asRight) : Math.min(asLeft,asRight));
  }
 else {
    return Math.max(asLeft,asRight);
  }
}
