{
  SNode node=unsorted.iterator().next();
  int size=unsorted.size();
  List<SNode> result=new LinkedList<SNode>();
  while (result.size() < size) {
    SNode current=getNodeWithNoInput(inputsToOutputs,node,unsorted.size());
    result.add(current);
    unsorted.remove(current);
    if (unsorted.isEmpty()) {
      return result;
    }
    if (inputsToOutputs.getByFirst(current).isEmpty()) {
      node=unsorted.iterator().next();
    }
 else {
      node=inputsToOutputs.getByFirst(current).iterator().next();
    }
    inputsToOutputs.clearFirst(current);
  }
  return result;
}
