{
  SNode type=this.getMethodType();
  SNode body=SConceptOperations.createNewNode("jetbrains.mps.baseLanguage.structure.StatementList",null);
  this.modifyPartToExtract();
  Map<SNode,SNode> mapping=MapSequence.fromMap(new HashMap<SNode,SNode>());
  ListSequence.fromList(SLinkOperations.getTargets(body,"statement",true)).addSequence(ListSequence.fromList(CopyUtil.copy(this.myStatements,mapping)));
  List<SNode> params=new ArrayList<SNode>();
  Map<SNode,SNode> inputToParams=this.createInputParameters(body,params);
  SNode newMethod=this.createNewMethod(type,params,body);
  this.addMethod(newMethod);
  this.replaceInputVariablesWithParameters(body,inputToParams,mapping);
  MethodMatch exactMatch=this.createMatch(this.createInputVaryablesMapping(inputToParams),params);
  this.addCallExpression(exactMatch,params,newMethod);
  MethodOptimizer.optimize(body);
  return newMethod;
}
