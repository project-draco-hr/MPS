{
  String jdkHome=Java_Command.getJdkHome();
  if (StringUtils.isEmpty(jdkHome)) {
    throw new ExecutionException("Could not find valid java home.");
  }
  return new Java_Command().setClassPath(Ant_Command.getAntClassPath(myAntLocation)).setProgramParameter("-Djava.home=" + jdkHome + " -Dant.home="+ myAntLocation+ " "+ IterableUtils.join(Sequence.fromIterable(Ant_Command.getMacroValues())," ")+ " "+ ((StringUtils.isNotEmpty(myOptions) ? myOptions + " " : ""))+ "-f "+ antFilePath+ ((StringUtils.isEmpty(myTargetName) ? "" : " " + myTargetName))).createProcess("org.apache.tools.ant.launch.Launcher");
}
