{
  if (outputNodeToWeave == null) {
    return;
  }
  fillOriginalNode(inputNode,outputNodeToWeave);
  RoleValidationStatus status=generator.validateChild(contextParentNode,childRole,outputNodeToWeave);
  if (status != null) {
    status.reportProblem(false,"",GeneratorUtil.describe(inputNode,"input"),GeneratorUtil.describe(templateNode.getNode(),"template"));
  }
  SNode childLinkDeclaration=SModelSearchUtil.findLinkDeclaration(((jetbrains.mps.smodel.SNode)contextParentNode).getConceptDeclarationNode(),childRole);
  if (childLinkDeclaration == null) {
    contextParentNode.addChild(childRole,outputNodeToWeave);
  }
 else {
    if (SModelUtil.isMultipleLinkDeclaration(childLinkDeclaration)) {
      contextParentNode.addChild(childRole,outputNodeToWeave);
    }
 else {
      SNode oldChild=jetbrains.mps.util.SNodeOperations.getChild(contextParentNode,childRole);
      if (oldChild != null) {
        contextParentNode.removeChild(oldChild);
      }
      contextParentNode.addChild(childRole,outputNodeToWeave);
    }
  }
}
