{
  TemplateProcessor templateProcessor=new TemplateProcessor(generator);
  List<Pair<SNode,String>> oldInputHistory=generator.setInputHistory(templateProcessor.myInputHistory);
  try {
    List<SNode> outputNodels=templateProcessor.createOutputNodesForTemplateNode(mappingName,templateNode,inputNode,0,true);
    if (outputNodels == null) {
      throw new TemplateProcessingFailureException();
    }
    return outputNodels;
  }
  finally {
    generator.setInputHistory(oldInputHistory);
  }
}
