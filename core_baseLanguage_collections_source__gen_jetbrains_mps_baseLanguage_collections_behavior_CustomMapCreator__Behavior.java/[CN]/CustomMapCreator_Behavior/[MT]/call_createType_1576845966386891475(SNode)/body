{
  SNode res=SNodeOperations.copyNode(SLinkOperations.getTarget(SLinkOperations.getTarget(thisNode,"containerDeclaration",false),"containerType",true));
  if (res != null) {
    res.changeModel(AuxilaryRuntimeModel.getDescriptor().getSModel());
  }
  final List<SNode> params=ListSequence.<SNode>fromList(new ArrayList<SNode>());
  if ((SLinkOperations.getTarget(thisNode,"keyType",true) != null)) {
    ListSequence.<SNode>fromList(params).addElement(SLinkOperations.getTarget(thisNode,"keyType",true));
  }
  if ((SLinkOperations.getTarget(thisNode,"valueType",true) != null)) {
    ListSequence.<SNode>fromList(params).addElement(SLinkOperations.getTarget(thisNode,"valueType",true));
  }
  final List<SNode> tvars=SLinkOperations.getTargets(SLinkOperations.getTarget(thisNode,"containerDeclaration",false),"typeVariableDeclaration",true);
  ListSequence.<SNode>fromList(SNodeOperations.getChildren(res)).toListSequence().visitAll(new IVisitor<SNode>(){
    public void visit(    SNode chld){
      if (SNodeOperations.isInstanceOf(chld,"jetbrains.mps.baseLanguage.structure.TypeVariableReference")) {
        int index=ListSequence.<SNode>fromList(tvars).indexOf(SLinkOperations.getTarget(SNodeOperations.cast(chld,"jetbrains.mps.baseLanguage.structure.TypeVariableReference"),"typeVariableDeclaration",false));
        SNode realType=((index >= 0 && index < ListSequence.<SNode>fromList(params).count()) ? SNodeOperations.copyNode(ListSequence.<SNode>fromList(params).getElement(index)) : null);
        SNodeOperations.replaceWithAnother(chld,realType);
      }
    }
  }
);
  return res;
}
