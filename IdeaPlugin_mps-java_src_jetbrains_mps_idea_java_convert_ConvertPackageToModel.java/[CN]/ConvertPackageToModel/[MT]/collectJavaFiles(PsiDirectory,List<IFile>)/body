{
  for (  PsiFile f : dir.getFiles()) {
    if (f instanceof PsiJavaFile) {
      VirtualFile vfile=f.getVirtualFile();
      IFile ifile=new IdeaFileSystemProvider().getFile(vfile.getPath());
      result.add(ifile);
    }
  }
  for (  PsiDirectory d : dir.getSubdirectories()) {
    collectJavaFiles(d,result);
  }
}
