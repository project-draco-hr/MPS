{
  Set<SNode> declarations=SetSequence.fromSet(new HashSet<SNode>());
  Set<SNode> reference=SetSequence.fromSet(new HashSet<SNode>());
  SetSequence.fromSet(reference).addSequence(ListSequence.fromList(SNodeOperations.getDescendants(thisNode,"jetbrains.mps.baseLanguage.structure.IVariableReference",false,new String[]{})));
  for (  SNode ref : reference) {
    boolean statementsContainsVar=false;
    for (    SNode parent : SNodeOperations.getAncestors(BehaviorReflection.invokeVirtual((Class<SNode>)((Class)(Object.class)),ref,"virtual_getVariable_1023687332192481693",new Object[]{}),null,false)) {
      if (parent == SNodeOperations.getParent(thisNode)) {
        statementsContainsVar=true;
      }
    }
    if (!(statementsContainsVar)) {
      SetSequence.fromSet(declarations).addElement(BehaviorReflection.invokeVirtual((Class<SNode>)((Class)(Object.class)),ref,"virtual_getVariable_1023687332192481693",new Object[]{}));
    }
  }
  return declarations;
}
