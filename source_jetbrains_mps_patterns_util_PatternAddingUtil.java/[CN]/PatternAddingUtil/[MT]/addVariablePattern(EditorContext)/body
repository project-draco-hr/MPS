{
  EditorCell contextCell=context.getSelectedCell();
  SNode node=contextCell.getSNode();
  SModel model=node.getModel();
  LinkDeclaration linkDeclaration=(LinkDeclaration)contextCell.getUserObject(EditorCell.METAINFO_LINK_DECLARATION);
  if (linkDeclaration != null && SModelUtil.getGenuineLinkMetaclass(linkDeclaration) == LinkMetaclass.reference) {
    linkDeclaration=SModelUtil.getGenuineLinkDeclaration(linkDeclaration);
    String role=linkDeclaration.getRole();
    LinkPatternVariableDeclaration linkPatternVariable=new LinkPatternVariableDeclaration(model);
    node.setLinkAttribute(role,linkPatternVariable);
  }
 else {
    PatternVariableDeclaration patternVariable=new PatternVariableDeclaration(model);
    node.setAttribute(patternVariable);
  }
}
