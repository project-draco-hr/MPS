{
  GeneratorSessionContext generatorContext=generator.getGeneratorSessionContext();
  SModelDescriptor currentTargetModel=createTransientModel(0,sourceModel,generatorContext.getModule());
  int iterationCount=1;
  generator.doMapping(sourceModel,currentTargetModel.getSModel(),null);
  while (true) {
    SModelDescriptor currentSourceModel=currentTargetModel;
    int numReductions=generator.prepareReduction(currentSourceModel.getSModel(),null);
    while (numReductions == 0 && generator.hasPendingReductions()) {
      numReductions=generator.preparePendingReduction();
    }
    generator.getProgressMonitor().addText("found reductions : " + numReductions);
    if (numReductions == 0) {
      break;
    }
    currentTargetModel=createTransientModel(iterationCount,sourceModel,generatorContext.getModule());
    generator.doReduction(currentTargetModel.getSModel());
    if (++iterationCount > 10) {
      generator.showErrorMessage(null,"Failed to reduce model after 10 iterations");
      throw new GenerationFailedException("Failed to reduce model after 10 iterations");
    }
  }
  return currentTargetModel.getSModel();
}
