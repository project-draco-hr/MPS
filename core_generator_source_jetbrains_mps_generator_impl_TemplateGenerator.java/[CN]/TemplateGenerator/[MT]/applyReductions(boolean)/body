{
  if (isPrimary) {
    ttrace.push("create root",false);
    for (    TemplateCreateRootRule rule : myRuleManager.getCreateRootRules()) {
      checkMonitorCanceled();
      applyCreateRootRule(((TemplateCreateRootRuleInterpreted)rule).getNode());
    }
    ttrace.pop();
  }
  ttrace.push("root mappings",false);
  ArrayList<SNode> rootsToCopy=new ArrayList<SNode>();
  for (  SNode root : myInputModel.roots()) {
    rootsToCopy.add(root);
  }
  for (  TemplateRootMappingRule rule : myRuleManager.getRoot_MappingRules()) {
    checkMonitorCanceled();
    applyRootMappingRule(((TemplateRootMappingRuleInterpreted)rule).getNode(),rootsToCopy);
  }
  ttrace.pop();
  checkMonitorCanceled();
  getGeneratorSessionContext().clearCopiedRootsSet();
  for (  SNode rootToCopy : rootsToCopy) {
    QueryExecutionContext context=getExecutionContext(rootToCopy);
    if (context != null) {
      copyRootNodeFromInput(rootToCopy,context);
    }
  }
}
