{
  myGenerationTracer.pushInputNode(GenerationTracerUtil.getSNodePointer(inputNode));
  try {
    Collection<SNode> outputNodes=tryToReduce(new DefaultTemplateContext(inputNode),null,mappingName,reductionContext);
    if (outputNodes != null) {
      changed[0]=true;
      return outputNodes;
    }
    SNode copiedNode=copyInputNode(inputNode,reductionContext,changed);
    if (templateNodeId != null) {
      myMappings.addOutputNodeByInputAndTemplateNode(inputNode,templateNodeId,copiedNode);
    }
 else     if (templateNode != null) {
      myMappings.addOutputNodeByInputAndTemplateNode(inputNode,templateNode.getNode(),copiedNode);
    }
    myMappings.addOutputNodeByInputNodeAndMappingName(inputNode,mappingName,copiedNode);
    return Collections.singletonList(copiedNode);
  }
  finally {
    myGenerationTracer.closeInputNode(GenerationTracerUtil.getSNodePointer(inputNode));
  }
}
