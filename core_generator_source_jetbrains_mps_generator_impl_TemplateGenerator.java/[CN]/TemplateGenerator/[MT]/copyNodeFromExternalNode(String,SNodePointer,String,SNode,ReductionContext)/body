{
  if (jetbrains.mps.util.SNodeOperations.isRegistered(inputNode)) {
    inputNode=CopyUtil.copy(inputNode);
  }
synchronized (myAdditionalInputNodes) {
    if (!myAdditionalInputNodes.containsKey(inputNode)) {
      myAdditionalInputNodes.put(inputNode,Boolean.TRUE);
      for (      SNode n : inputNode.getDescendants()) {
        myAdditionalInputNodes.put(n,Boolean.TRUE);
      }
    }
  }
  return copyNodeFromInputNode(mappingName,templateNode,templateNodeId,inputNode,reductionContext,new boolean[]{false});
}
