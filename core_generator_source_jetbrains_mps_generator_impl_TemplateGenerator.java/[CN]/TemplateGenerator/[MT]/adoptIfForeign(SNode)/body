{
  SModel model=inputNode.getModel();
  if (model != getInputModel() || model == null) {
    if (model != null) {
      inputNode=CopyUtil.copy(inputNode);
    }
synchronized (myAdditionalInputNodes) {
      if (!myAdditionalInputNodes.containsKey(inputNode)) {
        myAdditionalInputNodes.put(inputNode,Boolean.TRUE);
        for (        SNode n : jetbrains.mps.util.SNodeOperations.getDescendants(inputNode,null)) {
          myAdditionalInputNodes.put(n,Boolean.TRUE);
        }
      }
    }
  }
  return inputNode;
}
