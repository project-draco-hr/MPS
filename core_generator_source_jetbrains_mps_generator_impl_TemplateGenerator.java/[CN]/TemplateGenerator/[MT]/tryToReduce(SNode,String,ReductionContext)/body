{
  ReductionRule reductionRule=null;
  GeneratedMatchingPattern pattern=null;
  checkGenerationCanceledFast();
  try {
    ReductionRule[] conceptRules=myRuleManager.getRuleFinder().findReductionRules(inputNode);
    if (conceptRules == null) {
      return null;
    }
    for (    ReductionRule rule : conceptRules) {
      if (!getBlockedReductionsData().isReductionBlocked(inputNode,rule,reductionContext)) {
        if (rule instanceof Reduction_MappingRule) {
          if (reductionContext.getQueryExecutor().checkCondition(((Reduction_MappingRule)rule).getConditionFunction(),false,inputNode,rule.getNode())) {
            reductionRule=rule;
            break;
          }
        }
 else         if (rule instanceof PatternReduction_MappingRule) {
          pattern=reductionContext.getQueryExecutor().checkIfApplicable(inputNode,(PatternReduction_MappingRule)rule,reductionContext);
          if (pattern != null) {
            reductionRule=rule;
            break;
          }
        }
      }
    }
    if (reductionRule != null) {
      List<SNode> outputNodes=applyReductionRule(inputNode,reductionRule,pattern,new ReductionContext(reductionContext,inputNode,reductionRule));
      if (outputNodes != null && outputNodes.size() == 1) {
        SNode reducedNode=outputNodes.get(0);
        getMappings().addOutputNodeByInputNodeAndMappingName(inputNode,mappingName,reducedNode);
        getMappings().addCopiedOutputNodeForInputNode(inputNode,reducedNode);
        reducedNode.putUserObjects(inputNode);
        if (inputNode.getModel() == getGeneratorSessionContext().getOriginalInputModel()) {
          reducedNode.putUserObject(TemplateQueryContext.ORIGINAL_INPUT_NODE,inputNode);
          reducedNode.putUserObject(TemplateQueryContext.ORIGINAL_DEBUG_NODE,inputNode);
        }
      }
      return outputNodes;
    }
  }
 catch (  DismissTopMappingRuleException ex) {
    if (ex.isLoggingNeeded()) {
      String messageText="-- dismissed reduction rule: " + reductionRule.getDebugText();
      if (ex.isInfo()) {
        myLogger.info(reductionRule.getNode(),messageText);
      }
 else       if (ex.isWarning()) {
        myLogger.warning(reductionRule.getNode(),messageText);
      }
 else {
        myLogger.error(reductionRule.getNode(),messageText);
      }
    }
  }
  return null;
}
