{
  ttrace.push("drop root rules",false);
  for (  TemplateDropRootRule dropRootRule : myRuleManager.getDropRootRules()) {
    if (isApplicableDropRootRule(inputRootNode,dropRootRule,environment)) {
      return;
    }
  }
  ttrace.pop();
  myGenerationTracer.pushInputNode(GenerationTracerUtil.getSNodePointer(inputRootNode));
  try {
    boolean[] changed=new boolean[]{false};
    SNode root=copyInputNode(inputRootNode,environment,changed);
    registerRoot(root,inputRootNode,null,true);
    if (changed[0]) {
      setChanged();
    }
  }
  finally {
    myGenerationTracer.closeInputNode(GenerationTracerUtil.getSNodePointer(inputRootNode));
  }
}
