{
  if (mySModel == null)   return;
  if (!ApplicationManager.getApplication().isDispatchThread()) {
    throw new IllegalStateException("DefaultSModelDescriptor.Save should only be called from EDT.");
  }
  if (!mySModel.isLoading())   LOG.assertInCommand();
  if (needsReloading()) {
    LOG.warning("Model " + mySModel.getSModelFqName() + " was modified externally and not reloaded!");
  }
  SModelRepository.getInstance().markUnchanged(mySModel);
  myModelRootManager.saveModel(this);
  myDiskTimestamp=fileTimestamp();
  IFile modelFile=getModelFile();
  if (modelFile != null && !modelFile.isReadOnly()) {
    MPSFileSynchronizer.getInstance().requestSync(modelFile);
  }
  mySModel.fireModelSaved();
}
