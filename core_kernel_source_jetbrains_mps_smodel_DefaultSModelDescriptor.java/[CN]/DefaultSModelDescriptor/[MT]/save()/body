{
  if (mySModel == null)   return;
  if (!ApplicationManager.getApplication().isDispatchThread()) {
    throw new IllegalStateException("DefaultSModelDescriptor.Save sould only be called from EDT.");
  }
  if (!mySModel.isLoading())   LOG.assertInCommand();
  SModelRepository.getInstance().markUnchanged(mySModel);
  myModelRootManager.saveModel(this);
  myDiskTimestamp=fileTimestamp();
  IFile modelFile=getModelFile();
  if (modelFile != null) {
    VFileSystem.refreshFileSynchronously(modelFile);
  }
  mySModel.fireModelSaved();
}
