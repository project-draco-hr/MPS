{
  if (DISABLED) {
    return new HashSet<EditorMessage>();
  }
  SModel model=SNodeOperations.getModel(rootNode);
  if (!(model instanceof EditableSModel) || model.getModule() instanceof TransientModelsModule || jetbrains.mps.util.SNodeOperations.isModelDisposed(model)) {
    return new HashSet<EditorMessage>(0);
  }
  final Map<SNode,SNode> reResolvedTargets=new HashMap<SNode,SNode>();
  if (!(wasCheckedOnce) || myCachesCleared) {
    myCachesCleared=false;
    for (    SNode methodCall : SNodeOperations.getNodeDescendants(rootNode,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1204053956946l,"jetbrains.mps.baseLanguage.structure.IMethodCall"),false,new SConcept[]{})) {
      testAndFixMethodCall(methodCall,reResolvedTargets);
    }
  }
 else {
    SModelEventVisitor visitor=new SModelEventVisitorAdapter(){
      @Override public void visitChildEvent(      SModelChildEvent event){
        SNode child=event.getChild();
        if (event.isAdded() && child.getModel() != null) {
          nodeAdded(child,reResolvedTargets);
        }
 else {
          nodeRemoved(child,event.getParent(),event.getModel(),reResolvedTargets);
        }
      }
      @Override public void visitReferenceEvent(      SModelReferenceEvent event){
        SReference reference=event.getReference();
        SNode sourceNode=reference.getSourceNode();
        if (SNodeOperations.isInstanceOf(sourceNode,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1204053956946l,"jetbrains.mps.baseLanguage.structure.IMethodCall")) && "baseMethodDeclaration".equals(reference.getRole())) {
          methodCallDeclarationChanged(SNodeOperations.cast(sourceNode,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1204053956946l,"jetbrains.mps.baseLanguage.structure.IMethodCall")),reResolvedTargets);
        }
      }
      @Override public void visitPropertyEvent(      SModelPropertyEvent event){
        SNode node=event.getNode();
        SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1068580123132l,"jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration"));
        if (SNodeOperations.isInstanceOf(node,MetaAdapterFactory.getConcept(new UUID(-935030926396207931l,-6610165693999523818l),1068580123132l,"jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration")) && "name".equals(event.getPropertyName())) {
          methodDeclarationNameChanged(node,reResolvedTargets);
          methodDeclarationSignatureChanged(node,reResolvedTargets);
        }
      }
      @Override public void visitReplacedEvent(      SModelReplacedEvent event){
        clearCaches();
      }
    }
;
    for (    SModelEvent event : events) {
      if (event.getAffectedRoot() != rootNode) {
        continue;
      }
      event.accept(visitor);
    }
  }
  ThreadUtils.runInUIThreadNoWait(new Runnable(){
    public void run(){
      if (reResolvedTargets.isEmpty()) {
        return;
      }
      Project p=(editorContext != null && editorContext.getOperationContext() != null ? editorContext.getOperationContext().getProject() : null);
      if (p == null) {
        return;
      }
      p.getModelAccess().executeUndoTransparentCommand(new Runnable(){
        public void run(){
          for (          SNode methodCall : reResolvedTargets.keySet()) {
            SNode referent=reResolvedTargets.get(methodCall);
            if (referent != null && SNodeUtil.isAccessible(referent,MPSModuleRepository.getInstance())) {
              SLinkOperations.setTarget(methodCall,MetaAdapterFactory.getReferenceLink(new UUID(-935030926396207931l,-6610165693999523818l),1204053956946l,1068499141037l,"baseMethodDeclaration"),referent);
            }
          }
        }
      }
);
    }
  }
);
  return new HashSet<EditorMessage>();
}
