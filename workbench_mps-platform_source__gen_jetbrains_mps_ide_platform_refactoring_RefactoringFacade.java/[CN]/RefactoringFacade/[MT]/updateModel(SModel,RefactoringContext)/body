{
  IRefactoring refactoring=context.getRefactoring();
  try {
    ((ILoggableRefactoring)refactoring).updateModel(model,context);
  }
 catch (  Throwable t) {
    myLog.error("An exception was thrown by refactoring " + refactoring.getUserFriendlyName() + " while updating model "+ model.getLongName()+ ". Models could have been corrupted.",t);
  }
  if (!(context.isLocal())) {
    Map<SModelReference,Integer> dependencies=context.getStructureModification().getDependencies();
    for (    SModelReference modelRef : dependencies.keySet()) {
      model.updateImportedModelUsedVersion(modelRef,dependencies.get(modelRef) + 1);
    }
  }
  SModelRepository.getInstance().markChanged(model);
}
