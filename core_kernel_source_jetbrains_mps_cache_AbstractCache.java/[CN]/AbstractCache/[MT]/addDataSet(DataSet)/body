{
  String dataSetId=dataSet.getId();
  if (myDataSets.containsKey(dataSetId)) {
    throw new RuntimeException("couldn't put another data set by key " + dataSetId);
  }
  LOG.assertLog(!myInitializingDataSetKeys.contains(dataSetId),"cache data set initialization re-enter : " + dataSetId);
  myInitializingDataSetKeys.add(dataSetId);
  try {
    dataSet.init();
    myDataSets.put(dataSetId,dataSet);
  }
  finally {
    myInitializingDataSetKeys.remove(dataSetId);
  }
}
