{
  final LanguageDescriptor languageDescriptor=language.getModuleDescriptor();
  final GeneratorDescriptor generatorDescriptor=new GeneratorDescriptor();
  generatorDescriptor.setGeneratorUID(Generator.generateGeneratorUID(language));
  generatorDescriptor.setNamespace(name);
  ModelRoot templateModelsRoot=new ModelRoot();
  templateModelsRoot.setPath(templateModelsDir);
  generatorDescriptor.getModelRoots().add(templateModelsRoot);
  generatorDescriptor.getUsedDevkits().add(MPSModuleRepository.getInstance().getModuleById(ModuleId.fromString("fbc25dd2-5da4-483a-8b19-70928e1b62d7")).getModuleReference());
  generatorDescriptor.getUsedLanguages().add(MPSModuleRepository.getInstance().getModuleById(ModuleId.fromString("b401a680-8325-4110-8fd3-84331ff25bef")).getModuleReference());
  generatorDescriptor.getUsedLanguages().add(MPSModuleRepository.getInstance().getModuleById(ModuleId.fromString("d7706f63-9be2-479c-a3da-ae92af1e64d5")).getModuleReference());
  languageDescriptor.getGenerators().add(generatorDescriptor);
  language.setLanguageDescriptor(languageDescriptor,false);
  language.save();
  return (Generator)MPSModuleRepository.getInstance().getModuleById(generatorDescriptor.getId());
}
