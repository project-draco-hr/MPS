{
  if (targetModel.getModelDescriptor().getModule() == null) {
    return true;
  }
  final List<ModuleReference> additionalLanguages=new ArrayList<ModuleReference>();
  final List<SModelReference> additionalModels=new ArrayList<SModelReference>();
  ModelAccess.instance().runReadAction(new Runnable(){
    public void run(){
      List<SModelReference> allImportedModels=new ArrayList<SModelReference>();
      for (      SModelDescriptor sm : targetModel.allImportedModels(context.getScope())) {
        allImportedModels.add(sm.getSModelReference());
      }
      for (      SModelReference modelReference : necessaryImports) {
        if (modelReference != null && !(allImportedModels.contains(modelReference)) && !(targetModel.getSModelReference().equals(modelReference)))         additionalModels.add(modelReference);
      }
      necessaryImports.retainAll(additionalModels);
      for (      ModuleReference moduleReference : necessaryLanguages) {
        if (!targetModel.hasLanguage(moduleReference)) {
          additionalLanguages.add(moduleReference);
        }
      }
      necessaryLanguages.retainAll(additionalLanguages);
    }
  }
);
  if ((!necessaryImports.isEmpty()) || (!necessaryLanguages.isEmpty())) {
    AddRequiredModelImportsDialog dialog=ModelAccess.instance().runReadAction(new Computable<AddRequiredModelImportsDialog>(){
      public AddRequiredModelImportsDialog compute(){
        return new AddRequiredModelImportsDialog(context,sourceModule,targetModel,necessaryImports,necessaryLanguages);
      }
    }
);
    dialog.setModal(true);
    dialog.showDialog();
    return !dialog.isCancelled();
  }
  return true;
}
