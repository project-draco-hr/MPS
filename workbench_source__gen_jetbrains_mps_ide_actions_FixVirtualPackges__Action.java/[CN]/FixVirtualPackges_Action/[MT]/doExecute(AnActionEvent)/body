{
  try {
    Language language=(Language)FixVirtualPackges_Action.this.module;
    SModel structure=language.getStructureModelDescriptor().getSModel();
    List<SNode> concepts=SModelOperations.getRoots(structure,"jetbrains.mps.lang.structure.structure.AbstractConceptDeclaration");
    for (    SNode concept : concepts) {
      List<SNode> aspects=AbstractConceptDeclaration_Behavior.call_findAllAspects_7754459869734028917(concept,language.getScope());
      for (      SNode aspect : aspects) {
        if (!(SNodeOperations.isInstanceOf(aspect,"jetbrains.mps.lang.core.structure.BaseConcept"))) {
          continue;
        }
        String aspectPack=SPropertyOperations.getString(SNodeOperations.cast(aspect,"jetbrains.mps.lang.core.structure.BaseConcept"),"virtualPackage");
        String conceptPack=SPropertyOperations.getString(concept,"virtualPackage");
        if (aspectPack == null && conceptPack == null) {
          continue;
        }
        if (aspectPack != null && aspectPack.equals(conceptPack)) {
          continue;
        }
        SPropertyOperations.set(SNodeOperations.cast(aspect,"jetbrains.mps.lang.core.structure.BaseConcept"),"virtualPackage",SPropertyOperations.getString(concept,"virtualPackage"));
      }
    }
  }
 catch (  Throwable t) {
    if (log.isErrorEnabled()) {
      log.error("User's action execute method failed. Action:" + "FixVirtualPackges",t);
    }
  }
}
