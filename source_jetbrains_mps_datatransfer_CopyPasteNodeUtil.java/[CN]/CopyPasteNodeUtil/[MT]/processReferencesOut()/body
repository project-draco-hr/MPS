{
  for (  SReference sourceReference : ourReferences) {
    SNode oldSourceNode=sourceReference.getSourceNode();
    SNode newSourceNode=ourSourceNodesToNewNodes.get(oldSourceNode);
    if (sourceReference instanceof InternalReference) {
      SNode oldTargetNode=sourceReference.getTargetNode();
      SNode newTargetNode=ourSourceNodesToNewNodes.get(oldTargetNode);
      if (newTargetNode != null) {
        newSourceNode.addSemanticReference(SReference.newInstance(sourceReference.getRole(),newSourceNode,newTargetNode));
      }
 else {
        String oldTargetNodeId=sourceReference.getTargetNodeId();
        SReference newReference=SReference.newInstance(sourceReference.getRole(),newSourceNode,oldTargetNodeId);
        newReference.setResolveInfo(sourceReference.getResolveInfo());
        newReference.setTargetClassResolveInfo(sourceReference.getTargetClassResolveInfo());
        newSourceNode.addSemanticReference(newReference);
      }
    }
 else     if (sourceReference instanceof ExternalReference) {
      String targetNodeId=sourceReference.getTargetNodeId();
      SReference newReference=SReference.newInstance(sourceReference.getRole(),newSourceNode,targetNodeId);
      newSourceNode.addSemanticReference(newReference);
    }
  }
}
