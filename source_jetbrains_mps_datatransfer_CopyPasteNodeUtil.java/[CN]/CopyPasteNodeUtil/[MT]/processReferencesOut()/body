{
  for (  SReference sourceReference : ourReferences) {
    SNode oldSourceNode=sourceReference.getSourceNode();
    SNode newSourceNode=ourSourceNodesToNewNodes.get(oldSourceNode);
    if (sourceReference instanceof InternalReference) {
      SNode oldTargetNode=sourceReference.getTargetNode();
      SNode newTargetNode=ourSourceNodesToNewNodes.get(oldTargetNode);
      if (newTargetNode != null) {
        newSourceNode.addSemanticReference(SReference.newInstance(sourceReference.getRole(),newSourceNode,newTargetNode));
      }
 else {
        String oldTargetNodeId=sourceReference.getTargetNodeId();
        SReference newReference=SReference.newInstance(sourceReference.getRole(),newSourceNode,oldTargetNodeId,sourceReference.getResolveInfo(),sourceReference.getTargetClassResolveInfo(),null);
        newSourceNode.addSemanticReference(newReference);
      }
    }
 else     if (sourceReference instanceof ExternalReference) {
      String targetNodeId=sourceReference.createReferencedNodeId();
      String extResolveInfo=((ExternalReference)sourceReference).createExtResolveInfo();
      SReference newReference=SReference.newInstance(sourceReference.getRole(),newSourceNode,targetNodeId,null,null,extResolveInfo);
      newSourceNode.addSemanticReference(newReference);
    }
  }
}
