{
  AbstractEditorComponent nodeEditor=historyItem.editor;
  EditorCell selectedCell=historyItem.selectedCell;
  Stack<EditorCell> selectedStack=historyItem.selectedStack;
  AbstractEditorComponent newEditor=editorOpener.openEditor(nodeEditor.getRootCell().getSNode(),nodeEditor.getOperationContext());
  if (selectedCell != null) {
    EditorCell nodeCell=newEditor.findNodeCell(selectedCell.getSNode(),(String)selectedCell.getUserObject(EditorCell.CELL_ID));
    if (nodeCell == null)     nodeCell=newEditor.findNodeCell(selectedCell.getSNode());
    if (nodeCell != null)     newEditor.changeSelection(nodeCell);
  }
  newEditor.setSelectedStackFromHistory(selectedStack);
  return newEditor;
}
