{
  if (keyEvent.getKeyCode() == KeyEvent.VK_Z && keyEvent.isControlDown()) {
    if (keyEvent.isShiftDown()) {
      if (UndoManager.instance().isRedoAvailable(getEditorContext())) {
        UndoManager.instance().redo(getEditorContext());
      }
    }
 else {
      if (UndoManager.instance().isUndoAvailable(getEditorContext())) {
        UndoManager.instance().undo(getEditorContext());
      }
    }
    keyEvent.consume();
    return;
  }
  if (keyEvent.isControlDown() && keyEvent.isAltDown()) {
    if (keyEvent.getKeyCode() == KeyEvent.VK_LEFT) {
      getOperationContext().getComponent(EditorsPane.class).openPrevEditorInHistory();
      keyEvent.consume();
      return;
    }
    if (keyEvent.getKeyCode() == KeyEvent.VK_RIGHT) {
      getOperationContext().getComponent(EditorsPane.class).openNextEditorInHistory();
      keyEvent.consume();
      return;
    }
  }
  if (keyEvent.getKeyCode() == KeyEvent.VK_F5) {
    TypeCheckerAccess.getTypeChecker().checkNodeType(getRootCell().getSNode());
    rebuildEditorContent();
    keyEvent.consume();
    return;
  }
  if (keyEvent.getKeyCode() == KeyEvent.VK_F6) {
    relayout();
    keyEvent.consume();
    return;
  }
  if (keyEvent.getKeyCode() == KeyEvent.VK_D && keyEvent.isControlDown()) {
    if (mySelectedCell != null) {
      System.out.println("--- Selected cell parents ---");
      EditorUtil.dumpCellsUp(mySelectedCell,0);
      System.out.println("--- Selected cell children ---");
      EditorUtil.dumpCellsDown(mySelectedCell,0);
      System.out.println("--- end dump ---");
      keyEvent.consume();
    }
  }
  CommandProcessor.instance().executeCommand(getEditorContext(),new Runnable(){
    public void run(){
      if (peekKeyboardHandler().processKeyPressed(getEditorContext(),keyEvent) == true) {
        keyEvent.consume();
        return;
      }
    }
  }
);
  relayout();
  return;
}
