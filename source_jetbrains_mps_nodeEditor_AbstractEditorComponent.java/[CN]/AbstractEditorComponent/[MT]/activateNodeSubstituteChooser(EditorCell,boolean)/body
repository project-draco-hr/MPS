{
  if (myNodeSubstituteChooser.isVisible()) {
    return true;
  }
  if (editorCell != null && editorCell.getSubstituteInfo() != null) {
    NodeSubstitutePatternEditor patternEditor=editorCell.createSubstitutePatternEditor();
    if (resetPattern) {
      patternEditor.setCaretPosition(0);
    }
    String pattern=patternEditor.getPattern();
    INodeSubstituteInfo substituteInfo=editorCell.getSubstituteInfo();
    boolean trySubstituteNow=!patternEditor.getText().equals(substituteInfo.getOriginalText()) || pattern.equals(patternEditor.getText());
    if (trySubstituteNow) {
      List<INodeSubstituteAction> matchingActions=substituteInfo.getMatchingActions(pattern);
      if (matchingActions.size() == 1) {
        CommandUtil.substituteNode(matchingActions.get(0),pattern,substituteInfo,this.getContext());
        return true;
      }
    }
    myNodeSubstituteChooser.setNodeSubstituteInfo(editorCell.getSubstituteInfo());
    myNodeSubstituteChooser.setPatternEditor(patternEditor);
    myNodeSubstituteChooser.setLocationRelative(editorCell);
    myNodeSubstituteChooser.setVisible(true);
    return true;
  }
  return false;
}
