{
  if (mouseEvent.getButton() != MouseEvent.BUTTON1 && mouseEvent.getButton() != MouseEvent.BUTTON2)   return;
  EditorCell newSelectedCell=myRootCell.findCell(mouseEvent.getX(),mouseEvent.getY());
  if (newSelectedCell == null || !newSelectedCell.isSelectable()) {
    newSelectedCell=myRootCell.findNearestCell(mouseEvent.getX(),mouseEvent.getY(),true);
  }
  if (newSelectedCell != null && newSelectedCell.isSelectable()) {
    changeSelection(newSelectedCell);
    mySelectedCell.processMousePressed(mouseEvent);
    revalidateAndRepaint(false);
  }
  if (mouseEvent.getButton() == MouseEvent.BUTTON2) {
    new GoByFirstReferenceAction().execute(createActionContext());
  }
}
