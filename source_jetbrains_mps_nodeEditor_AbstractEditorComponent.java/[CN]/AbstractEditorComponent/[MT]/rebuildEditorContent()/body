{
  removeAll();
  Point selectionPoint=null;
  Point prevSelectablePoint=null;
  int caretX=0;
  if (mySelectedCell != null) {
    selectionPoint=new Point(mySelectedCell.getX(),mySelectedCell.getY());
    EditorCell prevSelectableCell=null;
    if (mySelectedCell.getSemanticNode() != null) {
      prevSelectableCell=findPrevSelectableCell(findNodeCell(mySelectedCell.getSemanticNode()));
    }
    if (prevSelectableCell != null) {
      prevSelectablePoint=new Point(prevSelectableCell.getX(),prevSelectableCell.getY());
    }
    caretX=mySelectedCell.getCaretX();
  }
  mySelectedCell=null;
  mySelectedStack.clear();
  setRootCell(createRootCell());
  EditorCell newSelection=null;
  if (selectionPoint != null) {
    newSelection=findNearestCell(selectionPoint.x,selectionPoint.y);
  }
  if (newSelection == null && prevSelectablePoint != null) {
    newSelection=findNearestCell(prevSelectablePoint.x,prevSelectablePoint.y);
  }
  if (newSelection != null) {
    changeSelection(newSelection);
    newSelection.setCaretX(caretX);
  }
}
