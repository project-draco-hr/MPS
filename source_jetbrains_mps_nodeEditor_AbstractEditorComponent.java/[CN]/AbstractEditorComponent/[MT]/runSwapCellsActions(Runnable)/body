{
  EditorCell selectedCell=getSelectedCell();
  int caretPosition=selectedCell instanceof EditorCell_Label ? ((EditorCell_Label)selectedCell).getTextLine().getCaretPosition() : 0;
  String id="";
  SNodeProxy nodeProxy=null;
  if (selectedCell != null) {
    nodeProxy=selectedCell.getSNodeProxy();
    id=(String)selectedCell.getUserObject(EditorCell.CELL_ID);
  }
  action.run();
  if (nodeProxy != null && id != null) {
    EditorCell newSelectedCell=findNodeCell(nodeProxy.getNode(),id);
    changeSelection(newSelectedCell);
    if (newSelectedCell instanceof EditorCell_Label) {
      ((EditorCell_Label)newSelectedCell).getTextLine().setCaretPosition(caretPosition);
    }
  }
 else {
    changeSelection(null);
  }
}
