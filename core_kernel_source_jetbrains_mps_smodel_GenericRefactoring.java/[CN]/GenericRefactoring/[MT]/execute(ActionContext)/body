{
  final RefactoringContext refactoringContext=new RefactoringContext();
  boolean success=myRefactoring.askForInfo(context,refactoringContext);
  if (!success)   return;
  if (myRefactoring.showsAffectedNodes()) {
    final SearchResults[] usagesContainer=new SearchResults[]{null};
    Thread thread=new Thread(){
      public void run(){
        CommandProcessor.instance().executeLightweightCommand(new Runnable(){
          public void run(){
            usagesContainer[0]=myRefactoring.getAffectedNodes(context,refactoringContext);
          }
        }
);
        ThreadUtils.runInUIThreadAndWait(new Runnable(){
          public void run(){
            SearchResults usages=usagesContainer[0];
            if (usages != null) {
              refactoringContext.setUsages(usages);
              NewRefactoringView.showRefactoringView(GenericRefactoring.this,context,refactoringContext);
            }
 else {
              doExecute(context,refactoringContext);
            }
          }
        }
);
      }
    }
;
    thread.start();
  }
 else {
    doExecute(context,refactoringContext);
  }
}
