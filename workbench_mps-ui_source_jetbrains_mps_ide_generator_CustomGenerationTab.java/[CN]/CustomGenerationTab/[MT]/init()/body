{
  JPanel p=new JPanel();
  JPanel p2=new JPanel();
  p2.setBorder(IdeBorderFactory.createTitledBorder("Custom generation plan"));
  p.setLayout(new BorderLayout());
  p.add(p2,BorderLayout.NORTH);
  p2.setLayout(new GridBagLayout());
  JLabel l=new JLabel("Model:");
  final JTextField f=new JTextField();
  f.setEditable(false);
  JButton b=new JButton("...");
  GridBagConstraints c=new GridBagConstraints();
  c.gridx=0;
  c.gridy=0;
  c.anchor=GridBagConstraints.LINE_START;
  p2.add(l,c);
  c.gridx++;
  c.fill=GridBagConstraints.HORIZONTAL;
  c.weightx=1.0;
  p2.add(f,c);
  c.gridx++;
  c.fill=GridBagConstraints.NONE;
  c.weightx=0;
  p2.add(b,c);
  myActualReference=myModuleFacet.getPlanModelReference();
  f.setText(myActualReference == null ? "<none>" : myActualReference.getModelName());
  b.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      ArrayList<SModelReference> models=new ModelAccessHelper(myProject.getModelAccess()).runReadAction(new Computable<ArrayList<SModelReference>>(){
        @Override public ArrayList<SModelReference> compute(){
          ArrayList<SModelReference> rv=new ArrayList<SModelReference>();
          for (          SModule module : new GlobalModuleDependenciesManager(myModuleFacet.getModule()).getModules(Deptype.VISIBLE)) {
            for (            SModel m : module.getModels()) {
              rv.add(m.getReference());
            }
          }
          return rv;
        }
      }
);
      myActualReference=CommonChoosers.showModelChooser(myProject,"Pick model with a generation plan",models);
      f.setText(myActualReference == null ? "<none>" : myActualReference.getModelName());
    }
  }
);
  setTabComponent(p);
}
