{
  if (template == null) {
    generator.showErrorMessage(inputNode,null,reductionRule,"couldn't apply reduction: no template declaration");
    throw new RuntimeException("no template declaration");
  }
  List<TemplateFragment> templateFragments=getTemplateFragments(template);
  if (templateFragments.size() != 1) {
    generator.showErrorMessage(inputNode,BaseAdapter.fromAdapter(template),reductionRule,"reduction template must have exactly one template fragment");
    throw new RuntimeException("reduction template must have exactly one template fragment");
  }
  TemplateFragment fragment=templateFragments.get(0);
  String mappingName=fragment.getName();
  if (mappingName == null) {
    mappingName=reductionRule.getName();
  }
  SNode fragmentNode=BaseAdapter.fromAdapter(fragment.getParent());
  return applyReductionRuleTemplateNode(inputNode,fragmentNode,mappingName,reductionRule,generator);
}
