{
  List<TemplateFragment> templateFragments=getTemplateFragments(templateDeclaration);
  if (templateFragments.isEmpty()) {
    LOG.warning("WARN: no template fragments found in " + templateDeclaration.getDebugText());
    return;
  }
  for (  TemplateFragment templateFragment : templateFragments) {
    SNode templateFragmentNode=templateFragment.getParent();
    String mappingName=templateFragment.getName();
    List<INodeBuilder> fragmentNodeBuilders=createNodeBuildersForTemplateNode(sourceNode,templateFragmentNode,mappingName,generator);
    for (    INodeBuilder fragmentBuilder : fragmentNodeBuilders) {
      fragmentBuilder.setRuleNode(ruleNode);
      INodeBuilder fragmentContextBuilder=getContextBuilderForTemplateFragment(templateFragmentNode,contextBuilder,generator);
      fragmentContextBuilder.addChildBuilder(fragmentBuilder);
    }
  }
}
