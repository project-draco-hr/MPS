{
  SNode referenceMacro=SNodeOperations.getAncestor(thisNode,"jetbrains.mps.lang.generator.structure.ReferenceMacro",false,false);
  SNode attributedNode=SNodeOperations.getParent(referenceMacro);
  String linkRole=AttributesRolesUtil.getLinkRoleFromLinkAttributeRole(referenceMacro.getRole_());
  ConceptAndSuperConceptsScope linkSearchScope=new ConceptAndSuperConceptsScope(SNodeOperations.getConceptDeclaration(attributedNode));
  SNode link=SNodeOperations.cast(linkSearchScope.getMostSpecificLinkDeclarationByRole(linkRole),"jetbrains.mps.lang.structure.structure.LinkDeclaration");
  SNode targetConcept=SLinkOperations.getTarget(link,"target",false);
  SNode expectedNodeType=new ReferenceMacro_GetReferent_Behavior.QuotationClass_mxwyp3_a0a6a1().createNode(targetConcept);
  if (SConceptOperations.isSubConceptOf(targetConcept,"jetbrains.mps.lang.core.structure.IResolveInfo")) {
    return new ReferenceMacro_GetReferent_Behavior.QuotationClass_mxwyp3_a0a0i0b().createNode(targetConcept);
  }
  return expectedNodeType;
}
