{
  try {
    final String fullClassName=this.myAuxModel.getLongName() + "." + AbstractEvaluationModel.EVALUATOR_NAME;
    InMemoryJavaGenerationHandler handler=new MyInMemoryJavaGenerationHandler(false,true,myGenerationListeners);
    AbstractEvaluationModel.MyCompilationResultAdapter compilationResult=new AbstractEvaluationModel.MyCompilationResultAdapter();
    handler.setCompilationListener(compilationResult);
    Project ideaProject=this.myAuxModule.getMPSProject().getProject();
    DefaultMessageHandler messageHandler=new DefaultMessageHandler(ideaProject);
    ProgressWindow progressWindow=new ProgressWindow(false,ideaProject);
    boolean successful=GenerationFacade.generateModels(myContext.getProject(),Collections.singletonList((SModelDescriptor)myAuxModel),myContext,handler,new ProgressMonitorAdapter(progressWindow),messageHandler,GenerationOptions.getDefaults().incremental(new AbstractEvaluationModel.MyIncrementalGenerationStrategy()).saveTransientModels(IS_DEVELOPER_MODE).rebuildAll(false).reporting(false,false,false,0).create(),myContext.getProject().getComponent(TransientModelsComponent.class));
    Disposer.dispose(progressWindow);
    String source=handler.getSources().get(fullClassName);
    if (successful && StringUtils.isNotEmpty(source)) {
      if (isDeveloperMode()) {
        System.err.println(source);
      }
      ClassLoader parentClassLoader=this.myUiState.getClass().getClassLoader();
      Class clazz=Class.forName(fullClassName,true,handler.getCompiler().getClassLoader(parentClassLoader));
      Evaluator evaluator;
      try {
        evaluator=(Evaluator)clazz.getConstructor(JavaUiState.class).newInstance(this.myUiState);
      }
 catch (      InvocationTargetException e) {
        myUiState=myDebugSession.refresh();
        evaluator=(Evaluator)clazz.getConstructor(JavaUiState.class).newInstance(this.myUiState);
      }
      return evaluator;
    }
 else     if (StringUtils.isNotEmpty(source) && !(successful)) {
      String text="Errors during compilation";
      if (compilationResult.hasErrors()) {
        text+=":\n" + compilationResult.getMessage();
      }
 else {
        text+=".";
      }
      throw new EvaluationException(text);
    }
 else {
      throw new EvaluationException("Errors during generation.");
    }
  }
 catch (  InvocationTargetException e) {
    throw new InvocationTargetEvaluationException(e.getCause());
  }
catch (  EvaluationException e) {
    throw e;
  }
catch (  Throwable t) {
    throw new EvaluationException(t);
  }
}
