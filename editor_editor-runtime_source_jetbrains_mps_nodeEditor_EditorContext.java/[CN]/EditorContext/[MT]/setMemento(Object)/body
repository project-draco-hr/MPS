{
  if (o instanceof Memento) {
    final Memento memento=(Memento)o;
    if (ModelAccess.instance().isInEDT()) {
      ModelAccess.instance().runReadAction(new Runnable(){
        public void run(){
          myNodeEditorComponent.relayout();
          memento.restore(myNodeEditorComponent);
        }
      }
);
      myNodeEditorComponent.flushEvents();
    }
 else {
      ModelAccess.instance().runReadInEDT(new Runnable(){
        @Override public void run(){
          myNodeEditorComponent.relayout();
          memento.restore(myNodeEditorComponent);
          ModelAccess.instance().runWriteInEDT(new Runnable(){
            @Override public void run(){
              myNodeEditorComponent.flushEvents();
            }
          }
);
        }
      }
);
    }
    return true;
  }
  return false;
}
